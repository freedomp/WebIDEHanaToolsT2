(function(){"use strict";jQuery.sap.require('sap.ushell.renderers.fiori2.search.SearchHelper');var S=sap.ushell.renderers.fiori2.search.SearchHelper;jQuery.sap.require('sap.ushell.renderers.fiori2.search.suggestions.InABaseSuggestionProvider');var I=sap.ushell.renderers.fiori2.search.suggestions.InABaseSuggestionProvider;jQuery.sap.require('sap.ushell.renderers.fiori2.search.suggestions.SuggestionTypes');var a=sap.ushell.renderers.fiori2.search.suggestions.SuggestionTypes;jQuery.sap.declare('sap.ushell.renderers.fiori2.search.suggestions.InA1SuggestionProvider');var m=sap.ushell.renderers.fiori2.search.suggestions.InA1SuggestionProvider=function(){this.init.apply(this,arguments);};m.prototype=jQuery.extend(new I(),{init:function(p){I.prototype.init.apply(this,arguments);this.getResultSet=S.refuseOutdatedRequests(this.getResultSet);},getResultSet:function(){return this.suggestionQuery.getResultSet();},abortSuggestions:function(){this.getResultSet.abort();},getSuggestions:function(){var t=this;if(!t.model.isBusinessObjSearchEnabled()){return jQuery.when([]);}if(t.model.getDataSource().equals(t.model.appDataSource)){return jQuery.when([]);}var s=t.model.getProperty('/searchBoxTerm');if(s.length<3&&t.model.isAllCategory()){return jQuery.when([]);}var b=t.splitSuggestionTerm(s);t.suggestionQuery.clearSearchTerms();if(b.searchTerm){t.suggestionQuery.addSearchTerm(b.searchTerm);}t.suggestionQuery.setSuggestionTerm(b.suggestionTerm);t.suggestionQuery.setDataSource(t.model.getProperty("/dataSource"));return t.getResultSet().then(function(r){var c=r.getElements();t.concatenateSearchTerm(c,b);var n=t.assembleNormalSuggestionItems(c,s);for(var i=0;i<n.length;i++){var d=n[i];if(t.model.isAllCategory()&&d.dataSourceLabel){d.label=d.label+" <i>in "+d.dataSourceLabel+"</i>";}}return n;});},assembleNormalSuggestionItems:function(s,b){var t=this;var r=[];for(var i=0;i<s.length;i++){var c=s[i];var f;if(i===0){f=c.labelRaw;}if(c.attribute.value!=="$$AllAttributes$$"){continue;}if(t.model.isAllCategory()){if(!c.dataSource.equals(t.model.allDataSource)){if(f===c.labelRaw){c.dataSourceLabel=c.dataSource.getLabel();}else{continue;}}}else{if(c.dataSource.equals(t.model.allDataSource)===true){c.dataSource=t.model.getDataSource();c.dataSourceLabel=c.dataSource.getLabel();}else{continue;}}if(jQuery.type(c.label)==="string"&&c.label.length<1){c.label=c.labelRaw;}c.type=a.SUGGESTION_TYPE_OBJECT_DATA;c.position=a.objectData.position;r.push(c);if(a.objectData.limit===r.length){break;}}return r;}});})();
