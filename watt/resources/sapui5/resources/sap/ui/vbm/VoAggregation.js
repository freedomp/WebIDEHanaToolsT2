/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2012 SAP AG. All rights reserved
 */
sap.ui.define(['sap/ui/core/Element','./library'],function(E,l){"use strict";var V=E.extend("sap.ui.vbm.VoAggregation",{metadata:{library:"sap.ui.vbm",properties:{minSel:{type:"string",group:"Misc",defaultValue:"0"},maxSel:{type:"string",group:"Misc",defaultValue:"n"}},events:{handleMoved:{},handleContextMenu:{},handleClick:{},select:{},deselect:{}}}});V.prototype.init=function(){this.BindingDiff=[];};V.prototype.handleSelectEvent=function(s,d){if(s){this.fireSelect({selected:d});}else{this.fireDeselect({deselected:d});}};V.prototype.isEventRegistered=function(n){var v=this.getItems();if(!v){return false;}for(var a=0,b=v.length;a<b;++a){var i=v[a];if(i.mEventRegistry[n]){return true;}}return false;};V.prototype.findSelected=function(s,d){var v=this.getItems();if(!v){return null;}var S=[];if(jQuery.type(d)=='object'){if(d["VB:s"]==(s?"true":"false")){for(var n=0;n<v.length;++n){if(v[n].sId==d["K"]){S.push(v[n]);}}}}else if(jQuery.type(d)=='array'){for(var a=0;a<d.length;++a){if(d[a]["VB:s"]==(s?"true":"false")){for(var b=0;b<v.length;++b){if(v[b].sId==d[a]["K"]){S.push(v[b]);}}}}}return S;};V.prototype.findInstance=function(n){var v=this.getItems();if(!v){return false;}var k=(n.indexOf(".")!==-1)?n.split(".")[1]:n;for(var a=0,b=v.length;a<b;++a){if(v[a].sId===k){return v[a];}}return null;};V.prototype.findInstanceByKey=function(n){var v=this.getItems();if(!v){return false;}var k=(n.indexOf(".")!==-1)?n.split(".")[1]:n;for(var a=0,b=v.length;a<b;++a){if(v[a].sId===k||v[a].getKey()===k){return v[a];}}return null;};V.prototype.getActionArray=function(){var i=this.getId();var a=[];if(this.mEventRegistry["handleMoved"]||this.isEventRegistered("handleMoved")){a.push({"id":i+"4","name":"handleMoved","refScene":"MainScene","refVO":i,"refEvent":"HandleMoved"});}if(this.mEventRegistry["handleContextMenu"]||this.isEventRegistered("handleContextMenu")){a.push({"id":i+"5","name":"handleContextMenu","refScene":"MainScene","refVO":i,"refEvent":"HandleContextMenu"});}if(this.mEventRegistry["handleClick"]||this.isEventRegistered("handleClick")){a.push({"id":i+"6","name":"handleClick","refScene":"MainScene","refVO":i,"refEvent":"HandleClick"});}if((this.mEventRegistry["select"]||this.mEventRegistry["deselect"])&&!this.isEventRegistered("click")){a.push({"id":i+"9","name":"click","refScene":"MainScene","refVO":i,"refEvent":"Click"});}return a;};V.prototype.getTemplateBindingInfo=function(){var b=this.getBindingInfo("items");if(b&&b.template){return b.template.mBindingInfos;}};V.prototype.getBindInfo=function(){var b={};var t=this.getTemplateBindingInfo();b.HS=(t)?t.hasOwnProperty("hotScale"):true;b.HDC=(t)?t.hasOwnProperty("hotDeltaColor"):true;b.SC=(t)?t.hasOwnProperty("selectColor"):true;b.FS=(t)?t.hasOwnProperty("fxsize"):true;b.FD=(t)?t.hasOwnProperty("fxdir"):true;b.ET=(t)?t.hasOwnProperty("entity"):true;b.LT=(t)?t.hasOwnProperty("labelText"):true;b.LBC=(t)?t.hasOwnProperty("labelBgColor"):true;b.LBBC=(t)?t.hasOwnProperty("labelBorderColor"):true;b.AR=(t)?t.hasOwnProperty("labelArrow"):true;b.LP=(t)?t.hasOwnProperty("labelPos"):true;b.TT=(t)?t.hasOwnProperty("tooltip"):true;b.DD=(t)?t.hasOwnProperty("dragData"):true;b.M=(t)?t.hasOwnProperty("changeable"):true;b.DS=(t)?t.hasOwnProperty("dragSource"):true;b.DT=(t)?t.hasOwnProperty("dropTarget"):true;b.LabelType=(t)?t.hasOwnProperty("labelType"):true;b.hasTemplate=(t)?true:false;return b;};V.prototype.getTemplateObject=function(){var t={};t['id']=this.getId();t['datasource']=t.id;var b=this.mBindInfo=this.getBindInfo();var v=(b.hasTemplate)?this.getBindingInfo("items").template:null;this.bHasType=b.LabelType||(v.mProperties["labelType"]!==sap.ui.vbm.SemanticType.None);if(b.HS){t['hotScale.bind']=t.id+".HS";}else{t.hotScale=v.getHotScale();}if(b.HDC){t['hotDeltaColor.bind']=t.id+".HDC";}else{t.hotDeltaColor=v.getHotDeltaColor();}if(b.SC){t['selectColor.bind']=t.id+".SC";}else{t.selectColor=v.getSelectColor();}if(b.FS){t['fxsize.bind']=t.id+".FS";}else{t.fxsize=v.getFxsize();}if(b.FD){t['fxdir.bind']=t.id+".FD";}else{t.fxdir=v.getFxdir();}if(b.ET){t['entity.bind']=t.id+".ET";}else{t.entity=v.getEntity();}if(b.LT){t['labelText.bind']=t.id+".LT";}else{t.labelText=v.getLabelText();}if(this.bHasType){t['labelIcon.bind']=t.id+".LIC";t['labelIconBgrdCol.bind']=t.id+".LICC";t['labelIconTextCol.bind']=t.id+".LICTC";t['labelBgColor.bind']=t.id+".LBC";t['labelBorderColor.bind']=t.id+".LBBC";}else{if(b.LBC){t['labelBgColor.bind']=t.id+".LBC";}else{t.labelBgColor=v.getLabelBgColor();}if(b.LBBC){t['labelBorderColor.bind']=t.id+".LBBC";}else{t.labelBorderColor=v.getLabelBorderColor();}}if(b.AR){t['labelArrow.bind']=t.id+".AR";}else{t.labelArrow=v.getLabelArrow();}if(b.LP){t['labelPos.bind']=t.id+".LP";}else{t.labelPos=v.getLabelPos();}if(b.TT){t['tooltip.bind']=t.id+".TT";}else{t.tooltip=v.getTooltip();}if(b.DD){t['dragdata.bind']=t.id+".DD";}else{t.dragdata=v.getDragData();}if(!b.M){t['VB:c']=v.getChangeable();}t.altBorderDeltaColor='#676767';return t;};V.prototype.getTypeObject=function(){var t={};t['name']=this.getId();t['key']='K';var m=this.getMinSel();if(m!="0"&&m!="1"){m="0";}var M=this.getMaxSel();if(M!="0"&&M!="1"&&M!="n"||M=="n"){M="-1";}t['minSel']=m;t['maxSel']=M;var b=this.mBindInfo;t.A=[{"name":"K","alias":"K","type":"string"},{"name":"VB:s","alias":"VB:s","type":"boolean"}];if(b.HS){t.A.push({"name":"HS","alias":"HS","type":"vector"});}if(b.HDC){t.A.push({"name":"HDC","alias":"HDC","type":"string"});}if(b.SC){t.A.push({"name":"SC","alias":"SC","type":"string"});}if(b.FS){t.A.push({"name":"FS","alias":"FS","type":"boolean"});}if(b.ET){t.A.push({"name":"ET","alias":"ET","type":"string"});}if(b.LT){t.A.push({"name":"LT","alias":"LT","type":"string"});}if(this.bHasType){t.A.push({"name":"LBC","alias":"LBC","type":"color"});t.A.push({"name":"LBBC","alias":"LBBC","type":"color"});t.A.push({"name":"LIC","alias":"LIC","type":"string"});t.A.push({"name":"LICC","alias":"LICC","type":"color"});t.A.push({"name":"LICTC","alias":"LICTC","type":"color"});}else{if(b.LBC){t.A.push({"name":"LBC","alias":"LBC","type":"color"});}if(b.LBBC){t.A.push({"name":"LBBC","alias":"LBBC","type":"color"});}}if(b.AR){t.A.push({"name":"AR","alias":"AR","type":"boolean"});}if(b.LIC){t.A.push({"name":"LIC","alias":"LIC","type":"string"});}if(b.LP){t.A.push({"name":"LP","alias":"LP","type":"long"});}if(b.TT){t.A.push({"name":"TT","alias":"TT","type":"string"});}if(b.DD){t.A.push({"name":"DD","alias":"DD","type":"string"});}if(b.DS||b.DT){t.N=[];if(b.DS){t.N.push({"name":"DS","A":{"name":"DGT","alias":"A","type":"string"}});}if(b.DT){t.N.push({"name":"DT","A":{"name":"DPT","alias":"A","type":"string"}});}}return t;};V.prototype.getDataObject=function(){var d={};d['name']=this.getId();d.E=[];var v=this.getItems();for(var n=0,a=v.length;n<a;++n){d.E.push(v[n].getDataElement());}return d;};V.prototype.getDragItemTemplate=function(i){var b=this.mBindInfo;var d=this.getDragSource();var D=[];for(var n=0,a=d.length;n<a;++n){D.push({"type":d[n].getType()});}if(b.DS){D.push({"datasource":i+".DS","type.bind":i+".DS.DGT"});}return D;};V.prototype.getDropItemTemplate=function(i){var b=this.mBindInfo;var d=this.getDropTarget();var D=[];for(var n=0,a=d.length;n<a;++n){D.push({"type":d[n].getType()});}if(b.DT){D.push({"datasource":i+".DT","type.bind":i+".DT.DPT"});}return D;};V.prototype.openDetailWindow=function(v,p,u){var P=this.getParent();P.mDTWindowCxt.bUseClickPos=u;P.mDTWindowCxt.open=true;P.mDTWindowCxt.src=v;P.mDTWindowCxt.key=v.getKey();P.mDTWindowCxt.params=p;P.m_bWindowsDirty=true;P.invalidate(this);};V.prototype.openContextMenu=function(t,v,m){this.oParent.openContextMenu(t,v,m);};V.prototype.handleChangedData=function(e){if(e&&e.length){for(var n=0,o,i;n<e.length;++n){o=e[n];i=this.findInstance(o.K);if(i){i.handleChangedData(o);}}}};V.prototype.updateAggregation=function(n){if(n==="items"){var b,B;if((b=this.mBindingInfos['items'])&&(B=b.binding)){B.enableExtendedChangeDetection(true);var c=B.getContexts();this.BindingDiff=(c.diff)?c.diff:[];}}E.prototype.updateAggregation.apply(this,arguments);};return V;});
