(function(){"use strict";jQuery.sap.require('sap.ushell.renderers.fiori2.search.SearchHelper');var S=sap.ushell.renderers.fiori2.search.SearchHelper;jQuery.sap.require('sap.ushell.renderers.fiori2.search.suggestions.SuggestionProvider');var a=sap.ushell.renderers.fiori2.search.suggestions.SuggestionProvider;jQuery.sap.require('sap.ushell.renderers.fiori2.search.suggestions.SuggestionTypes');var b=sap.ushell.renderers.fiori2.search.suggestions.SuggestionTypes;jQuery.sap.declare('sap.ushell.renderers.fiori2.search.suggestions.DataSourceSuggestionProvider');var m=sap.ushell.renderers.fiori2.search.suggestions.DataSourceSuggestionProvider=function(){this.init.apply(this,arguments);};m.prototype=jQuery.extend(new a(),{init:function(p){a.prototype.init.apply(this,arguments);this.suggestDataSources=S.refuseOutdatedRequests(this.suggestDataSources);},abortSuggestions:function(){this.suggestDataSources.abort();},getSuggestions:function(){if(!this.model.isBusinessObjSearchEnabled()){return jQuery.when([]);}if(!this.model.getDataSource().equals(this.model.allDataSource)){return jQuery.when([]);}return this.suggestDataSources();},suggestDataSources:function(){var t=this;return t.model.getServerDataSources().then(function(d){if(jQuery.inArray(t.model.appDataSource,d)<0){d.unshift(t.model.appDataSource);}if(jQuery.inArray(t.model.allDataSource,d)<0){d.unshift(t.model.allDataSource);}var s=t.model.getProperty('/searchBoxTerm');var c=s.replace(/\*/g,'');var T=new S.Tester(c);var o;var e;var f=[];for(var i=0;i<d.length;++i){var g=d[i];if(g.equals(t.model.getDataSource())){continue;}o=T.test(g.label);if(o.bMatch===true){e={};e.label='<i>'+sap.ushell.resources.i18n.getText("searchInPlaceholder",o.sHighlightedText)+'</i>';e.labelRaw='';e.dataSource=g;e.type=b.SUGGESTION_TYPE_DATASOURCE;e.position=b.datasource.position;f.push(e);if(f.length===b.datasource.limit){break;}}}return f;});}});})();
