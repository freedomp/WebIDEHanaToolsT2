jQuery.sap.declare('sap.suite.ui.generic.template.library-all');if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.js.AnnotationHelper')){(function(){"use strict";jQuery.sap.require('sap.ui.model.odata.AnnotationHelper');jQuery.sap.require('sap.ui.comp.smartfield.SmartField');jQuery.sap.declare("sap.suite.ui.generic.template.js.AnnotationHelper");sap.suite.ui.generic.template.js.AnnotationHelper={formatWithExpandSimple:function(i,d){var e=[],E;var m=i.getModel();var M=/^(\/dataServices\/schema\/\d+\/entityType\/\d+)(?:\/|$)/.exec(i.getPath());if(M&&M.length&&M[0]){var o=m.getProperty(M[0]);var n=m.getODataEntityContainer().namespace;var a=m.getODataEntityType(n+'.'+o.name);if(d&&d.Path){E=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,a,d.Path);if(E){e.push(E);}}else if(d&&d.Apply&&d.Apply.Name==="odata.concat"){d.Apply.Parameters.forEach(function(P){if(P.Type==="Path"){E=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,a,P.Value);if(E){if(e.indexOf(E)===-1){e.push(E);}}}});}if(e.length>0){var p=i.getSetting("preprocessorsData");if(p){var r=p.rootContextExpand||[];for(var j=0;j<e.length;j++){if(r.indexOf(e[j])===-1){r.push(e[j]);}}p.rootContextExpand=r;}}}return sap.ui.model.odata.AnnotationHelper.format(i,d);},formatWithExpand:function(i,d,e){sap.suite.ui.generic.template.js.AnnotationHelper.getNavigationPathWithExpand(i,d,e);i=i.getInterface(0);return sap.ui.model.odata.AnnotationHelper.format(i,d);},_getNavigationPrefix:function(m,e,p){var E="";var P=p.split("/");if(P.length>1){for(var i=0;i<(P.length-1);i++){var a=m.getODataAssociationEnd(e,P[i]);if(a){e=m.getODataEntityType(a.type);if(E){E=E+"/";}E=E+P[i];}else{return E;}}}return E;},getNavigationPathWithExpand:function(I,c,E){I=I.getInterface(0);var d=[],a=[],f,F=[];var m=I.getModel();var o=m.getODataEntitySet(E.name||'');var r=sap.ui.model.odata.AnnotationHelper.resolvePath(m.getContext(I.getPath()));var n=sap.ui.model.odata.AnnotationHelper.getNavigationPath(I,c);var N=n.replace("{","").replace("}","");if(N){var b=m.getODataEntityType(o.entityType);var A=m.getODataAssociationSetEnd(b,N);if(A&&A.entitySet){o=m.getODataEntitySet(A.entitySet);}}else{var b=m.getODataEntityType(E.entityType);}if(r){F=m.getObject(r);}F=F.Data||F;var g=function(P,k){var s=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,b,P);if(s){if(a.indexOf(s)===-1){a.push(s);}}if(k){try{d=sap.ui.comp.smartfield.SmartField.getSupportedAnnotationPaths(m,o,P,true)||[];}catch(e){d=[];}for(var i=0;i<d.length;i++){if(a.indexOf(d[i])===-1){a.push(d[i]);}}}};var h=function(P){if(P.Type==="LabeledElement"){g(P.Value.Path);}else if(P.Type==="Path"){g(P.Value);}};for(var i=0;i<F.length;i++){f=F[i];if(f.Value&&f.Value.Path){g(f.Value.Path,true);}if(f.Value&&f.Value.Apply&&f.Value.Apply.Name==="odata.concat"){f.Value.Apply.Parameters.forEach(h);}if(f.Action&&f.Action.Path){g(f.Action.Path);}if(f.Target&&f.Target.Path){g(f.Target.Path);}if(f.SemanticObject&&f.SemanticObject.Path){g(f.SemanticObject.Path);}if(f.Url&&f.Url.Path){g(f.Url.Path);}if(f.Url&&f.Url.Apply&&f.Url.Apply.Parameters){f.Url.Apply.Parameters.forEach(h);}if(f.UrlContentType&&f.UrlContentType.Path){g(f.UrlContentType.Path);}}if(F.name){g(F.name,true);}if(a.length>0){if(N===""){var p=I.getSetting("preprocessorsData");if(p){var R=p.rootContextExpand||[];for(var j=0;j<a.length;j++){if(R.indexOf(a[j])===-1){R.push(a[j]);}}p.rootContextExpand=R;}}else{n="{ path : '"+N+"', parameters : { expand : '"+a.join(',')+"'} }";}}return n;},isSelf:function(p){if(p===undefined||(p&&p.indexOf('@')===0&&p.indexOf('/')===-1)){return true;}return false;},number:function(v){if(!v){return NaN;}else if(v.Decimal){return+v.Decimal;}else if(v.Path){return'{'+v.Path+'}';}else{return NaN;}},formatColor:(function(){function f(v){if(!v){return NaN;}else if(v.Decimal){return v.Decimal;}else if(v.EnumMember){return'\''+v.EnumMember+'\'';}else if(v.Path){return'${'+v.Path+'}';}else{return NaN;}}function a(d){var c=d.Criticality;return'{= '+f(c)+' === \'UI.CriticalityType/Negative\' ? \'Error\' : '+f(c)+'=== \'UI.CriticalityType/Critical\' ? \'Critical\' : \'Good\'}';}function b(d){var v=f(d.Value);var c=d.CriticalityCalculation;return'{= ('+v+' < '+f(c.DeviationRangeLowValue)+' || '+v+' > '+f(c.DeviationRangeHighValue)+') ? \'Error\' : ('+v+' < '+f(c.ToleranceRangeLowValue)+' || '+v+' > '+f(c.ToleranceRangeHighValue)+') ? \'Critical\' : \'Good\'}';}return function(d){if(d.Criticality){return a(d);}else if(d.CriticalityCalculation){return b(d);}};})(),createP13N:function(c,C,d){var p="",a=[];if(d.Value.Path){p='\\{"columnKey":"'+d.Value.Path+'", "leadingProperty":"'+d.Value.Path;}else if(d.Value.Apply&&d.Value.Apply.Name==="odata.concat"){d.Value.Apply.Parameters.forEach(function(P){if(P.Type==="Path"){if(!p){p='\\{"columnKey":"'+P.Value+'", "leadingProperty":"'+P.Value;}else{a.push(P.Value);}}});}var m=this.getModel("meta");if(m){var e=m.getODataEntityType(c.entityType);if(e){var n=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,e,d.Value.Path);if(n){n=n+"/";}}}if(C["com.sap.vocabularies.Common.v1.Text"]){a.push(n+C["com.sap.vocabularies.Common.v1.Text"].Path);}if(C["Org.OData.Measures.V1.ISOCurrency"]){a.push(n+C["Org.OData.Measures.V1.ISOCurrency"].Path);}if(C["Org.OData.Measures.V1.Unit"]){a.push(n+C["Org.OData.Measures.V1.Unit"].Path);}if((d["RecordType"]==="com.sap.vocabularies.UI.v1.DataFieldWithUrl")&&d.Url&&d.Url.Apply&&d.Url.Apply.Parameters){d.Url.Apply.Parameters.forEach(function(P){if(P.Type==="LabeledElement"){a.push(n+P.Value.Path);}});}if(a.length>0){var A="";a.forEach(function(P){if(A){A=A+",";}A=A+P;});p+='", "additionalProperty":"'+A;}var N=false;if(c["Org.OData.Capabilities.V1.SortRestrictions"]&&c["Org.OData.Capabilities.V1.SortRestrictions"].NonSortableProperties){var b=c["Org.OData.Capabilities.V1.SortRestrictions"].NonSortableProperties;for(var i=b.length-1;i>=0;i--){if(b[i].PropertyPath===d.Value.Path){N=true;break;}}}if(!N){p+='", "sortProperty":"'+C.name;}var f=false;if(c["Org.OData.Capabilities.V1.FilterRestrictions"]){if(c["Org.OData.Capabilities.V1.FilterRestrictions"].Filterable!=='false'){if(c["Org.OData.Capabilities.V1.FilterRestrictions"].NonFilterableProperties){var g=c["Org.OData.Capabilities.V1.FilterRestrictions"].NonFilterableProperties;for(var j=g.length-1;j>=0;j--){if(g[j].PropertyPath===d.Value.Path){f=true;break;}}}}else{f=true;}}if(!f){p+='", "filterProperty":"'+C.name;}return p+'" \\}';},getEntitySetOfPath:function(c){var C="",r=c.getObject(),a=null,n=null,A=null,e=null,m=c.getModel(),E=null,s=[],b=null,d=null;var M=/^(\/dataServices\/schema\/\d+\/entityType\/\d+)(?:\/|$)/.exec(c.getPath());if(M){if(r.hasOwnProperty("AnnotationPath")){a=r.AnnotationPath;if(a.indexOf('/')>-1){n=a.split("/")[0];e=c.getObject(M[1]);A=m.getODataAssociationEnd(e,n);s=c.getObject('/dataServices/schema');jQuery.each(s,function(f,S){d=S.entityContainer;jQuery.each(d,function(i,o){jQuery.each(o.associationSet,function(i,g){jQuery.each(g.end,function(i,h){if(h.role===A.role){E=h.entitySet;b=f;return false;}});if(E){return false;}});if(E){return false;}});if(E){return false;}});if(E){jQuery.each(d,function(i,o){jQuery.each(o.entitySet,function(j,f){if(f.name===E){C='/dataServices/schema/'+b+'/entityContainer/'+i+'/entitySet/'+j;return false;}});if(C){return false;}});}}}}return C?C:undefined;},hasActions:function(P){for(var i=0;i<P.length;i++){if(P[i].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||P[i].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){return true;}}},getSortOrder:function(P){var s='';for(var i=0;i<P.length;i++){if(!s){s=P[i].Property.PropertyPath;}else{s=s+', '+P[i].Property.PropertyPath;}if(P[i].Descending){s=s+' '+P[i].Descending.Bool;}}return s;},replaceSpecialCharsInId:function(i){if(i.indexOf(" ")>=0){jQuery.sap.log.error("Annotation Helper: Spaces are not allowed in ID parts. Please check the annotations, probably something is wrong there.");}return i.replace("@","").replace("/","::").replace("#","::");},getStableIdPartFromDataField:function(d){var p="",I="";if(d.RecordType&&d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"){return sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Action.String);}else if(d.RecordType&&d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){if(d.SemanticObject.String){I=sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.SemanticObject.String);}else if(d.SemanticObject.Path){I=sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.SemanticObject.Path);}if(d.Action&&d.Action.String){I=I+"::"+sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Action.String);}else if(d.Action&&d.Action.Path){I=I+"::"+sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Action.Path);}return I;}else if(d.Value&&d.Value.Path){return sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Value.Path);}else if(d.Value&&d.Value.Apply&&d.Value.Apply.Name==="odata.concat"){for(var i=0;i<d.Value.Apply.Parameters.length;i++){if(d.Value.Apply.Parameters[i].Type==="Path"){if(p){p=p+"::";}p=p+sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Value.Apply.Parameters[i].Value);}}return p;}else{jQuery.sap.log.error("Annotation Helper: Unable to create a stable ID. Please check the annotations.");}},getStableIdPartFromDataPoint:function(d){var p="";if(d.Value&&d.Value.Path){return sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Value.Path);}else if(d.Value&&d.Value.Apply&&d.Value.Apply.Name==="odata.concat"){for(var i=0;i<d.Value.Apply.Parameters.length;i++){if(d.Value.Apply.Parameters[i].Type==="Path"){if(p){p=p+"::";}p=p+sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Value.Apply.Parameters[i].Value);}}return p;}else{jQuery.sap.log.error("Annotation Helper: Unable to create stable ID derived from annotations.");}},getStableIdPartFromFacet:function(f){if(f.RecordType&&f.RecordType==="com.sap.vocabularies.UI.v1.CollectionFacet"){if(f.ID&&f.ID.String){return f.ID.String;}else{jQuery.sap.log.error("Annotation Helper: Unable to create a stable ID. You have to set an ID at all collection facets.");return Math.floor((Math.random()*99999)+1).toString();}}else if(f.RecordType&&f.RecordType==="com.sap.vocabularies.UI.v1.ReferenceFacet"){return sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(f.Target.AnnotationPath);}else{jQuery.sap.log.error("Annotation Helper: Unable to create a stable ID. Please check the facet annotations.");return Math.floor((Math.random()*99999)+1).toString();}},extensionPointBeforeFacetExists:function(e,f,m){var E="BeforeFacet|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);if(m['sap.suite.ui.generic.template.ObjectPage.view.Details'][E]){return"true";}else{return"";}},extensionPointAfterFacetExists:function(e,f,m){var E="AfterFacet|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);if(m['sap.suite.ui.generic.template.ObjectPage.view.Details'][E]){return"true";}else{return"";}},getExtensionPointBeforeFacetTitle:function(e,f,m){var E="BeforeFacet|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);var o=m['sap.suite.ui.generic.template.ObjectPage.view.Details'][E];if(o&&o['sap.ui.generic.app']&&o['sap.ui.generic.app'].title){return o['sap.ui.generic.app'].title;}},getExtensionPointAfterFacetTitle:function(e,f,m){var E="AfterFacet|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);var o=m['sap.suite.ui.generic.template.ObjectPage.view.Details'][E];if(o&&o['sap.ui.generic.app']&&o['sap.ui.generic.app'].title){return o['sap.ui.generic.app'].title;}},getRepeatIndex:function(v){if(v&&v.getPath()){return parseInt(v.getPath().substring(v.getPath().lastIndexOf("/")+1),10)+1;}else{jQuery.sap.log.error("Annotation Helper: Unable to get index.");}},getColumnListItemType:function(l,s){var t="Inactive";if(l.name&&s&&s.length>0){s.forEach(function(S){if(l.name===S.entitySet){t="Navigation";}});}return t;},getEntityTypesForFormPersonalization:function(i,f,e){i=i.getInterface(0);var E=[];var m=i.getModel();var o=m.getODataEntitySet(e.name||'');var F=[];if(f.RecordType==="com.sap.vocabularies.UI.v1.CollectionFacet"&&f.Facets){F=f.Facets;}else if(f.RecordType==="com.sap.vocabularies.UI.v1.ReferenceFacet"){F.push(f);}F.forEach(function(f){var n;if(f.Target&&f.Target.AnnotationPath&&f.Target.AnnotationPath.indexOf("/")>0){n=f.Target.AnnotationPath.split("/")[0];var a=m.getODataEntityType(o.entityType);var A=m.getODataAssociationSetEnd(a,n);if(A&&A.entitySet){o=m.getODataEntitySet(A.entitySet);if(E.indexOf(o.entityType.split(".")[1])===-1){E.push(o.entityType.split(".")[1]);}}}else{if(E.indexOf(e.entityType.split(".")[1])===-1){E.push(e.entityType.split(".")[1]);}}});return E.join(", ");}};sap.suite.ui.generic.template.js.AnnotationHelper.getRepeatIndex.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.formatWithExpand.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.formatWithExpandSimple.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getNavigationPathWithExpand.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getEntityTypesForFormPersonalization.requiresIContext=true;})();};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.library')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
jQuery.sap.declare('sap.suite.ui.generic.template.library');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.library');sap.ui.define("sap/suite/ui/generic/template/library",['jquery.sap.global','sap/ui/core/library'],function(q,l){"use strict";sap.ui.getCore().initLibrary({name:"sap.suite.ui.generic.template",dependencies:["sap.ui.core"],types:["sap.suite.ui.generic.template.ListReport.nav.NavType","sap.suite.ui.generic.template.ListReport.nav.ParamHandlingMode","sap.suite.ui.generic.template.ListReport.nav.SuppressionBehavior","sap.suite.ui.generic.template.ListReport.nav.Severity"],interfaces:[],controls:[],elements:[],version:"1.32.6"});sap.suite.ui.generic.template.ListReport.nav.NavType={initial:"initial",URLParams:"URLParams",xAppState:"xAppState",iAppState:"iAppState",AppCtx:"AppCtx"};sap.suite.ui.generic.template.ListReport.nav.ParamHandlingMode={SelVarWins:"SelVarWins",URLParamWins:"URLParamWins",InsertInSelOpt:"InsertInSelOpt"};sap.suite.ui.generic.template.ListReport.nav.SuppressionBehavior={standard:0,ignoreEmptyString:1,raiseErrorOnNull:2,raiseErrorOnUndefined:4};sap.suite.ui.generic.template.ListReport.nav.Severity={INFO:"INFO",WARNING:"WARNING",ERROR:"ERROR",SUCCESS:"SUCCESS"};return sap.suite.ui.generic.template;},false);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ListReport.nav.Error')){jQuery.sap.declare('sap.suite.ui.generic.template.ListReport.nav.Error');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.EventProvider');jQuery.sap.require('sap.m.MessageBox');sap.ui.define("sap/suite/ui/generic/template/ListReport/nav/Error",["jquery.sap.global","sap/ui/base/EventProvider","sap/suite/ui/generic/template/library","sap/m/MessageBox"],function(q,E,T,M){"use strict";var S=T.ListReport.nav.SeverityType;var L=E.extend("sap.suite.ui.generic.template.ListReport.nav.Error",{metadata:{publicMethods:["getErrorCode","getSeverity","getPrevious","getI18n","getTextKey","getParameters","resolveUIText","resolveUITextDeep","showMessageBox","getErrorObject","setUIText","getUIText"],properties:[]},constructor:function(e,s,p,u){E.apply(this);this._sErrorCode=e;this._sSeverity=s;this._oPrevious=p;this.setUIText(u);},_sErrorCode:"",_sSeverity:"",_oPrevious:null,_mUIText:{oi18n:null,sTextKey:"",aParams:[]}});L.prototype.getErrorCode=function(){return this._sErrorCode;};L.prototype.getSeverity=function(){return this._sSeverity;};L.prototype.getPrevious=function(){return this._oPrevious;};L.prototype.getI18n=function(){return this._mUIText.oi18n;};L.prototype.getTextKey=function(){return this._mUIText.sTextKey;};L.prototype.getParameters=function(){return this._mUIText.aParams;};L.prototype.getUIText=function(){return this._mUIText;};L.prototype.setUIText=function(u){if(typeof u==="undefined"){return;}this._mUIText={};this._mUIText.oi18n=u.oi18n;this._mUIText.sTextKey=u.sTextKey;this._mUIText.aParams=u.aParams;if(typeof u.oi18n!=="undefined"||typeof u.sTextKey!=="undefined"||typeof u.aParams!=="undefined"){}};L.prototype.isUITextAvailable=function(){return this._mUIText.sTextKey!==""&&typeof this._mUIText.oi18n!==undefined;};L.prototype.resolveUIText=function(){if(!this.isUITextAvailable()){return"";}var g=[this._mUIText.sTextKey];if(typeof this._mUIText.aParams!=="undefined"){g.push(this._mUIText.aParams);}return this._mUIText.oi18n.getText.apply(this._mUIText.oi18n,g);};L.prototype.resolveUITextDeep=function(){var r=this._iterateThroughPreviousChain(function(e){if(!e.isUITextAvailable()){return undefined;}return e.resolveUIText();});if(typeof r==="undefined"){return"";}return r;};L.prototype._iterateThroughPreviousChain=function(v){var t=this;var r;while(typeof t!=="undefined"&&t!==null){r=v(t);if(typeof r!=="undefined"){return r;}t=this._oPrevious;}return undefined;};L.prototype.showMessageBox=function(d){if(typeof d==="undefined"){d=false;}var u="",s="";if(d){var r=this._iterateThroughPreviousChain(function(e){if(!e.isUITextAvailable()){return undefined;}return{severity:e._sSeverity,text:e.resolveUIText()};});if(typeof r==="undefined"){return;}s=r.severity;u=r.text;}else{s=this._sSeverity;u=this.resolveUIText();}var t;switch(s){case S.ERROR:t=M.Icon.ERROR;break;case S.INFO:t=M.Icon.INFORMATION;break;case S.WARNING:t=M.Icon.WARNING;break;case S.SUCCESS:t=M.Icon.SUCCESS;break;default:t=M.Icon.SUCCESS;}M.show(u,{icon:t});};L.prototype.getErrorObject=function(){var e=null;if(!this.isUITextAvailable()){e=new Error();}else{e=new Error(this.resolveUIText());}e.origin=this;return e;};return L;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ListReport.nav.SelectionVariant')){
/*
 * ! @copyright@
 */
jQuery.sap.declare('sap.suite.ui.generic.template.ListReport.nav.SelectionVariant');sap.ui.define("sap/suite/ui/generic/template/ListReport/nav/SelectionVariant",["./Error","sap/suite/ui/generic/template/library"],function(E,T){"use strict";var S=T.ListReport.nav.Severity;var a=sap.ui.base.Object.extend("sap.suite.ui.generic.template.ListReport.nav.SelectionVariant",{_rValidateSign:new RegExp("[E|I]"),_rValidateOption:new RegExp("EQ|NE|LE|GE|LT|GT|BT|CP"),constructor:function(s){this._mParameters={};this._mSelectOptions={};this._sId="";if(s!==undefined){if(typeof s==="string"){this._parseFromString(s);}else if(typeof s==="object"){this._parseFromObject(s);}else{throw new E("SelectionVariant.INVALID_INPUT_TYPE",S.ERROR);}}},getID:function(){return this._sId;},setID:function(i){this._sId=i;},setText:function(n){if(typeof n!=="string"){throw new E("SelectionVariant.INVALID_INPUT_TYPE",S.ERROR);}this._sText=n;},getText:function(){return this._sText;},setParameterContextUrl:function(u){if(typeof u!=="string"){throw new E("SelectionVariant.INVALID_INPUT_TYPE",S.ERROR);}this._sParameterCtxUrl=u;},getParameterContextUrl:function(){return this._sParameterCtxUrl;},getFilterContextUrl:function(){return this._sFilterCtxUrl;},setFilterContextUrl:function(u){if(typeof u!=="string"){throw new E("SelectionVariant.INVALID_INPUT_TYPE",S.ERROR);}this._sFilterCtxUrl=u;},addParameter:function(n,v){if(typeof n!=="string"){throw new E("SelectionVariant.INVALID_INPUT_TYPE",S.ERROR);}if(typeof v!=="string"){throw new E("SelectionVariant.INVALID_INPUT_TYPE",S.ERROR);}if(n===""){throw new E("SelectionVariant.PARAMETER_WITHOUT_NAME",S.ERROR);}if(this._mSelectOptions[n]){throw new E("SelectionVariant.PARAMETER_SELOPT_COLLISION",S.ERROR);}this._mParameters[n]=v;return this;},removeParameter:function(n){if(typeof n!=="string"){throw new E("SelectionVariant.INVALID_INPUT_TYPE",S.ERROR);}if(n===""){throw new E("SelectionVariant.PARAMETER_WITHOUT_NAME",S.ERROR);}delete this._mParameters[n];return this;},renameParameter:function(n,N){if(typeof n!=="string"||typeof N!=="string"){throw new E("SelectionVariant.INVALID_INPUT_TYPE",S.ERROR);}if(n===""||N===""){throw new E("SelectionVariant.PARAMETER_WITHOUT_NAME",S.ERROR);}if(this._mParameters[n]!==undefined){if(this._mSelectOptions[N]){throw new E("SelectionVariant.PARAMETER_SELOPT_COLLISION",S.ERROR);}if(this._mParameters[N]){throw new E("SelectionVariant.PARAMETER_COLLISION",S.ERROR);}this._mParameters[N]=this._mParameters[n];delete this._mParameters[n];}return this;},getParameter:function(n){if(typeof n!=="string"){throw new E("SelectionVariant.INVALID_INPUT_TYPE",S.ERROR);}return this._mParameters[n];},getParameterNames:function(){return Object.keys(this._mParameters);},addSelectOption:function(p,s,o,l,h){if(typeof p!=="string"){throw new E("SelectionVariant.INVALID_INPUT_TYPE",S.ERROR);}if(p===""){throw new E("SelectionVariant.INVALID_PROPERTY_NAME",S.ERROR);}if(typeof s!=="string"){throw new E("SelectionVariant.INVALID_INPUT_TYPE",S.ERROR);}if(typeof o!=="string"){throw new E("SelectionVariant.INVALID_INPUT_TYPE",S.ERROR);}if(typeof l!=="string"){throw new E("SelectionVariant.INVALID_INPUT_TYPE",S.ERROR);}if(o==="BT"&&typeof h!=="string"){throw new E("SelectionVariant.INVALID_INPUT_TYPE",S.ERROR);}if(!this._rValidateSign.test(s.toUpperCase())){throw new E("SelectionVariant.INVALID_SIGN",S.ERROR);}if(!this._rValidateOption.test(o.toUpperCase())){throw new E("SelectionVariant.INVALID_OPTION",S.ERROR);}if(this._mParameters[p]){throw new E("SelectionVariant.PARAMETER_SELOPT_COLLISION",S.ERROR);}if(o!=="BT"){if((h!==undefined)&&(h!=="")&&(h!==null)){throw new E("SelectionVariant.HIGH_PROVIDED_THOUGH_NOT_ALLOWED",S.ERROR);}}if(this._mSelectOptions[p]===undefined){this._mSelectOptions[p]=[];}var e={Sign:s.toUpperCase(),Option:o.toUpperCase(),Low:l};if(o==="BT"){e.High=h;}else{e.High=null;}for(var i=0;i<this._mSelectOptions[p].length;i++){var b=this._mSelectOptions[p][i];if(b.Sign===e.Sign&&b.Option===e.Option&&b.Low===e.Low&&b.High===e.High){return this;}}this._mSelectOptions[p].push(e);return this;},removeSelectOption:function(n){if(typeof n!=="string"){throw new E("SelectionVariant.SELOPT_WRONG_TYPE",S.ERROR);}if(n===""){throw new E("SelectionVariant.SELOPT_WITHOUT_NAME",S.ERROR);}delete this._mSelectOptions[n];return this;},renameSelectOption:function(n,N){if(typeof n!=="string"||typeof N!=="string"){throw new E("SelectionVariant.SELOPT_WRONG_TYPE",S.ERROR);}if(n===""||N===""){throw new E("SelectionVariant.SELOPT_WITHOUT_NAME",S.ERROR);}if(this._mSelectOptions[n]!==undefined){if(this._mSelectOptions[N]){throw new E("SelectionVariant.SELOPT_COLLISION",S.ERROR);}if(this._mParameters[N]){throw new E("SelectionVariant.PARAMETER_SELOPT_COLLISION",S.ERROR);}this._mSelectOptions[N]=this._mSelectOptions[n];delete this._mSelectOptions[n];}return this;},getSelectOption:function(p){if(typeof p!=="string"){throw new E("SelectionVariant.INVALID_INPUT_TYPE",S.ERROR);}if(p===""){throw new E("SelectionVariant.INVALID_PROPERTY_NAME",S.ERROR);}var e=this._mSelectOptions[p];if(!e){return undefined;}return JSON.parse(JSON.stringify(e));},getSelectOptionsPropertyNames:function(){return Object.keys(this._mSelectOptions);},getValue:function(n){var v=this.getSelectOption(n);if(v!==undefined){return v;}var p=this.getParameter(n);if(p!==undefined){v=[{Sign:"I",Option:"EQ",Low:p,High:null}];return v;}return undefined;},toJSONObject:function(){var e={Version:{Major:"1",Minor:"0",Patch:"0"},SelectionVariantID:this._sId};if(this._sParameterCtxUrl){e.ParameterContextUrl=this._sParameterCtxUrl;}if(this._sFilterCtxUrl){e.FilterContextUrl=this._sFilterCtxUrl;}if(this._sText){e.Text=this._sText;}else{e.Text="Selection Variant with ID "+this._sId;}this._determineODataFilterExpression(e);this._serializeParameters(e);this._serializeSelectOptions(e);return e;},toJSONString:function(){return JSON.stringify(this.toJSONObject());},_determineODataFilterExpression:function(e){e.ODataFilterExpression="";},_serializeParameters:function(e){if(this._mParameters.length===0){return;}e.Parameters=[];jQuery.each(this._mParameters,function(p,P){var o={PropertyName:p,PropertyValue:P};e.Parameters.push(o);});},_serializeSelectOptions:function(e){if(this._mSelectOptions.length===0){return;}e.SelectOptions=[];jQuery.each(this._mSelectOptions,function(p,b){var s={PropertyName:p,Ranges:b};e.SelectOptions.push(s);});},_parseFromString:function(j){if(j===undefined){throw new E("SelectionVariant.UNABLE_TO_PARSE_INPUT",S.ERROR);}if(typeof j!=="string"){throw new E("SelectionVariant.INVALID_INPUT_TYPE",S.ERROR);}var i=JSON.parse(j);this._parseFromObject(i);},_parseFromObject:function(i){if(i.SelectionVariantID===undefined){jQuery.sap.log.warning("SelectionVariantID is not defined");i.SelectionVariantID="";}this.setID(i.SelectionVariantID);if(i.ParameterContextUrl!==undefined&&i.ParameterContextUrl!==""){this.setParameterContextUrl(i.ParameterContextUrl);}if(i.FilterContextUrl!==undefined&&i.FilterContextUrl!==""){this.setFilterContextUrl(i.FilterContextUrl);}if(i.Text!==undefined){this.setText(i.Text);}if(i.Parameters){this._parseFromStringParameters(i.Parameters);}if(i.SelectOptions){this._parseFromStringSelectOptions(i.SelectOptions);}},_parseFromStringParameters:function(p){jQuery.each(p,jQuery.proxy(function(i,e){this.addParameter(e.PropertyName,e.PropertyValue);},this));},_parseFromStringSelectOptions:function(s){jQuery.each(s,jQuery.proxy(function(i,o){if(!o.Ranges){jQuery.sap.log.warning("Select Option object does not contain a Ranges entry; ignoring entry");return true;}if(!jQuery.isArray(o.Ranges)){throw new E("SelectionVariant.SELECT_OPTION_RANGES_NOT_ARRAY",S.ERROR);}jQuery.each(o.Ranges,jQuery.proxy(function(I,r){this.addSelectOption(o.PropertyName,r.Sign,r.Option,r.Low,r.High);},this));},this));}});return a;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.TemplateComponent')){jQuery.sap.require('sap.ui.generic.template.TemplateComponent');jQuery.sap.declare("sap.suite.ui.generic.template.lib.TemplateComponent");jQuery.sap.require('sap.ui.core.CustomizingConfiguration');(function(){var o=sap.ui.core.CustomizingConfiguration.getViewExtension;sap.ui.core.CustomizingConfiguration.getViewExtension=function(v,e,a){var c=a&&typeof a==="string"?a:(a&&sap.ui.core.Component.getOwnerIdFor(a));var C=c&&sap.ui.component(c);if(C instanceof sap.suite.ui.generic.template.lib.TemplateComponent){a=C.getAppComponent().getId();}var r=o(v,e,a);return r;};var O=sap.ui.core.CustomizingConfiguration.getControllerExtension;sap.ui.core.CustomizingConfiguration.getControllerExtension=function(c,C){var a=null;if(C){a=sap.ui.component(C);if(a instanceof sap.suite.ui.generic.template.lib.TemplateComponent){a=a.getAppComponent();if(a){C=a.getId();}}}var r=O(c,C);return r;};})();sap.ui.generic.template.TemplateComponent.extend("sap.suite.ui.generic.template.lib.TemplateComponent",{metadata:{library:"sap.suite.ui.generic.template",properties:{"isLeaf":{"type":"boolean"},preventBinding:{type:"boolean",defaultValue:true}}},getCreateMode:function(b){"use strict";var e;var m=this.getModel();if(b){if(m){e=m.getProperty(b);}}else{var c=this.getBindingContext();if(c){e=c.getObject();}}if(e&&e.__metadata&&e.__metadata.created){return true;}return false;},init:function(){"use strict";sap.ui.generic.template.TemplateComponent.prototype.init.apply(this,arguments);var u=new sap.ui.model.json.JSONModel({editable:false,enabled:false});this.setModel(u,"ui");},getEntityType:function(){"use strict";var m=this.getModel().getMetaModel();var e=m.getODataEntitySet(this.getEntitySet(),false);var E=m.getODataEntityType(e.entityType,false);return E.name;},bindComponent:function(){"use strict";var p={};if(this._sBindingPath){var c=this.getComponentContainer();if(c){if(this.getCreateMode(this._sBindingPath)){c.unbindElement();c.setBindingContext(c.getModel().getContext(this._sBindingPath));}else{var C=this.getComponentData();if(C&&C.preprocessorsData&&C.preprocessorsData.rootContextExpand&&C.preprocessorsData.rootContextExpand.length){p.expand=C.preprocessorsData.rootContextExpand.join(",");}c.bindElement({path:this._sBindingPath,parameters:p,batchGroupId:"Changes",changeSetId:"Changes"});}}}},onActivate:function(b){"use strict";this._sBindingPath=b;var c=this.getComponentContainer();if(c&&c.getElementBinding()){c.unbindElement();this.getModel("ui").setProperty("/enabled",false);this.getModel("ui").setProperty("/editable",false);}if(this.getAggregation("rootControl")){this.bindComponent();}if(this.getIsRefreshRequired()){this.refreshBinding();this.setIsRefreshRequired(false);}},refreshBinding:function(){"use strict";var e=this.getComponentContainer().getElementBinding();if(e){e.refresh();}}});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ListReport.Component')){jQuery.sap.declare("sap.suite.ui.generic.template.ListReport.Component");sap.suite.ui.generic.template.lib.TemplateComponent.extend("sap.suite.ui.generic.template.ListReport.Component",{metadata:{library:"sap.suite.ui.generic.template",properties:{"templateName":{"type":"string","defaultValue":"sap.suite.ui.generic.template.ListReport.view.ListReport"},"gridTable":"boolean","hideTableVariantManagement":"boolean"},"manifest":"json"},hasDraft:function(){"use strict";return this.getAppComponent().getTransactionController().getDraftController().getDraftContext().isDraftEnabled(this.getEntitySet());},refreshBinding:function(){"use strict";var v=this.getAggregation("rootControl");if(v instanceof sap.ui.core.mvc.XMLView){var s=v.byId("listReport");if(s&&s.rebindTable){s.rebindTable();}}}});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ListReport.nav.NavigationHandler')){jQuery.sap.declare('sap.suite.ui.generic.template.ListReport.nav.NavigationHandler');sap.ui.define("sap/suite/ui/generic/template/ListReport/nav/NavigationHandler",["./Error","./SelectionVariant","sap/suite/ui/generic/template/library"],function(E,S,T){"use strict";var N=T.ListReport.nav.NavType;var P=T.ListReport.nav.ParamHandlingMode;var a=T.ListReport.nav.Severity;var b=T.ListReport.nav.SuppressionBehavior;var c=sap.ui.base.Object.extend("sap.suite.ui.generic.template.ListReport.nav.NavigationHandler",{metadata:{publicMethods:["navigate","parseNavigation","storeInnerAppState","openSmartLinkPopover","mixAttributesAndSelectionVariant"]},constructor:function(C,p){this.oRouter=this._getRouter(C);this.oComponent=C.getOwnerComponent().getAppComponent();if(typeof this.oRouter==="undefined"||typeof this.oComponent==="undefined"){throw new E("NavigationHandler.INVALID_INPUT",a.ERROR);}try{this.oCrossAppNavService=sap.ushell.Container.getService("CrossApplicationNavigation");}catch(e){jQuery.sap.log.error("NavigationHandler: UShell service for cross app navigation is not available.");}this.IAPP_STATE="sap-iapp-state";this._oLastSavedInnerAppData={sAppStateKey:"",oAppData:{},iCacheHit:0,iCacheMiss:0};this._rIAppStateOld=new RegExp("/"+this.IAPP_STATE+"=([^/?]+)");this._rIAppStateOldAtStart=new RegExp("^"+this.IAPP_STATE+"=([^/?]+)");this._rIAppStateNew=new RegExp("[\?&]"+this.IAPP_STATE+"=([^&]+)");if(p===P.URLParamWins||p===P.InsertInSelOpt){this.sParamHandlingMode=p;}else{this.sParamHandlingMode=P.SelVarWins;}this.oi18n=new sap.ui.model.resource.ResourceModel({bundleName:"sap.suite.ui.generic.template.ListReport.i18n.i18n",bundleLocale:sap.ui.getCore().getConfiguration().getFormatLocale()}).getResourceBundle();},hasCrossApplicationNavigationService:function(){return this.oCrossAppNavService!==undefined;},_getRouter:function(C){return sap.ui.core.UIComponent.getRouterFor(C);},navigate:function(s,A,n,i,o){var d,p;if(typeof n==="string"){d=n;p=this._getURLParametersFromSelectionVariant(d);}else if(typeof n==="object"){p=n;var e=this._addParametersToAppData({},p);d=e.selectionVariant;}else{throw new E("NavigationHandler.INVALID_INPUT",a.ERROR);}var t=this;var f={target:{semanticObject:s,action:A},params:p||{}};var I=t.oCrossAppNavService.hrefForExternal(f);var g=t.oCrossAppNavService.isIntentSupported([I]);g.done(function(h){if(h[I].supported){var j=t.storeInnerAppState(i);j.done(function(){var O=function(q){f.appStateKey=q;t.oCrossAppNavService.toExternal(f,t.oComponent);};t._saveAppState({selectionVariant:d},O,o);});if(o){j.fail(function(m){o(m);});}}else if(o){var k="NavigationHandler.isIntentSupported.notSupported";var l=a.ERROR;var u={oi18n:t.oi18n,sTextKey:"INTENT_NOT_SUPPORTED",aParams:[s,A]};var m=new E(k,l,undefined,u);o(m);}});if(o){g.fail(function(){var h=t._createTechnicalError("NavigationHandler.isIntentSupported.failed");o(h);});}},parseNavigation:function(){var A=this.oRouter.oHashChanger.getHash();var i=this._getInnerAppStateKey(A);var C=this.oComponent.oComponentData;var s;if(C){s=C.startupParameters;}var m=jQuery.Deferred();var t=this;if(i){this._loadAppState(i,m);}else{var I=C!==undefined&&C["sap-xapp-state"]!==undefined;if(I){var o=this.oCrossAppNavService.getStartupAppState(this.oComponent);o.done(function(e){var f;var g=e.getData();if(!jQuery.isEmptyObject(s)){if(g){g=t._addParametersToAppData(g,s);m.resolve(g,s,N.xAppState);}else{f=t._createTechnicalError("NavigationHandler.getDataFromAppState.failed");m.reject(f,s,N.xAppState);}}else if(g){jQuery.sap.log.warning("Broken Sender navigation via xapp-state detected; sender did not provide legacy URL parameters");g.selectionVariant=t._ensureSelectionVariantFormatString(g.selectionVariant);m.resolve(g,{},N.xAppState);}else{jQuery.sap.log.warning("Broken Sender navigation via xapp-state detected; sender did not provide legacy URL parameters");f=t._createTechnicalError("NavigationHandler.getDataFromAppState.failed");m.reject(f,{},N.xAppState);}});o.fail(function(){var e=t._createTechnicalError("NavigationHandler.getStartupState.failed");m.reject(e,{},N.xAppState);});}else if(s){var d=t._addParametersToAppData({},s);m.resolve(d,s,N.URLParams);}else{m.resolve({},{},N.initial);}}return m.promise();},storeInnerAppState:function(i,I){if(typeof I!=="boolean"){I=true;}var t=this;var m=jQuery.Deferred();var r=function(s){var e=t.oRouter.oHashChanger.getHash();var f=t._replaceInnerAppStateKey(e,s);t.oRouter.oHashChanger.replaceHash(f);};var A=this._oLastSavedInnerAppData.sAppStateKey;var d=(JSON.stringify(i)===JSON.stringify(this._oLastSavedInnerAppData.oAppData));if(d&&A){this._oLastSavedInnerAppData.iCacheHit++;r(A);m.resolve(A);return m.promise();}this._oLastSavedInnerAppData.iCacheMiss++;var o=function(s){if(!I){r(s);}t._oLastSavedInnerAppData.oAppData=i;t._oLastSavedInnerAppData.sAppStateKey=s;m.resolve(s);};var O=function(e){m.reject(e);};var s=this._saveAppState(i,o,O);if(s!==undefined){if(I){r(s);}}return m.promise();},processBeforeSmartLinkPopoverOpens:function(t,s,i){var m=jQuery.Deferred();var d=t.semanticAttributes;var e=this;var f=function(d,s){s=s||"{}";var g=b.raiseErrorOnNull|b.raiseErrorOnUndefined;var M=e.mixAttributesAndSelectionVariant(d,s,g);s=M.toJSONString();d=e._getURLParametersFromSelectionVariant(M);var O=function(A){t.setSemanticAttributes(d);t.setAppStateKey(A);t.open();m.resolve(t);};var h=function(j){m.reject(j);};e._saveAppState({selectionVariant:s},O,h);};if(i){var o=this.storeInnerAppState(i,true);o.done(function(){f(d,s);});o.fail(function(g){m.reject(g);});}else{f(d,s);}return m.promise();},mixAttributesAndSelectionVariant:function(s,d,e){if(e===undefined){e=sap.suite.ui.generic.template.ListReport.nav.SuppressionBehavior.standard;}var o=new S(d);var n=new S();for(var p in s){if(s.hasOwnProperty(p)){var v=s[p];if(jQuery.type(v)==="array"||jQuery.type(v)==="object"){v=JSON.stringify(v);}else if(jQuery.type(v)==="date"){v=v.toJSON();}else if(jQuery.type(v)==="number"||jQuery.type(v)==="boolean"){v=v.toString();}if(v===""){if(e&b.ignoreEmptyString){jQuery.sap.log.info("Semantic attribute "+p+" is an empty string and due to the chosen Suppression Behiavour is being ignored.");continue;}}if(v===null){if(e&b.raiseErrorOnNull){throw new E("NavigationHandler.INVALID_INPUT",a.ERROR);}else{jQuery.sap.log.warning("Semantic attribute "+p+" is null and ignored for mix in to selection variant");continue;}}if(v===undefined){if(e&b.raiseErrorOnUndefined){throw new E("NavigationHandler.INVALID_INPUT",a.ERROR);}else{jQuery.sap.log.warning("Semantic attribute "+p+" is undefined and ignored for mix in to selection variant");continue;}}if(jQuery.type(v)==="string"){n.addSelectOption(p,"I","EQ",v);}else{throw new E("NavigationHandler.INVALID_INPUT",a.ERROR);}}}var f=o.getParameterNames();var i;for(i=0;i<f.length;i++){if(!n.getSelectOption(f[i])){n.addSelectOption(f[i],"I","EQ",o.getParameter(f[i]));}}var g=o.getSelectOptionsPropertyNames();for(i=0;i<g.length;i++){if(!n.getSelectOption(g[i])){var h=o.getSelectOption(g[i]);for(var j=0;j<h.length;j++){n.addSelectOption(g[i],h[j].Sign,h[j].Option,h[j].Low,h[j].High);}}}return n;},_ensureSelectionVariantFormatString:function(s){if(s===undefined){return undefined;}var C=s;if(typeof s==="object"){C=JSON.stringify(s);}return C;},_addParametersToAppData:function(A,s){var v=A.selectionVariant||{};var o=new S(v);for(var p in s){if(s.hasOwnProperty(p)){var V="";if(typeof s[p]==="string"){V=s[p];}else if(jQuery.type(s[p])==="array"&&s[p].length===1){V=s[p][0];}else{throw new E("NavigationHandler.INVALID_INPUT",a.ERROR);}if(typeof o.getSelectOption(p)==="undefined"&&typeof o.getParameter(p)==="undefined"){o.addSelectOption(p,"I","EQ",V);continue;}if(o.getSelectOption(p)||o.getParameter(p)){switch(this.sParamHandlingMode){case P.SelVarWins:break;case P.URLParamWins:o.removeSelectOption(p);o.removeParameter(p);o.addSelectOption(p,"I","EQ",V);break;case P.InsertInSelOpt:var O=o.getParameter(p);if(O){o.removeParameter(p);o.addSelectOption(p,"I","EQ",O);}o.addSelectOption(p,"I","EQ",V);break;default:break;}}}}A.selectionVariant=o.toJSONString();return A;},_saveAppState:function(A,o,O){var d=this.oCrossAppNavService.createEmptyAppState(this.oComponent);var s=d.getKey();var e;var f={selectionVariant:{},tableVariantId:"",customData:{}};if(A.selectionVariant){if(typeof A.selectionVariant==="string"){try{f.selectionVariant=JSON.parse(A.selectionVariant);}catch(x){e=this._createTechnicalError("NavigationHandler.AppStateSave.parseError");if(O){O(e);}return undefined;}}else{f.selectionVariant=A.selectionVariant;}}if(A.tableVariantId){f.tableVariantId=A.tableVariantId;}if(A.customData){f.customData=A.customData;}d.setData(f);var g=d.save();if(o){g.done(function(){o(s);});}if(O){var t=this;g.fail(function(){e=t._createTechnicalError("NavigationHandler.AppStateSave.failed");O(e);});}return s;},_loadAppState:function(A,d){var o=this.oCrossAppNavService.getAppState(this.oComponent,A);var t=this;o.done(function(e){var f={selectionVariant:"{}",tableVariantId:"",customData:{}};var g=e.getData();if(typeof g==="undefined"){var h=t._createTechnicalError("NavigationHandler.getDataFromAppState.failed");d.reject(h,{},N.iAppState);}else{if(g.selectionVariant){f.selectionVariant=t._ensureSelectionVariantFormatString(g.selectionVariant);}if(g.tableVariantId){f.tableVariantId=g.tableVariantId;}if(g.customData){f.customData=g.customData;}}d.resolve(f,{},N.iAppState);});o.fail(function(){var e=t._createTechnicalError("NavigationHandler.getAppState.failed");d.reject(e,{},N.iAppState);});},_getInnerAppStateKey:function(A){if(!A){return undefined;}var m=this._rIAppStateNew.exec(A);if(m===null){m=this._rIAppStateOld.exec(A);}if(m===null){m=this._rIAppStateOldAtStart.exec(A);}if(m===null){return undefined;}return m[1];},_replaceInnerAppStateKey:function(A,s){var n=this.IAPP_STATE+"="+s;if(!A){return"?"+n;}var f=function(A){if(A.indexOf("?")!==-1){return A+"&"+n;}return A+"?"+n;};if(!this._getInnerAppStateKey(A)){return f(A);}if(this._rIAppStateNew.test(A)){return A.replace(this._rIAppStateNew,function(d){return d.replace(/\=.*/ig,"="+s);});}var r=function(d,A){A=A.replace(d,"");return f(A);};if(this._rIAppStateOld.test(A)){return r(this._rIAppStateOld,A);}if(this._rIAppStateOldAtStart.test(A)){return r(this._rIAppStateOldAtStart,A);}return undefined;},_getURLParametersFromSelectionVariant:function(s){var u={};var i=0;var o;if(typeof s==="string"){o=new S(s);}else if(typeof s==="object"){o=s;}else{throw new E("NavigationHandler.INVALID_INPUT",a.ERROR);}var d=o.getSelectOptionsPropertyNames();for(i=0;i<d.length;i++){var e=o.getSelectOption(d[i]);if(e.length===1&&e[0].Sign==="I"&&e[0].Option==="EQ"){u[d[i]]=e[0].Low;}}var p=o.getParameterNames();for(i=0;i<p.length;i++){var f=o.getParameter(p[i]);u[p[i]]=f;}return u;},_createTechnicalError:function(e,p){var s=a.ERROR;var u={oi18n:this.oi18n,sTextKey:"TECHNICAL_ERROR"};return new E(e,s,p,u);}});return c;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ObjectPage.Component')){jQuery.sap.require('sap.ui.core.format.DateFormat');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.declare("sap.suite.ui.generic.template.ObjectPage.Component");sap.suite.ui.generic.template.lib.TemplateComponent.extend("sap.suite.ui.generic.template.ObjectPage.Component",{metadata:{library:"sap.suite.ui.generic.template",properties:{"templateName":{"type":"string","defaultValue":"sap.suite.ui.generic.template.ObjectPage.view.Details"},"attachmentSupport":"boolean","showRelatedApps":"boolean"},"manifest":"json"},updateBindingContext:function(){"use strict";sap.suite.ui.generic.template.lib.TemplateComponent.prototype.updateBindingContext.apply(this,arguments);var t=this;var b=this.getBindingContext();if(b){this.getModel().getMetaModel().loaded().then(function(){var u=t.getModel("ui");u.setProperty("/draftStatus",'');var a=b.getObject();if(a){var d=t.getAppComponent().getTransactionController().getDraftController();var D=d.getDraftContext();var I=D.hasDraft(b)&&!a.IsActiveEntity;var h=a.HasActiveEntity;if(t.getCreateMode()){u.setProperty("/createMode",true);u.setProperty("/editable",true);u.setProperty("/enabled",true);}else{if(I){if(h){u.setProperty("/createMode",false);u.setProperty("/editable",true);u.setProperty("/enabled",true);}else{u.setProperty("/createMode",true);u.setProperty("/editable",true);u.setProperty("/enabled",true);}}else{u.setProperty("/createMode",false);u.setProperty("/editable",false);if(a.hasOwnProperty("HasDraftEntity")&&a.HasDraftEntity&&D.hasSiblingEntity(t.getEntitySet())){u.setProperty("/enabled",false);t.getModel().read(b.getPath(),{urlParameters:{'$expand':"SiblingEntity,DraftAdministrativeData"},success:function(r){var s={};if(r.hasOwnProperty("SiblingEntity")){s=t.getModel().getContext("/"+t.getModel().getKey(r.SiblingEntity));}if(s){var S=s.getObject();if(S&&S.hasOwnProperty("IsActiveEntity")&&S.IsActiveEntity===false){var R=t.getModel("i18n").getResourceBundle();var m=t.getModel();var M=m.getMetaModel();var o=M.getODataEntitySet(t.getEntitySet());var c=M.getODataEntityType(o.entityType);var T="";var p;if(c["com.sap.vocabularies.Common.v1.Label"]){T=c["com.sap.vocabularies.Common.v1.Label"].String;if(T===""){p=c["com.sap.vocabularies.Common.v1.Label"].Path;if(p){T=a[p];}}}if(c["com.sap.vocabularies.UI.v1.HeaderInfo"]&&c["com.sap.vocabularies.UI.v1.HeaderInfo"].TypeName){if(T===""){T=c["com.sap.vocabularies.UI.v1.HeaderInfo"].TypeName.String;}if(T===""){p=c["com.sap.vocabularies.UI.v1.HeaderInfo"].TypeName.Path;if(p){T=a[p];}}}var O="";var e=c["com.sap.vocabularies.Common.v1.SemanticKey"];for(var i in e){var P=e[i];if(O===""){O=a[P.PropertyPath];}else{O=O+"-"+a[P.PropertyPath];}}var C="-";if(r.DraftAdministrativeData!==null&&r.DraftAdministrativeData.LastChangeDateTime!==null){var f=sap.ui.core.format.DateFormat.getDateTimeInstance({pattern:"MMMM d, yyyy HH:mm",style:"long"});C=f.format(r.DraftAdministrativeData.LastChangeDateTime);}var g=[T,O,C];var j=R.getText("DRAFT_FOUND_RESUME",g);var k=new sap.m.Dialog({title:R.getText("WARNING"),type:'Message',state:'Warning',content:new sap.m.Text({text:j}),buttons:[new sap.m.Button({text:R.getText("RESUME"),press:function(){k.close();t.getAppComponent().getNavigationController().navigateToContext(s,null,true);}}),new sap.m.Button({text:R.getText("DISCARD"),press:function(){k.close();u.setProperty("/enabled",true);var v=t.getAggregation("rootControl");var l=v.getController();l.oBaseViewController.deleteEntity(true);var L=sap.ui.getCore().byId(v.getAggregation("content")[0].getAggregation("content")[0].getAggregation("headerTitle").getId()+"-lock");L.setVisible(false);a.HasDraftEntity=false;var n=t.getAppComponent().getNavigationController().getViews();for(var q in n){var w=n[q].getComponentInstance();if(w.setIsRefreshRequired){w.setIsRefreshRequired(true);}}}})],afterClose:function(){k.destroy();}});k.open();}}u.setProperty("/enabled",true);}});}else{u.setProperty("/enabled",true);}}}}});}},refreshBinding:function(){"use strict";sap.suite.ui.generic.template.lib.TemplateComponent.prototype.refreshBinding.apply(this,arguments);var v=this.getAggregation("rootControl");if(v instanceof sap.ui.core.mvc.XMLView){try{v.getContent()[0].getContent()[0].getSections().forEach(function(s){s.getSubSections().forEach(function(S){S.getBlocks().forEach(function(b){if(b instanceof sap.ui.comp.smarttable.SmartTable){b.rebindTable();}});});});}catch(e){jQuery.sap.log.error("Object Page could not rebind tables");}}}});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.TemplateViewController')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.TemplateViewController');jQuery.sap.require('sap.ui.core.mvc.Controller');jQuery.sap.require('sap.ui.generic.template.BaseViewController');jQuery.sap.require('sap.ui.generic.template.ViewUtil');jQuery.sap.require('sap.m.Table');sap.ui.define("sap/suite/ui/generic/template/lib/TemplateViewController",["sap/ui/core/mvc/Controller","sap/ui/generic/template/BaseViewController","sap/ui/generic/template/ViewUtil","sap/m/Table","sap/suite/ui/generic/template/ListReport/nav/NavigationHandler","sap/suite/ui/generic/template/library"],function(m,B,V,T,N){"use strict";return m.extend("sap.suite.ui.generic.template.lib.TemplateViewController",{metadata:{library:"sap.suite.ui.generic.template"},onInit:function(){this.oBaseViewController=new B();this.oBaseViewController.onInit({showMessages:function(){var u=this.getView().getModel("ui");if(u){return u.getProperty("/editable")?false:true;}else{return true;}}});this.oBaseViewController.connectToView(this.getView());var c=this.getComponent();this._resourceBundle=c.getModel("i18n").getResourceBundle();if(typeof c.bindComponent==='function'){c.bindComponent();}},onShowMessages:function(e){var b=e.getSource();this.showMessagePopover(b,true);},showMessagePopover:function(b,t){return this.oBaseViewController.showMessagePopover(b,t);},handleSuccess:function(r,p){return this.oBaseViewController.handleSuccess(r,p);},handleError:function(e,p){return this.oBaseViewController.handleError(e,p);},getContext:function(){return this.oBaseViewController.getContext();},getComponent:function(){return this.oBaseViewController.getComponent();},getComponentContainer:function(){return this.oBaseViewController.getComponentContainer();},getTransactionController:function(){return this.oBaseViewController.getTransactionController();},getNavigationController:function(){return this.oBaseViewController.getNavigationController();},getDraftContext:function(){return this.oBaseViewController.getDraftContext();},onBack:function(){return this.goBack();},goBack:function(){window.history.back();},onEdit:function(){var t=this;var e=false;var c;var E=t.getComponent().getEntitySet();if(t.getDraftContext().isDraftEnabled(E)&&t.getDraftContext().isDraftRoot(E)){if(t.getDraftContext().hasDraftAdministrativeData(E)){var d=t.getContext().getProperty("DraftAdministrativeData");if(d&&!d.DraftIsProcessedByMe&&!d.InProcessByUser){e=true;c=d.CreatedByUser;}}else{var b=t.getComponent().getBindingContext();var M=t.getComponent().getModel();M.read(b.getPath(),{urlParameters:{"$expand":"SiblingEntity,DraftAdministrativeData"},success:function(r){if(r.DraftAdministrativeData&&!r.DraftAdministrativeData.DraftIsProcessedByMe&&!r.DraftAdministrativeData.InProcessByUser){e=true;c=r.DraftAdministrativeData.CreatedByUser;t.expiredLockDialog(c);}}});return;}}if(e){t.expiredLockDialog(c);}else{t.oBaseViewController.editEntity().then(function(C){var D;if(t.getDraftContext().hasDraft(C)){t._setRootPageToDirty();D=C&&C.context||C;}if(D){t.getNavigationController().navigateToContext(D,undefined,true);}else{var u=t.getView().getModel("ui");u.setProperty("/editable",true);}});}},expiredLockDialog:function(c){var t=this;var a=[c];var d=t._resourceBundle.getText("DRAFT_LOCK_EXPIRED",a);var D=new sap.m.Dialog({title:t._resourceBundle.getText("WARNING"),type:"Message",state:"Warning",content:new sap.m.Text({text:d}),buttons:[new sap.m.Button({text:t._resourceBundle.getText("EDIT"),press:function(){D.close();t.oBaseViewController.editEntity().then(function(C){var o;if(t.getDraftContext().hasDraft(C)){o=C&&C.context||C;}if(o){t.getNavigationController().navigateToContext(o,undefined,true);}else{var u=t.getView().getModel("ui");u.setProperty("/editable",true);}});}}),new sap.m.Button({text:t._resourceBundle.getText("CANCEL"),press:function(){D.close();}})],afterClose:function(){D.destroy();}});D.open();},fnDraftPopover:function(c,b,v,t){if(!c._oPopover){c._oPopover=sap.ui.xmlfragment("sap.suite.ui.generic.template.fragments.DraftAdminDataPopover",c);v.addDependent(c._oPopover);}else{c._oPopover.unbindElement();}var a=new sap.ui.model.json.JSONModel({IsActiveEntity:b.getProperty("IsActiveEntity"),HasDraftEntity:b.getProperty("HasDraftEntity")});c._oPopover.setModel(a,"admin");c._oPopover.bindElement({path:b.getPath()+'/DraftAdministrativeData'});if(c._oPopover.getBindingContext()!==undefined&&c._oPopover.getBindingContext()!==null){c._oPopover.openBy(t);}else{c._oPopover.getObjectBinding().attachDataReceived(jQuery.proxy(function(){c._oPopover.openBy(t);},this));c._oPopover.getObjectBinding().getModel().attachBatchRequestFailed(jQuery.proxy(function(){c._oPopover.openBy(t);},this));}var p=sap.ui.getCore().byId(c._oPopover.getAggregation("_internalHeader").getAggregation("contentRight")[0].getId());p.attachPress(function(e){e.getSource().getParent().getParent().close();});},formatText:function(){var a=Array.prototype.slice.call(arguments,1);var k=arguments[0];if(!k){return'';}var b=this.getView().getModel("i18n").getResourceBundle();if(a.length>0&&(a[0]===null||a[0]===undefined||a[0]==="")){if(a.length>2&&(a[1]===null||a[1]===undefined||a[1]==="")){return a[2];}else{return"";}}else{return b.getText(k,a[0]);}},formatDraftLockText:function(I,H,L){return this.formatDraftLockTextGeneric(I,H,L,this);},formatDraftLockTextGeneric:function(I,H,L,c){var b=c.getView().getModel("i18n").getResourceBundle();if(!I){return b.getText("DRAFT_OBJECT");}else if(H){if(L!==''){return b.getText("LOCKED_OBJECT");}else{return b.getText("UNSAVED_CHANGES");}}else{return"";}},onDiscardDraft:function(e){var c=e.getSource().getCustomData();var t=this;var C=t.getContext();var E=C.getObject();var p;var P;if(c&&c.length&&c[0]){p=c[0].getValue();}else{p=sap.m.PlacementType.Top;}if(E.hasOwnProperty("HasActiveEntity")&&!C.getProperty("IsActiveEntity")&&!C.getProperty("HasActiveEntity")){P=this._resourceBundle.getText("CANCEL_AND_DISCARD");}else{P=this._resourceBundle.getText("DISCARD_EDIT");}var o=new sap.m.Popover({placement:p,showHeader:false,content:new sap.m.VBox({items:[new sap.m.Text({text:P,width:'16rem'}),new sap.m.Button({text:this._resourceBundle.getText("DISCARD"),width:'100%',press:function(){var d=function(a){t.oBaseViewController.deleteEntity().then(function(){t._setRootPageToDirty();if(a&&a.getObject()&&a.getObject().IsActiveEntity){t.getNavigationController().navigateToContext(a,undefined,true);}else{t.goBack();}});};var M=t.getView().getModel();if(E.hasOwnProperty("HasActiveEntity")&&E.HasActiveEntity&&E.hasOwnProperty("SiblingEntity")){M.read(C.getPath()+"/SiblingEntity",{success:function(r){var C=M.getContext("/"+M.getKey(r));d(C);}});}else{d();}}})]})});o.addStyleClass("sapUiContentPadding");o.openBy(e.getSource());},onDelete:function(e){var c=e.getSource().getCustomData();var p;var t=this;if(c&&c.length&&c[0]){p=c[0].getValue();}else{p=sap.m.PlacementType.Top;}var P=new sap.m.ResponsivePopover({placement:p,showHeader:false,content:new sap.m.VBox({items:[new sap.m.Label({text:this._resourceBundle.getText("DELETE_QUESTION")}),new sap.m.Button({text:this._resourceBundle.getText("DELETE"),width:'100%',press:function(){t.oBaseViewController.deleteEntity().then(function(){t._setOthersToDirty();t.goBack();});}})]})});P.addStyleClass("sapUiContentPadding");P.openBy(e.getSource());},onRelatedApps:function(e){var t=this;t.oButton=e.getSource();t.oMetaModel=t.getComponent().getModel().getMetaModel();t.oContext=t.getContext();t.oParsedUrl=sap.ushell.Container.getService("URLParsing").parseShellHash(document.location.hash);var l=sap.ushell.Container.getService("CrossApplicationNavigation").getSemanticObjectLinks(t.oParsedUrl.semanticObject);l.done(function(L){var E=t.oContext.getObject();var s=E.__metadata.type;var d=t.oMetaModel.getODataEntityType(s);var S=d["com.sap.vocabularies.Common.v1.SemanticKey"];var p={};if(S&&S.length>0){for(var j in S){var a=S[j].PropertyPath;if(!p[a]){p[a]=[];p[a].push(E[a]);}}}else{for(var k in d.key.propertyRef){var o=d.key.propertyRef[k].name;if(!p[o]){p[o]=[];p[o].push(E[o]);}}}var b=[];var c=t.oParsedUrl.semanticObject+"-"+t.oParsedUrl.action;for(var i in L){var f=L[i];if(f.intent.indexOf(c)<0){b.push(f);}}var A=new sap.m.ActionSheet({placement:sap.m.PlacementType.Bottom,showCancelButton:false});if(b.length>0){for(var n in b){var g=b[n];var h=new sap.m.Button({text:g.text});h.attachPress(t.onPressLinkedApps,t);h.addCustomData(new sap.ui.core.CustomData({key:"linkData",value:{"oParam":p,"oLinkforNav":g}}));A.addButton(h);}}else{var q=new sap.m.Button({text:sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("LIST_NO_DATA"),enabled:false});A.addButton(q);}A.openBy(t.oButton);});},onPressLinkedApps:function(e){var b=e.getSource();var l=b.getCustomData()[0].getValue();var s=l.oLinkforNav.intent;var S=s.substring(1,s.indexOf("-"));var p=(s.indexOf("~")>-1)?s.indexOf("~"):s.length;var a=s.substring(s.indexOf("-")+1,p);var n={target:{semanticObject:S,action:a},params:l.oParam};this.oCrossAppNavService=sap.ushell.Container.getService("CrossApplicationNavigation").toExternal(n);},showMessagesButton:function(M){if(M&&M.length&&M.length>0){return true;}else{return false;}},showMessagesButtonText:function(M){return M&&M.length||'';},onActivate:function(){var t=this;this.oBaseViewController.activateDraftEntity().then(function(r){sap.m.MessageToast.show(t._resourceBundle.getText("OBJECT_SAVED"));if(r&&r.context){t._setRootPageToDirty();t.getNavigationController().navigateToContext(r.context,undefined,true);}});},onSave:function(){var t=this;this.oBaseViewController.saveEntity().then(function(c){var n=t.getNavigationController();var u=t.getView().getModel("ui");u.setProperty("/editable",false);if(t.getComponent().getCreateMode()){if(c){n.navigateToContext(c,undefined,true);}setTimeout(function(){sap.m.MessageToast.show(this._resourceBundle.getText("OBJECT_CREATED"));},10);}else{sap.m.MessageToast.show(this._resourceBundle.getText("OBJECT_SAVED"));}});},onCallActionFromList:function(e,s){var o,i;if(e){var t=e.getSource().getParent().getParent().getTable();var c=this._getSelectedContext(t);var C=this._getCustomData(e);var n=new N(this);if(C.Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"){this._callAction(e,C,c,"",t);}else if(n){var S=c.getObject();delete S.__metadata;if(s){var a=this.oSmartFilterBar.getDataSuiteFormat()||"{}";S=this._filterObjectsFromJSON(S);o=n.mixAttributesAndSelectionVariant(S,a).toJSONString();i={selectionVariant:this.oSmartFilterBar.getDataSuiteFormat(),tableVariantID:this.oSmartTable.getCurrentVariantId()};}else{jQuery.extend(S,this.getContext().getObject());o=this._filterObjectsFromJSON(S);o=JSON.stringify(o);i={};}var f=jQuery.proxy(this._handleError,this);n.navigate(C.SemanticObject,C.Action,o,i,f);}}},onCallAction:function(e){var c=this._getCustomData(e);var C=this.getContext();if(C&&c.Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"){this._callAction(e,c,C,this.getComponent().getNavigationProperty(),"");}},onCancel:function(){var u=this.getView().getModel("ui");u.setProperty("/editable",false);u.setProperty("/enabled",true);this.getView().getModel().resetChanges();if(this.getComponent().getCreateMode()){this.goBack();}},triggerPrepareOnEnterKeyPress:function(){var d=this.getDraftContext();if(d.isDraftEnabled(this.getComponent().getEntitySet())){var t=this;this.getView().attachBrowserEvent("keyup",function(b){if(b.keyCode===13&&t.getView().getModel("ui").getProperty("/editable")){var c=t.getContext();if(c&&d.hasDraftPreparationAction(c)){t.getTransactionController().getDraftController().saveAndPrepareDraftEntity(c,{binding:t.getComponentContainer().getElementBinding()}).then(function(r){t.oBaseViewController.handleSuccess(r);t._setOthersToDirty();},function(e){t.oBaseViewController.handleError(e);});}}});}},onBeforeRebindTable:function(e){var b=e.getParameter("bindingParams");b.parameters=b.parameters||{};var s=e.getSource();this.oBaseViewController.getTableQueryParameters(s.getEntitySet(),b);var S=b.parameters.select&&b.parameters.select.split(',')||[];var E=b.parameters&&b.parameters.expand&&b.parameters.expand.split(',')||[];var a=s.getEntitySet();for(var i=0;i<S.length;i++){if(S[i].indexOf("/")!==-1){var p=S[i].split("/");p.pop();var n=p.join("/");if(E.indexOf(n)===-1){E.push(n);}}}if(this.getDraftContext().isDraftEnabled(a)&&this.getDraftContext().isDraftRoot(a)){if(this.getTransactionController().getDraftController().getDraftContext().hasDraftAdministrativeData(a)){if(S&&S.length>0){if(S.indexOf("DraftAdministrativeData")===-1){b.parameters.select=b.parameters.select+',DraftAdministrativeData';}}if(E.indexOf("DraftAdministrativeData")===-1){E.push("DraftAdministrativeData");}}}if(E.length>0){b.parameters.expand=E.join(",");}var c=s.getCustomData();var C={};for(var k=0;k<c.length;k++){C[c[k].getKey()]=c[k].getValue();}var t=s.getTable();var v=s.fetchVariant();var d=true;for(var f in v){if(v.hasOwnProperty(f)){d=false;}}if(d&&t instanceof T&&C.TemplateSortOrder){var g=C.TemplateSortOrder.split(', ');for(var j=0;j<g.length;j++){var h=g[j].split(' ');if(h.length>1){b.sorter.push(new sap.ui.model.Sorter(h[0],h[1]==="true"));}else{b.sorter.push(new sap.ui.model.Sorter(h[0]));}}}},onListNavigate:function(e){e.getSource().detachPress("onListNavigate");var r=this.oBaseViewController.navigateFromListItem(e.getSource());e.getSource().attachPress("onListNavigate");return r;},navigateFromListItem:function(i,t){return this.oBaseViewController.navigateFromListItem(i,t);},addEntry:function(e){var t=this;var o=V.getParentTable(e.getSource());return this.oBaseViewController.addEntry(o).then(function(){t._setMeToDirty();});},onSearch:function(e){var t=V.getParentTable(e.getSource());return this.oBaseViewController.searchOnTable(t,e.getParameter("query"));},onChange:function(e){var t=this;var p=e.getSource().getBindingPath("value");if(this.getDraftContext().hasDraft(this.getContext())){var u=this.getView().getModel("ui");if(u){var M=this.getView().getModel();M.attachEventOnce("requestSent",function(){u.setProperty("/draftStatus",t._resourceBundle.getText("DRAFT_SAVING"));});var r;var R=function(){u.setProperty("/draftStatus",t._resourceBundle.getText("DRAFT_SAVED"));M.detachEvent("requestCompleted",R);M.detachEvent("requestFailed",r);};r=function(){u.setProperty("/draftStatus",t._resourceBundle.getText("DRAFT_NOT_SAVED"));M.detachEvent("requestCompleted",R);M.detachEvent("requestFailed",r);};M.attachRequestCompleted(R);M.attachRequestFailed(r);}}return this.oBaseViewController.modifyEntity(p,e.getSource());},onContactDetails:function(e){if(!this.oPopover){this.oPopover=e.getSource().getParent().getParent().getParent().getParent().getParent().getAggregation("items")[1];}this.oPopover.bindElement(e.getSource().getBindingContext().getPath());this.oPopover.openBy(e.getSource());},_setEnabledOfExportToExcel:function(t,e){var c=t.length;for(var n=c-1;n>=0;--n){if(t[n].getIcon()==="sap-icon://excel-attachment"){t[n].setProperty("enabled",e);break;}}return this;},_setRootPageToDirty:function(){var v=this.getNavigationController().getViews();if(v&&v.root){var i=v.root.getComponentInstance();if(i&&typeof i.setIsRefreshRequired==='function'){i.setIsRefreshRequired(true);}}},_setMeToDirty:function(){var v=this.getNavigationController().getViews();var M=this.getComponent().getId();for(var s in v){var i=v[s].getComponentInstance();if(i){if(i.getId()===M){if(typeof i.setIsRefreshRequired==='function'){i.setIsRefreshRequired(true);}return;}}}},_setOthersToDirty:function(){var v=this.getNavigationController().getViews();var M=this.getComponent().getId();for(var s in v){var i=v[s].getComponentInstance();if(i){if(i.getId()===M){continue;}if(typeof i.setIsRefreshRequired==='function'){i.setIsRefreshRequired(true);}}}},_getCustomData:function(e){var c=e.getSource().getCustomData();var C={};for(var i=0;i<c.length;i++){C[c[i].getKey()]=c[i].getValue();}return C;},_checkActionCustomData:function(c){if(!c.Action){throw"Template Error: Function Import Name not found in custom data";}if(!c.Label){c.Label=c.Action;}},_getSelectedContext:function(t){var s=[];if(t instanceof T){s=t.getSelectedContexts();}else{var I=t.getSelectedIndices();for(var i=0;i<I.length;i++){s.push(t.getContextByIndex(I[i]));}}var S=null;var b=new sap.ui.model.resource.ResourceModel({bundleName:"sap/suite/ui/generic/template/ListReport/i18n/i18n"}).getResourceBundle();var c=!!this.getView().$().closest(".sapUiSizeCompact").length;if((!s||s.length===0)){sap.m.MessageBox.error(b.getText("NO_ITEM_SELECTED"),{styleClass:c?"sapUiSizeCompact":""});return undefined;}else if(s.length>1){sap.m.MessageBox.error(b.getText("MULTIPLE_ITEMS_SELECTED"),{styleClass:c?"sapUiSizeCompact":""});return undefined;}else{S=s[0];}return S;},_filterObjectsFromJSON:function(j){var f={};for(var p in j){var a=j[p];if(jQuery.type(a)!=="object"){f[p]=a;}}return f;},_handleError:function(e){if(e instanceof Error){e.showMessageBox();}},_callAction:function(e,c,C,n,s){this._checkActionCustomData(c);return this.oBaseViewController.callAction({functionImportPath:c.Action,context:C,sourceControl:s,label:c.Label,navigationProperty:n});},_getTableFromContent:function(c){var t=null;if(c&&c.length>0){for(var i=0;i<c.length;i++){var C=c[i];if(C instanceof sap.m.Table||C instanceof sap.ui.comp.smarttable.SmartTable){t=C;return t;}else{try{t=this._getTableFromContent(C.getContent());if(t){return t;}}catch(e){continue;}}}}return t;}});},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ListReport.view.ListReport.controller')){jQuery.sap.declare('sap.suite.ui.generic.template.ListReport.view.ListReport.controller');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.Table');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.Link');jQuery.sap.require('sap.ui.core.Icon');jQuery.sap.require('sap.m.HBox');jQuery.sap.require('sap.m.ObjectIdentifier');jQuery.sap.require('sap.ui.comp.smarttable.SmartTable');jQuery.sap.require('sap.ui.comp.smartfield.SmartField');sap.ui.define("sap/suite/ui/generic/template/ListReport/view/ListReport.controller",["sap/suite/ui/generic/template/lib/TemplateViewController","sap/ui/model/json/JSONModel","sap/m/Table","sap/m/Text","sap/m/Link","sap/ui/core/Icon","sap/m/HBox","sap/m/ObjectIdentifier","sap/ui/comp/smarttable/SmartTable","sap/ui/comp/smartfield/SmartField","sap/suite/ui/generic/template/ListReport/nav/NavigationHandler","sap/suite/ui/generic/template/library","sap/suite/ui/generic/template/ListReport/nav/SelectionVariant","sap/suite/ui/generic/template/ListReport/nav/Error"],function(B,J,T,a,L,I,H,O,S,b,N,d,e,E){"use strict";var f=d.ListReport.nav.NavType;var l=B.extend("sap.suite.ui.generic.template.ListReport.view.ListReport",{bOnInitFinished:false,bFilterBarInitialized:false,onInit:function(){B.prototype.onInit.apply(this,arguments);var t=this;var C=this.getComponent();var v=this.getView();var o=v.byId("listReport");var s=C.getEntitySet();var A=new sap.ui.model.json.JSONModel({HasDetail:!this.getOwnerComponent().getIsLeaf()});A.setDefaultBindingMode("OneWay");v.setModel(A,"admin");var g=new sap.ui.model.json.JSONModel({DraftState:" "});v.setModel(g,"sfb");var G=jQuery.sap.getObject("sap.ushell.Container.getUser");var m=this.getOwnerComponent().getAppComponent().getMetadata().getManifestEntry("sap.ui");var h=(m&&m.icons&&m.icons.icon)?m.icons.icon:"";var j=new J({bookmarkIcon:h,bookmarkCustomUrl:function(){try{this.storeCurrentAppState();}catch(U){jQuery.sap.log.error("ListReport.bookmarkCustomUrl: "+U);}return document.URL;}.bind(this),bookmarkServiceUrl:function(){if(this.oSmartTable.getTable().getBinding("rows")){return this.oSmartTable.getTable().getBinding("rows").getDownloadUrl()+"&$top=0&$inlinecount=allpages";}else if(this.oSmartTable.getTable().getBinding("items")){return this.oSmartTable.getTable().getBinding("items").getDownloadUrl()+"&$top=0&$inlinecount=allpages";}else{return"";}}.bind(this),isShareInJamActive:G?G().isJamActive():false});j.setDefaultBindingMode("OneWay");v.setModel(j,"share");this.oSmartTable=this.byId("listReport");this.oSmartFilterBar=this.byId("listReportFilter");if(sap.ui.Device.system.desktop){v.addStyleClass("sapUiSizeCompact");o.addStyleClass("sapUiSizeCondensed");}else{o.addStyleClass("sapUiSizeCozy");}var D=function(U,V){return(!U||(U&&V));};var n=function(U,V,W){this.removeStyleClass("sapSmartTemplatesListReportDraftInfoIcon");this.addStyleClass("sapSmartTemplatesListReportDraftInfoIcon");return((U&&V&&W!==''));};var p=function(U,V,W){return t.formatDraftLockTextGeneric(U,V,W,t);};var q=function(U){var V=U.getSource().getBindingContext();t.oButton=U.getSource();B.prototype.fnDraftPopover.call(this,t,V,t.oView,t.oButton);};if(o instanceof S){for(var i=0;i<o.getItems().length;i++){if(o.getItems()[i]instanceof T){o=o.getItems()[i];if(C.hasDraft()){jQuery.sap.log.info(s+" is draft enabled");var r=this.getTransactionController().getDraftController().getDraftContext().hasDraftAdministrativeData(s);if(!r){jQuery.sap.log.info(s+" doesn't have nav. prop. DraftAdministrativeData - no admin data is shown");}else{var u=o.getItems()||[];var w=u[0];if(w){var x=w.getCells()||[];var y=this.getTransactionController().getDraftController().getDraftContext().getSemanticKey(s);var z="";var F;var K;var M;var P;for(var k=0;k<y.length;k++){for(var c=0;c<x.length;c++){u=x[c].getItems();for(i=0;i<u.length;i++){if(u[i]instanceof O){z=u[i].getBindingPath("title");}else if(u[i]instanceof b){z=u[i].getBindingPath("value");}else{z=u[i].getBindingPath("text");}if(!(P&&M)){M=u[i];P=x[c];}if(z===y[k].name){F=u[i];K=x[c];break;}}if(F){break;}}if(F){break;}}if(!(K&&F)){K=P;F=M;}if(!(K&&F)){jQuery.sap.log.info("No semantic key found in Object List - no admin data is shown");}else{if(!(F instanceof O)){if(F instanceof a){z=F.getBindingPath("text");K.removeItem(F);F=new O({title:{path:z}});K.addItem(F);}}var Q=new I({src:"sap-icon://locked",enabled:{parts:[{path:'IsActiveEntity'},{path:'HasDraftEntity'},{path:'DraftAdministrativeData/InProcessByUser'}],formatter:n},visible:{parts:[{path:'IsActiveEntity'},{path:'HasDraftEntity'},{path:'DraftAdministrativeData/InProcessByUser'}],formatter:n}}).addStyleClass("sapUiTinyMarginTop");var R=new L({enabled:{parts:[{path:'IsActiveEntity'},{path:'HasDraftEntity'}],formatter:D},visible:{parts:[{path:'IsActiveEntity'},{path:'HasDraftEntity'}],formatter:D},press:q,text:{parts:[{path:'IsActiveEntity'},{path:'HasDraftEntity'},{path:'DraftAdministrativeData/InProcessByUser'}],formatter:p}}).addStyleClass("sapUiTinyMarginTop");K.addItem(new H({items:[Q,R]}));}}}}}}}if(sap.ushell){this.oNavigationHandler=new N(this);this.bOnInitFinished=true;this.initAppState();}},initAppState:function(){if(!(this.bFilterBarInitialized&&this.bOnInitFinished&&this.oNavigationHandler)){return;}var p=this.oNavigationHandler.parseNavigation();var t=this;p.done(function(A,u,n){if(n!==f.initial){t.oSmartFilterBar.clearVariantSelection();t.oSmartFilterBar.setDataSuiteFormat(A.selectionVariant,true);t.oSmartTable.setCurrentVariantId(A.tableVariantId);t.restoreCustomAppStateData(A.customData);t.oSmartTable.rebindTable();}});p.fail(function(o){t._handleError(o);});},storeCurrentAppState:function(){if(this.oNavigationHandler){if(!this.oNavigationHandler.hasCrossApplicationNavigationService()){return undefined;}var A=this.oNavigationHandler.storeInnerAppState(this.getCurrentAppState());A.fail(function(o){this._handleError(o);}.bind(this));return A;}else{throw"ListReport: navigation handler is not defined. Check if UShell services exist.";}},getCurrentAppState:function(){var s=new e(this.oSmartFilterBar.getDataSuiteFormat());var v=this.getVisibleSelectionsWithDefaults();for(var i=0;i<v.length;i++){if(!s.getValue(v[i])){s.addSelectOption(v[i],"I","EQ","");}}return{selectionVariant:s.toJSONString(),tableVariantId:this.oSmartTable.getCurrentVariantId(),customData:this.getCustomAppStateData()};},getCustomAppStateData:function(){var c={};if(this.getCustomAppStateDataExtension){this.getCustomAppStateDataExtension(c);}return c;},restoreCustomAppStateData:function(c){if(this.restoreCustomAppStateDataExtension){this.restoreCustomAppStateDataExtension(c);}},getVisibleSelectionsWithDefaults:function(){var v=[];return v;},onInitSmartFilterBar:function(o){if(this.onInitSmartFilterBarExtension){this.onInitSmartFilterBarExtension(o);}this.bFilterBarInitialized=true;this.initAppState();},onBeforeRebindTable:function(o){sap.suite.ui.generic.template.lib.TemplateViewController.prototype.onBeforeRebindTable.apply(this,arguments);if(this.onBeforeRebindTableExtension){this.onBeforeRebindTableExtension(o);}},onExit:function(){if(this._oPopover){this._oPopover.destroy();}},getTable:function(){var s=this.getView().byId("listReport");return s.getTable();},onCallAction:function(o){this.onCallActionFromList(o,this.oSmartFilterBar);},getSelectedContext:function(){var t=this.getTable();var s=[];if(t instanceof T){s=t.getSelectedContexts();}else{var c=t.getSelectedIndices();for(var i=0;i<c.length;i++){s.push(t.getContextByIndex(c[i]));}}var o=null;var g=this.getView().getModel("i18n").getResourceBundle();var C=!!this.getView().$().closest(".sapUiSizeCompact").length;if((!s||s.length===0)){sap.m.MessageBox.error(g.getText("NO_ITEM_SELECTED"),{styleClass:C?"sapUiSizeCompact":""});return undefined;}else if(s.length>1){sap.m.MessageBox.error(g.getText("MULTIPLE_ITEMS_SELECTED"),{styleClass:C?"sapUiSizeCompact":""});return undefined;}else{o=s[0];}return o;},onSearchButtonPressed:function(){this.storeForBackNavigation();},onBeforePopoverOpens:function(o){if(this.oNavigationHandler){var p=o.getParameters();var s=this.oSmartFilterBar.getDataSuiteFormat();this.oNavigationHandler.processBeforeSmartLinkPopoverOpens(p,s);}else{o.getParameters().open();}},onPopoverLinkPressed:function(){this.storeForBackNavigation();},onAfterTableVariantSave:function(){this.storeForBackNavigation();},onAfterApplyTableVariant:function(){this.storeForBackNavigation();},onBeforeSFBVariantSave:function(o){if(o.getParameter("context")!=="STANDARD"){this.oSmartFilterBar.setFilterData({"_CUSTOM":this.getCustomAppStateData()});}this.storeForBackNavigation();},onAfterSFBVariantLoad:function(){var D=this.oSmartFilterBar.getFilterData();if(D["_CUSTOM"]!==undefined){this.restoreCustomAppStateData(D["_CUSTOM"]);}this.storeForBackNavigation();},storeForBackNavigation:function(){try{this.storeCurrentAppState();}catch(c){jQuery.sap.log.error("ListReport.storeForBackNavigation: "+c);}},onShareEmailPress:function(){var r=this.getView().getModel("i18n").getResourceBundle();try{this.storeCurrentAppState().done(function(){sap.m.URLHelper.triggerEmail(null,r.getText("EMAIL_HEADER",[r.getText("PAGEHEADER")]),document.URL);});}catch(c){jQuery.sap.log.error("ListReport.onShareInJamPress: "+c);sap.m.URLHelper.triggerEmail(null,r.getText("EMAIL_HEADER",[r.getText("PAGEHEADER")]),document.URL);}},onShareInJamPress:function(){var r=this.getView().getModel("i18n").getResourceBundle();try{this.storeCurrentAppState().done(function(){var s=sap.ui.getCore().createComponent({name:"sap.collaboration.components.fiori.sharing.dialog",settings:{object:{id:document.URL,share:r.getText("PAGEHEADER")}}});s.open();});}catch(c){jQuery.sap.log.error("ListReport.onShareInJamPress: "+c);var s=sap.ui.getCore().createComponent({name:"sap.collaboration.components.fiori.sharing.dialog",settings:{object:{id:document.URL,share:r.getText("PAGEHEADER")}}});s.open();}},onBeforePressBookmark:function(){try{this.storeCurrentAppState();}catch(c){jQuery.sap.log.error("ListReport.onBeforePressBookmark: "+c);}},onNavigateToDetail:function(o){var s=this.getSelectedContext();this.navigateFromListItem(s,this.getTable());},_handleError:function(o){if(o instanceof E){o.showMessageBox();}}});return l;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ObjectPage.view.Details.controller')){jQuery.sap.declare('sap.suite.ui.generic.template.ObjectPage.view.Details.controller');jQuery.sap.require('sap.m.Table');sap.ui.define("sap/suite/ui/generic/template/ObjectPage/view/Details.controller",["sap/suite/ui/generic/template/lib/TemplateViewController","sap/m/Table"],function(B,T){"use strict";return B.extend("sap.suite.ui.generic.template.ObjectPage.view.Details",{onInit:function(){B.prototype.onInit.apply(this,arguments);this.triggerPrepareOnEnterKeyPress();var s=false;try{s=sap.ushell.Container.getService("URLParsing").isIntentUrl(document.URL)?true:false;}catch(e){jQuery.sap.log.error("Detail.controller: UShell service is not available.");}var a=new sap.ui.model.json.JSONModel({HasDetail:!this.getOwnerComponent().getIsLeaf(),HasShell:s});a.setDefaultBindingMode("OneWay");this.getView().setModel(a,"admin");},onPressDraftInfo:function(e){var c=this.getContext();var l=sap.ui.getCore().byId(e.getSource().getId()+"-lock");B.prototype.fnDraftPopover.call(this,this,c,this.oView,l);}});},true);};
