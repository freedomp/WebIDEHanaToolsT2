define("tinymce/imagetoolsplugin/Filters",["tinymce/imagetoolsplugin/Canvas","tinymce/imagetoolsplugin/ImageSize","tinymce/imagetoolsplugin/Conversions","tinymce/imagetoolsplugin/ColorMatrix"],function(C,I,c,e){var f=c.revokeImageUrl;function j(h,q){return c.blobToImage(h).then(function(s){var t=C.create(I.getWidth(s),I.getHeight(s)),u=C.get2dContext(t),v;function w(v,m){var d=v.data,r,g,b,a,i,x=m[0],y=m[1],z=m[2],A=m[3],B=m[4],D=m[5],E=m[6],F=m[7],G=m[8],H=m[9],J=m[10],K=m[11],L=m[12],M=m[13],N=m[14],O=m[15],P=m[16],Q=m[17],R=m[18],S=m[19];for(i=0;i<d.length;i+=4){r=d[i];g=d[i+1];b=d[i+2];a=d[i+3];d[i]=r*x+g*y+b*z+a*A+B;d[i+1]=r*D+g*E+b*F+a*G+H;d[i+2]=r*J+g*K+b*L+a*M+N;d[i+3]=r*O+g*P+b*Q+a*R+S;}return v;}u.drawImage(s,0,0);f(s);v=w(u.getImageData(0,0,t.width,t.height),q);u.putImageData(v,0,0);return c.canvasToBlob(t);});}function k(a,m){return c.blobToImage(a).then(function(i){var d=C.create(I.getWidth(i),I.getHeight(i)),q=C.get2dContext(d),s,t;function u(s,t,m){var v,z,A,B,x,y,r,g,b,D,E,F,G,H,J,w,h;function K(L,M,N){if(L>N){L=N;}else if(L<M){L=M;}return L;}A=Math.round(Math.sqrt(m.length));B=Math.floor(A/2);v=s.data;z=t.data;w=s.width;h=s.height;for(y=0;y<h;y++){for(x=0;x<w;x++){r=g=b=0;for(E=0;E<A;E++){for(D=0;D<A;D++){F=K(x+D-B,0,w-1);G=K(y+E-B,0,h-1);H=(G*w+F)*4;J=m[E*A+D];r+=v[H]*J;g+=v[H+1]*J;b+=v[H+2]*J;}}H=(y*w+x)*4;z[H]=K(r,0,255);z[H+1]=K(g,0,255);z[H+2]=K(b,0,255);}}return t;}q.drawImage(i,0,0);f(i);s=q.getImageData(0,0,d.width,d.height);t=q.getImageData(0,0,d.width,d.height);t=u(s,t,m);q.putImageData(t,0,0);return c.canvasToBlob(d);});}function l(a){return function(b,v){return c.blobToImage(b).then(function(g){var h=C.create(I.getWidth(g),I.getHeight(g)),m=C.get2dContext(h),q,i,r=new Array(256);function s(q,r){var d=q.data,i;for(i=0;i<d.length;i+=4){d[i]=r[d[i]];d[i+1]=r[d[i+1]];d[i+2]=r[d[i+2]];}return q;}for(i=0;i<r.length;i++){r[i]=a(i,v);}m.drawImage(g,0,0);f(g);q=s(m.getImageData(0,0,h.width,h.height),r);m.putImageData(q,0,0);return c.canvasToBlob(h);});};}function n(m){return function(b,a){return j(b,m(e.identity(),a));};}function o(m){return function(b){return j(b,m);};}function p(a){return function(b){return k(b,a);};}return{invert:o([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0]),brightness:n(e.adjustBrightness),hue:n(e.adjustHue),saturate:n(e.adjustSaturation),contrast:n(e.adjustContrast),grayscale:n(e.adjustGrayscale),sepia:n(e.adjustSepia),colorize:function(b,a,d,g){return j(b,e.adjustColors(e.identity(),a,d,g));},sharpen:p([0,-1,0,-1,5,-1,0,-1,0]),emboss:p([-2,-1,0,-1,1,1,0,1,2]),gamma:l(function(a,v){return Math.pow(a/255,1-v)*255;}),exposure:l(function(a,v){return 255*(1-Math.exp(-(a/255)*v));}),colorFilter:j,convoluteFilter:k};});
