(function(g){"use strict";jQuery.sap.require('sap.ushell.renderers.fiori2.search.SearchModel');sap.ushell.renderers.fiori2.search.SearchModel.extend("sap.ushell.renderers.fiori2.search.SearchFacetDialogModel",{constructor:function(){var t=this;sap.ushell.renderers.fiori2.search.SearchModel.prototype.constructor.apply(t,[]);t.facetQuery=t.sina.createPerspectiveQuery({templateFactsheet:true});t.aFilters=[];t.aAttributsMetaData=[];},facetDialogCall:function(){var t=this;t.facetQuery.setSearchTerms("*");t.facetQuery.setDataSource(t.getDataSource());t.facetQuery.setSkip(0);t.facetQuery.setFacetOptions({});t.resetFacetQueryFilterConditions();t.facetQuery.setExpand(['Grid','Items','ResultsetFacets','TotalCount']);return t.facetQuery.getResultSet().then(function(p){t.aAttributesMetaData=p.searchresultset.elements[0];t.setProperty('/facetDialog',t.oFacetFormatter.getDialogFacets(t.getDataSource(),p,t));},function(e){return jQuery.when(true);});},facetDialogSingleCall:function(p){var t=this;t.facetQuery.setSearchTerms("*");t.facetQuery.setDataSource(t.getDataSource());t.facetQuery.setSkip(0);t.facetQuery.setFacetOptions({"MaxNumberOfReturnValues":1000,"Attributes":[p.sAttribute]});t.facetQuery.setExpand(['Grid','Items','ResultsetFacets','TotalCount']);return t.facetQuery.getResultSet().then(function(a){var f=t.oFacetFormatter.getDialogFacets(t.getDataSource(),a,t);var I=[];jQuery.each(f,function(i,b){if(p.sAttribute===b.dimension){I=b.items;}});t.setProperty(p.sBindingPath+"/items",I);});},resetFacetQueryFilterConditions:function(){var t=this;t.facetQuery.resetFilterConditions();t.facetQuery.addFilterCondition('$$RenderingTemplatePlatform$$','=','html');t.facetQuery.addFilterCondition('$$RenderingTemplateTechnology$$','=','Tempo');t.facetQuery.addFilterCondition('$$RenderingTemplateVariant$$','=','');t.facetQuery.addFilterCondition('$$RenderingTemplateType$$','=','ItemDetails');t.facetQuery.addFilterCondition('$$RenderingTemplateType$$','=','ResultItem');},hasFilter:function(a){var t=this;var f=a.filterCondition;for(var i=0;i<t.aFilters.length;i++){if(t.aFilters[i].filterCondition.equals&&t.aFilters[i].filterCondition.equals(f)){return true;}}return false;},addFilter:function(i){var t=this;var f=i.filterCondition;if(!t.hasFilter(f)){t.aFilters.push(i);}},removeFilter:function(a){var t=this;var f=a.filterCondition;for(var i=0;i<t.aFilters.length;i++){if(t.aFilters[i].filterCondition.equals&&t.aFilters[i].filterCondition.equals(f)){t.aFilters.splice(i,1);return;}}},changeFilterAdvaced:function(a,A){var t=this;var f=a.filterCondition;for(var i=0;i<t.aFilters.length;i++){if(t.aFilters[i].filterCondition.equals&&t.aFilters[i].filterCondition.equals(f)){t.aFilters[i].advanced=A;return;}}}});})(window);
