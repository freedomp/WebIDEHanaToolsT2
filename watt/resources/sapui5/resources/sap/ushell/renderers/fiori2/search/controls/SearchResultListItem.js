(function(){"use strict";jQuery.sap.require('sap.ushell.renderers.fiori2.search.controls.SearchText');jQuery.sap.require('sap.ushell.renderers.fiori2.search.controls.SearchLink');jQuery.sap.require('sap.ushell.renderers.fiori2.search.SearchHelper');jQuery.sap.require('sap.ushell.renderers.fiori2.search.SearchLogger');jQuery.sap.require('sap.ushell.renderers.fiori2.search.controls.SearchRelatedObjectsToolbar');var S=sap.ushell.renderers.fiori2.search.controls.SearchText;var a=sap.ushell.renderers.fiori2.search.controls.SearchLink;var b=sap.ushell.renderers.fiori2.search.SearchHelper;var c=sap.ushell.renderers.fiori2.search.SearchLogger;var e=sap.ushell.renderers.fiori2.search.controls.SearchRelatedObjectsToolbar;var n='\u2013';sap.ui.core.Control.extend("sap.ushell.renderers.fiori2.search.controls.SearchResultListItem",{metadata:{properties:{title:"string",titleUrl:"string",type:"string",imageUrl:"string",previewButton:"string",data:"object"}},renderer:function(r,C){C._resetPrecalculatedValues();C._renderOuterContainer(r);},_renderOuterContainer:function(r){var t=this;r.write("<div");r.writeControlData(t);if(t.status==="open"||t.getData().selected===true){r.addClass("sapUshellSearchResultListItem-open");}r.addClass("sapUshellSearchResultListItem-content");r.writeClasses();r.write(">");t._renderIntermediateContainer(r);t._renderExpandButton(r);r.write("</div>");},_renderIntermediateContainer:function(r){var t=this;r.write('<div class="sapUshellSearchResultListItem-main">');t._renderInnerContainer(r);r.write("</div>");},_renderInnerContainer:function(r){var t=this;r.write('<div class="sapUshellSearchResultListItem-titleContainer">');t._renderImageForPhone(r);t._renderTitle(r);r.write('</div>');var i=t.getData().itemattributes;t._renderAllAttributes(r,i);},_renderTitle:function(r){var t=this;var d=t._titleUrl;t.title=new a({href:d,press:function(){var N=new c.NavigationEvent();N.addUserHistoryEntry(d);var m=sap.ushell.renderers.fiori2.search.getModelSingleton();m.analytics.logCustomEvent('FLP: Search','Launch Object',[d]);}});t.title.setText(t.getTitle());t.title.setTooltip((sap.ushell.resources.i18n.getText('linkTo_tooltip')+' '+t.getTitle()).replace(/<b>/gi,'').replace(/<\/b>/gi,''));t.title.addStyleClass("sapUshellSearchResultListItem-title");r.renderControl(t.title);var f=new S();f.setText(t.getType());f.setTooltip((''+t.getType()).replace(/<b>/gi,'').replace(/<\/b>/gi,''));f.addStyleClass("sapUshellSearchResultListItem-type");r.renderControl(f);},_renderImage:function(r){var t=this;if(t.getImageUrl()){r.write('<div class="sapUshellSearchResultListItem-attribute sapUshellSearchResultListItem-imageDesktop-outerContainer">');r.write('<div class="sapUshellSearchResultListItem-imageDesktop-innerContainer">');r.write('<div class="sapUshellSearchResultListItem-imageDesktop-alignmentHelper">');r.write('</div>');r.write('<img class="sapUshellSearchResultListItem-imageDesktop" src="');r.write(t.getImageUrl());r.write('">');r.write('</div>');r.write('</div>');}},_renderImageForPhone:function(r){var t=this;if(t.getImageUrl()){r.write('<div class="sapUshellSearchResultListItem-imagePhone-container">');r.write('<img class="sapUshellSearchResultListItem-imagePhone" src="');r.write(t.getImageUrl());r.write('">');r.write('</div>');}},_renderAllAttributes:function(r,i){var t=this;var p=0;r.write('<div class="sapUshellSearchResultListItem-attributes">');r.write('<div class="sapUshellSearchResultListItem-visibleAttributes">');p=t._renderSummaryAttributes(r,i,p);t._renderImage(r);r.write("</div>");p=t._renderDetailAttributes(r,i,p);r.write("</div>");return p;},_renderSummaryAttributes:function(r,i,p){var t=this;var s=[];var v=t._getNumberOfVisibleAttributes();for(;p<i.length&&p<v;p++){s.push(i[p]);}t._renderAttributes(r,s);return p;},_renderDetailAttributes:function(r,i,p){var t=this;var d;if(t._isPhoneSize()){return p;}var l,v;var f=8;var g=[];var h=p+f;for(;p<h&&p<i.length;p++){var j=i[p];l=j.name;v=j.value;if(l===undefined||v===undefined){continue;}if(!v||v===""){v=n;}d={name:l,value:v};g.push(d);}if(g.length>0){t._showExpandButton=true;}r.write('<div class="sapUshellSearchResultListItemDetails2"');if(t.status!=="open"){r.write(' style="height:0; overflow:hidden" ');}r.write('>');r.write('<div class="sapUshellSearchResultListItem-detailsAttributes">');t._renderAttributes(r,g);r.write('</div>');p=t._renderWhyFoundAttributes(r,i,p);t._renderRelatedObjectsToolbar(r);r.write('</div>');return p;},_renderWhyFoundAttributes:function(r,i,p){var t=this;var l,v;var w=[];var d;for(;p<i.length;p++){var f=i[p];if(!f.whyfound){continue;}l=f.name;v=f.value;if(l===undefined||v===undefined){continue;}if(!v||v===""){v=n;}d={name:l,value:v};w.push(d);}if(w.length>0){t._showExpandButton=true;r.write('<div class="sapUshellSearchResultListItem-whyFoundContainer">');t._renderAttributes(r,w);r.write("</div>");}return p;},_renderAttributes:function(r,d,l){l=l||d.length;for(var i=0;i<l;i++){var f=d[i];var g=f.name;var v=f.value;if(g===undefined||v===undefined){return;}if(!v||v===""){v=n;}r.write('<div class="sapUshellSearchResultListItem-attribute">');var h=new sap.m.Label();h.setText(g);h.setTooltip((''+g).replace(/<b>/gi,'').replace(/<\/b>/gi,''));h.addStyleClass("sapUshellSearchResultListItem-attribute-label");var j=new S();j.setText(v);j.setTooltip((''+v).replace(/<b>/gi,'').replace(/<\/b>/gi,''));j.addStyleClass("sapUshellSearchResultListItem-attribute-value");h.setLabelFor(j);r.renderControl(h);r.renderControl(j);r.write("</div>");}},_renderRelatedObjectsToolbar:function(r){var t=this;if(!t._intents||t._intents.length==0){return;}t._showExpandButton=true;var d=[];for(var i=0;i<t._intents.length;i++){var f=t._intents[i];d.push({label:f.text,href:f.externalHash,target:f.target});}t.relatedObjectActionsToolbar=new e({relatedObjects:d});t.relatedObjectActionsToolbar.addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar");r.renderControl(t.relatedObjectActionsToolbar);},_renderExpandButton:function(r){var t=this;var s=(t._showExpandButton&&t.getPreviewButton()!=="false");r.write('<div class="sapUshellSearchResultListItemButton">');r.write('<div class="sapUshellSearchResultListItemButtonContainer');if(!s){r.write(' sapUshellSearchResultListItemButtonContainer-hidden');}r.write('">');var i=sap.ui.core.IconPool.getIconURI("slim-arrow-down");t.button=new sap.m.Button({icon:i,type:sap.m.ButtonType.Transparent,tooltip:sap.ushell.resources.i18n.getText("showDetailBtn_tooltip"),press:function(){t.toggleDetails();}});r.renderControl(t.button);r.write('</div>');r.write('</div>');},_getDetailsArea:function(){if(!this._detailsArea){var d=$(this.getDomRef()).find('.sapUshellSearchResultListItemDetails2');if(d&&d.length===1){this._detailsArea=d;}}return this._detailsArea;},isShowingDetails:function(){var i=false;var d=this._getDetailsArea();if(d){i=d.css('display')!=="none";}return i;},showDetails:function(d){var t=this;if(t.isShowingDetails()){return;}var f=t._getDetailsArea();if(f){var g=function(){var i=sap.ui.core.IconPool.getIconURI("slim-arrow-up");t.button.setTooltip(sap.ushell.resources.i18n.getText("hideDetailBtn_tooltip"));t.button.setIcon(i);t.button.rerender();};d=typeof d==='undefined'?true:d;if(d){f.slideDown({start:function(){if(t.relatedObjectActionsToolbar){t.relatedObjectActionsToolbar._layoutToolbarElements();}},duration:"fast",complete:g});}else{f.css("display","");g();if(t.relatedObjectActionsToolbar){t.relatedObjectActionsToolbar._layoutToolbarElements();}}}},hideDetails:function(d){var t=this;if(!t.isShowingDetails()){return;}var f=t._getDetailsArea();if(f){var g=function(){var i=sap.ui.core.IconPool.getIconURI("slim-arrow-down");t.button.setTooltip(sap.ushell.resources.i18n.getText("showDetailBtn_tooltip"));t.button.setIcon(i);t.button.rerender();};d=typeof d==='undefined'?true:d;if(d){f.slideUp("fast",g);}else{f.css("display","none");g();}}},toggleDetails:function(d){if(this.isShowingDetails()){this.hideDetails(d);}else{this.showDetails(d);}},onAfterRendering:function(){var t=this;var p=767;var w=$(window).width();if(w<=p){var d=t._titleUrl;if(d&&d.length>0){d=encodeURI(d);$(t.getDomRef()).find(".sapUshellSearchResultListItem-left").bind('click',t.fireNavigate(d));}}t.forwardEllipsis($(t.getDomRef()).find(".sapUshellSearchResultListItem-title, .sapUshellSearchResultListItem-attribute-value, .sapUshellSearchResultListItem-type"));var f=$(t.getDomRef()).find('.sapUshellSearchResultListItemDetails2');f.css("display","none");f.css("height","auto");f.css("overflow","visible");},_isDesktopSize:function(){if(!(this._isTabletSize()||this._isPhoneSize())){return true;}return false;},_isTabletSize:function(){var w=$(window).width();if(w<=1150&&!this._isPhoneSize()){return true;}return false;},_isPhoneSize:function(){var w=$(window).width();if(w<=767){return true;}return false;},_getNumberOfVisibleAttributes:function(){var t=this;if(!t._visibleAttributes){var v=4;if(!t._isDesktopSize()){v=3;}if(!t._isPhoneSize()&&t.getImageUrl()){v--;}t._visibleAttributes=v;}return t._visibleAttributes;},_resetPrecalculatedValues:function(){this._visibleAttributes=undefined;this._detailsArea=undefined;this._showExpandButton=false;this._titleUrl=this.getTitleUrl();this._intents=this.getData().intents;},fireNavigate:function(u){return function(){if(u){window.location.href=u;}};},forwardEllipsis:function(o){o.each(function(i,d){b.forwardEllipsis4Whyfound(d);});}});})();
