/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2015 SAP SE. All rights reserved
 */
sap.ui.define(['sap/ui/base/Object','sap/ui/core/MessageType'],function(B,M){"use strict";var U={sortItemsByText:function(p){var l;try{var l=sap.ui.getCore().getConfiguration().getLocale().toString();if(typeof window.Intl!=='undefined'){var c=window.Intl.Collator(l,{numeric:true});p.sort(function(a,b){return c.compare(a.text,b.text);});}else{p.sort(function(a,b){return a.text.localeCompare(b.text,l,{numeric:true});});}}catch(e){}},recoverPersonalisationData:function(p,t,c){if(!t){return;}if(!c){c=this.getColumnKeysOfDateType(t);}if(c.length&&p&&p.filter){p.filter.filterItems.forEach(function(f){if(c.indexOf(f.columnKey)>-1){if(f.value1&&typeof(f.value1)==="string"){f.value1=new Date(f.value1);}if(f.value2&&typeof(f.value2)==="string"){f.value2=new Date(f.value2);}}},this);}},getColumnKeysOfDateType:function(t){if(!t){return[];}var c=[];t.getColumns().forEach(function(C){if(this.getColumnType(C)==="date"){c.push(this.getColumnKey(C));}},this);return c;},validate:function(s,p,t,P){var r=[];var R=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");if(t instanceof sap.ui.table.AnalyticalTable&&s.group&&s.columns){t.getColumns().forEach(function(c){if(c.getInResult()){return;}var C=this.getColumnKey(c);var b=s.columns.controller.isColumnSelected(p.columns,P.columns,C);var g=s.group.controller.isGroupSelected(p.group,P.group,C);if(g&&!b){r.push({columnKey:C,panelTypes:[sap.m.P13nPanelType.group,sap.m.P13nPanelType.columns],messageType:M.Warning,messageText:R.getText("PERSODIALOG_MSG_GROUPING_NOT_POSSIBLE_DESCRIPTION")});}},this);}return r;},getUnionOfAttribute:function(s,a){var u=[];var A=function(c){if(u.indexOf(c)<0){u.push(c);}};for(var n in s){var N=s[n];if(!N[a]){continue;}N[a].forEach(A);}return u;},getVisibleColumnKeys:function(t){var c=[];t.getColumns().forEach(function(C){if(C.getVisible()){c.push(this.getColumnKey(C));}},this);return c;},copy:function(o){if(o instanceof Array){return jQuery.extend(true,[],o);}return jQuery.extend(true,{},o);},sort:function(k,A){var r=this.copy(A);r.sort(function(a,b){var t=a[k].toLocaleLowerCase();var T=b[k].toLocaleLowerCase();if(t<T){return-1;}if(t>T){return 1;}return 0;});return r;},removeEmptyProperty:function(o){for(var t in o){if(o[t]===null||o[t]===undefined){delete o[t];}}return o;},semanticEqual:function(i,I){if(!i||!I){return false;}for(var p in i){if(I[p]===undefined||i[p]!==I[p]){return false;}}return true;},hasChangedType:function(c){for(var t in c){if(c[t]===sap.ui.comp.personalization.ChangeType.ModelChanged||c[t]===sap.ui.comp.personalization.ChangeType.TableChanged){return true;}}return false;},isNamespaceChanged:function(c,n){if(c[n]){return c[n]===sap.ui.comp.personalization.ChangeType.ModelChanged||c[n]===sap.ui.comp.personalization.ChangeType.TableChanged;}return false;},isTrueForAll:function(o){for(var t in o){if(o[t]===false){return false;}}return true;},createArrayFromString:function(e){if(!e){return[];}var E=[];var r=e.split(",");r.forEach(function(f){if(f!==""){E.push(f.trim());}});return E;},getColumn:function(c,C){var r=null;C.some(function(o){if(this.getColumnKey(o)===c){r=o;return true;}},this);return r;},getIndexByKey:function(m,c){var I=-1;m.some(function(o,i){if(o.columnKey===c){I=i;return true;}});return I;},getColumnKey:function(c){return this._getCustomProperty(c,"columnKey")||c.getId();},getColumnType:function(c){return this._getCustomProperty(c,"type");},isGroupable:function(c){if(c instanceof sap.ui.table.AnalyticalColumn){var t=c.getParent();var b=t&&t.getBinding("rows");var r=b&&b.getAnalyticalQueryResult();if(t&&r&&r.findDimensionByPropertyName(c.getLeadingProperty())&&jQuery.inArray(c.getLeadingProperty(),b.getSortablePropertyNames())>-1&&jQuery.inArray(c.getLeadingProperty(),b.getFilterablePropertyNames())>-1){return true;}}if(c instanceof sap.m.Column){return this.isSortable(c);}return false;},isSortable:function(c){if(c.getSortProperty){return!!c.getSortProperty();}if(this._getCustomProperty(c,"sortProperty")){return true;}return false;},isFilterable:function(c){if(c.getFilterProperty){return!!c.getFilterProperty();}if(this._getCustomProperty(c,"filterProperty")){return true;}return false;},isConsistent:function(c){if(!c||!c.length){return true;}var C=true;var p=sap.ui.comp.personalization.Util.getColumnKey(c[0])!==c[0].getId();c.some(function(o){var P=sap.ui.comp.personalization.Util.getColumnKey(o)!==o.getId();if(P!==p){C=false;return true;}});return C;},getArrayElementByKey:function(k,K,a){if(!a||!a.length){return null;}var e=null;a.some(function(E){if(E[k]!==undefined&&E[k]===K){e=E;return true;}});return e;},isColumnIgnored:function(c,i){return i.indexOf(sap.ui.comp.personalization.Util.getColumnKey(c))>-1;},createSort2Json:function(t,d,i){if(t){if(t instanceof sap.ui.table.Table){t.getColumns().forEach(function(c){var C=this.getColumnKey(c);if(this.isColumnIgnored(c,i)){return;}if(c.getSorted()){d.push({columnKey:C,operation:c.getSortOrder()});}},this);}}},_getCustomProperty:function(c,p){var C=this._getCustomData(c);if(!C||!p){return null;}return C[p];},_getCustomData:function(c){if(!c){return null;}var C=c.data("p13nData");if(typeof C==="string"){try{C=JSON.parse(C);c.data("p13nData",C);}catch(e){}}return C;}};return U;},true);
