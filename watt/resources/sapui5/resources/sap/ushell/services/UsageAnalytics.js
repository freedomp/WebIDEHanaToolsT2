// Copyright (c) 2009-2014 SAP SE, All Rights Reserved
(function(){"use strict";jQuery.sap.declare("sap.ushell.services.UsageAnalytics");sap.ushell.services.UsageAnalytics=function(c,p,S){var o=(S&&S.config)||{},D=[],a=false,i=false,e=true;window.oCustomProperties={};this.isEnabled=function(){if(!i){if(!o.enabled||!o.pubToken){e=false;if(!o.pubToken){jQuery.sap.log.warning("No valid pubToken was found in the service configuration");}}else{e=true;}}return e;};this.init=function(){if(this.isEnabled()&&!i){this._initUsageAnalyticsLogging();i=true;}};this.setCustomAttributes=function(C){var b,P="attribute",s,d="custom",f,F,g="customFunction";if(!this.isEnabled()){return;}for(b=1;b<5;b++){f=d.concat(b+2);if(window.swa[f]!==undefined){continue;}s=P+b;if(C[s]===undefined){continue;}if(jQuery.isFunction(C[s])){F=g+b;window[F]=C[s];window.swa[f]={ref:F};}else{window.swa[f]={ref:C[s]};}}};this.logCustomEvent=function(b,d,A){var f,C,s;if(!this.isEnabled()){return;}if(!this._isAnalyticsScriptLoaded()){this._addDelayedEvent(b,d,A);return;}if(A){for(f=0;f<4&&f<A.length;f++){C=f+7;s="custom"+C;window.oCustomProperties[s]=A[f];window.swa[s]={ref:"_getCustomValue",params:[C]};}}this._trackCustomEvent(b,d);};window._trackingScriptsLoaded=function(){var b,t;a=true;for(b=0;b<D.length;b++){t=D[b];this.logCustomEvent(t.eventType,t.customEventValue,t.aAdditionalValues);}D=null;};this._trackCustomEvent=function(b,d){window.swa.trackCustomEvent(b,d);};this._initUsageAnalyticsLogging=function(){if(window.swa===undefined){window.swa={};}window.swa.pubToken=o.pubToken;window.swa.baseUrl=o.baseUrl;window.swa.bannerEnabled=false;window.swa.loggingEnabled=true;window.swa.visitorCookieTimeout=63113852;window.swa.dntLevel=1;window.swa.trackerReadyCallback=window._trackingScriptsLoaded.bind(this);window.swa.clicksEnabled=(o.logClickEvents===false?false:true);window.swa.pageLoadEnabled=(o.logPageLoadEvents===false?false:true);this._handlingTrackingScripts();};this._handlingTrackingScripts=function(){var d=document,g=d.createElement('script'),s=d.getElementsByTagName('script')[0];g.onerror=function(){e=false;jQuery.sap.log.warning("SWA scripts not loaded!");};g.type='text/javascript';g.defer=true;g.async=true;g.src=window.swa.baseUrl+'js/privacy.js';s.parentNode.insertBefore(g,s);};this._isAnalyticsScriptLoaded=function(){return a;};this._addDelayedEvent=function(b,d,A){var f={eventType:b,customEventValue:d,aAdditionalValues:A};D.push(f);};window._getCustomValue=function(b){var C="custom"+b,v=window.oCustomProperties[C];window.oCustomProperties[C]=undefined;return v;};};sap.ushell.services.UsageAnalytics.hasNoAdapter=true;}());
