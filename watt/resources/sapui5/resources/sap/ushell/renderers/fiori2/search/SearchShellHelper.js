(function(){"use strict";jQuery.sap.require('sap.ushell.renderers.fiori2.search.controls.SearchFieldGroup');var S=sap.ushell.renderers.fiori2.search.controls.SearchFieldGroup;jQuery.sap.require("sap.ushell.renderers.fiori2.search.SearchModel");jQuery.sap.declare('sap.ushell.renderers.fiori2.search.SearchShellHelper');var m=sap.ushell.renderers.fiori2.search.SearchShellHelper={};jQuery.sap.require('sap.ushell.renderers.fiori2.search.SemanticObjectsHandler');var a=sap.ushell.renderers.fiori2.search.SemanticObjectsHandler;jQuery.extend(m,{init:function(i){var t=this;this.oShell=sap.ui.getCore().byId('shell');this.oModel=sap.ushell.renderers.fiori2.search.getModelSingleton();this.oSearchFieldGroup=new S("searchFieldInShell");this.oSearchFieldGroup.setModel(this.oModel);this.oShell.setSearch(this.oSearchFieldGroup);this.oSearchInput=this.oSearchFieldGroup.getAggregation("input");this.oSearchSelect=this.oSearchFieldGroup.getAggregation("select");this.oSearchButton=this.oSearchFieldGroup.getAggregation("button");this.oSearchButton.setType(sap.m.ButtonType.Transparent);var b=1150;if(jQuery(window).width()<=b){this.oSearchSelect.setDisplayMode('icon');}this.oSearchButton.attachPress(function(){t.handleClickSearchButton();});sap.ui.getCore().getEventBus().subscribe("allSearchFinished",this.onAllSearchFinished,this);sap.ui.getCore().byId('navContainer').attachAfterNavigate(this.onAfterNavigate,this);if(i||i===undefined){this.openSearchFieldGroup(false);this.setSearchFieldGroupInCenter();}else{this.closeSearchFieldGroup(false);this.setSearchFieldGroupOnSide();}},onAfterNavigate:function(e){if(e.getParameter('toId')!=='shellPage-Action-search'&&e.getParameter('toId')!=='applicationShellPage-Action-search'){return;}var s=sap.ui.getCore().byId('searchContainerResultsView');if(s&&s.oFocusHandler){s.oFocusHandler.setFocus();}},onAllSearchFinished:function(){this.setSearchFieldGroupInCenter();this.oSearchInput.setValue(this.oModel.getSearchBoxTerm());},setOpenStyle:function(){jQuery('#sf').removeClass("sapUshellSearchFieldElementDisplayInlineBlock");jQuery('#sf').addClass("sapUshellSearchFieldElementDisplayNone");this.oSearchButton.removeStyleClass("sapUshellSearchFieldElementDisplayNone");this.oSearchButton.addStyleClass("sapUshellSearchFieldElementDisplayBlock");this.oSearchFieldGroup.addStyleClass("sapUshellSearchFieldGroupMaximized");this.oSearchFieldGroup.removeStyleClass("sapUshellSearchFieldGroupMinimized");this.oSearchFieldGroup.removeStyleClass("sapUshellSearchFieldGroupNotVisible");},setCloseStyle:function(){this.setSearchFieldGroupOnSide();this.oSearchFieldGroup.removeStyleClass("sapUshellSearchFieldGroupMaximized");this.oSearchFieldGroup.addStyleClass("sapUshellSearchFieldGroupMinimized");this.oSearchFieldGroup.addStyleClass("sapUshellSearchFieldGroupNotVisible");jQuery('#sf').removeClass("sapUshellSearchFieldElementDisplayNone");jQuery('#sf').addClass("sapUshellSearchFieldElementDisplayInlineBlock");this.oSearchButton.removeStyleClass("sapUshellSearchFieldElementDisplayBlock");this.oSearchButton.addStyleClass("sapUshellSearchFieldElementDisplayNone");},setSearchFieldGroupInCenter:function(){this.oSearchFieldGroup.addStyleClass("sapUshellSearchFieldGroupInCenter");this.oSearchFieldGroup.removeStyleClass("sapUshellSearchFieldGroupOnSide");},setSearchFieldGroupOnSide:function(){this.oSearchFieldGroup.removeStyleClass("sapUshellSearchFieldGroupInCenter");this.oSearchFieldGroup.addStyleClass("sapUshellSearchFieldGroupOnSide");},resetModel:function(){this.oSearchInput.setValue('');this.oModel.setSearchBoxTerm('');this.oModel.resetDataSource(false);this.oModel.resetFilterConditions(false);},openSearchFieldGroup:function(h){var t=this;sap.ushell.Container.getService("Search")._getCatalogTiles();a.getSemanticObjectsMetadata();if(h){t.setOpenStyle();if(jQuery('#searchFieldInShell-select').length>0){jQuery('#searchFieldInShell-select').css('max-width','0%').animate({'max-width':'30%'},{duration:200,complete:function(){jQuery(this).css('max-width','');}});}var i=jQuery('.sapUshellSearchFieldGroupSubContainer').width()*0.85-4+"px";jQuery('#searchFieldInShell-input').css('max-width','0%').animate({'max-width':i},{duration:300,complete:function(){t.setOpenStyle();if(!sap.ui.Device.system.phone){t.oSearchInput.focus();}jQuery(this).css('max-width','');}});}else{t.setOpenStyle();if(!sap.ui.Device.system.phone){t.oSearchInput.focus();}}t.isSearchFieldGroupOpen=true;},closeSearchFieldGroup:function(h){var t=this;if(h){t.oSearchFieldGroup.addStyleClass("sapUshellSearchFieldGroupOnSide");t.oSearchFieldGroup.removeStyleClass("sapUshellSearchFieldGroupInCenter");var i=jQuery('#searchFieldInShell-input').width()+"px";jQuery('#searchFieldInShell-input').css('max-width',i).animate({'max-width':'0%'},{duration:400,complete:function(){t.setCloseStyle();}});}else{t.setCloseStyle();}t.isSearchFieldGroupOpen=false;},handleClickSearchButton:function(){if(window.location.hash.substr(1,13)!=="Action-search"){if(this.isSearchFieldGroupOpen){if(this.oSearchInput.getValue()===""){this.closeSearchFieldGroup(true);}}}}});})();
