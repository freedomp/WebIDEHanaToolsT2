/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2015 SAP SE. All rights reserved
 */
sap.ui.define(['jquery.sap.global','sap/m/Label','sap/ui/comp/library','./BindingUtil',"./AnnotationHelper","./SmartField"],function(q,L,l,B,A,S){"use strict";var a=L.extend("sap.ui.comp.smartfield.SmartLabel",{metadata:{library:"sap.ui.comp"}});a.prototype.init=function(){this._sSmartFieldId=null;};a.prototype.bindRequiredPropertyToSmartField=function(){var i=null,b=null;var s=this._getField();if(s&&s.getContextEditable()&&s.getEditable()){b=new B();i=s.getBindingInfo("mandatory");if(i){this.bindProperty("required",b.toBinding(i));}else{this.setRequired(s.getMandatory());}}else{this.unbindProperty("required");this.setRequired(false);}};a.prototype._bindProperties=function(){var s=this._getField();if(s){var b=new B();var i=s.getBindingInfo("visible");if(i){this.bindProperty("visible",b.toBinding(i));}else{this.setVisible(s.getVisible());}this.bindRequiredPropertyToSmartField();i=s.getBindingInfo("textLabel");if(i){this.bindProperty("text",b.toBinding(i));}else{this.setText(s.getTextLabel());}i=s.getBindingInfo("tooltipLabel");if(i){this.bindProperty("tooltip",b.toBinding(i));}else{this.setTooltip(s.getTooltipLabel());}}};a.prototype.getLabelInfo=function(){var m,o;var s=this._getField();if(s){this._bindProperties();m=s.getDataProperty();if(m){o=this._getLabelInfo(m);if(o){if(o.text){if(!s.getTextLabel()){this.setText(o.text);}}if(o.quickinfo){if(!s.getTooltipLabel()){this.setTooltip(o.quickinfo);}}}}if(!o||!o.quickinfo){if(!s.getTooltipLabel()){this.setTooltip(this.getText());}}}};a.prototype.setLabelFor=function(s){if(s){if(typeof s==='string'){this._sSmartFieldId=s;}else{this._sSmartFieldId=s.getId();}this._setLabelFor();sap.m.Label.prototype.setLabelFor.apply(this,[s]);}};a.prototype._getField=function(){if(this._sSmartFieldId){return sap.ui.getCore().byId(this._sSmartFieldId);}return null;};a.prototype._setLabelFor=function(){var d;var s=this._getField();if(s){if(s.getDataProperty){d=s.getDataProperty();if(d){this.getLabelInfo();}else{s.attachInitialise(q.proxy(this.getLabelInfo,this));}}}};a.prototype.updateLabelFor=function(c){if(c&&c.length>0){sap.m.Label.prototype.setLabelFor.apply(this,[c[0]]);c.splice(0,1);this.updateAriaLabeledBy(c);}};a.prototype.updateAriaLabeledBy=function(c){if(c){for(var i=0;i<c.length;i++){if(c[i].addAriaLabelledBy){c[i].addAriaLabelledBy(this);}}}};a.prototype._getLabelInfo=function(p){var o=new A();if(p&&p.property){return{text:o.getLabel(p.property),quickinfo:o.getQuickInfo(p.property)};}};a.prototype.onBeforeRendering=function(){if(this._sSmartFieldId){this._setLabelFor();}};a.prototype.destroy=function(s){this._sSmartFieldId=null;L.prototype.destroy.apply(this,[s]);};return a;},true);
