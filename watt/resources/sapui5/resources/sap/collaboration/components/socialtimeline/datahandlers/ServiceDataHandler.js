/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.collaboration.components.socialtimeline.datahandlers.ServiceDataHandler");sap.ui.base.Object.extend("sap.collaboration.components.socialtimeline.datahandlers.ServiceDataHandler",{constructor:function(b,t){this._oLogger=jQuery.sap.log.getLogger("sap.collaboration.components.socialtimeline.datahandlers.ServiceDataHandler");this._oBOModel=b;this._oTimelineTermsUtility=t;},readTimelineEntries:function(e,b,o,s,t){var a=this;var p=jQuery.Deferred();var E=this._buildTimelineEntriesEndpoint(e,b,o,s,t);var P={context:null,urlParameters:null,async:true,filters:[],sorters:[],success:function(d,r){var R=d;if(d.__next){var n=a._resolveResponseNextLink(d.__next,e,b);R.results=R.results.concat(n.results);}p.resolve(R.results);},error:function(c){if(c.response&&c.response.statusCode){a._oLogger.error(c.body);p.reject(c);}}};return{request:this._oBOModel.read(E,P),promise:p.promise()};},_resolveResponseNextLink:function(n,e,b){var t=this;var r=[];var N=n.slice(n.indexOf(e+"("+jQuery.sap.encodeURL(b)+")")-1);var p={context:null,urlParameters:null,async:false,filters:[],sorters:[],success:function(d,a){r=d;if(d.__next){var o=t._resolveResponseNextLink(d.__next,e,b);r.results=r.results.concat(o.results);}},error:function(E){t._oLogger.error(E.body);}};this._oBOModel.read(N,p);return r;},_buildTimelineEntriesEndpoint:function(e,b,o,s,t){var a="/"+e+"("+jQuery.sap.encodeURL(b)+")"+"/"+this._oTimelineTermsUtility.getTimelineEntryNavigationPath(e)+"?$expand="+this._oTimelineTermsUtility.getTimelineEntryFields(e).TimelineDetailNavigationPath;if(s!=undefined){a+="&$skip="+s;}if(t!=undefined){a+="&$top="+t;}if(o!=undefined){a+="&$filter="+o;}this._oLogger.info("Timeline Entries Endpoint: "+a);return a;}});
