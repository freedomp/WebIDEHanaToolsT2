jQuery.sap.declare('sap.ui.generic.template.library-all');if(!jQuery.sap.isDeclared('sap.ui.generic.template.ActionUtil')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
jQuery.sap.declare('sap.ui.generic.template.ActionUtil');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.ManagedObject');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.ui.layout.form.SimpleForm');jQuery.sap.require('sap.ui.comp.smartform.Group');jQuery.sap.require('sap.ui.comp.smartform.GroupElement');jQuery.sap.require('sap.ui.comp.smartfield.SmartField');jQuery.sap.require('sap.ui.comp.smartfield.SmartLabel');jQuery.sap.require('sap.m.Dialog');jQuery.sap.require('sap.ui.generic.app.util.ModelUtil');jQuery.sap.require('sap.m.VBox');jQuery.sap.require('sap.m.Text');sap.ui.define("sap/ui/generic/template/ActionUtil",["jquery.sap.global","sap/ui/base/ManagedObject","sap/m/MessageBox","sap/ui/layout/form/SimpleForm","sap/ui/comp/smartform/Group","sap/ui/comp/smartform/GroupElement","sap/ui/comp/smartfield/SmartField","sap/ui/comp/smartfield/SmartLabel","sap/m/Dialog","sap/ui/generic/app/util/ModelUtil","sap/m/VBox","sap/m/Text"],function(q,M,a,S,G,b,c,d,D,e,V,T){"use strict";var A=M.extend("sap.ui.generic.template.ActionUtil",{metadata:{properties:{controller:{type:"object",group:"Misc",defaultValue:null},context:{type:"object",group:"Misc",defaultValue:null},successCallback:{type:"function",group:"Misc",defaultValue:null}}}});A.prototype.call=function(f,F){this._sFunctionImportPath=f;var C=this.getController();if(!C){throw new Error("Controller not provided");}this._oMetaModel=C.getView().getModel().getMetaModel();var s=f.split('/')[1];this._oFunctionImport=this._oMetaModel.getODataFunctionImport(s);this._sFunctionImportLabel=F||s;if(!this._oFunctionImport){throw new Error("Unknown Function Import "+s);}if(this._isActionCritical()){var t=this;var m=sap.ui.getCore().getLibraryResourceBundle("sap.ui.generic.template").getText("ACTION_CONFIRM");m=q.sap.formatMessage(m,this._sFunctionImportLabel);a.confirm(m,{title:this._sFunctionImportLabel,onClose:function(o){if(o==="OK"){t._prepareParameters();t._initiateCall();}},sClass:t._getCompactModeStyleClass()});}else{this._prepareParameters();this._initiateCall();}};A.prototype._getCompactModeStyleClass=function(){if(this.getController().getView().$().closest(".sapUiSizeCompact").length){return"sapUiSizeCompact";}return"";};A.prototype._isActionCritical=function(){var C=this._oFunctionImport["com.sap.vocabularies.Common.v1.IsActionCritical"];if(!C){return false;}if(C.Bool===undefined){return true;}return this._toBoolean(C.Bool);};A.prototype._toBoolean=function(p){if(typeof p==="string"){var v=p.toLowerCase();return!(v=="false"||v==""||v==" ");}return!!p;};A.prototype._prepareParameters=function(){this._oCurrentContext=this.getContext()||this._oView.getBindingContext();this._oContextObject=this._oCurrentContext.getObject();var E=this._getEntityType();var k=this._getPropertyKeys(E);var p;this._oParameters={parameterData:{},additionalParameters:[]};if(this._oFunctionImport.parameter){for(var i=0;i<this._oFunctionImport.parameter.length;i++){var P=this._oFunctionImport.parameter[i];this._addParameterLabel(P,E);var s=P.name;var I=!!k[s];p=undefined;if(this._oContextObject.hasOwnProperty(s)){p=this._oContextObject[s];}else if(I){q.sap.log.error("Key parameter of action not found in current context: "+s);throw new Error("Key parameter of action not found in current context: "+s);}this._oParameters.parameterData[s]=p;if(!I){this._oParameters.additionalParameters.push(P);}}}};A.prototype._getPropertyKeys=function(E){var k={};if(E&&E.key&&E.key.propertyRef){for(var i=0;i<E.key.propertyRef.length;i++){var K=E.key.propertyRef[i].name;k[K]=true;}}return k;};A.prototype._getEntityType=function(){var E=null;if(this._oCurrentContext&&this._oCurrentContext.getPath()){var s=e.getEntitySetFromContext(this._oCurrentContext);var o=this._oMetaModel.getODataEntitySet(s,false);E=this._oMetaModel.getODataEntityType(o.entityType,false);}return E;};A.prototype._initiateCall=function(){if(this._oParameters.additionalParameters.length>0){var p=new sap.ui.model.json.JSONModel();p.setData(this._oParameters.parameterData);var t=this;var P=this._buildParametersForm();var o=new D({title:this._sFunctionImportLabel,content:[P.form],beginButton:new sap.m.Button({text:this._sFunctionImportLabel,press:function(E){if(!P.checkClientErrors()){var m=t._getActionParameterData(E.getSource().getModel());if(m.missingMandatoryParameters.length==0){o.close();t._call(m.preparedParameterData);}else{var C=new V();var r=sap.ui.getCore().getLibraryResourceBundle("sap.ui.generic.template").getText("ACTION_MISSING_MANDATORY");for(var i=0;i<m.missingMandatoryParameters.length;i++){var s=q.sap.formatMessage(r,t._getParameterName(m.missingMandatoryParameters[i]));C.addItem(new T({text:s}));}a.error(C,{sClass:t._getCompactModeStyleClass()});}}}}),endButton:new sap.m.Button({text:sap.ui.getCore().getLibraryResourceBundle("sap.ui.generic.template").getText("ACTION_CANCEL"),press:function(){o.close();}}),afterClose:function(){o.destroy();}}).addStyleClass("sapUiNoContentPadding");o.addStyleClass(this._getCompactModeStyleClass());o.setModel(p);o.open();}else{this._call();}};A.prototype._call=function(u){var p={urlParameters:u};var C=this.getController();var o=this._oCurrentContext;var t=this;try{C.getTransactionController().invokeAction(this._sFunctionImportPath,this._oCurrentContext,p).then(function(r){var g=t.getSuccessCallback();if(g){g(r.context);}C.handleSuccess(r);},function(E){C.handleError(E,{context:o});});}catch(f){C.handleError(f,{context:o});}};A.prototype._getActionParameterData=function(p){var m=[];var r=p.getObject('/');var P={};for(var i=0;i<this._oFunctionImport.parameter.length;i++){var o=this._oFunctionImport.parameter[i];var s=o.name;if(r.hasOwnProperty(s)){var v=r[s];if(v===undefined){if(!this._toBoolean(o.nullable)){if(o.type==='Edm.Boolean'){P[s]=false;}else{m.push(o);}}}else{P[s]=v;}}else{throw new Error("Unknown parameter: "+s);}}return{preparedParameterData:P,missingMandatoryParameters:m};};A.prototype._buildParametersForm=function(){var f=new S({editable:true});var F=[];for(var i=0;i<this._oParameters.additionalParameters.length;i++){var p=this._oParameters.additionalParameters[i];var P=this._getParameterName(p);var B='{/'+p.name+'}';var j=null;var E=p.type;var m=p.maxLength?parseInt(p.maxLength,10):undefined;if(E==='Edm.String'){j=sap.ui.comp.smartfield.JSONType.String;}else if(E==='Edm.Boolean'){j=sap.ui.comp.smartfield.JSONType.Boolean;}else if(E==='Edm.Byte'||E==='Edm.SByte'||E==='Edm.Int16'||E==='Edm.Int32'){j=sap.ui.comp.smartfield.JSONType.Integer;}else{throw new Error("Unsupported parameter type: "+E);}var o=new c({value:B,mandatory:false,jsontype:j,maxLength:m});F.push(o);var l=new d();l.setText(P);l.setLabelFor(o);f.addContent(l);f.addContent(o);}var C=function(){var h=false;return h;};return{form:f,checkClientErrors:C};};A.prototype._getParameterName=function(p){return p["com.sap.vocabularies.Common.v1.Label"]?p["com.sap.vocabularies.Common.v1.Label"].String:p.name;};A.prototype._addParameterLabel=function(p,E){if(E&&p&&!p["com.sap.vocabularies.Common.v1.Label"]){var P=this._oMetaModel.getODataProperty(E,p.name,false);if(P&&P["com.sap.vocabularies.Common.v1.Label"]){p["com.sap.vocabularies.Common.v1.Label"]=P["com.sap.vocabularies.Common.v1.Label"];}}};return A;},true);};if(!jQuery.sap.isDeclared('sap.ui.generic.template.MessageUtil')){jQuery.sap.declare('sap.ui.generic.template.MessageUtil');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.ManagedObject');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.m.Dialog');sap.ui.define("sap/ui/generic/template/MessageUtil",["jquery.sap.global","sap/ui/base/ManagedObject","sap/m/MessageBox","sap/m/Dialog"],function(q,M,a,D){"use strict";var b=M.extend("sap.ui.generic.template.MessageUtil",{metadata:{properties:{controller:{type:"object",group:"Misc",defaultValue:null},response:{type:"object",group:"Misc",defaultValue:null}}}});b.prototype._httpStatusCodes={badRequest:"400",forbidden:"403",methodNotAllowed:"405",preconditionFailed:"428",internalServerError:"500"};b.prototype.handleError=function(p){p=p||{};var e=p.errorContext||{};var E=this.getResponse();var c=this.getController();var m=sap.ui.getCore().getLibraryResourceBundle("sap.ui.generic.template").getText("ERROR_UNKNOWN");var h;if(E instanceof Error){if(E.message){m=E.message;}}else if(E.response){if(E.response.message){m=E.response.message;}if(E.response.statusCode){h=E.response.statusCode;}if(E.response.headers){for(var H in E.response.headers){if(H.toLowerCase()==='content-type'){var s=E.response.headers[H];if(s.toLowerCase().indexOf('application/json')===0){if(E.response.responseText){var o=JSON.parse(E.response.responseText);if(o&&o.error&&o.error.message&&o.error.message.value){m=o.error.message.value;}}}else{if(E.message){m=E.message;}}break;}}}}var S=true;switch(e.lastOperation.name){case'':break;case c.operations.callAction:break;case c.operations.addEntry:S=false;break;case c.operations.modifyEntity:if(this._httpStatusCodes.preconditionFailed===h){S=false;}break;case c.operations.saveEntity:if(e.isDraft){S=false;}break;case c.operations.deleteEntity:break;case c.operations.editEntity:break;case c.operations.validateDraftEntity:break;case c.operations.prepareDraftEntity:S=false;break;case c.operations.activateDraftEntity:break;default:break;}var d={entitySet:e.entitySet,title:p.title,message:m};if(S){if(e.showMessages){this._showMessageBox(d);}}else{this._showMessagePage(d);}};b.prototype._showMessageBox=function(p){sap.m.MessageBox.show(p.message,{icon:p.messageBoxIcon||sap.m.MessageBox.Icon.ERROR,title:p.title||sap.ui.getCore().getLibraryResourceBundle("sap.ui.generic.template").getText("ERROR_TITLE"),actions:[sap.m.MessageBox.Action.OK],onClose:function(A){},styleClass:this._getCompactModeStyleClass()});};b.prototype._showMessagePage=function(p){var n=this.getController().getNavigationController();n.navigateToMessagePage({entitySet:p.entitySet,title:p.title,text:p.message});};b.prototype._getCompactModeStyleClass=function(){if(this.getController().getView().$().closest(".sapUiSizeCompact").length){return"sapUiSizeCompact";}return"";};b.prototype.handleSuccess=function(p){p=p||{};var s=p.successContext||{};var r,m,c;r=this.getResponse();c=this._getMessages(r.response);if(c&&c.length>0){if(c.length===1){m=c[0];if(m.state===sap.ui.core.ValueState.Success){this._showSuccessToast(m);}else{if(s.showMessages){this._showMessages(c);}}}else{if(s.showMessages){this._showMessages(c);}}}};b.prototype._getMessages=function(r){var m=[];if(!r||!r.statusCode){return;}if(r.statusCode.toString().substring(0,1)==="2"){if(r.headers["sap-message"]){var o=r.headers["sap-message"];var c=JSON.parse(o);m.push(this._getMessage(c));if(c.details){for(var i=0;i<c.details.length;i++){m.push(this._getMessage(c.details[i]));}}}}return m;};b.prototype._getMessage=function(m){var i,s;switch(m.severity){case"info":i="sap-icon://sys-enter";s=sap.ui.core.ValueState.Success;break;case"warning":i="sap-icon://notification";s=sap.ui.core.ValueState.Warning;break;case"error":i="sap-icon://error";s=sap.ui.core.ValueState.Error;break;default:i="sap-icon://sys-enter";s=sap.ui.core.ValueState.Success;break;}var o={message:m.message,code:m.messageCode,target:m.target,icon:i,state:s};return o;};b.prototype._showSuccessToast=function(m){sap.m.MessageToast.show(m.message);};b.prototype._showMessages=function(m){var o,d;var t=this;o=new sap.ui.model.json.JSONModel();o.setData({messages:m});d=new sap.m.Dialog({content:t.getMessageTable(),type:sap.m.DialogType.Message,state:"None",afterClose:function(){d.destroy();},buttons:[new sap.m.Button({text:sap.ui.getCore().getLibraryResourceBundle("sap.ui.generic.template").getText("DIALOG_CLOSE"),press:function(){d.close();}})]});d.setModel(o);d.open();};b.prototype.getMessageTable=function(){var m=new sap.m.Table({growing:false,showSeparators:sap.m.ListSeparators.None,inset:false,fixedLayout:false,backgroundDesign:sap.m.BackgroundDesign.Transparent,columns:[new sap.m.Column({hAlign:"Left",vAlign:"Top"})]});var t=this;var c=new sap.m.ColumnListItem({unread:false,vAlign:"Top",type:"{itemType}",press:function(e){t._navigateToDetail(e);},cells:[new sap.ui.layout.Grid({vSpacing:0,hSpacing:1,content:[new sap.m.ObjectStatus({icon:"{icon}",state:"{state}",layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2"})}),new sap.m.Text({maxLines:3,text:"{message}",layoutData:new sap.ui.layout.GridData({span:"L10 M10 S10"})})]})]});m.bindAggregation("items","/messages",c);return m;};return b;},true);};if(!jQuery.sap.isDeclared('sap.ui.generic.template.ViewUtil')){jQuery.sap.declare('sap.ui.generic.template.ViewUtil');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.table.Table');jQuery.sap.require('sap.m.Table');jQuery.sap.require('sap.ui.comp.smarttable.SmartTable');sap.ui.define("sap/ui/generic/template/ViewUtil",["sap/ui/base/Object","sap/ui/table/Table","sap/m/Table","sap/ui/comp/smarttable/SmartTable"],function(O,T,R,S){"use strict";var V=O.extend("sap.ui.generic.template.ViewUtil",{metadata:{properties:{}}});V.getParentTable=function(s){var c=s;while(c){if(c instanceof R||c instanceof T||c instanceof S){return c;}if(c.getParent){c=c.getParent();}else{return null;}}return null;};V.getTableBinding=function(t){if(t instanceof S){t=t.getTable();}if(t instanceof T){return t.getBindingInfo("rows");}else if(t instanceof R){return t.getBindingInfo("items");}return null;};return V;},true);};if(!jQuery.sap.isDeclared('sap.ui.generic.template.library')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
jQuery.sap.declare('sap.ui.generic.template.library');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.library');jQuery.sap.require('sap.ui.comp.library');sap.ui.define("sap/ui/generic/template/library",['jquery.sap.global','sap/ui/core/library','sap/ui/comp/library'],function(q,l,a){"use strict";sap.ui.getCore().initLibrary({name:"sap.ui.generic.template",version:"1.32.7",dependencies:["sap.ui.core","sap.ui.comp"],types:[],interfaces:[],controls:[],elements:[]});return sap.ui.generic.template;},true);};if(!jQuery.sap.isDeclared('sap.ui.generic.template.BaseViewController')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
jQuery.sap.declare('sap.ui.generic.template.BaseViewController');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.mvc.Controller');jQuery.sap.require('sap.m.MessagePopover');jQuery.sap.require('sap.m.MessagePopoverItem');jQuery.sap.require('sap.ui.core.Component');jQuery.sap.require('sap.m.PlacementType');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.ui.table.Table');jQuery.sap.require('sap.m.Table');jQuery.sap.require('sap.ui.comp.smarttable.SmartTable');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.generic.app.util.ModelUtil');sap.ui.define("sap/ui/generic/template/BaseViewController",['jquery.sap.global','sap/ui/core/mvc/Controller','sap/ui/generic/template/library','sap/m/MessagePopover','sap/m/MessagePopoverItem','sap/ui/core/Component','sap/m/PlacementType','sap/m/MessageToast','sap/m/MessageBox','sap/ui/table/Table','sap/m/Table','sap/ui/comp/smarttable/SmartTable','sap/ui/model/Sorter','sap/ui/model/Filter','sap/ui/generic/template/ViewUtil','sap/ui/generic/template/ActionUtil','sap/ui/generic/template/MessageUtil','sap/ui/generic/app/util/ModelUtil'],function(q,C,l,M,a,b,P,c,d,T,R,S,e,F,V,A,f,g){"use strict";var B=C.extend("sap.ui.generic.template.BaseViewController",{metadata:{library:"sap.ui.generic.template"}});B.prototype.onInit=function(p){p=p||{};this._fnShowMessages=p.showMessages;this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.generic.template");this._setCurrentOperation('',null);};B.prototype.getContext=function(){return this.getView().getBindingContext();};B.prototype.getComponent=function(){if(!this._oComponent){this._oComponent=b.getOwnerComponentFor(this.getView());}return this._oComponent;};B.prototype.getComponentContainer=function(){return this.getComponent().getComponentContainer();};B.prototype.getTransactionController=function(){return this.getComponent().getAppComponent().getTransactionController();};B.prototype.getNavigationController=function(){return this.getComponent().getAppComponent().getNavigationController();};B.prototype.getDraftController=function(){return this.getTransactionController().getDraftController();};B.prototype.getDraftContext=function(){return this.getTransactionController().getDraftController().getDraftContext();};B.prototype.editEntity=function(){this._setCurrentOperation(this.operations.editEntity);var t=this;return new Promise(function(r,h){t.getTransactionController().editEntity(t.getContext()).then(function(o){t.getComponentContainer().bindElement(o.context.getPath());t.handleSuccess(o);return r(o.context);},function(E){t.handleError(E);return h(E);});});};B.prototype.deleteEntity=function(D){this._setCurrentOperation(this.operations.deleteEntity);var t=this;var o=this.getContext();var i=this.getDraftController().isActiveEntity(o);var h=this.getDraftController().hasActiveEntity(o);return new Promise(function(r,j){if(i&&D){t.getDraftController().getDraftForActiveEntity(o).then(function(k){t.getTransactionController().deleteEntity(k.context).then(function(){setTimeout(function(){c.show(t._oRb.getText("DRAFT_WITH_ACTIVE_DOCUMENT_DELETED"));},50);return r();});},function(E){t.getComponentContainer().bindElement(o.getPath());t.handleError(E);return j();});}else{t.getTransactionController().deleteEntity(o).then(function(){var E=g.getEntitySetFromContext(o);var k=t.getDraftController().getDraftContext();var m=k.isDraftRoot(E);var s=t._oRb.getText("OBJECT_DELETED");if(!i&&m){s=h?t._oRb.getText("DRAFT_WITH_ACTIVE_DOCUMENT_DELETED"):t._oRb.getText("DRAFT_WITHOUT_ACTIVE_DOCUMENT_DELETED");}setTimeout(function(){c.show(s);},50);return r();},function(E){t.getComponentContainer().bindElement(o.getPath());t.handleError(E);return j();});}});};B.prototype.modifyEntity=function(v){this._setCurrentOperation(this.operations.modifyEntity);var t=this;return new Promise(function(r,h){var E=t.getComponent().getEntitySet();if(!t.getDraftContext().isDraftEnabled(E)){return r();}t.getTransactionController().propertyChanged(E,v,t.getComponentContainer().getElementBinding()).then(function(){return r();},function(o){t.handleError(o);return h();});});};B.prototype.saveEntity=function(){this._setCurrentOperation(this.operations.saveEntity);var t=this;return new Promise(function(r,h){t.getTransactionController().triggerSubmitChanges().then(function(o){t.handleSuccess(o);return r(o.context);},function(E){t.handleError(E);return h(E);});});};B.prototype.activateDraftEntity=function(){this._setCurrentOperation(this.operations.activateDraftEntity);var t=this;return new Promise(function(r,h){t.getDraftController().activateDraftEntity(t.getContext()).then(function(o){t.getComponentContainer().unbindElement();t.getComponentContainer().bindElement(o.context.getPath());t.handleSuccess(o);return r(o);},function(E){t.handleError(E);return h(E);});});};B.prototype.prepareDraftEntity=function(){this._setCurrentOperation(this.operations.prepareDraftEntity);var t=this;return new Promise(function(r,h){t.getComponentContainer().unbindElement();t.getDraftController().prepareDraftEntity(t.getContext()).then(function(o){t.handleSuccess(o);return r(o);},function(E){t.handleError(E);return h(E);});});};B.prototype.validateDraftEntity=function(){this._setCurrentOperation(this.operations.validateDraftEntity);var t=this;return new Promise(function(r,h){t.getComponentContainer().unbindElement();t.getDraftController().validateDraftEntity(t.getContext()).then(function(o){t.handleSuccess(o);return r(o);},function(E){t.handleError(E);return h(E);});});};B.prototype._setRefreshRequiredOnComponents=function(o){var h=this.getNavigationController().getViews();for(var s in h){var i=h[s].getComponentInstance();if(i===o){continue;}if(i.setIsRefreshRequired){i.setIsRefreshRequired(true);}}};B.prototype._setCurrentOperation=function(s,p){this._oCurrentOperation={name:s};if(p){this._oCurrentOperation.parameters=p;}};B.prototype._getShowMessages=function(){if(this._fnShowMessages){return this._fnShowMessages();}return true;};B.prototype._getErrorContext=function(p){p=p||{};try{var i,E;var D=this.getDraftContext();if(D){var o=p.context||this.getContext();E=o?g.getEntitySetFromContext(o):this.getComponent().getEntitySet();i=D.isDraftEnabled(E);}return{entitySet:E,isDraft:i,lastOperation:this._oCurrentOperation,showMessages:this._getShowMessages()};}catch(h){q.sap.log.error("BaseViewController._getErrorContext threw an exception: "+h);return null;}};B.prototype.handleError=function(E,p){if(!p||!p.errorContext){p={errorContext:this._getErrorContext(p)};}var m=new f({controller:this,response:E});m.handleError(p);};B.prototype.handleSuccess=function(r,p){if(!p){p={successContext:{showMessages:this._getShowMessages()}};}var m=new f({controller:this,response:r});m.handleSuccess(p);};B.prototype.callAction=function(s,o,h){var n,i;if(typeof s==="object"){var p=s;s=p.functionImportPath;o=p.context;i=p.sourceControl;h=p.label;n=p.navigationProperty;}this._setCurrentOperation(this.operations.callAction,{functionImport:s});var t=this;var j=new A({controller:this,context:o,successCallback:function(k){if(k===o){return;}if(k&&k.getPath()!=="/undefined"){if(i){t.navigateFromListItem(k,i);}else{t.getNavigationController().navigateToContext(k,n,false);}}}});j.call(s,h);};B.prototype.navigateFromListItem=function(s,t){var o=null;if(s.getBindingContext){o=s.getBindingContext();}else{o=s;s=null;}var h=o.getPath();var i=this.getComponent();var p="";if(i.getComponentContainer().getElementBinding()){p=i.getComponentContainer().getElementBinding().getPath();}var n=null;if(h.indexOf(p)!==0){if(!t){t=V.getParentTable(s);}n=V.getTableBinding(t).path;}this.getNavigationController().navigateToContext(o,n,false);};B.prototype.searchOnTable=function(t,Q){if(!t){throw new Error("No table","BaseViewController.js");}var o=V.getTableBinding(t);var h={path:o.path,template:o.template,parameters:{custom:{search:Q}}};if(t instanceof T){t.bindRows(h);}else if(t instanceof R){t.bindItems(h);}else{throw new TypeError("searchOnTable not valid on "+t?t.toString():"(null)","BaseViewController.js");}};B.prototype.addEntry=function(t){this._setCurrentOperation(this.operations.addEntry);var n=this.getNavigationController();var s="";var h="";var E=this.getComponent().getEntitySet();var i=this;var o,j,N,m,k;if(!t){throw new Error("Unknown Table");}k=this.getView().getBindingContext();if(k){h=V.getTableBinding(t).path;m=this.getView().getModel().getMetaModel();j=m.getODataEntitySet(E);o=m.getODataEntityType(j.entityType);N=m.getODataAssociationSetEnd(o,h);E=N.entitySet;h='/'+h;s=k.getPath()+h;}else{s="/"+E;}return new Promise(function(r,p){if(i.getDraftContext().isDraftEnabled(E)){i.getDraftController().createNewDraftEntity(E,s).then(function(u){k=u.context;n.navigateToContext(k,h,false);return r(u.context);},function(u){i.handleError(u);return p(u);});}else{k=i.getView().getModel().createEntry(s,{batchGroupId:'Changes',changeSetId:'Changes'});n.navigateToContext(k,h,false);return r(k);}});};B.prototype.showMessagePopover=function(o,t){if(!this._oMessagePopover){this._oMessagePopover=new M({items:{path:"message>/",template:new a({description:"{message>description}",type:"{message>type}",title:"{message>message}"})}});o.addDependent(this._oMessagePopover);}if(t||!this._oMessagePopover.isOpen()){this._oMessagePopover.toggle(o);}};B.prototype.getTableQueryParameters=function(E,o){var m=this.getView().getModel().getMetaModel();var h=o;var j=m.getODataEntitySet(E,false);var k=m.getODataEntityType(j.entityType,false);var n=k.key.propertyRef;var i;if(this.getDraftContext().isDraftEnabled(E)){n=n.concat(this.getDraftContext().getSemanticKey(E));n.push({name:"IsActiveEntity"},{name:"HasDraftEntity"},{name:"HasActiveEntity"});}if(h.parameters.select&&h.parameters.select.length>0){var s=h.parameters.select.split(',');for(i=0;i<n.length;i++){if(q.inArray(n[i].name,s)===-1){h.parameters.select+=','+n[i].name;}}}return h;};B.operations={callAction:"callAction",addEntry:"addEntry",saveEntity:"saveEntity",deleteEntity:"deleteEntity",editEntity:"editEntity",modifyEntity:"modifyEntity",validateDraftEntity:"validateDraftEntity",prepareDraftEntity:"prepareDraftEntity",activateDraftEntity:"activateDraftEntity"};B.prototype.operations={callAction:B.operations.callAction,addEntry:B.operations.addEntry,saveEntity:B.operations.saveEntity,deleteEntity:B.operations.deleteEntity,editEntity:B.operations.editEntity,modifyEntity:B.operations.modifyEntity,validateDraftEntity:B.operations.validateDraftEntity,prepareDraftEntity:B.operations.prepareDraftEntity,activateDraftEntity:B.operations.activateDraftEntity};return B;},true);};if(!jQuery.sap.isDeclared('sap.ui.generic.template.TemplateComponent')){jQuery.sap.declare('sap.ui.generic.template.TemplateComponent');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.UIComponent');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.core.mvc.ViewType');sap.ui.define("sap/ui/generic/template/TemplateComponent",['jquery.sap.global','sap/ui/core/UIComponent','sap/ui/generic/template/library','sap/m/MessageBox','sap/ui/model/json/JSONModel','sap/ui/core/mvc/ViewType'],function(q,U,l,M,J,V){"use strict";var T=U.extend("sap.ui.generic.template.TemplateComponent",{metadata:{properties:{templateName:{type:"string",defaultValue:null},entitySet:{type:"string",defaultValue:null},navigationProperty:{type:"string",defaultValue:null},appComponent:{type:"object",defaultValue:null},isRefreshRequired:{type:"boolean",defaultValue:false},preventBinding:{type:"boolean",defaultValue:false}},library:"sap.ui.generic.template"}});T.prototype.getComponentContainer=function(){return this.oContainer;};T.prototype.setContainer=function(){var m;sap.ui.core.UIComponent.prototype.setContainer.apply(this,arguments);if(this.oContainer){m=this.oContainer.getModel();if(m){m.getMetaModel().loaded().then(function(){this.runAsOwner(function(){var v=this._createXMLView();this.setAggregation("rootControl",v);this.getUIArea().invalidate();}.bind(this));}.bind(this));}}};T.prototype._createXMLView=function(){var v=null;var m=this.getModel().getMetaModel();var E=m.getODataEntitySet(this.getEntitySet());if(!E||!E.entityType){this.handleErrors();return null;}this._enhanceI18nModel();q.sap.require("sap.ui.model.odata.AnnotationHelper");try{var s=this._determineStableID();v=sap.ui.getCore().byId(s);if(v){window.console.warn("View with ID: "+s+" already exists - old view is getting destroyed now!");try{v.destroy();}catch(a){window.console.error("Error destroying view: "+a);}v=null;}var d=new J(sap.ui.Device);d.setDefaultBindingMode("OneWay");v=sap.ui.view({preprocessors:{xml:{bindingContexts:{meta:m.createBindingContext(m.getODataEntityType(E.entityType,true)),entitySet:m.createBindingContext(m.getODataEntitySet(this.getEntitySet(),true))},models:{device:d,meta:m,entitySet:m,parameter:this._createParameterModel(E.entityType)},preprocessorsData:this.getComponentData().preprocessorsData}},id:s,type:V.XML,viewName:this.getTemplateName(),height:"100%"});}catch(e){this.handleErrors(e);throw e;}return v;};T.prototype._determineStableID=function(){if(this.getAppComponent().getMetadata().getComponentName()===""||this.getTemplateName()===""||this.getEntitySet()===""){var t="Stable Id could not be determined in sap.ui.generic.template.TemplateComponent. Either application component name or template name or entity set is empty.";this.handleErrors(new Error(t));throw new Error(t+this);}return this.getAppComponent().getMetadata().getComponentName()+'::'+this.getTemplateName()+'::'+this.getEntitySet();};T.prototype._enhanceI18nModel=function(){var m=this.getAppComponent().getModel('i18n|'+this.getMetadata().getComponentName()+'|'+this.getEntitySet());if(!m){return;}var o=this.getModel('i18n');o.enhance(m.getResourceBundle());};T.prototype._createParameterModel=function(e){var i=this.getAppComponent().getTransactionController().getDraftController().getDraftContext().isDraftEnabled(this.getEntitySet());var s=null;var a=this.getComponentContainer().getSettings();s=q.extend({},a);delete s.appComponent;delete s.entitySet;delete s.navigationProperty;return new J({entitySet:this.getEntitySet(),entityType:e,"sap-ui-debug":window['sap-ui-debug'],isDraftEnabled:i,"settings":s,"manifest":this.getAppComponent().getMetadata().getManifest()});};T.prototype.handleErrors=function(e){var v=this.getAggregation("rootControl");if(!v||!v.getController()){return;}var c=v.getController();c.handleError(e);};T.prototype.destroy=function(){U.prototype.destroy.apply(this,arguments);};T.prototype.getRouter=function(){if(this.getAppComponent()){return this.getAppComponent().getRouter();}return U.prototype.getRouter.apply(this,arguments);};T.prototype.onActivate=function(){this.setIsRefreshRequired(false);};T.prototype.onDeactivate=function(){};return T;},true);};
