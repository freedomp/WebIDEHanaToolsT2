define("tinymce/tableplugin/Plugin",["tinymce/tableplugin/TableGrid","tinymce/tableplugin/Quirks","tinymce/tableplugin/CellSelection","tinymce/tableplugin/Dialogs","tinymce/util/Tools","tinymce/dom/TreeWalker","tinymce/Env","tinymce/PluginManager"],function(T,Q,C,D,a,b,E,P){var c=a.each;function d(f){var g,s=this,h=new D(f);function j(e){return function(){f.execCommand(e);};}function k(e,r){var y,x,i,t;i='<table id="__mce"><tbody>';for(y=0;y<r;y++){i+='<tr>';for(x=0;x<e;x++){i+='<td>'+(E.ie?" ":'<br>')+'</td>';}i+='</tr>';}i+='</tbody></table>';f.undoManager.transact(function(){f.insertContent(i);t=f.dom.get('__mce');f.dom.setAttrib(t,'id',null);f.dom.setAttribs(t,f.settings.table_default_attributes||{});f.dom.setStyles(t,f.settings.table_default_styles||{});});return t;}function l(e,i){function r(){e.disabled(!f.dom.getParent(f.selection.getStart(),i));f.selection.selectorChanged(i,function(t){e.disabled(!t);});}if(f.initialized){r();}else{f.on('init',r);}}function p(){l(this,'table');}function m(){l(this,'td,th');}function n(){var e='';e='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var y=0;y<10;y++){e+='<tr>';for(var x=0;x<10;x++){e+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(y*10+x)+'" href="#" '+'data-mce-x="'+x+'" data-mce-y="'+y+'"></a></td>';}e+='</tr>';}e+='</table>';e+='<div class="mce-text-center" role="presentation">1 x 1</div>';return e;}function o(t,e,i){var r=i.getEl().getElementsByTagName('table')[0];var x,y,u,v,w;var z=i.isRtl()||i.parent().rel=='tl-tr';r.nextSibling.innerHTML=(t+1)+' x '+(e+1);if(z){t=9-t;}for(y=0;y<10;y++){for(x=0;x<10;x++){v=r.rows[y].childNodes[x].firstChild;w=(z?x>=t:x<=t)&&y<=e;f.dom.toggleClass(v,'mce-active',w);if(w){u=v;}}}return u.parentNode;}if(f.settings.table_grid===false){f.addMenuItem('inserttable',{text:'Insert table',icon:'table',context:'table',onclick:h.table});}else{f.addMenuItem('inserttable',{text:'Insert table',icon:'table',context:'table',ariaHideMenu:true,onclick:function(e){if(e.aria){this.parent().hideAll();e.stopImmediatePropagation();h.table();}},onshow:function(){o(0,0,this.menu.items()[0]);},onhide:function(){var e=this.menu.items()[0].getEl().getElementsByTagName('a');f.dom.removeClass(e,'mce-active');f.dom.addClass(e[0],'mce-active');},menu:[{type:'container',html:n(),onPostRender:function(){this.lastX=this.lastY=0;},onmousemove:function(e){var t=e.target,x,y;if(t.tagName.toUpperCase()=='A'){x=parseInt(t.getAttribute('data-mce-x'),10);y=parseInt(t.getAttribute('data-mce-y'),10);if(this.isRtl()||this.parent().rel=='tl-tr'){x=9-x;}if(x!==this.lastX||y!==this.lastY){o(x,y,e.control);this.lastX=x;this.lastY=y;}}},onclick:function(e){var s=this;if(e.target.tagName.toUpperCase()=='A'){e.preventDefault();e.stopPropagation();s.parent().cancel();f.undoManager.transact(function(){k(s.lastX+1,s.lastY+1);});f.addVisual();}}}]});}f.addMenuItem('tableprops',{text:'Table properties',context:'table',onPostRender:p,onclick:h.tableProps});f.addMenuItem('deletetable',{text:'Delete table',context:'table',onPostRender:p,cmd:'mceTableDelete'});f.addMenuItem('cell',{separator:'before',text:'Cell',context:'table',menu:[{text:'Cell properties',onclick:j('mceTableCellProps'),onPostRender:m},{text:'Merge cells',onclick:j('mceTableMergeCells'),onPostRender:m},{text:'Split cell',onclick:j('mceTableSplitCells'),onPostRender:m}]});f.addMenuItem('row',{text:'Row',context:'table',menu:[{text:'Insert row before',onclick:j('mceTableInsertRowBefore'),onPostRender:m},{text:'Insert row after',onclick:j('mceTableInsertRowAfter'),onPostRender:m},{text:'Delete row',onclick:j('mceTableDeleteRow'),onPostRender:m},{text:'Row properties',onclick:j('mceTableRowProps'),onPostRender:m},{text:'-'},{text:'Cut row',onclick:j('mceTableCutRow'),onPostRender:m},{text:'Copy row',onclick:j('mceTableCopyRow'),onPostRender:m},{text:'Paste row before',onclick:j('mceTablePasteRowBefore'),onPostRender:m},{text:'Paste row after',onclick:j('mceTablePasteRowAfter'),onPostRender:m}]});f.addMenuItem('column',{text:'Column',context:'table',menu:[{text:'Insert column before',onclick:j('mceTableInsertColBefore'),onPostRender:m},{text:'Insert column after',onclick:j('mceTableInsertColAfter'),onPostRender:m},{text:'Delete column',onclick:j('mceTableDeleteCol'),onPostRender:m}]});var q=[];c("inserttable tableprops deletetable | cell row column".split(' '),function(e){if(e=='|'){q.push({text:'-'});}else{q.push(f.menuItems[e]);}});f.addButton("table",{type:"menubutton",title:"Table",menu:q});if(!E.isIE){f.on('click',function(e){e=e.target;if(e.nodeName==='TABLE'){f.selection.select(e);f.nodeChanged();}});}s.quirks=new Q(f);f.on('Init',function(){s.cellSelection=new C(f);});f.on('PreInit',function(){f.serializer.addAttributeFilter('data-mce-cell-padding,data-mce-border,data-mce-border-color',function(e,r){var i=e.length;while(i--){e[i].attr(r,null);}});});c({mceTableSplitCells:function(e){e.split();},mceTableMergeCells:function(e){var i;i=f.dom.getParent(f.selection.getStart(),'th,td');if(!f.dom.select('td.mce-item-selected,th.mce-item-selected').length){h.merge(e,i);}else{e.merge();}},mceTableInsertRowBefore:function(e){e.insertRow(true);},mceTableInsertRowAfter:function(e){e.insertRow();},mceTableInsertColBefore:function(e){e.insertCol(true);},mceTableInsertColAfter:function(e){e.insertCol();},mceTableDeleteCol:function(e){e.deleteCols();},mceTableDeleteRow:function(e){e.deleteRows();},mceTableCutRow:function(e){g=e.cutRows();},mceTableCopyRow:function(e){g=e.copyRows();},mceTablePasteRowBefore:function(e){e.pasteRows(g,true);},mceTablePasteRowAfter:function(e){e.pasteRows(g);},mceTableDelete:function(e){e.deleteTable();}},function(e,i){f.addCommand(i,function(){var r=new T(f);if(r){e(r);f.execCommand('mceRepaint');s.cellSelection.clear();}});});c({mceInsertTable:h.table,mceTableProps:function(){h.table(true);},mceTableRowProps:h.row,mceTableCellProps:h.cell},function(e,i){f.addCommand(i,function(u,v){e(v);});});if(f.settings.table_tab_navigation!==false){f.on('keydown',function(e){var i,r,t;if(e.keyCode==9){i=f.dom.getParent(f.selection.getStart(),'th,td');if(i){e.preventDefault();r=new T(f);t=e.shiftKey?-1:1;f.undoManager.transact(function(){if(!r.moveRelIdx(i,t)&&t>0){r.insertRow();r.refresh();r.moveRelIdx(i,t);}});}}});}s.insertTable=k;}P.add('table',d);});
