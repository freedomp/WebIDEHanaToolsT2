sap.ui.controller("sap.apf.modeler.ui.controller.configurationListNew",{onInit:function(){var c=this.getOwnerComponent();if(c){this.oCoreApi=c.oCoreApi;}this.aData=[];this.oModel=new sap.ui.model.json.JSONModel({tableData:this.aData});this.oView=this.getView();this.oView.setModel(this.oModel);sap.ui.core.UIComponent.getRouterFor(this).attachRouteMatched(this._handleRouteChanged.bind(this));},_handleRouteChanged:function(e){var E=e.getParameters();if(E.name!=="applicationList"){this.sAppId=E.arguments.appId;this._displayApplicationName();this._getConfigHandler().then(this._populateConfigList);this.oModel.updateBindings();}},_getConfigHandler:function(){var s=this;var c=new jQuery.Deferred();this.oCoreApi.getConfigurationHandler(this.sAppId,function(C){s.oConfigHandler=C;c.resolveWith(s,[C]);});return c;},_populateConfigList:function(){var s=this;var c=this.oConfigHandler.getList();c.forEach(function(C){s.aData.push({AnalyticalConfiguration:C.AnalyticalConfiguration,Application:C.Application,name:C.AnalyticalConfigurationName,type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION});});this.oModel.updateBindings();},_displayApplicationName:function(){var s=this;this.oCoreApi.getApplicationHandler(function(a){var A=a.getApplication(s.sAppId).ApplicationName;s.byId("idConfigTitleMaster").setText(s.oCoreApi.getText("configurationObjectTitle")+" : "+A);});}});
/*!
* SAP APF Analysis Path Framework
*
* (c) Copyright 2012-2014 SAP SE. All rights reserved
*/
sap.ui.controller("sap.apf.modeler.ui.controller.titleBreadCrumb",{onInit:function(){this.oViewData=this.getView().getViewData();this.getText=this.oViewData.getText;this._addConfigStyleClass();},_addConfigStyleClass:function(){this.byId("IdBreadCrumb").addStyleClass("breadCrumb");this.byId("IdFormTitle").addStyleClass("formTitle");},setTitleAndBreadCrumb:function(f){this.byId("IdFormTitle").setText(f);}});sap.ui.controller("sap.apf.modeler.ui.controller.toolbar",{onInit:function(){this.oCoreApi=this.getView().getViewData().oConfigListInstance.oCoreApi;this.oConfigListInstance=this.getView().getViewData().oConfigListInstance;this._setDisplayText();},_setDisplayText:function(){this.byId("idAddButton").setText(this.oCoreApi.getText("addButton"));this.byId("idCopyButton").setText(this.oCoreApi.getText("copyButton"));this.byId("idDeleteButton").setText(this.oCoreApi.getText("deleteButton"));},enableCopyDeleteButton:function(){if(!this.byId("idCopyButton").getEnabled()){this.byId("idCopyButton").setEnabled(true);}if(!this.byId("idDeleteButton").getEnabled()){this.byId("idDeleteButton").setEnabled(true);}},disableCopyDeleteButton:function(){if(this.byId("idCopyButton").getEnabled()){this.byId("idCopyButton").setEnabled(false);}if(this.byId("idDeleteButton").getEnabled()){this.byId("idDeleteButton").setEnabled(false);}},_setAddMenuText:function(){sap.ui.core.Fragment.byId("idAddMenuFragment","idNewConfig").setText(this.oCoreApi.getText("newConfiguration"));sap.ui.core.Fragment.byId("idAddMenuFragment","idNewFacetFilter").setText(this.oCoreApi.getText("newFacetFilter"));sap.ui.core.Fragment.byId("idAddMenuFragment","idNewCategory").setText(this.oCoreApi.getText("newCategory"));sap.ui.core.Fragment.byId("idAddMenuFragment","idNewNavigationTarget").setText(this.oCoreApi.getText("newNavigationTarget"));sap.ui.core.Fragment.byId("idAddMenuFragment","idStep").setText(this.oCoreApi.getText("step"));sap.ui.core.Fragment.byId("idAddMenuFragment","idNewStep").setText(this.oCoreApi.getText("newStep"));sap.ui.core.Fragment.byId("idAddMenuFragment","idExistingStep").setText(this.oCoreApi.getText("existingStep"));sap.ui.core.Fragment.byId("idAddMenuFragment","idNewRepresentation").setText(this.oCoreApi.getText("newRepresentation"));},_setExistingStepDialogText:function(){sap.ui.core.Fragment.byId("idExistingStepDialogFragment","idExistingStepDialog").setTitle(this.oCoreApi.getText("existingStepDialogTitle"));},_enableDisableAddMenuItems:function(s,a){var A=a.getItems();var n;if(this.oConfigListInstance.configurationHandler.getList().length===0||s===null){n="default";}else{n=s.nodeObjectType;}var m={};m["default"]=1;m[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]=4;m[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER]=4;m[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]=5;m[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP]=6;m[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION]=6;m[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET]=4;A.forEach(function(M,i){if(i<m[n]){M.setEnabled(true);}else{M.setEnabled(false);}});},_handlePressAddButton:function(e){var s;var S=this;if(this.oConfigListInstance.getView().byId("idConfigDetailData").getContent().length>=1){s=(typeof this.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController==="function")?this.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController():undefined;}e.getSource().$().blur();var n=sap.apf.modeler.ui.utils.navigationHandler.getInstance();var i=(s!==undefined)?(typeof s.getValidationState==="function"?s.getValidationState.call(s):true):true;this.oConfigListInstance.bIsSaved=this.oConfigListInstance.configEditor?this.oConfigListInstance.configEditor.isSaved():undefined;var a=false;var b=function(){var A=e.getSource();var o=this.oConfigListInstance.oTreeInstance.getAPFTreeNodeContext(this.oConfigListInstance.oTreeInstance.getSelection());if(!this.addMenu){this.addMenu=new sap.ui.xmlfragment("idAddMenuFragment","sap.apf.modeler.ui.fragment.addMenu",this);this.getView().addDependent(this.addMenu);this._setAddMenuText();}var c=sap.ui.core.Popup.Dock;this._enableDisableAddMenuItems(o,this.addMenu);this.addMenu.open(false,A,c.BeginTop,c.BeginBottom,A);};if(!i){n.throwMandatoryPopup(S.oConfigListInstance,{yes:function(){var N=S.oConfigListInstance._navMandatoryResetState(S.oConfigListInstance);if(!N.isNewView){b.call(S);}}});a=true;}if(!a){b.call(S);}},_handleAddMenuItemPress:function(e){var i=this.addMenu.getItems();var a=e.getParameters("item");var n;var N={"idAddMenuFragment--idNewFacetFilter":sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER,"idAddMenuFragment--idNewCategory":sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY,"idAddMenuFragment--idNewStep":sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP,"idAddMenuFragment--idNewRepresentation":sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION,"idAddMenuFragment--idNewConfig":sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION,"idAddMenuFragment--idNewNavigationTarget":sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET,"default":sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION};i.forEach(function(I){if(I.getId()===a.id){n=N[I.getId()];}else if(I.getSubmenu()){I.getSubmenu().getItems().forEach(function(I){if(I.getId()===a.id){n=N[I.getId()];}});}});if(a.id==="idAddMenuFragment--idExistingStep"){this._handleAddExistingStepPress();}else if(a.id!=="idAddMenuFragment--idStep"&&n!==undefined){this.oConfigListInstance.oTreeInstance.addNodeInTree(n);}},_copyConfiguration:function(c,n){var C=this.oConfigListInstance.configurationHandler.getConfiguration(c);var o={};o.AnalyticalConfiguration=C.AnalyticalConfiguration;o.name="< "+C.AnalyticalConfigurationName+" >";o.Application=C.Application;o.type=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION;o.bIsLoaded=false;o.bToggleState=false;o.isSelected=true;o.expanded=true;o.selectable=true;o.hasExpander=true;this.oConfigListInstance.oModel.getData().aConfigDetails.push(o);this.oConfigListInstance.oModel.updateBindings();this.oConfigListInstance.selectedNode=this.oConfigListInstance.oTreeInstance.getNodeByContext(n);this.oConfigListInstance.modelUpdateDeferred[this.oConfigListInstance.oModel.getData().aConfigDetails.length-1]=new jQuery.Deferred();var a={appId:this.oConfigListInstance.appId,configId:c};sap.ui.core.UIComponent.getRouterFor(this.oConfigListInstance).navTo(o.type,a,true);},_handlePressCopyButton:function(e){var s;var S=this;if(this.oConfigListInstance.getView().byId("idConfigDetailData").getContent().length>=1){s=(typeof this.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController==="function")?this.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController():undefined;}e.getSource().$().blur();var n=sap.apf.modeler.ui.utils.navigationHandler.getInstance();var a=(s!==undefined)?(typeof s.getValidationState==="function"?s.getValidationState.call(s):true):true;this.oConfigListInstance.bIsSaved=this.oConfigListInstance.configEditor?this.oConfigListInstance.configEditor.isSaved():undefined;var b=false;var c=function(){var C=this;var g=this.oTreeInstance.getAPFTreeNodeContext(this.oTreeInstance.getSelection()||this.selectedNode);this.selectedNode=this.oTreeInstance.getSelection()||this.selectedNode;var h,k,l,O,p,m,q,r,t,u,v;k=g.nodeContext;switch(g.nodeObjectType){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:var F=this.oCoreApi.getText("copyOf")+"  "+g.nodeTitle;var w=this.configEditor.copyFacetFilter(g.nodeAPFId);var x=this.configEditor.getFacetFilter(w);var T=sap.apf.modeler.ui.utils.TranslationFormatMap.FACETFILTER_LABEL;var y=this.oTextPool.setText(F,T);x.setLabelKey(y);O=k.split("/");m=O[2];q=O[6];var z=this.oModel.getData().aConfigDetails[m].configData[0].filters[q];z.isSelected=false;var A=jQuery.extend(true,{},z);A.id=w;A.name="< "+F+" >";A.isSelected=true;l=this.oModel.getData().aConfigDetails[m].configData[0].filters.length;this.oModel.getData().aConfigDetails[m].configData[0].filters.push(A);O[6]=l;h=O.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:var B=this.oCoreApi.getText("copyOf")+"  "+g.nodeTitle;var D=this.configEditor.copyCategory(g.nodeAPFId);var E=this.configEditor.getCategory(D);var G=sap.apf.modeler.ui.utils.TranslationFormatMap.CATEGORY_TITLE;var H=this.oTextPool.setText(B,G);var I={labelKey:H};this.configEditor.setCategory(I,D);O=k.split("/");m=O[2];r=O[6];var N=[];var J=this.configEditor.getSteps();J.forEach(function(y1){if(C.configEditor.getCategoriesForStep(y1.getId())[0]===D){N.push(y1.getId());}});var K=this.oModel.getData().aConfigDetails[m].configData[1].categories[r];K.isSelected=false;var L=jQuery.extend(true,{},K);if(L.steps){for(var i=0;i<L.steps.length;i++){L.steps[i].id=N[i];var M=C.configEditor.getStep(N[i]);var P=M.getRepresentations();if(L.steps[i].representations){for(var j=0;j<L.steps[i].representations.length;j++){L.steps[i].representations[j].id=P[j].getId();}}}}L.id=D;L.name="< "+B+" >";L.isSelected=true;l=this.oModel.getData().aConfigDetails[m].configData[1].categories.length;this.oModel.getData().aConfigDetails[m].configData[1].categories.push(L);O[6]=l;h=O.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:var Q=this.oCoreApi.getText("copyOf")+"  "+g.nodeTitle;var R=this.configEditor.copyNavigationTarget(g.nodeAPFId);var U=this.configEditor.getNavigationTarget(R);O=k.split("/");m=O[2];t=O[6];var V=this.oModel.getData().aConfigDetails[m].configData[2].navTargets[t];V.isSelected=false;var W=jQuery.extend(true,{},V);W.id=R;W.name="< "+Q+" >";W.isSelected=true;l=this.oModel.getData().aConfigDetails[m].configData[2].navTargets.length;this.oModel.getData().aConfigDetails[m].configData[2].navTargets.push(W);O[6]=l;h=O.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:var X=this.oCoreApi.getText("copyOf")+"  "+g.nodeTitle;var Y=this.configEditor.copyStep(g.nodeAPFId);var Z=this.configEditor.getCategoriesForStep(Y);var $=this.configEditor.getStep(Y);var _=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_TITLE;var a1=this.oTextPool.setText(X,_);$.setTitleId(a1);O=k.split("/");m=O[2];r=O[6];u=O[8];var b1=this.oModel.getData().aConfigDetails[m].configData[1].categories[r].steps[u];b1.isSelected=false;var c1=jQuery.extend(true,{},b1);P=$.getRepresentations();c1.id=Y;c1.name="< "+X+" >";if(c1.representations){for(j=0;j<c1.representations.length;j++){c1.representations[j].id=P[j].getId();}}l=this.oModel.getData().aConfigDetails[m].configData[1].categories[r].steps.length;O[8]=l;h=O.join("/");for(var d1=0;d1<Z.length;d1++){var e1=jQuery.extend(true,{},c1);var f1={arguments:{configId:S.oConfigListInstance.configId,categoryId:Z[d1]}};var g1=S.oConfigListInstance.getSPathFromURL(f1).sPath.split("/");var h1=g1[6];this.oModel.getData().aConfigDetails[m].configData[1].categories[h1].steps.push(e1);}this.oModel.getData().aConfigDetails[m].configData[1].categories[r].steps[l].isSelected=true;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:O=k.split("/");m=O[2];r=O[6];u=O[8];v=O[10];var i1=this.oModel.getData().aConfigDetails[m].configData[1].categories[r].steps[u].id;var j1=this.configEditor.getStep(i1);var k1=this.configEditor.getCategoriesForStep(i1);this.oModel.getData().aConfigDetails[m].configData[1].categories[r].steps[u].representations[v].isSelected=false;var l1=this.oModel.getData().aConfigDetails[m].configData[1].categories[r].steps[u].representations[v];var m1=jQuery.extend(true,{},l1);var n1=j1.copyRepresentation(m1.id);m1.id=n1;l=this.oModel.getData().aConfigDetails[m].configData[1].categories[r].steps[u].representations.length;O[10]=l;h=O.join("/");for(var o1=0;o1<k1.length;o1++){var p1=jQuery.extend(true,{},m1);var q1={arguments:{configId:S.oConfigListInstance.configId,categoryId:k1[o1],stepId:i1}};var r1=S.oConfigListInstance.getSPathFromURL(q1).sPath.split("/");var s1=r1[6];var t1=r1[8];this.oModel.getData().aConfigDetails[m].configData[1].categories[s1].steps[t1].representations.push(p1);}this.oModel.getData().aConfigDetails[m].configData[1].categories[r].steps[u].representations[l].isSelected=true;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION:var u1=this.oCoreApi.getText("copyOf")+"  "+g.nodeTitle;O=k.split("/");m=O[2];var v1=this.oModel.getData().aConfigDetails[m];v1.isSelected=false;O[2]=this.oModel.getData().aConfigDetails.length;h=O.join("/");this.configurationHandler.copyConfiguration(g.nodeAPFId,function(y1){var z1={AnalyticalConfigurationName:u1};var A1=C.configurationHandler.setConfiguration(z1,y1);C.configTitle=u1;C.configurationHandler.loadConfiguration(A1,function(B1){var u1=C.configTitle;var C1=sap.apf.modeler.ui.utils.TranslationFormatMap.APPLICATION_TITLE;var D1=C.configurationHandler.getTextPool().setText(u1,C1);B1.setApplicationTitle(D1);});S._copyConfiguration(y1,h);});break;default:break;}if(g.nodeObjectType!==sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION){this.oModel.updateBindings();this.selectedNode=this.oTreeInstance.getNodeByContext(h);var w1=this.oTreeInstance.getAPFTreeNodeContext(this.selectedNode);var x1=this.oTreeInstance.getParentNodeContext(w1);this.navigateToDifferntView(x1,w1);this.configEditor.setIsUnsaved();}};var d=function(){var g=new sap.m.Label().addStyleClass("noConfigSelected");g.setText(S.oConfigListInstance.oCoreApi.getText("noConfigSelected"));g.placeAt(S.oConfigListInstance.byId("idConfigDetailData"));S.oConfigListInstance.toolbarController.disableCopyDeleteButton();S.oConfigListInstance.disableExportButton();};var o;if(!a){n.throwMandatoryPopup(S.oConfigListInstance,{yes:function(){S.oConfigListInstance.bIsDifferntConfig=S.oConfigListInstance.oTreeInstance.isConfigurationSwitched(S.oConfigListInstance.oPreviousSelectedNode,S.oConfigListInstance.selectedNode);if(S.oConfigListInstance.bIsDifferntConfig===false){var r=S.oConfigListInstance.getRouteContext(S.oConfigListInstance.oParentNodeDetails);var s=(typeof S.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController==="function")?S.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController():undefined;var i=S.oConfigListInstance._isNewSubView(s.oViewData.oParams);if(!i){var p=S.oConfigListInstance.getSPathForConfig(S.oConfigListInstance.configId);c.call(S.oConfigListInstance);S.oConfigListInstance._navHandleExpandDelete.call(S.oConfigListInstance,S.oConfigListInstance.oSelectedNodeDetails,r);}else{S.oConfigListInstance.handleConfirmDeletion();}}else{var N=S.oConfigListInstance._navMandatoryResetState(S.oConfigListInstance);if(!N.isNewView){if(!N.bIsSaved){o(S.oConfigListInstance);}else{c.call(S.oConfigListInstance);}}}}});b=true;}var f;if(s.oViewData.oParams.name==="configuration"){f=true;}o=function(g){n.throwLossOfDataPopup(g,{yes:function(h){S.oConfigListInstance._navSaveState(function(){h(function(i){if(S.oConfigListInstance.selectedNode){var B=S.oConfigListInstance.selectedNode.getBindingContext().sPath;var C=B.split("/");var j=C[2];}S.oConfigListInstance.oModel.getData().aConfigDetails[j].AnalyticalConfiguration=S.oConfigListInstance.configId;S.oConfigListInstance.oModel.updateBindings();c.call(S.oConfigListInstance);});});},no:function(){var g={appId:S.oConfigListInstance.appId,configId:S.oConfigListInstance.configId};var s=(typeof S.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController==="function")?S.oConfigListInstance.getView().byId("idConfigDetailData").getContent()[0].getController():undefined;var f=(s.oViewData.oParams.name==="configuration")?true:false;if(S.oConfigListInstance.configId.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===0){S.oConfigListInstance._navHandleExpandDelete.call(S.oConfigListInstance,{},g,f);S.oConfigListInstance.clearTitleAndBreadCrumb();S.oConfigListInstance.byId("idConfigDetailData").removeAllContent();d();}else{S.oConfigListInstance._navConfigResetState(S.oConfigListInstance,function(){c.call(S.oConfigListInstance);});}}});};if(!S.oConfigListInstance.bIsSaved&&a&&f){o(S.oConfigListInstance);b=true;}if(!b){c.call(S.oConfigListInstance);}},_handlePressDeleteButton:function(e){var d;var s=this.oConfigListInstance.oTreeInstance.getAPFTreeNodeContext(this.oConfigListInstance.oTreeInstance.getSelection());var n=this.oCoreApi.getText(s.nodeObjectType);e.getSource().$().blur();if(s.nodeObjectType===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP){d=this.oCoreApi.getText("confirmStepDeletion",[s.nodeTitle]);}else{d=this.oCoreApi.getText("confirmDeletion",[n,s.nodeTitle]);}this._openDeleteConfirmationDialog(d);},_openDeleteConfirmationDialog:function(d){var s=this;var c=jQuery.extend(s.oConfigListInstance,{closeDialog:s.closeDialog.bind(s)});if(!this.confirmationDialog){this.confirmationDialog=sap.ui.xmlfragment("idConfigConfirmationDialogFragment","sap.apf.modeler.ui.fragment.confirmationDialog",c);this.getView().addDependent(this.confirmationDialog);this._setConfirmationDialogText();}var a=new sap.m.Label();a.addStyleClass("dialogText");a.setText(d);this.confirmationDialog.removeAllContent();this.confirmationDialog.addContent(a);jQuery.sap.syncStyleClass("sapUiSizeCompact",this.getView(),this.confirmationDialog);this.confirmationDialog.open();},closeDialog:function(){if(this.confirmationDialog&&this.confirmationDialog.isOpen()){this.confirmationDialog.close();}},_setConfirmationDialogText:function(){sap.ui.core.Fragment.byId("idConfigConfirmationDialogFragment","idDeleteConfirmation").setTitle(this.oCoreApi.getText("confirmation"));sap.ui.core.Fragment.byId("idConfigConfirmationDialogFragment","idDeleteButton").setText(this.oCoreApi.getText("deleteButton"));sap.ui.core.Fragment.byId("idConfigConfirmationDialogFragment","idCancelButtonDialog").setText(this.oCoreApi.getText("cancel"));},_handlePressMoveUpButton:function(){this.bIsDown=false;var s=this.oConfigListInstance.oTreeInstance.getSelection();if(s!==null){var a=this.oConfigListInstance.oTreeInstance.getAPFTreeNodeContext(s);if(a!==undefined){this._moveUpOrDown(a,this.bIsDown);}}},_handlePressMoveDownButton:function(){this.bIsDown=true;var s=this.oConfigListInstance.oTreeInstance.getSelection();if(s!==null){var a=this.oConfigListInstance.oTreeInstance.getAPFTreeNodeContext(s);if(a!==undefined){this._moveUpOrDown(a,this.bIsDown);}}},_moveUpOrDown:function(s,i){var a=s.nodeObjectType;var b=s.nodeAPFId;var n=s.nodeContext;var c=n.split('/')[2];var o,d,t,T,l;var S=false;var e=n.split('/')[n.split('/').length-1];switch(a){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:o=this.oConfigListInstance.oModel.getData().aConfigDetails[c].configData[0].filters;l=o.length;if(i){if(parseInt(e,10)!==(l-1)){this.oConfigListInstance.configEditor.moveFacetFilterUpOrDown(b,1);d=parseInt(e,10)+1;S=true;}}else{if(parseInt(e,10)!==0){this.oConfigListInstance.configEditor.moveFacetFilterUpOrDown(b,-1);d=parseInt(e,10)-1;S=true;}}break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:o=this.oConfigListInstance.oModel.getData().aConfigDetails[c].configData[1].categories;l=o.length;if(i){if(parseInt(e,10)!==(l-1)){this.oConfigListInstance.configEditor.moveCategoryUpOrDown(b,1);d=parseInt(e,10)+1;S=true;}}else{if(parseInt(e,10)!==0){this.oConfigListInstance.configEditor.moveCategoryUpOrDown(b,-1);d=parseInt(e,10)-1;S=true;}}break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:o=this.oConfigListInstance.oModel.getData().aConfigDetails[c].configData[2].navTargets;l=o.length;if(i){if(parseInt(e,10)!==(l-1)){this.oConfigListInstance.configEditor.moveNavigationTargetUpOrDown(b,1);d=parseInt(e,10)+1;S=true;}}else{if(parseInt(e,10)!==0){this.oConfigListInstance.configEditor.moveNavigationTargetUpOrDown(b,-1);d=parseInt(e,10)-1;S=true;}}break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:var f=n.split('/')[6];var g=this.oConfigListInstance.oModel.getData().aConfigDetails[c].configData[1].categories[f];o=g.steps;l=o.length;if(i){if(parseInt(e,10)!==(l-1)){this.oConfigListInstance.configEditor.moveCategoryStepAssignmentUpOrDown(g.id,b,1);d=parseInt(e,10)+1;S=true;}}else{if(parseInt(e,10)!==0){this.oConfigListInstance.configEditor.moveCategoryStepAssignmentUpOrDown(g.id,b,-1);d=parseInt(e,10)-1;S=true;}}break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:var h=this.oConfigListInstance.oTreeInstance.getSelection();var j=sap.ui.getCore().byId(h.getId());var k=j.getParent();var m=this.oConfigListInstance.oTreeInstance.getAPFTreeNodeContext(k).nodeAPFId;var p=this.oConfigListInstance.configEditor.getStep(m);f=n.split('/')[6];var q=n.split('/')[8];o=this.oConfigListInstance.oModel.getData().aConfigDetails[c].configData[1].categories[f].steps[q].representations;l=o.length;if(i){if(parseInt(e,10)!==(l-1)){p.moveRepresentationUpOrDown(b,1);d=parseInt(e,10)+1;S=true;}}else{if(parseInt(e,10)!==0){p.moveRepresentationUpOrDown(b,-1);d=parseInt(e,10)-1;S=true;}}break;default:break;}if(S){t=o[e];T=o[d];o[d]=t;o[e]=T;this.oConfigListInstance.oModel.updateBindings();this.oConfigListInstance.configEditor.setIsUnsaved();}},_handleAddExistingStepPress:function(){var s=this;var a=this.oConfigListInstance.oTreeInstance.getAPFTreeNodeContext(this.oConfigListInstance.oTreeInstance.getSelection());var c=this.oConfigListInstance.oTreeInstance.getParentNodeContext(a).categoryId;var S=this.oConfigListInstance.configEditor.getStepsNotAssignedToCategory(c);var b;var d=[];S.forEach(function(e){var o={};var f=s.oConfigListInstance.configEditor.getStep(e);b=s.oConfigListInstance.oTextPool.get(f.getTitleId()).TextElementDescription;o.id=e;o.name=b;d.push(o);});var m=new sap.ui.model.json.JSONModel({existingStepData:d});if(!this.addExistingStepDialog){this.addExistingStepDialog=sap.ui.xmlfragment("idExistingStepDialogFragment","sap.apf.modeler.ui.fragment.existingStepDialog",this);this._setExistingStepDialogText();}this.getView().addDependent(this.addExistingStepDialog);this.addExistingStepDialog.setModel(m);this.addExistingStepDialog.open();},_handleExistingStepDialogOK:function(e){var s=this;var n=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP;var a=e.getParameters("listItem").selectedItems;var b=a.length;var c=this.oConfigListInstance.oTreeInstance.getAPFTreeNodeContext(this.oConfigListInstance.oTreeInstance.getSelection());var d=this.oConfigListInstance.oTreeInstance.getParentNodeContext(c).categoryId;var E=[];for(var i=0;i<b;i++){var p=e.getParameters("selectedItems").selectedContexts[i].sPath.split('/')[2];var o=e.getSource().getModel().getData().existingStepData[p];var f=this.oConfigListInstance.configEditor.getStep(o.id);this.oConfigListInstance.configEditor.addCategoryStepAssignment(d,o.id);var r=f.getRepresentations();var g=r.length;var R=[];for(var j=0;j<g;j++){var h={};h.id=r[j].getId();h.name=r[j].getRepresentationType();h.icon=this._getRepresentationIcon(h.name);R.push(h);}var S={};S.step=o;S.representations=R;S.noOfReps=g;E.push(S);}if(b!==0){var k={noOfSteps:b,aExistingStepsToBeAdded:E};this.oConfigListInstance.oTreeInstance.addNodeInTree(n,k);}},_getRepresentationIcon:function(r){var i;var R=this.oCoreApi.getRepresentationTypes();for(var a=0;a<R.length;a++){if(r===R[a].id){i=R[a].picture;break;}}return i;},_handleExistingStepDialogSearch:function(e){var v=e.getParameter("value");var f=new sap.ui.model.Filter("name",sap.ui.model.FilterOperator.Contains,v);var b=e.getSource().getBinding("items");b.filter([f]);},_handleExistingStepDialogClose:function(e){if(this.addExistingStepDialog){e.getSource().getBinding("items").filter([]);}}});
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.controller("sap.apf.ui.reuse.controller.analysisPath",{refreshAnalysisPath:function(){this.getView().getCarousel().getController().refreshCarousel();},isOpenPath:false,isNewPath:false,bIsBackNavigation:false,onInit:function(){this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;this.bIsDirtyState=false;},refresh:function(n){var v=this.getView().oCarousel;var s=v.stepViews;var i;if(n!==-1){for(i=n;i<s.length;i++){var S={};S=s[i];if(S!==undefined){S.oThumbnailChartLayout.setBusy(true);}}}var a=this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep());if(a>n){var c=this.oUiApi.getStepContainer();c.vLayout.setBusy(true);}var p=this.oUiApi.getAnalysisPath().oSavedPathName.getTitle();if((this.bIsDirtyState===undefined||this.bIsDirtyState===false)&&this.oCoreApi.getSteps().length!==0){var b="*"+p;this.bIsDirtyState=true;this.oUiApi.getAnalysisPath().oSavedPathName.setTitle(b);}},callBackForUpdatePath:function(c,s){var n=this.oCoreApi.getSteps().indexOf(c);if(n===0){this.refreshAnalysisPath();}this.updateCurrentStep(c,n,s);},callBackForUpdatePathAndSetLastStepAsActive:function(c,s){var n=this.oCoreApi.getSteps().indexOf(c);if(n===0){var S=this.oCoreApi.getSteps()[this.oCoreApi.getSteps().length-1];this.oCoreApi.setActiveStep(S);this.refreshAnalysisPath();}this.updateCurrentStep(c,n,s);this.oUiApi.getLayoutView().setBusy(false);},updateCurrentStep:function(c,n,s){var i=this.oUiApi.getAnalysisPath().getController().isOpenPath;var a=this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep());var b=(n===a);this.drawThumbnail(n,s||i);if(b){this.drawMainChart(s);}if(this.oUiApi.getAnalysisPath().getController().isOpenPath&&(this.oCoreApi.getSteps().indexOf(c)===(this.oCoreApi.getSteps().length-1))){this.oUiApi.getLayoutView().setBusy(false);this.oUiApi.getAnalysisPath().getController().isOpenPath=false;}if(this.oUiApi.getAnalysisPath().getController().bIsBackNavigation&&(this.oCoreApi.getSteps().indexOf(c)===(this.oCoreApi.getSteps().length-1))){this.oUiApi.getLayoutView().setBusy(false);this.oUiApi.getAnalysisPath().getController().bIsBackNavigation=false;}this.oUiApi.getAnalysisPath().getController().isNewPath=false;},drawMainChart:function(s){var c=this.oUiApi.getStepContainer();c.getController().drawStepContent(s);},drawThumbnail:function(n,s){var S=this.getView().getCarousel().getStepView(n);S.getController().drawThumbnailContent(s);}});sap.ui.controller("sap.apf.ui.reuse.controller.carousel",{onAfterRendering:function(){if(this.oCoreApi.getSteps().length<1){jQuery(".DnD-separator").hide();}this.oViewData=this.getView().getViewData().oInject;this.oUiApi=this.oViewData.uiApi;jQuery(this.oUiApi.getStepContainer().getDomRef()).hide();if(jQuery("#"+this.initialText.getId()).length===0){jQuery('#'+this.oUiApi.getStepContainer().getId()).parent().append(sap.ui.getCore().getRenderManager().getHTML(this.initialText));}if(this.oUiApi.getAnalysisPath().getController().isOpenPath){jQuery(".initialText").remove();}},onInit:function(){var v=this.getView().getViewData().oInject;this.oCoreApi=v.oCoreApi;this.oUiApi=v.uiApi;this.stepGalleryView=sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.apf.ui.reuse.view.stepGallery",viewData:v});this.initialText=new sap.m.Label({text:v.oCoreApi.getTextNotHtmlEncoded('initialText')}).addStyleClass('initialText');},showStepGallery:function(){this.stepGalleryView.oController.openHierarchicalSelectDialog();},onBeforeRendering:function(){this.oUiApi.getLayoutView().getController().addMasterFooterContentLeft(this.getView().up);this.oUiApi.getLayoutView().getController().addMasterFooterContentLeft(this.getView().down);},getStepData:function(s){var S=this;var f=s;var o={};o.index=this.oCoreApi.getSteps().indexOf(s);o.title=this.oCoreApi.getTextNotHtmlEncoded(f.title);o.thumbnail=this.getThumbnailDataset(s);return o;},refreshCarousel:function(){if(this.oCoreApi.getSteps().length>this.getView().stepViews.length){this.addStep(this.oCoreApi.getSteps());}},addStep:function(s){this.oViewData=this.getView().getViewData().apfInstance;if(s instanceof Array){if(this.oUiApi.getAnalysisPath().getController().isOpenPath||this.oUiApi.getAnalysisPath().getController().bIsBackNavigation){var i;for(i=0;i<s.length;i++){this.addStep(s[i]);}return;}else{this.addStep(s[this.oCoreApi.getSteps().length-1]);return;}}var a=new sap.ui.view({viewName:"sap.apf.ui.reuse.view.step",type:sap.ui.core.mvc.ViewType.JS,viewData:this.getView().getViewData().oInject});var j=new sap.ui.model.json.JSONModel();a.setModel(j);var b=this.getStepData(s);j.setData(b);this.getView().stepViews.push(a);var c=document.createElement('div');c.innerHTML=sap.ui.getCore().getRenderManager().getHTML(a);var d=this.getView().dndBox;var e=d.eleRefs.blocks.length-1;jQuery(".initialText").remove();jQuery(this.oUiApi.getStepContainer().getDomRef()).show();jQuery(".DnD-separator").show();var f=this.Step?this.Step.categories[0].id:undefined;if(f==="initial"){d.insertBlock({blockElement:c,dragState:false,dropState:false,removable:false},e);}else{d.insertBlock({blockElement:c},e);}if(b.index===this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep())){a.toggleActiveStep();}a.rerender();this.oUiApi.getLayoutView().setBusy(true);},moveStep:function(d,a){var c=this.oUiApi.getAnalysisPath().getCarousel();if(d===a){return;}c.stepViews=(function(e,f,t){var g=Math.abs(t-f);var h=(t-f)>0?1:-1;var i;while(g--){i=e[f];e[f]=e[f+h];e[f+h]=i;f=f+h;}return e;})(c.stepViews,d,a);this.oUiApi.getAnalysisPath().getController().refresh(Math.min(d,a));var b=this.oCoreApi.getSteps()[d];this.oCoreApi.moveStepToPosition(b,a,this.oUiApi.getAnalysisPath().getController().callBackForUpdatePath.bind(this.oUiApi.getAnalysisPath().getController()));},removeStep:function(r){var c=this.oUiApi.getAnalysisPath().getCarousel();c.stepViews.splice(r,1);var s=c.stepViews.length;var a=this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep());if(s>0){if(r===a){var n;var b;if(a===0){n=a;b=c.stepViews[n];b.toggleActiveStep();this.oCoreApi.setActiveStep(this.oCoreApi.getSteps()[n+1]);}else{n=a-1;b=c.stepViews[n];b.toggleActiveStep();this.oCoreApi.setActiveStep(this.oCoreApi.getSteps()[n]);}}}else{jQuery(".DnD-separator").hide();jQuery(this.oUiApi.getStepContainer().getDomRef()).hide();this.oUiApi.getStepContainer().getStepToolbar().chartToolbar.removeAllCharts();jQuery('#'+this.oUiApi.getStepContainer().getId()).parent().append(sap.ui.getCore().getRenderManager().getHTML(this.initialText));}var d=this.oCoreApi.getSteps()[r];if(d.getSelectedRepresentation().chart){d.getSelectedRepresentation().chart.removeEventDelegate(this.oUiApi.getStepContainer().getController().fnSetHeightAndWidth);this.oUiApi.getStepContainer().getController().fnSetHeightAndWidth=null;this.oUiApi.getStepContainer().getController().setHeightAndWidth=null;}this.oUiApi.getStepContainer().getController().representationInstance=null;this.oUiApi.getStepContainer().getController().currentSelectedRepresentationId=null;this.oUiApi.getAnalysisPath().getController().refresh(r);this.oCoreApi.removeStep(d,this.oUiApi.getAnalysisPath().getController().callBackForUpdatePath.bind(this.oUiApi.getAnalysisPath().getController()));this.oUiApi.getLayoutView().getController().enableDisableOpenIn();},removeAllSteps:function(){var r=0;var i;var d=this.getView().dndBox;var c=this.oUiApi.getAnalysisPath().getCarousel();var s=c.stepViews.length;function C(){}for(i=1;i<=s;i++){d.removeBlock(r,C);var a=this.oCoreApi.getSteps()[i-1];if(a.getSelectedRepresentation().chart){a.getSelectedRepresentation().chart.removeEventDelegate(this.oUiApi.getStepContainer().getController().fnSetHeightAndWidth);this.oUiApi.getStepContainer().getController().fnSetHeightAndWidth=null;this.oUiApi.getStepContainer().getController().setHeightAndWidth=null;}this.oUiApi.getStepContainer().getController().representationInstance=null;this.oUiApi.getStepContainer().getController().currentSelectedRepresentationId=null;c.stepViews.splice(r,1);}jQuery(".DnD-separator").hide();this.oUiApi.getStepContainer().getStepToolbar().chartToolbar.removeAllCharts();this.oUiApi.getLayoutView().getController().enableDisableOpenIn();},getThumbnailDataset:function(s){var S=this;var t=["leftUpper","rightUpper","leftLower","rightLower"];var T=s.thumbnail;var o=s.getSelectedRepresentationInfo().thumbnail;var r={};t.forEach(function(a){var h=o&&o[a];h=h&&!S.oCoreApi.isInitialTextKey(o[a]);var H=T&&T[a];H=H&&!S.oCoreApi.isInitialTextKey(T[a]);if(h){r[a]=S.oCoreApi.getTextNotHtmlEncoded(o[a]);return;}else if(H){r[a]=S.oCoreApi.getTextNotHtmlEncoded(T[a]);return;}});return r;}});sap.ui.controller("sap.apf.ui.reuse.controller.deleteAnalysisPath",{onInit:function(){var s=this;this.oCoreApi=this.getView().getViewData().oInject.oCoreApi;this.oUiApi=this.getView().getViewData().oInject.uiApi;this.oSerializationMediator=this.getView().getViewData().oInject.oSerializationMediator;this.contentWidth=jQuery(window).height()*0.6+"px";this.contentHeight=jQuery(window).height()*0.6+"px";this.stdDialog=new sap.m.Dialog({title:s.oCoreApi.getTextNotHtmlEncoded("select-analysis-path"),contentWidth:s.contentWidth,contentHeight:s.contentHeight,content:this.getView().getContent()[0],leftButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("close"),press:function(){s.stdDialog.close();s.oUiApi.getLayoutView().setBusy(false);}})});},openPathGalleryWithDelete:function(){this.stdDialog.open();},getGuidForPath:function(p,v){var i;for(i=0;i<v.length;i++){var d=v[i];if(d.AnalysisPathName===p){return d.guid;}}},deleteSavedPath:function(p,i){var s=this;var g=i.guid;var a=p;var m;var c=s.oUiApi.getAnalysisPath().oSavedPathName.getTitle();s.oSerializationMediator.deletePath(g,function(r,b,d){if(d===undefined&&(typeof r==="object")){i.list.removeItem(i.item);s.oCoreApi.readPaths(function(r,b,d){if(d===undefined&&(typeof r==="object")){var n=r.paths.length;if(n===0){jQuery(".pathText").removeClass("pathTextDontShow");jQuery(".pathText").addClass("pathTextShow");}}else{m=s.oCoreApi.createMessageObject({code:"6005",aParameters:[a]});m.setPrevious(d);s.oCoreApi.putMessage(m);}});}else{m=s.oCoreApi.createMessageObject({code:"6009",aParameters:["delete",a]});m.setPrevious(d);s.oCoreApi.putMessage(m);}});if(c===a){s.oUiApi.getAnalysisPath().getToolbar().getController().resetAnalysisPath();}}});sap.ui.controller("sap.apf.ui.reuse.controller.layout",{onInit:function(){this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;this.oNavigationHandler=this.getView().getViewData().oNavigationHandler;var a;if(this.oCoreApi.getApplicationConfigProperties()){a=this.oCoreApi.getApplicationConfigProperties().appName;}this.applicationTitle=this.oCoreApi.getTextNotHtmlEncoded(a);this.getView().byId("applicationPage").setTitle(this.applicationTitle);var m=this.oUiApi.getNotificationBar();this.getView().byId("applicationPage").addContent(m);var c=m.initializeHandler;this.oCoreApi.setCallbackForMessageHandling(c.bind(m));this.loadLayout();},loadLayout:function(){var c=this.oUiApi.getStepContainer();var a=this.oUiApi.getAnalysisPath();this.getView().byId("applicationPage").setTitle(this.applicationTitle);this.getView().byId("masterFooter").addStyleClass("applicationFooter");this.getView().byId("detailFooter").addStyleClass("applicationFooter");this.getView().byId("stepContainer").addContent(c);this.getView().byId("analysisPath").addContent(a);this.addOpenInButton();},onAfterRendering:function(){var s=this;var a=new sap.m.Button({text:this.oCoreApi.getTextNotHtmlEncoded("showAnalyticalPath"),press:function(){s.getView().byId("applicationView").showMaster();},lite:true,type:"Transparent"});this.getView().byId("applicationView").attachAfterMasterClose(function(){s.getView().byId("detailFooter").removeContentLeft(a);s.addDetailFooterContentLeft(a);});this.getView().byId("applicationView").attachAfterMasterOpen(function(){if(s.getView().byId('detailFooter')){s.getView().byId("detailFooter").removeAllContentLeft();}});if(this.getView().byId("applicationView").isMasterShown()===false){this.addDetailFooterContentLeft(a);}},hideMaster:function(){if(sap.ui.Device.system.phone||sap.ui.Device.system.tablet){this.getView().byId("applicationView").hideMaster();if(sap.ui.Device.system.phone){this.getView().byId("applicationView").toDetail(this.getView().byId("stepContainer").getId());}}},showMaster:function(){this.getView().byId("applicationView").showMaster();},addMasterFooterContentLeft:function(c){this.getView().byId("masterFooter").addContentLeft(c);},addMasterFooterContentRight:function(c){if(this.getView().byId("masterFooter").getContentRight().length===0){this.getView().byId("masterFooter").insertContentRight(c);}else{this.addMasterFooterContent(c);}},addMasterFooterContent:function(c){var s=this;if(this.oActionListPopover===undefined){this.oActionListPopover=new sap.m.Popover({showHeader:false,placement:sap.m.PlacementType.Top});}if(typeof c.getWidth==="function"){c.setWidth("100%");}if(this.footerContentButton===undefined){this.getView().byId("masterFooter").getContentRight()[0].setWidth("71%");this.footerContentButton=new sap.m.Button({text:'...',press:function(e){s.oActionListPopover.openBy(e.getSource());},lite:true,type:"Transparent"});}this.oActionListPopover.addContent(c);this.getView().byId("masterFooter").insertContentRight(this.footerContentButton,1);},addDetailFooterContentLeft:function(c){this.getView().byId("detailFooter").addContentLeft(c);},addFacetFilter:function(f){this.getView().byId("subHeader").addItem(f);},enableDisableOpenIn:function(){var s=this;var n=this.oNavigationHandler.getNavigationTargets();n.then(function(a){if(s.oCoreApi.getActiveStep()){var g=function(){return s.oCoreApi.getActiveStep().getAssignedNavigationTargets().length===0?0:s.oCoreApi.getActiveStep().getAssignedNavigationTargets().length;};var b=s.oCoreApi.getActiveStep().getAssignedNavigationTargets()===undefined?0:g();if(b!==0||a.global.length!==0){s.openInBtn.setEnabled(true);}else if(b===0&&a.global.length===0){s.openInBtn.setEnabled(false);}}else{if(a.global.length===0){s.openInBtn.setEnabled(false);}else{s.openInBtn.setEnabled(true);}}s.openInBtn.rerender();});},addOpenInButton:function(){var s=this;if(this.oNavListPopover===undefined){this.oNavListPopover=new sap.m.Popover({showHeader:false,placement:sap.m.PlacementType.Top});}this.openInBtn=new sap.m.Button({text:this.oCoreApi.getTextNotHtmlEncoded("openIn"),type:"Transparent",enabled:false,press:function(e){s.oNavTargetsView=sap.ui.view({viewName:"sap.apf.ui.reuse.view.navigationTarget",type:sap.ui.core.mvc.ViewType.JS,viewData:{oNavigationHandler:s.oNavigationHandler,oNavListPopover:s.oNavListPopover,oOpenInButtonEventSource:e.getSource(),oUiApi:s.oUiApi}});}});this.getView().byId("detailFooter").insertContentRight(this.openInBtn,1);this.enableDisableOpenIn();},handleNavBack:function(){window.history.go(-1);}});sap.ui.controller("sap.apf.ui.reuse.controller.messageHandler",{onInit:function(){this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;},showMessage:function(m){var t=m.getMessage();var c=m.getCode();var s=m.getSeverity();var d=m.getTimestampAsdateObject();var M=new sap.ui.core.Message({text:t,timestamp:d});var f=sap.apf.core.constants.message.severity.fatal;var w=sap.apf.core.constants.message.severity.warning;var a=sap.apf.core.constants.message.severity.technError;var e=sap.apf.core.constants.message.severity.error;var b=this;switch(s){case f:M.setLevel(sap.ui.core.MessageType.Error);this.oUiApi.getLayoutView().setBusy(false);b.showDialog(t,c);break;case w:M.setLevel(sap.ui.core.MessageType.Warning);break;case e:this.oUiApi.getLayoutView().setBusy(false);M.setLevel(sap.ui.core.MessageType.Error);break;case a:break;default:jQuery.sap.log.error("Error type not defined");break;}if(s===f||s===w||s===e){jQuery.sap.require("sap.m.MessageToast");sap.m.MessageToast.show(M.getText(),{duration:3000,width:"40%",my:"center bottom",at:"center bottom",of:window,offset:"0 -50",collision:"fit fit",onClose:null,autoClose:true,animationTimingFunction:"ease",animationDuration:2000});}},showDialog:function(t){var s=this;var b=this.oCoreApi.getTextNotHtmlEncoded("application-logout");var d=this.oCoreApi.getTextNotHtmlEncoded("fatal-error");var l=this.oCoreApi.getLogMessages();var a=false;var i;for(i=0;i<l.length;i++){if(l[i].search(5021)!==-1){a=true;break;}}if(a===true){t=this.oCoreApi.getTextNotHtmlEncoded("application-reload");b=this.oCoreApi.getTextNotHtmlEncoded("reload-button");d=this.oCoreApi.getTextNotHtmlEncoded("sessionTimeout");}var D;for(i=0;i<l.length;i++){if(D){D=D+"\n"+l[i];}else{D=l[i];}}var I=false;s.fnClose=function(){I=true;if(window.location.hash){window.location.hash="";}};sap.ca.ui.message.showMessageBox({type:sap.ca.ui.message.Type.ERROR,message:t,details:D},s.fnClose);}});
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
sap.ui.controller("sap.apf.ui.reuse.controller.navigationTarget",{onInit:function(){this.oNavigationHandler=this.getView().getViewData().oNavigationHandler;},handleNavigation:function(s){this.oNavigationHandler.navigateToApp(s);}});
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.controller("sap.apf.ui.reuse.controller.pathGallery",{onInit:function(){this.oCoreApi=this.getView().getViewData().oInject.oCoreApi;this.oUiApi=this.getView().getViewData().oInject.uiApi;this.oSerializationMediator=this.getView().getViewData().oInject.oSerializationMediator;},openPathGallery:function(){if(this.oHierchicalPathGalleryDialog){this.oHierchicalPathGalleryDialog.destroy();}this.oHierchicalPathGalleryDialog=new sap.ui.jsfragment("sap.apf.ui.reuse.fragment.pathGallery",this);var m=new sap.ui.model.json.JSONModel();var j=this.getPathGalleryData();m.setData(j);this.oHierchicalPathGalleryDialog.setModel(m);this.oHierchicalPathGalleryDialog.open();},getPathGalleryData:function(){var s=this;var a=this.getView().getViewData()?this.getView().getViewData().jsonData:{};var f=function(){var c={"steps":s.oCoreApi.getStepTemplates()};return c;};if(a.GalleryElements.length!==0){var b=a.GalleryElements;var c=f();var i,j,k,d;for(i=0;i<b.length;i++){for(j=0;j<b[i].StructuredAnalysisPath.steps.length;j++){for(k=0;k<c.steps.length;k++){var e=b[i].StructuredAnalysisPath.steps[j].stepId;var g=b[i].StructuredAnalysisPath.steps[j].selectedRepresentationId;if(e===c.steps[k].id){for(d in c.steps[k].getRepresentationInfo()){if(g===c.steps[k].getRepresentationInfo()[d].representationId){a.GalleryElements[i].StructuredAnalysisPath.steps[j].imgSrc=c.steps[k].getRepresentationInfo()[d].picture;a.GalleryElements[i].StructuredAnalysisPath.steps[j].title=s.oCoreApi.getTextNotHtmlEncoded(c.steps[k].title.key);}}}}}}}return a;},openPath:function(p,g,a){var s=this;var m;var c=s.oUiApi.getAnalysisPath().getCarousel();this.oUiApi.getAnalysisPath().getCarousel().oController.removeAllSteps();s.oSerializationMediator.openPath(g,(function(s){return function(r,e,b){if(b===undefined&&(typeof r==="object")){s.oUiApi.getAnalysisPath().getController().isOpenPath=true;s.oUiApi.contextChanged();s.oUiApi.getAnalysisPath().getController().refresh(-1);s.oCoreApi.updatePath(s.oUiApi.getAnalysisPath().getController().callBackForUpdatePath.bind(s.oUiApi.getAnalysisPath().getController()));s.oUiApi.getAnalysisPath().oSavedPathName.setTitle(p);s.oUiApi.getAnalysisPath().getController().bIsDirtyState=false;if(s.oHierchicalPathGalleryDialog!==undefined){s.oHierchicalPathGalleryDialog.close();}c.rerender();s.oUiApi.getLayoutView().setBusy(false);}else{m=s.oCoreApi.createMessageObject({code:"6008",aParameters:[p]});m.setPrevious(b);s.oUiApi.getLayoutView().setBusy(false);s.oCoreApi.putMessage(m);}};}(this)),a);}});sap.ui.controller("sap.apf.ui.reuse.controller.step",{setActiveStep:function(i){var o=this.oCoreApi.getActiveStep();var a=this.oCoreApi.getSteps().indexOf(o);if(a===i){return;}var b=this.oCoreApi.getSteps()[i];this.oCoreApi.setActiveStep(b);this.oUiApi.getAnalysisPath().getController().drawMainChart();var s=this.oUiApi.getAnalysisPath().getCarousel().stepViews[i];s.toggleActiveStep();},bindEvts:function(){var s=this;var c=this.oUiApi.getAnalysisPath().getCarousel();var a=this.getView().oVChartTiltleLayout;a.attachBrowserEvent('click',function(){var b=c.stepViews.indexOf(s.getView());s.setActiveStep(b);s.oUiApi.getLayoutView().getController().enableDisableOpenIn();});},onAfterRendering:function(){this.bindEvts();this.oUiApi.getLayoutView().getController().enableDisableOpenIn();},onInit:function(){this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;this.isSwitched=false;},drawThumbnailContent:function(d){var v=this.getView();var i=this.oUiApi.getAnalysisPath().getCarousel().stepViews.indexOf(v);if(this.representationInstance!==undefined){if(this.representationInstance!==this.oCoreApi.getSteps()[i].getSelectedRepresentation().type){this.isSwitched=true;}}this.representationInstance=this.oCoreApi.getSteps()[i].getSelectedRepresentation().type;if(this.oCoreApi.getSteps()[i].getSelectedRepresentation().toggleInstance!==undefined){this.bToggleInstanceExists=true;}if(this.isSwitched===true||d===undefined||d===true||this.bToggleInstanceExists===true){this.isSwitched=false;v.oThumbnailChartLayout.removeAllItems();var s=this.oCoreApi.getSteps()[i];var c;if(s.getSelectedRepresentation().bIsAlternateView){if(s.getSelectedRepresentation().toggleInstance!==undefined){var a=s.getSelectedRepresentation().getData();var m=s.getSelectedRepresentation().getMetaData();s.getSelectedRepresentation().toggleInstance.setData(a,m);c=s.getSelectedRepresentation().toggleInstance.getThumbnailContent();}else{s.getSelectedRepresentation().toggleInstance=this.oUiApi.getStepContainer().getController().createAlternateRepresentation(i);c=s.getSelectedRepresentation().toggleInstance.getThumbnailContent();}}else{c=s.getSelectedRepresentation().getThumbnailContent();}var o=new sap.m.VBox({}).addStyleClass("overlayThumbnailWrapper");v.oThumbnailChartLayout.addItem(c);v.oThumbnailChartLayout.addItem(o);var C=this.oUiApi.getAnalysisPath().getCarousel().getController();var t=C.getThumbnailDataset(s);v.getModel().getData().thumbnail=t;v.getModel().updateBindings();v.oThumbnailChartLayout.rerender();v.oThumbnailChartLayout.setBusy(false);}else{v.oThumbnailChartLayout.setBusy(false);}}});sap.ui.controller("sap.apf.ui.reuse.controller.stepContainer",{onInit:function(){this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;},drawSelectionContainer:function(){this.getView().getStepToolbar().getController().showSelectionCount();},resizeContent:function(){if(this.oCoreApi.getActiveStep()){if(this.oCoreApi.getActiveStep().getSelectedRepresentation().type===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){this.drawStepContent();var s=((window.innerHeight-jQuery('.tableWithoutHeaders').offset().top)-20)+"px";jQuery('.tableWithoutHeaders').css({"height":s});}else{this.drawStepContent();}}},onAfterRendering:function(){var s=this;var t;jQuery(window).resize(function(){clearTimeout(t);t=setTimeout(function(){s.resizeContent();},500);});},getCurrentRepresentation:function(){return this.representationInstance;},drawRepresentation:function(){var s=this;var a=this.oCoreApi.getActiveStep();if(a.getSelectedRepresentation().bIsAlternateView===undefined||a.getSelectedRepresentation().bIsAlternateView===false){this.representationInstance=a.getSelectedRepresentation();}else{this.representationInstance=a.getSelectedRepresentation().toggleInstance;var d=a.getSelectedRepresentation().getData(),m=a.getSelectedRepresentation().getMetaData();this.representationInstance.setData(d,m);}var l=a.longTitle&&!this.oCoreApi.isInitialTextKey(a.longTitle.key)?a.longTitle:undefined;var t=l||a.title;var S=this.oCoreApi.getTextNotHtmlEncoded(t);var c=this.representationInstance.getMainContent(S);var b=this.getView().getStepToolbar().chartToolbar.getId();this.setHeightAndWidth=function(){var e;var f;if(jQuery("#"+b).length!==0){e=jQuery("#"+b+" > div:first-child > div:nth-child(2)").offset().top;f=jQuery("#"+b+" > div:first-child > div:nth-child(2)").width();}else{e="0";f=jQuery(window).width();}var g=s.getView().getStepToolbar().chartToolbar.getFullScreen()?(jQuery(window).height()-e):(jQuery(window).height()-e)-jQuery(".applicationFooter").height();var h=f;if(s.oCoreApi.getActiveStep().getSelectedRepresentation().bIsAlternateView||s.oCoreApi.getActiveStep().getSelectedRepresentation().type===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){c.getContent()[0].setHeight((g-5)+"px");c.getContent()[0].setWidth(h+"px");}else if(s.oCoreApi.getActiveStep().getSelectedRepresentation().type===sap.apf.ui.utils.CONSTANTS.representationTypes.GEO_MAP){var i=(jQuery(c.getContent())[0]);i.style.height=g+"px";i.style.width=h+"px";c.setContent(i.outerHTML);}else{c.setHeight(g+"px");c.setWidth(h+"px");}};c.getIcon=function(){return;};c.getLabel=function(){return;};this.fnSetHeightAndWidth={onBeforeRendering:function(){s.setHeightAndWidth();}};c.addEventDelegate(this.fnSetHeightAndWidth);this.getView().getStepToolbar().getController().drawRepresentation(c);},createAlternateRepresentation:function(I){var s=this;var a=function(b){var e=b.dimensions;var m=s.oCoreApi.getSteps()[I].getSelectedRepresentation().getMetaData();if(m===undefined){return b;}var i;for(i=0;i<e.length;i++){var S=m.getPropertyMetadata(e[i].fieldName).hasOwnProperty('text');if(S){var n={};n.fieldName=m.getPropertyMetadata(e[i].fieldName).text;b.dimensions.push(n);}}b.isAlternateRepresentation=true;return b;};var A=s.oCoreApi.getSteps()[I];var c=A.getSelectedRepresentation();var p=jQuery.extend(true,{},c.getParameter());delete p.alternateRepresentationTypeId;delete p.alternateRepresentationType;p=a(p);this.newToggleInstance=this.oCoreApi.createRepresentation(c.getParameter().alternateRepresentationType.constructor,p);var d=c.getData();var m=c.getMetaData();if(d!==undefined&&m!==undefined){this.newToggleInstance.setData(d,m);}this.newToggleInstance.adoptSelection(c);return this.newToggleInstance;},isActiveStepChanged:function(){var a;if(this.currentActiveStepIndex===undefined){this.currentActiveStepIndex=this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep());a=true;}else if(this.currentActiveStepIndex!==this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep())){this.currentActiveStepIndex=this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep());a=true;}else{a=false;}return a;},isSelectedRepresentationChanged:function(){var s;if(this.currentSelectedRepresentationId===undefined||this.currentSelectedRepresentationId===null){this.currentSelectedRepresentationId=this.oCoreApi.getActiveStep().getSelectedRepresentationInfo().representationId;s=true;}else if(this.currentSelectedRepresentationId!==this.oCoreApi.getActiveStep().getSelectedRepresentationInfo().representationId){this.currentSelectedRepresentationId=this.oCoreApi.getActiveStep().getSelectedRepresentationInfo().representationId;s=true;}else if(this.getCurrentRepresentation().type!==this.oCoreApi.getActiveStep().getSelectedRepresentation().type){this.currentSelectedRepresentationId=this.oCoreApi.getActiveStep().getSelectedRepresentationInfo().representationId;s=true;}else{s=false;}return s;},drawStepContent:function(d){var n=this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep());var t=this.oUiApi.getAnalysisPath().getCarousel().getStepView(n).oThumbnailChartLayout.isBusy();var i=this.oUiApi.getAnalysisPath().getController().isOpenPath;var a=this.oUiApi.getAnalysisPath().getController().isNewPath;if(t){this.getView().vLayout.setBusy(true);return;}var A=this.isActiveStepChanged();var s=this.isSelectedRepresentationChanged();var r=(d===undefined||d===true);if(r||A||s||i||a){this.drawRepresentation();}else{if(this.oCoreApi.getSteps().length>=1){this.drawSelectionContainer();}}if(this.getView().vLayout.isBusy()){this.getView().vLayout.removeAllContent();this.getView().vLayout.addContent(this.getView().stepLayout);this.getView().vLayout.setBusy(false);}this.getView().vLayout.setBusy(false);}});sap.ui.controller("sap.apf.ui.reuse.controller.toolbar",{resetAnalysisPath:function(){this.oUiApi.getAnalysisPath().getCarousel().getController().removeAllSteps();this.oCoreApi.resetPath();this.oUiApi.getAnalysisPath().getController().isNewPath=true;this.oStartFilterHandler.resetAll();this.oUiApi.contextChanged(true);this.oUiApi.getAnalysisPath().getController().refreshAnalysisPath();this.oUiApi.getAnalysisPath().oSavedPathName.setTitle(this.oCoreApi.getTextNotHtmlEncoded("unsaved"));this.oUiApi.getAnalysisPath().getController().bIsDirtyState=false;this.oUiApi.getAnalysisPath().getCarousel().rerender();},onInit:function(){this.view=this.getView();this.oViewData=this.getView().getViewData();this.oCoreApi=this.oViewData.oCoreApi;this.oSerializationMediator=this.oViewData.oSerializationMediator;this.oUiApi=this.oViewData.uiApi;this.oStartFilterHandler=this.oViewData.oStartFilterHandler;this.oPrintHelper=new sap.apf.ui.utils.PrintHelper(this.oViewData);this.bIsPathGalleryWithDelete=false;},openPathGalleryWithDelete:function(){var j={};var s=this;var m;var i;s.oCoreApi.readPaths(function(d,a,b){if(b===undefined&&(typeof d==="object")){var g=d.paths;for(i=0;i<g.length;i++){var n=g[i].StructuredAnalysisPath.steps.length;var u=g[i].LastChangeUTCDateTime;var c=/\d+/g;var t=parseInt(u.match(c)[0],10);var e=((new Date(t)).toString()).split(' ');var f=e[1]+"-"+e[2]+"-"+e[3];g[i].guid=g[i].AnalysisPath;g[i].StructuredAnalysisPath.noOfSteps=n;g[i].description=f+"  -   ("+s.oCoreApi.getTextNotHtmlEncoded("no-of-steps",[n])+")";g[i].summary=g[i].AnalysisPathName+"- ("+f+") - ("+s.oCoreApi.getTextNotHtmlEncoded("no-of-steps",[n])+")";}j={GalleryElements:g};if(!s.deleteAnalysisPath){s.deleteAnalysisPath=new sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.apf.ui.reuse.view.deleteAnalysisPath",viewData:{jsonData:j,oInject:s.oViewData}});}var h=s.deleteAnalysisPath.getController().stdDialog;if((!h)||(h&&!h.isOpen())){s.deleteAnalysisPath.getController().openPathGalleryWithDelete();}s.oUiApi.getLayoutView().setBusy(false);}else{m=s.oCoreApi.createMessageObject({code:"6005",aParameters:[]});m.setPrevious(b);s.oCoreApi.putMessage(m);s.oUiApi.getLayoutView().setBusy(false);}});},openPathGallery:function(){var j={};var s=this;var i,m;s.oCoreApi.readPaths(function(d,a,b){if(b===undefined&&(typeof d==="object")){var g=d.paths;for(i=0;i<g.length;i++){var n=g[i].StructuredAnalysisPath.steps.length;var u=g[i].LastChangeUTCDateTime;var c=/\d+/g;var t=parseInt(u.match(c)[0],10);var e=((new Date(t)).toString()).split(' ');var f=e[1]+"-"+e[2]+"-"+e[3];g[i].title=g[i].AnalysisPathName;g[i].guid=g[i].AnalysisPath;g[i].StructuredAnalysisPath.noOfSteps=n;g[i].description=f+"  -   ("+s.oCoreApi.getTextNotHtmlEncoded("no-of-steps",[n])+")";g[i].summary=g[i].AnalysisPathName+"- ("+f+") - ("+s.oCoreApi.getTextNotHtmlEncoded("no-of-steps",[n])+")";}j={GalleryElements:g};if(!s.pathGallery){s.pathGallery=new sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.apf.ui.reuse.view.pathGallery",viewData:{jsonData:j,oInject:s.oViewData}});}var p=s.pathGallery.getController().oHierchicalPathGalleryDialog;if((!p)||(p&&!p.isOpen())){s.pathGallery.getController().openPathGallery();}s.oUiApi.getLayoutView().setBusy(false);}else{m=s.oCoreApi.createMessageObject({code:"6005",aParameters:[]});m.setPrevious(b);s.oCoreApi.putMessage(m);s.oUiApi.getLayoutView().setBusy(false);}});},doPrint:function(){var p=this.oPrintHelper;p.doPrint();},getSaveDialog:function(s,r,p){var a=this;var h=this.oCoreApi.getTextNotHtmlEncoded("saveName");var b=this.oUiApi.getAnalysisPath().oSavedPathName.getTitle();var m=new sap.ui.model.json.JSONModel();m.setData(p);if(b){var f=b.charAt(0);if(f==="*"){b=b.split('*')[1];}}this.oInput=new sap.m.Input({type:sap.m.InputType.Text,placeholder:h,showSuggestion:true,suggestionItems:{path:"/",template:new sap.ui.core.Item({text:"{AnalysisPathName}",additionalText:"{AnalysisPath}"}),showValueHelp:true,valueHelpRequest:function(e){var c=function(e){var S=e.getParameter("selectedItem");if(S){input.setValue(S.getTitle());}e.getSource().getBinding("items").filter([]);};}}}).addStyleClass("saveStyle");this.oInput.setModel(m);if(!s){this.oInput.destroySuggestionItems();}this.oInput.attachEvent("click",function(e){jQuery(e.currentTarget).attr('value','');});this.oInput.attachLiveChange(function(d){var v=this.getValue();var c=a.saveDialog;var e=new RegExp("[*]","g");if(v===""){c.getBeginButton().setEnabled(false);}if((v.match(e)!==null)){c.getBeginButton().setEnabled(false);c.setSubHeader(new sap.m.Bar({contentMiddle:new sap.m.Text({text:this.oCoreApi.getTextNotHtmlEncoded('invalid-entry')})}));this.setValueState(sap.ui.core.ValueState.Error);return false;}else{c.getBeginButton().setEnabled(true);c.destroySubHeader();this.setValueState(sap.ui.core.ValueState.None);}if(v.trim()!==""){c.getBeginButton().setEnabled(true);c.destroySubHeader();}else{c.getBeginButton().setEnabled(false);c.setSubHeader(new sap.m.Bar({contentMiddle:new sap.m.Text({text:a.oCoreApi.getTextNotHtmlEncoded('enter-valid-path-name')})}));}});if(b!==(a.oCoreApi.getTextNotHtmlEncoded("unsaved"))){this.oInput.setValue(b);}this.analysisPathName=(a.oInput.getValue()).trim();if(!a.saveDialog){this.saveDialog=new sap.m.Dialog({type:sap.m.DialogType.Standard,title:a.oCoreApi.getTextNotHtmlEncoded("save-analysis-path"),beginButton:new sap.m.Button({text:a.oCoreApi.getTextNotHtmlEncoded("ok"),enabled:false,press:function(){a.saveDialog.getBeginButton().setEnabled(false);a.saveDialog.getEndButton().setEnabled(false);var c=(a.oInput.getValue()).trim();a.saveAnalysisPath(c,r,s);}}),endButton:new sap.m.Button({text:a.oCoreApi.getTextNotHtmlEncoded("cancel"),press:function(){a.saveDialog.close();}}),afterClose:function(){a.oUiApi.getLayoutView().setBusy(false);this.destroy();a.saveDialog=null;}});this.saveDialog.addContent(this.oInput);if(this.oInput.getValue()===b){this.saveDialog.getBeginButton().setEnabled(true);}}if(a.oCoreApi.getSteps().length>=1){if(!s&&b===(a.oCoreApi.getTextNotHtmlEncoded("unsaved"))){if(!a.saveDialog||(a.saveDialog&&!a.saveDialog.isOpen()))this.saveDialog.open();}else if(s){if(!a.saveDialog||(a.saveDialog&&!a.saveDialog.isOpen()))this.saveDialog.open();}else{a.saveAnalysisPath(b,r,s);}}},doOkOnNewAnalysisPath:function(){var s=this;this.isOpen=false;s.oCoreApi.readPaths(function(r,m,a){var S=true;var p=r.paths;if(m!==undefined){s.getView().maxNumberOfSteps=m.getEntityTypeMetadata().maximumNumberOfSteps;s.getView().maxNumberOfPaths=m.getEntityTypeMetadata().maxOccurs;}if(a===undefined&&(typeof r==="object")){s.getSaveDialog(S,function(){s.resetAnalysisPath();},p);}else{var M=s.oCoreApi.createMessageObject({code:"6005",aParameters:[]});M.setPrevious(a);s.oCoreApi.putMessage(M);}});},doOkOnOpenAnalysisPath:function(i){var s=this;this.isOpen=true;this.bIsPathGalleryWithDelete=i;s.oCoreApi.readPaths(function(r,m,a){var S=true;var p=r.paths;if(m!==undefined){s.getView().maxNumberOfSteps=m.getEntityTypeMetadata().maximumNumberOfSteps;s.getView().maxNumberOfPaths=m.getEntityTypeMetadata().maxOccurs;}if(a===undefined&&(typeof r==="object")){s.getSaveDialog(S,function(){return;},p);}else{var M=s.oCoreApi.createMessageObject({code:"6005",aParameters:[]});M.setPrevious(a);s.oCoreApi.putMessage(M);}});},getNewAnalysisPathDialog:function(){var s=this;if(s.oUiApi.getAnalysisPath().oSavedPathName.getTitle().slice(0,1)==="*"&&s.oCoreApi.getSteps().length!==0){var n=new sap.m.Dialog({type:sap.m.DialogType.Standard,title:s.oCoreApi.getTextNotHtmlEncoded("newPath"),content:new sap.m.Text({text:s.oCoreApi.getTextNotHtmlEncoded("analysis-path-not-saved")}).addStyleClass("textStyle"),beginButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("yes"),press:function(){s.doOkOnNewAnalysisPath();n.close();}}),endButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("no"),press:function(){s.resetAnalysisPath();n.close();}}),afterClose:function(){s.oUiApi.getLayoutView().setBusy(false);this.destroy();}});n.open();}else{this.resetAnalysisPath();}},getOpenDialog:function(i){var s=this;var d=new sap.m.Dialog({type:sap.m.DialogType.Standard,title:s.oCoreApi.getTextNotHtmlEncoded("newPath"),content:new sap.m.Text({text:s.oCoreApi.getTextNotHtmlEncoded("analysis-path-not-saved")}).addStyleClass("textStyle"),beginButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("yes"),press:function(){s.doOkOnOpenAnalysisPath(s.bIsPathGalleryWithDelete);d.close();}}),endButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("no"),press:function(){s.resetAnalysisPath();if(s.bIsPathGalleryWithDelete){s.openPathGalleryWithDelete();}else{s.openPathGallery();}d.close();}}),afterClose:function(){s.oUiApi.getLayoutView().setBusy(false);this.destroy();}});d.open();},getConfirmDelDialog:function(l){var s=this;var p=l.sPathName;var d=new sap.m.Dialog({type:sap.m.DialogType.Standard,title:s.oCoreApi.getTextNotHtmlEncoded("delPath"),content:new sap.m.Text({text:s.oCoreApi.getTextNotHtmlEncoded("do-you-want-to-delete-analysis-path")+" '"+p+"'?"}).addStyleClass("textStyle"),beginButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("yes"),press:function(){s.oUiApi.getAnalysisPath().getPathGalleryWithDeleteMode().getController().deleteSavedPath(p,l);d.close();}}),endButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("no"),press:function(){d.close();}}),afterClose:function(){s.oUiApi.getLayoutView().setBusy(false);this.destroy();}});d.open();},getConfirmDialog:function(p){var s=this;var o=p||{};var a={success:o.success||function(){return;},fail:o.fail||function(){return;},msg:o.msg||""};var d=new sap.m.Dialog({title:s.oCoreApi.getTextNotHtmlEncoded("caution"),type:sap.m.DialogType.Standard,content:new sap.m.Text({text:a.msg}).addStyleClass("textStyle"),beginButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("yes"),press:function(){s.overWriteAnalysisPath();d.close();}}),endButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("no"),press:function(){var S=true;var D=s.oInput.getModel().getData();s.getSaveDialog(S,function(){return;},D);d.close();}}),afterClose:function(){s.oUiApi.getLayoutView().setBusy(false);this.destroy();}});d.open();},getConfirmLogOffDialog:function(){var s=this;var d=new sap.m.Dialog({title:s.oCoreApi.getTextNotHtmlEncoded("confirmation"),type:sap.m.DialogType.Standard,content:new sap.m.Text({text:s.oCoreApi.getTextNotHtmlEncoded("do-you-want-to-logout")}).addStyleClass("textStyle"),beginButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("yes"),press:function(){s.oCoreApi.logoutHanaXse();d.close();}}),endButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("no"),press:function(){d.close();}}),afterClose:function(){s.oUiApi.getLayoutView().setBusy(false);this.destroy();}});d.open();},getErrorMessageDialog:function(m){var s=this;var d=new sap.m.Dialog({title:s.oCoreApi.getTextNotHtmlEncoded("error"),type:sap.m.DialogType.Message,content:new sap.m.Text({text:m}).addStyleClass("textStyle"),beginButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("ok"),press:function(){var f=function(){return;};if(f){setTimeout(function(){s.callbackforSave(f);},200);}d.close();}}),afterClose:function(){s.oUiApi.getLayoutView().setBusy(false);this.destroy();}});d.open();},callbackforSave:function(f){f();},onOpenPathGallery:function(){this.bIsPathGalleryWithDelete=false;var p=this.oUiApi.getAnalysisPath().oSavedPathName.getTitle();var f=p.charAt(0);if(f==="*"&&this.oCoreApi.getSteps().length!==0){this.getOpenDialog(this.bIsPathGalleryWithDelete);}else{this.openPathGallery();}this.isOpen=false;},onOpenPathGalleryWithDelete:function(){this.bIsPathGalleryWithDelete=true;var p=this.oUiApi.getAnalysisPath().oSavedPathName.getTitle();var f=p.charAt(0);if(f==="*"&&this.oCoreApi.getSteps().length!==0){this.getOpenDialog(this.bIsPathGalleryWithDelete);}else{this.openPathGalleryWithDelete();}this.isOpen=false;},saveAnalysisPath:function(a,f,s){var b=this;this.saveCallback=f;this.analysisPathName=a;this.aData=b.oInput.getModel().getData();var c=false;this.guid="";var d=b.oCoreApi.getSteps();if(this.aData.length>this.getView().maxNumberOfPaths){this.getErrorMessageDialog(b.oCoreApi.getTextNotHtmlEncoded("no-of-paths-exceeded"));if(b.saveDialog&&b.saveDialog.isOpen()){b.saveDialog.close();}return false;}else if(d.length>this.getView().maxNumberOfSteps){this.getErrorMessageDialog(b.oCoreApi.getTextNotHtmlEncoded("no-of-steps-exceeded"));if(b.saveDialog&&b.saveDialog.isOpen()){b.saveDialog.close();}return false;}var i;for(i=0;i<this.aData.length;i++){var e=this.aData[i].AnalysisPathName;if(this.analysisPathName===e){c=true;this.guid=this.aData[i].AnalysisPath;break;}}if(!c){b.oSerializationMediator.savePath(b.analysisPathName,function(r,m,g){if(g===undefined&&(typeof r==="object")){b.oUiApi.getAnalysisPath().oSavedPathName.setTitle(b.analysisPathName);b.oUiApi.getAnalysisPath().getController().bIsDirtyState=false;if(b.saveDialog&&b.saveDialog.isOpen()){b.saveDialog.close();}var h=b.oCoreApi.getTextNotHtmlEncoded("path-saved-successfully",["'"+b.analysisPathName+"'"]);b.getSuccessToast(b.analysisPathName,h);if(typeof b.saveCallback==="function"){b.saveCallback();}}else{var M=b.oCoreApi.createMessageObject({code:"6006",aParameters:[b.analysisPathName]});M.setPrevious(g);b.oCoreApi.putMessage(M);}});}else{if(b.saveDialog&&b.saveDialog.isOpen()){b.saveDialog.close();}var p;if(b.oUiApi.getAnalysisPath().oSavedPathName.getTitle().charAt(0)==="*"&&this.oCoreApi.getSteps().length!==0){p=b.oUiApi.getAnalysisPath().oSavedPathName.getTitle().slice(1,b.oUiApi.getAnalysisPath().oSavedPathName.getTitle().length);}else{p=b.oUiApi.getAnalysisPath().oSavedPathName.getTitle();}if(!s&&p===b.analysisPathName){b.overWriteAnalysisPath();}else{this.getConfirmDialog({msg:b.oCoreApi.getTextNotHtmlEncoded("path-exists",["'"+b.analysisPathName+"'"])});}c=false;}},getSuccessToast:function(p,m){var s=this;var a=m;sap.m.MessageToast.show(a,{width:"20em"});if(s.isOpen&&s.bIsPathGalleryWithDelete){s.openPathGalleryWithDelete();}else if(s.isOpen){s.openPathGallery();}},overWriteAnalysisPath:function(){var s=this;var p=this.analysisPathName;var g=this.guid;s.oSerializationMediator.savePath(g,p,function(r,m,a){if(a===undefined&&(typeof r==="object")){s.oUiApi.getAnalysisPath().oSavedPathName.setTitle(p);var b=s.oCoreApi.getTextNotHtmlEncoded("path-updated-successfully",["'"+p+"'"]);s.oUiApi.getAnalysisPath().getController().bIsDirtyState=false;if(s.saveDialog&&s.saveDialog.isOpen()){s.saveDialog.close();}s.getSuccessToast(p,b);if(typeof s.saveCallback==="function"){s.saveCallback();}}else{var M=s.oCoreApi.createMessageObject({code:"6007",aParameters:[p]});M.setPrevious(a);s.oCoreApi.putMessage(M);}});},getDialogForNoPathAdded:function(){var s=this;var m=s.oCoreApi.getTextNotHtmlEncoded("noStepInPath");var d=new sap.m.Dialog({title:s.oCoreApi.getTextNotHtmlEncoded("alert"),type:sap.m.DialogType.Message,contentWidth:jQuery(window).height()*0.2+"px",contentHeight:jQuery(window).height()*0.2+"px",content:new sap.m.Text({text:m}).addStyleClass("textStyle"),beginButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("ok"),press:function(){d.close();}}),afterClose:function(){s.oUiApi.getLayoutView().setBusy(false);this.destroy();}});d.open();}});sap.ui.jsfragment("sap.apf.ui.reuse.fragment.pathGallery",{createContent:function(c){var s=this;this.contentWidth=jQuery(window).height()*0.6+"px";this.contentHeight=jQuery(window).height()*0.6+"px";this.oCoreApi=c.oCoreApi;this.oUiApi=c.oUiApi;var p=new sap.m.List().bindItems({path:'/GalleryElements',template:new sap.m.StandardListItem({title:'{title}',tooltip:'{title}',description:'{description}',type:"Navigation",press:function(e){var B=e.getSource().getBindingContext();d.setBindingContext(B);d.setTitle(e.getSource().getTitle());s.oPathGalleryNavContainer.to(s.oPathGalleryNavContainer.getPages()[1]);}})});var a=new sap.m.List().bindItems({path:'StructuredAnalysisPath/steps',template:new sap.m.StandardListItem({title:'{title}',tooltip:'{title}',type:"Active",icon:'{imgSrc}',press:function(e){s.oUiApi.getLayoutView().setBusy(true);var f=e.getSource().getBindingContext().sPath.split('/');var g=this.getModel().getData().GalleryElements[f[2]].AnalysisPathName;var h=this.getModel().getData().GalleryElements[f[2]].AnalysisPath;var i=f[5];c.openPath(g,h,i);s.oUiApi.getLayoutView().setBusy(false);}})});var o=function(e){var l=[];var S=e.getSource().getValue();var L=s.pathGalleryHierarchicalDialog.getContent()[0].getCurrentPage().getContent()[0];if(S&&S.length>0){var f=new sap.ui.model.Filter("title",sap.ui.model.FilterOperator.Contains,S);l.push(f);}var g=L.getBinding("items");g.filter(l);};var b=new sap.m.Page({title:s.oCoreApi.getTextNotHtmlEncoded("select-analysis-path"),subHeader:new sap.m.Bar({contentLeft:[new sap.m.SearchField({enableFilterMode:true,liveChange:o})]}),content:p});var d=new sap.m.Page({subHeader:new sap.m.Bar({contentLeft:[new sap.m.SearchField({enableFilterMode:true,liveChange:o})]}),content:a,showNavButton:true,navButtonPress:function(){s.oPathGalleryNavContainer.back();}});this.oPathGalleryNavContainer=new sap.m.NavContainer({pages:[b,d]});this.oPathGalleryNavContainer.setModel(c.getView().getModel());this.pathGalleryHierarchicalDialog=new sap.m.Dialog({contentWidth:s.contentWidth,contentHeight:s.contentHeight,showHeader:false,content:[this.oPathGalleryNavContainer],endButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("cancel"),press:function(){s.pathGalleryHierarchicalDialog.close();}}),afterClose:function(){this.destroy();}});return this.pathGalleryHierarchicalDialog;}});
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
sap.ui.jsfragment("sap.apf.ui.reuse.fragment.selectionDisplay",{createContent:function(c){this.oController=c;this.contentWidth=jQuery(window).height()*0.6+"px";this.contentHeight=jQuery(window).height()*0.6+"px";var s=this;this.oCoreApi=c.oCoreApi;this.oUiApi=c.oUiApi;var a=new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("close"),press:function(){s.selectionDisplayDialog.close();s.selectionDisplayDialog.destroy();}});var A=this.oCoreApi.getActiveStep();var b=A.getSelectedRepresentation();var d=typeof b.getSelections==="function"?b.getSelections():undefined;var e=b.getMetaData().getPropertyMetadata(b.getParameter().requiredFilters[0]).label;var m=new sap.ui.model.json.JSONModel();if(d!==undefined){var D={selectionData:d};var f=new sap.m.List({items:{path:"/selectionData",template:new sap.m.StandardListItem({title:"{text}"})}});m.setData(D);f.setModel(m);this.selectionDisplayDialog=new sap.m.Dialog({title:this.oCoreApi.getTextNotHtmlEncoded("selected-required-filter",[e])+" ("+d.length+")",contentWidth:s.contentWidth,contentHeight:s.contentHeight,buttons:[a],content:[f]});return this.selectionDisplayDialog;}}});
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.jsfragment("sap.apf.ui.reuse.fragment.stepGallery",{createContent:function(c){var s=this;this.contentWidth=jQuery(window).height()*0.6+"px";this.contentHeight=jQuery(window).height()*0.6+"px";this.oCoreApi=c.oCoreApi;this.oUiApi=c.oUiApi;var a=new sap.m.List().bindItems({path:'/GalleryElements',template:new sap.m.StandardListItem({title:'{title}',tooltip:'{title}',type:"Navigation",press:function(E){var B=E.getSource().getBindingContext();g.setBindingContext(B);g.setTitle(E.getSource().getTitle());s.oStepGalleryNavContainer.to(s.oStepGalleryNavContainer.getPages()[1]);}})});var b=new sap.m.List().bindItems({path:'stepTemplates',template:new sap.m.StandardListItem({title:'{title}',tooltip:'{title}',type:"Navigation",press:function(E){var B=E.getSource().getBindingContext();h.setBindingContext(B);h.setTitle(E.getSource().getTitle());s.oStepGalleryNavContainer.to(s.oStepGalleryNavContainer.getPages()[2]);}})});var o=function(E){s.oUiApi.getLayoutView().setBusy(true);var i=E.getSource().getBindingContext().sPath.split('/');var j=i[2];var k=i[4];var r=i[6];var l=c.getStepDetails(j,k);c.onStepPress(l.id,l.representationtypes[r].representationId);};var d=new sap.m.List().bindItems({path:'representationtypes',template:new sap.m.StandardListItem({title:'{title}',icon:'{picture}',tooltip:'{title}',type:"Active",press:o}).bindProperty("description","sortDescription",function(v){if(v===undefined||v===null){return null;}return s.oCoreApi.getTextNotHtmlEncoded("sortBy")+": "+v;})});var e=function(E){var l=[];var S=E.getSource().getValue();var L=s.oStepGalleryHierarchicalDialog.getContent()[0].getCurrentPage().getContent()[0];if(S&&S.length>0){var F=new sap.ui.model.Filter("title",sap.ui.model.FilterOperator.Contains,S);l.push(F);}var i=L.getBinding("items");i.filter(l);};var f=new sap.m.Page({title:s.oCoreApi.getTextNotHtmlEncoded("category"),subHeader:new sap.m.Bar({contentLeft:[new sap.m.SearchField({enableFilterMode:true,liveChange:e})]}),content:a});var g=new sap.m.Page({subHeader:new sap.m.Bar({contentLeft:[new sap.m.SearchField({enableFilterMode:true,liveChange:e})]}),content:b,showNavButton:true,navButtonPress:function(){s.oStepGalleryNavContainer.back();}});var h=new sap.m.Page({subHeader:new sap.m.Bar({contentLeft:[new sap.m.SearchField({enableFilterMode:true,liveChange:e})]}),content:d,showNavButton:true,navButtonPress:function(){s.oStepGalleryNavContainer.back();}});this.oStepGalleryNavContainer=new sap.m.NavContainer({pages:[f,g,h]});this.oStepGalleryNavContainer.setModel(c.getView().getModel());this.oStepGalleryHierarchicalDialog=new sap.m.Dialog({contentWidth:s.contentWidth,contentHeight:s.contentHeight,showHeader:false,content:[this.oStepGalleryNavContainer],endButton:new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("cancel"),press:function(){s.oStepGalleryHierarchicalDialog.close();s.oStepGalleryHierarchicalDialog.destroy();}})});return this.oStepGalleryHierarchicalDialog;}});sap.ui.jsview("sap.apf.ui.reuse.view.analysisPath",{getCarousel:function(){return this.oCarousel;},getToolbar:function(){return this.oActionListItem;},getPathGallery:function(){return this.pathGallery;},getPathGalleryWithDeleteMode:function(){return this.deleteAnalysisPath;},getControllerName:function(){return"sap.apf.ui.reuse.controller.analysisPath";},createContent:function(c){var s=this;this.oController=c;this.oActionListPopover=new sap.m.Popover({showHeader:false,placement:sap.m.PlacementType.Bottom,contentWidth:"150px"});var v=this.getViewData();s.oCoreApi=v.oCoreApi;s.oUiApi=v.uiApi;this.oActionListItem=sap.ui.view({viewName:"sap.apf.ui.reuse.view.toolbar",type:sap.ui.core.mvc.ViewType.JS,viewData:v}).addStyleClass("toolbarView");this.oActionListPopover.addContent(this.oActionListItem);this.oSavedPathName=new sap.m.ObjectHeader({title:this.oCoreApi.getTextNotHtmlEncoded("unsaved"),showTitleSelector:true,condensed:true,titleSelectorPress:function(e){s.oActionListPopover.openBy(e.getParameter("domRef"));}}).addStyleClass("sapApfObjectHeader");this.oCarousel=new sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.apf.ui.reuse.view.carousel",viewData:{analysisPath:s,oInject:v}});this.pathGallery=new sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.apf.ui.reuse.view.pathGallery",viewData:{oInject:v}});this.deleteAnalysisPath=new sap.ui.view({type:sap.ui.core.mvc.ViewType.JS,viewName:"sap.apf.ui.reuse.view.deleteAnalysisPath",viewData:{oInject:v}});this.oAnalysisPath=new sap.ui.layout.VerticalLayout({content:[s.oContentTitle,s.oSavedPathName,s.oCarousel],width:'100%'});return this.oAnalysisPath;}});sap.ui.jsview("sap.apf.ui.reuse.view.carousel",{getStepGallery:function(){var s=this.oController.stepGalleryView;return s;},getChartToolbar:function(){return this.oController.oStepToolbar;},carouselContent:function(c){jQuery.sap.require('sap.apf.ui.controls.draggableCarousel.DraggableCarousel');var s=this;this.oController=c;this.stepViews=[];var v=this.getViewData().oInject;s.oCoreApi=v.oCoreApi;s.oUiApi=v.uiApi;var a=new sap.ui.core.Icon({src:"sap-icon://arrow-bottom"}).addStyleClass('downArrow');var b=document.createElement('div');b.innerHTML=sap.ui.getCore().getRenderManager().getHTML(a);var r=new sap.ui.core.Icon({src:"sap-icon://sys-cancel-2",size:"20px"}).addStyleClass('removeIcon');var d=document.createElement('div');d.innerHTML=sap.ui.getCore().getRenderManager().getHTML(r);var h=jQuery(window).height()-sap.apf.ui.utils.CONSTANTS.carousel.SCROLLCONTAINER+"px";var w="320px";window.onresize=function(){var h=jQuery(window).height()-sap.apf.ui.utils.CONSTANTS.carousel.SCROLLCONTAINER+"px";jQuery('.DnD-container').css({"height":jQuery(window).height()-sap.apf.ui.utils.CONSTANTS.carousel.DNDBOX+"px"});jQuery(".scrollContainerEle").css("height",h);};this.dndBox=new sap.apf.ui.controls.draggableCarousel.DraggableCarousel({containerHeight:jQuery(window).height()-sap.apf.ui.utils.CONSTANTS.carousel.DNDBOX+"px",containerWidth:w,blockHeight:sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.STEP_HEIGHT,blockWidth:sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.STEP_WIDTH,blockMargin:sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.STEP_MARGIN,separatorHeight:sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.SEPARATOR_HEIGHT,removeIconHeight:sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.REMOVE_ICON_HEIGHT,separator:b,removeIcon:d,onBeforeDrag:function(f){},onAfterDrop:c.moveStep.bind(c),onAfterRemove:c.removeStep.bind(c),onAfterSelect:function(i){if(jQuery(this).attr("drag-state")==="true"){s.getStepView(i).oController.setActiveStep(i);}else{c.showStepGallery();}}});var u=this.createId("dnd-Holder");this.oHtml=new sap.ui.core.HTML({content:"<div id = '"+jQuery.sap.encodeHTML(u)+"'></div>",sanitizeContent:true,afterRendering:function(){s.dndBox.placeAt(u);jQuery(s.dndBox.eleRefs.blocks[0]).height("80px");}});var e;this.addButton=new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("add-step"),width:"100%",icon:"sap-icon://add",press:function(f){c.showStepGallery();}});e=document.createElement('div');e.setAttribute('class','addStepBtnHolder');jQuery(e).html(jQuery(sap.ui.getCore().getRenderManager().getHTML(this.addButton)).attr("tabindex",-1));this.dndBox.addBlock({blockElement:e,dragState:false,dropState:false,removable:false});this.up=new sap.m.Button({icon:"sap-icon://arrow-top",press:function(){var f=s.oCoreApi.getSteps().indexOf(s.oCoreApi.getActiveStep());if(f!==0){var n=f-1;var g=s.oUiApi.getAnalysisPath().getCarousel().dndBox.swapBlocks(f,n);if(g){s.oUiApi.getAnalysisPath().getCarousel().getController().moveStep(f,n);}}}});this.down=new sap.m.Button({icon:"sap-icon://arrow-bottom",press:function(){var f=s.oCoreApi.getSteps().indexOf(s.oCoreApi.getActiveStep());if(f!==(s.oCoreApi.getSteps().length-1)){var n=f+1;var g=s.oUiApi.getAnalysisPath().getCarousel().dndBox.swapBlocks(f,n);if(g){s.oUiApi.getAnalysisPath().getCarousel().getController().moveStep(f,n);}}}});this.oCarousel=new sap.m.ScrollContainer({content:this.oHtml,height:h,horizontal:false,vertical:true}).addStyleClass("scrollContainerEle");return this.oCarousel;},getControllerName:function(){return"sap.apf.ui.reuse.controller.carousel";},createContent:function(c){var a=this.carouselContent(c);return a;},getStepView:function(s){return this.stepViews[s];}});sap.ui.jsview("sap.apf.ui.reuse.view.deleteAnalysisPath",{getControllerName:function(){return"sap.apf.ui.reuse.controller.deleteAnalysisPath";},createContent:function(c){this.oController=c;this.viewData=this.getViewData();var s=this;this.oCoreApi=this.getViewData().oInject.oCoreApi;this.oUiApi=this.getViewData().oInject.uiApi;this.width=jQuery(window).height()*0.55+"px";this.height=jQuery(window).height()*0.55+"px";var l=new sap.m.List({width:s.width,height:s.height,mode:sap.m.ListMode.Delete,items:{path:"/GalleryElements",template:new sap.m.StandardListItem({title:"{AnalysisPathName}",description:"{description}",tooltip:"{AnalysisPathName}"})},"delete":function(e){var i=e.getParameter("listItem");var P=i.getProperty('title');var g=s.oController.getGuidForPath(P,s.viewData.jsonData.GalleryElements);var L={};L.item=i;L.list=l;L.guid=g;L.sPathName=P;s.oUiApi.getAnalysisPath().getToolbar().getController().getConfirmDelDialog(L);}});var p=new sap.ui.model.json.JSONModel();p.setData(this.viewData.jsonData);l.setModel(p);return l;}});(function(){'use strict';sap.ui.jsview("sap.apf.ui.reuse.view.facetFilter",{getControllerName:function(){return"sap.apf.ui.reuse.controller.facetFilter";},createContent:function(c){var f;var C=this.getViewData().oCoreApi;var a=this.getViewData().aConfiguredFilters;var F=[];a.forEach(function(b){f=new sap.m.FacetFilterList({title:C.getTextNotHtmlEncoded(b.getLabel()),multiSelect:b.isMultiSelection(),key:b.getPropertyName(),growing:b.isMultiSelection()?false:true,listClose:c.onListClose.bind(c)});F.push(f);});F.forEach(function(b){b.bindItems("/",new sap.m.FacetFilterItem({key:'{key}',text:'{text}',selected:'{selected}'}));var m=new sap.ui.model.json.JSONModel([]);b.setModel(m);});var o=new sap.m.FacetFilter(c.createId("idAPFFacetFilter"),{type:"Simple",showReset:true,showPopoverOKButton:true,lists:F,reset:c.onResetPress.bind(c)});return o;}});}());sap.ui.jsview("sap.apf.ui.reuse.view.messageHandler",{initializeHandler:function(m){this.getController().showMessage(m);},getControllerName:function(){return"sap.apf.ui.reuse.controller.messageHandler";},createContent:function(c){jQuery.sap.require("sap.m.MessageToast");jQuery.sap.require("sap.ca.ui.message.message");}});
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
sap.ui.jsview("sap.apf.ui.reuse.view.navigationTarget",{getControllerName:function(){return"sap.apf.ui.reuse.controller.navigationTarget";},createContent:function(c){var v=this.getViewData();this.oNavListPopover=v.oNavListPopover;this.oOpenInButtonEventSource=v.oOpenInButtonEventSource;this.oNavigationHandler=v.oNavigationHandler;this.oUiApi=v.oUiApi;this.oController=c;this.oUiApi.getLayoutView().byId("applicationPage").setBusy(true);var n=this.oNavigationHandler.getNavigationTargets();n.then(this._prepareActionListModel.bind(this),function(){this.oUiApi.getLayoutView().byId("applicationPage").setBusy(false);});},_prepareActionListModel:function(n){var a=[];var b=[];n.global.forEach(function(t){a.push(t);});n.stepSpecific.forEach(function(t){b.push(t);});this.oNavListPopover.removeAllContent();var g,s;var c=this;if(b.length!==0){var m=new sap.ui.model.json.JSONModel();var d={navTargets:b};s=new sap.m.List({items:{path:"/navTargets",template:new sap.m.StandardListItem({title:"{text}",type:sap.m.ListType.Navigation,press:function(E){var f=E.getSource().getBindingContext().getObject().id;c.oController.handleNavigation(f);}})}});m.setData(d);s.setModel(m);var e=new sap.ui.core.HTML({content:'<hr class="lineSeparator">',sanitizeContent:true});this.oNavListPopover.addContent(s);this.oNavListPopover.addContent(e);}if(a.length!==0){var M=new sap.ui.model.json.JSONModel();var D={navTargets:a};g=new sap.m.List({items:{path:"/navTargets",template:new sap.m.StandardListItem({title:"{text}",type:sap.m.ListType.Navigation,press:function(E){var f=E.getSource().getBindingContext().getObject().id;c.oController.handleNavigation(f);}})}});M.setData(D);g.setModel(M);this.oNavListPopover.addContent(g);}this.oUiApi.getLayoutView().byId("applicationPage").setBusy(false);this.oNavListPopover.openBy(this.oOpenInButtonEventSource);}});
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.jsview("sap.apf.ui.reuse.view.pathGallery",{getControllerName:function(){return"sap.apf.ui.reuse.controller.pathGallery";},createContent:function(c){this.viewData=this.getViewData();}});sap.ui.jsview("sap.apf.ui.reuse.view.step",{getControllerName:function(){return"sap.apf.ui.reuse.controller.step";},stepContent:function(){this.oCoreApi=this.getViewData().oCoreApi;this.oUiApi=this.getViewData().uiApi;this.oTopLayout=new sap.m.FlexBox({items:[new sap.m.Text({text:'{/thumbnail/leftUpper}',tooltip:'{/thumbnail/leftUpper}',wrapping:true,maxLines:2,textAlign:sap.ui.core.TextAlign.Left}).addStyleClass("thumbanilText"),new sap.m.Text({text:'{/thumbnail/rightUpper}',tooltip:'{/thumbnail/rightUpper}',wrapping:true,maxLines:2,textAlign:sap.ui.core.TextAlign.Right}).addStyleClass("thumbanilText")],alignItems:sap.m.FlexAlignItems.Start,justifyContent:sap.m.FlexJustifyContent.SpaceBetween}).addStyleClass("topLayout");this.oThumbnailChartLayout=new sap.m.VBox({height:"80px"}).addStyleClass('ChartArea');this.oThumbnailChartLayout.setBusy(true);this.oBottomLayout=new sap.m.FlexBox({items:[new sap.m.Text({text:'{/thumbnail/leftLower}',tooltip:'{/thumbnail/leftLower}',wrapping:true,maxLines:2,textAlign:sap.ui.core.TextAlign.Left}).addStyleClass("thumbanilText"),new sap.m.Text({text:'{/thumbnail/rightLower}',tooltip:'{/thumbnail/rightLower}',wrapping:true,maxLines:2,textAlign:sap.ui.core.TextAlign.Right}).addStyleClass("thumbanilText")],alignItems:sap.m.FlexAlignItems.Start,justifyContent:sap.m.FlexJustifyContent.SpaceBetween}).addStyleClass("bottomLayout");this.oThumbnailVLayout=new sap.m.VBox({items:[this.oTopLayout,this.oThumbnailChartLayout,this.oBottomLayout],height:"130px"}).addStyleClass('stepThumbnail');this.oStepTitle=new sap.m.Text({text:'{/title}',textAlign:sap.ui.core.TextAlign.Center,wrapping:true,width:"200px"});this.oVChartLayout=new sap.m.VBox({items:[this.oThumbnailVLayout,this.oStepTitle],width:"200px"}).addStyleClass("sapApfStepLayout");var h=new sap.m.VBox({items:[]}).addStyleClass("block-overlay-container");var s=this;h.addEventDelegate({onAfterRendering:function(){var a=new sap.m.Button({text:s.oCoreApi.getTextNotHtmlEncoded("showAnalyticalPath"),press:function(){s.oUiApi.getLayoutView().byId("detailFooter").removeAllContentLeft();s.oUiApi.getLayoutView().byId("applicationView").backToTopMaster();},lite:true,type:"Transparent"});jQuery(h.getDomRef()).on("mouseenter",function(){jQuery(this).addClass("sapThemeBarBG");jQuery(this).css({"opacity":"0.3"});});jQuery(h.getDomRef()).on("touchstart",function(e){var t=e.timeStamp,b=$(this).data('lastTouch')||t,d=t-b,f=e.originalEvent.touches.length;$(this).data('lastTouch',t);if(!d||d>500||f>1){return;}e.preventDefault();$(this).trigger('click').trigger('click');jQuery(this).addClass("sapThemeBarBG");jQuery(this).css({"opacity":"0"});});jQuery(h.getDomRef()).on("mouseleave",function(){jQuery(this).removeClass("sapThemeBarBG");jQuery(this).css({"opacity":"1"});});jQuery(h.getDomRef()).on("touchend touchmove",function(){jQuery(this).removeClass("sapThemeBarBG");jQuery(this).css({"opacity":"0"});});if(sap.ui.Device.system.phone){jQuery(h.getDomRef()).on("tap",function(){s.oUiApi.getLayoutView().getController().hideMaster();s.oUiApi.getLayoutView().byId("detailFooter").removeContentLeft(a);s.oUiApi.getLayoutView().getController().addDetailFooterContentLeft(a);s.oUiApi.getStepContainer().getController().drawStepContent();});}}});this.oVChartTiltleLayout=new sap.m.VBox({items:[h,this.oVChartLayout],width:"200px"}).addStyleClass("sapUiTableCCnt");return this.oVChartTiltleLayout;},createContent:function(c){var s=this.stepContent();return s;},toggleActiveStep:function(){var a=this.oUiApi.getAnalysisPath().getCarousel().stepViews;for(var i in a){if(a[i].oThumbnailVLayout.hasStyleClass('sapThemeBaseBG-asBackgroundColor')){a[i].oThumbnailVLayout.removeStyleClass('sapThemeBaseBG-asBackgroundColor');a[i].oStepTitle.removeStyleClass('activeStepTitle');a[i].oThumbnailVLayout.removeStyleClass('activeStepThumbnail');break;}}this.oThumbnailVLayout.addStyleClass('sapThemeBaseBG-asBackgroundColor');this.oStepTitle.addStyleClass('activeStepTitle');this.oThumbnailVLayout.addStyleClass('activeStepThumbnail');}});sap.ui.jsview("sap.apf.ui.reuse.view.stepContainer",{getStepToolbar:function(){return this.oStepToolbar;},getControllerName:function(){return"sap.apf.ui.reuse.controller.stepContainer";},createContent:function(c){var v=this.getViewData();this.oStepToolbar=sap.ui.view({viewName:"sap.apf.ui.reuse.view.stepToolbar",type:sap.ui.core.mvc.ViewType.JS,viewData:v});this.stepLayout=new sap.ui.layout.VerticalLayout({content:[this.oStepToolbar],width:"100%"});this.vLayout=new sap.ui.layout.VerticalLayout({content:this.stepLayout,width:"100%"});this.vLayout.setBusy(true);return this.vLayout;}});sap.ui.jsview("sap.apf.ui.reuse.view.stepGallery",{getControllerName:function(){return"sap.apf.ui.reuse.controller.stepGallery";},createContent:function(c){this.oController=c;}});sap.ui.jsview("sap.apf.ui.reuse.view.stepToolbar",{getControllerName:function(){return"sap.apf.ui.reuse.controller.stepToolbar";},createContent:function(c){this.chartToolbar=new sap.ca.ui.charts.ChartToolBar({showLegend:true,showFullScreen:true});return this.chartToolbar;}});sap.ui.jsview("sap.apf.ui.reuse.view.toolbar",{getControllerName:function(){return"sap.apf.ui.reuse.controller.toolbar";},createContent:function(c){this.maxNumberOfSteps=32;this.maxNumberOfPaths=255;var s=this;var v=this.getViewData();s.oCoreApi=v.oCoreApi;s.oUiApi=v.uiApi;var t=new sap.m.StandardListItem({icon:'sap-icon://add-product',type:sap.m.ListType.Active,title:s.oCoreApi.getTextNotHtmlEncoded("new"),press:function(){s.getParent().close();s.oUiApi.getLayoutView().setBusy(true);c.getNewAnalysisPathDialog();s.oUiApi.getLayoutView().setBusy(false);}});var T=new sap.m.StandardListItem({icon:"sap-icon://open-folder",type:sap.m.ListType.Active,title:s.oCoreApi.getTextNotHtmlEncoded("open"),press:function(){s.oUiApi.getLayoutView().setBusy(true);s.getParent().close();c.onOpenPathGallery();}});var o=new sap.m.StandardListItem({icon:"sap-icon://save",type:sap.m.ListType.Active,title:s.oCoreApi.getTextNotHtmlEncoded("save"),press:function(){s.getParent().close();if(s.oCoreApi.getSteps().length!==0){s.oUiApi.getLayoutView().setBusy(true);s.oCoreApi.readPaths(function(r,m,e){var S=false;var p=r.paths;if(m!==undefined){s.maxNumberOfSteps=m.getEntityTypeMetadata().maximumNumberOfSteps;s.maxNumberOfPaths=m.getEntityTypeMetadata().maxOccurs;}if(e===undefined&&(typeof r==="object")){c.getSaveDialog(S,function(){},p);}else{var M=s.oCoreApi.createMessageObject({code:"6005",aParameters:[]});M.setPrevious(e);s.oCoreApi.putMessage(M);}s.oUiApi.getLayoutView().setBusy(false);});}else{c.getDialogForNoPathAdded();}}});var a=new sap.m.StandardListItem({icon:"sap-icon://save",type:sap.m.ListType.Active,title:s.oCoreApi.getTextNotHtmlEncoded("saveAs"),press:function(){s.getParent().close();if(s.oCoreApi.getSteps().length!==0){s.oUiApi.getLayoutView().setBusy(true);s.oCoreApi.readPaths(function(r,m,e){var S=true;var p=r.paths;if(m!==undefined){s.maxNumberOfSteps=m.getEntityTypeMetadata().maximumNumberOfSteps;s.maxNumberOfPaths=m.getEntityTypeMetadata().maxOccurs;}if(e===undefined&&(typeof r==="object")){c.getSaveDialog(S,function(){},p);}else{var M=s.oCoreApi.createMessageObject({code:"6005",aParameters:[]});M.setPrevious(e);s.oCoreApi.putMessage(M);}s.oUiApi.getLayoutView().setBusy(false);});}else{c.getDialogForNoPathAdded();}}});var b=new sap.m.StandardListItem({icon:"sap-icon://delete",type:sap.m.ListType.Active,title:s.oCoreApi.getTextNotHtmlEncoded("delete"),press:function(){s.getParent().close();s.oUiApi.getLayoutView().setBusy(true);c.onOpenPathGalleryWithDelete();}});var d=new sap.m.StandardListItem({icon:"sap-icon://print",type:sap.m.ListType.Active,title:s.oCoreApi.getTextNotHtmlEncoded("print"),press:function(){s.getParent().close();c.doPrint();}});this.oActionListItem=new sap.m.List({items:[t,T,o,a,b,d]});return this.oActionListItem;}});jQuery.sap.declare('sap.apf.library-all');jQuery.sap.declare('sap.apf.modeler.ui.controller.configurationListNew.controller');jQuery.sap.declare('sap.apf.modeler.ui.controller.titleBreadCrumb.controller');jQuery.sap.declare('sap.apf.modeler.ui.controller.toolbar.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.analysisPath.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.carousel.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.deleteAnalysisPath.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.layout.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.messageHandler.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.navigationTarget.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.pathGallery.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.step.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.stepContainer.controller');jQuery.sap.declare('sap.apf.ui.reuse.controller.toolbar.controller');jQuery.sap.declare('sap.apf.ui.reuse.fragment.pathGallery.fragment');jQuery.sap.declare('sap.apf.ui.reuse.fragment.selectionDisplay.fragment');jQuery.sap.declare('sap.apf.ui.reuse.fragment.stepGallery.fragment');jQuery.sap.declare('sap.apf.ui.reuse.view.analysisPath.view');jQuery.sap.declare('sap.apf.ui.reuse.view.carousel.view');jQuery.sap.declare('sap.apf.ui.reuse.view.deleteAnalysisPath.view');jQuery.sap.declare('sap.apf.ui.reuse.view.facetFilter.view');jQuery.sap.declare('sap.apf.ui.reuse.view.messageHandler.view');jQuery.sap.declare('sap.apf.ui.reuse.view.navigationTarget.view');jQuery.sap.declare('sap.apf.ui.reuse.view.pathGallery.view');jQuery.sap.declare('sap.apf.ui.reuse.view.step.view');jQuery.sap.declare('sap.apf.ui.reuse.view.stepContainer.view');jQuery.sap.declare('sap.apf.ui.reuse.view.stepGallery.view');jQuery.sap.declare('sap.apf.ui.reuse.view.stepToolbar.view');jQuery.sap.declare('sap.apf.ui.reuse.view.toolbar.view');if(!jQuery.sap.isDeclared('sap.apf.core.constants')){jQuery.sap.declare('sap.apf.core.constants');jQuery.sap.require('sap.ui.model.FilterOperator');(function(){'use strict';sap.apf.core.constants=sap.apf.core.constants||{};sap.apf.core.constants.filterMethodTypes={selectionAsArray:'saa',filter:'f'};sap.apf.core.constants.FilterOperators=sap.ui.model.FilterOperator;sap.apf.core.constants.BooleFilterOperators={AND:"and",OR:"or",NOT:"not"};sap.apf.core.constants.aSelectOpt=[sap.apf.core.constants.FilterOperators.EQ,sap.apf.core.constants.FilterOperators.NE,sap.apf.core.constants.FilterOperators.GT,sap.apf.core.constants.FilterOperators.LT,sap.apf.core.constants.FilterOperators.GE,sap.apf.core.constants.FilterOperators.LE,sap.apf.core.constants.FilterOperators.BT,sap.apf.core.constants.FilterOperators.StartsWith,sap.apf.core.constants.FilterOperators.Contains,sap.apf.core.constants.FilterOperators.EndsWith];sap.apf.core.constants.resourceLocation={applicationMessageDefinitionLocation:"applicationMessageDefinitionLocation",applicationMessageTextBundle:"applicationMessageTextBundle",apfUiTextBundle:"apfUiTextBundle",applicationUiTextBundle:"applicationUiTextBundle",analyticalConfigurationLocation:"analyticalConfigurationLocation"};sap.apf.core.constants.message={};sap.apf.core.constants.message.severity={fatal:"fatal",warning:"warning",error:"error",technError:"technError"};sap.apf.core.constants.message.code={suppressFurtherException:"APFapf1972",errorCheck:"5100",errorCheckWarning:"5101",errorCheckConfiguration:"5102",errorCheckConfigurationWarning:"5103",errorExitTriggered:"5300",errorUnknown:"9000",errorLoadConfig:"9001",errorStopProcessing:"9002",errorStartUp:"9003",errorLoadingRessource:"9007",wrongRessourcePath:"9008",missingAnalyticalConfig:"9009",errorLoadingAnalyticalConfig:"9010",errorInAnalyticalConfig:"9011",warningAnalyticalConfig:"9012"};sap.apf.core.constants.eventTypes={contextChanged:"contextChanged",printTriggered:"printTriggered",format:"format"};sap.apf.core.constants.configurationObjectTypes={facetFilter:"facetFilter"};sap.apf.core.constants.entitySets={application:'ApplicationQueryResults',configuration:'AnalyticalConfigurationQueryResults',texts:'TextElementQueryResults',logicalSystem:"SAPClientQuery",analysisPath:"AnalysisPathQueryResults",smartBusiness:"EVALUATIONS"};sap.apf.core.constants.modelerPersistenceServiceRoot="/sap/hba/r/apf/core/odata/modeler/AnalyticalConfiguration.xsodata";sap.apf.core.constants.developmentLanguage="";sap.apf.core.constants.textKeyForInitialText="00000000000000000000000000000000";sap.apf.core.constants.representationMetadata={kind:{XAXIS:"xAxis",YAXIS:"yAxis",BUBBLEWIDTH:"bubbleWidth",BUBBLEHEIGHT:"bubbleHeight",SECTORSIZE:"sectorSize",LEGEND:"legend",SECTORCOLOR:"sectorColor",REGIONCOLOR:"regionColor",REGIONSHAPE:"regionShape",COLUMN:"column"}};sap.apf.core.constants.vizFrame={feedItemTypes:{CATEGORYAXIS:"categoryAxis",COLOR:"color",VALUEAXIS:"valueAxis",VALUEAXIS2:"valueAxis2",BUBBLEHEIGHT:"bubbleHeight",BUBBLEWIDTH:"bubbleWidth",SIZE:"size",SHAPE:"shape"}};sap.apf.core.constants.applicationConfiguration={applicationConfigPath:"config/applicationConfiguration.json"};}());};if(!jQuery.sap.isDeclared('sap.apf.core.entityTypeMetadata')){jQuery.sap.declare("sap.apf.core.entityTypeMetadata");sap.apf.core.EntityTypeMetadata=function(m,e,M){this.type='entityTypeMetadata';this.getPropertyMetadata=function(p){var r;r=M.getPropertyMetadata(e,p);if(!r){r={dataType:{}};}return r;};this.getEntityTypeMetadata=function(){return M.getEntityTypeAnnotations(e);};function c(){m.check(e&&typeof e==='string','sap.apf.core.entityTypeMetadata: incorrect value for parameter sEntityType');m.check(M&&M.type&&M.type==="metadata",'sap.apf.core.entityTypeMetadata: incorrect value for parameter oMetadata');}c();};};if(!jQuery.sap.isDeclared('sap.apf.core.messageDefinition')){jQuery.sap.declare("sap.apf.core.messageDefinition");sap.apf.core.messageDefinition=[{code:"3001",severity:"technError",text:"Text is not available for the following key: {0}"},{code:"5001",severity:"technError",text:"Request {3} to server failed with http status code {0}, http error message {1}, and server response {2}."},{code:"5002",severity:"error",description:"Error in OData request; update of analysis step {0} failed.",key:"5002"},{code:"5004",severity:"fatal",description:"Request with ID {0} does not exist in the analytical content configuration.",key:"5004"},{code:"5005",severity:"technError",text:"Required property {1} is missing in the filter of the OData request for entity type {0}."},{code:"5006",severity:"technError",text:"Inconsistency in data model; non-filterable property {1} is set as required filter for entity type {0}."},{code:"5015",severity:"fatal",description:"Service for request {0} is not defined in the analytical content configuration.",key:"5015"},{code:"5016",severity:"technError",text:"Mandatory parameter key property {0} is missing in filter."},{code:"5018",severity:"fatal",description:"Metadata request {0} failed.",key:"5018"},{code:"5019",severity:"technError",text:"System query option $orderby for property {1} removed from OData request for entity type {0}."},{code:"5020",severity:"fatal",description:"Analytical content configuration is not available.",key:"5020"},{code:"5021",severity:"error",description:"Error during server request; session timeout occurred.",key:"5021"},{code:"5022",severity:"fatal",description:"Analytical configuration with ID {0} is not available.",key:"5022"},{code:"5023",severity:"fatal",description:"Texts could not be loaded for Analytical configuration with ID {0}.",key:"5023"},{code:"5024",severity:"fatal",description:"URL Parameter for Analytical Configuration ID must contain the ID of the application and the ID of the Analytical configuration seperated by a dot.",key:"5024"},{code:"5025",severity:"fatal",description:"Value for SAP client has not been provided at startup of the application.",key:"5025"},{code:"5026",severity:"fatal",description:"Logical system cannot be determined for SAP client {0}. ",key:"5026"},{code:"5027",severity:"technError",text:"Inconsistent parameters; analysis path cannot be saved. Path ID: {0}, path name: {1}, callback function {2}"},{code:"5028",severity:"technError",text:"Binding with ID {0} contains a representation without ID."},{code:"5029",severity:"technError",text:"Binding with ID {0} contains a duplicated representation ID."},{code:"5030",severity:"technError",text:"Constructor property of representation type ID {0} does not contain a module path to a valid function."},{code:"5031",severity:"technError",text:"Argument for method 'setApplicationMessageCallback' is not a function."},{code:"5032",severity:"technError",text:"System query option {1} unknown in request for entity type {0}."},{code:"5033",severity:"technError",text:"Unsupported type {0} in configuration object provided."},{code:"5034",severity:"technError",text:"Facet filter configuration attribute 'property' missing."},{code:"5035",severity:"technError",text:"Function module path contained in property preselectionFuntion of facet filter ID {0} does not contain a valid function."},{code:"5036",severity:"technError",text:"Start paramater step id {0} is not existing."},{code:"5037",severity:"technError",text:"Start paramater representation id {0} is not existing."},{code:"5038",severity:"technError",text:"Environment for sap.ushell.Container is not existing."},{code:"5039",severity:"technError",text:"Error while pushing content to the ushell container"},{code:"5040",severity:"technError",text:"Error while fetching content from the ushell container"},{code:"5100",severity:"fatal",description:"Unexpected internal error: {0}. Contact SAP.",key:"5100"},{code:"5101",severity:"technError",text:"Unexpected internal error: {0}. Contact SAP."},{code:"5102",severity:"fatal",description:"Wrong definition in analytical content configuration: {0}",key:"5102"},{code:"5103",severity:"technError",text:"Wrong definition in analytical content configuration."},{code:"5104",severity:"technError",text:"Wrong filter mapping definition in analytical content configuration"},{code:"5200",severity:"technError",text:"Server error during processing of path: {0} {1}"},{code:"5201",severity:"error",description:"Unknown server error.",key:"5201"},{code:"5202",severity:"technError",text:"Persistence service call returned '405 - Method not allowed'."},{code:"5203",severity:"technError",text:"Bad request; data is structured incorrectly."},{code:"5204",severity:"error",description:"Error during server request; maximum number of analysis steps exceeded.",key:"5204"},{code:"5205",severity:"error",description:"Error during server request; maximum number of analysis paths exceeded.",key:"5205"},{code:"5206",severity:"error",description:"Access forbidden; insufficient privileges",key:"5206"},{code:"5207",severity:"error",description:"Inserted value too large; probably maximum length of analysis path name exceeded",key:"5207"},{code:"5208",severity:"error",description:"Error during path persistence; request to server can not be proceed due to invalid ID.",key:"5208"},{code:"5210",severity:"error",description:"Error during opening of analysis path; see log.",key:"5210"},{code:"5211",severity:"error",description:"Server response contains undefined path objects.",key:"5211"},{code:"5212",severity:"error",description:"Metadata file of application {0} could not be accessed.",key:"5212"},{code:"5213",severity:"error",description:"Text file of application {0} could not be accessed.",key:"5213"},{code:"5300",severity:"fatal",description:"You must log out of the application due to a critical error.",key:"5300"},{code:"6001",severity:"fatal",description:"Missing {0} in the configuration; contact your administrator.",key:"6001"},{code:"6000",severity:"error",description:"Data is not available for the {0} step.",key:"6000"},{code:"6002",severity:"error",description:"Missing {0} for {1} in the configuration; contact your administrator.",key:"6002"},{code:"6003",severity:"error",description:"Missing {0} in the configuration; contact your administrator.",key:"6001"},{code:"6004",severity:"technError",text:"Metadata not available for step {0}."},{code:"6005",severity:"error",description:"Server request failed. Unable to read paths.",key:"6005"},{code:"6006",severity:"error",description:"Server request failed. Unable to save path {0}.",key:"6006"},{code:"6007",severity:"error",description:"Server request failed. Unable to update path {0}.",key:"6007"},{code:"6008",severity:"error",description:"Server request failed. Unable to open path {0}.",key:"6008"},{code:"6009",severity:"error",description:"Server request failed. Unable to delete path {0}.",key:"6009"},{code:"6010",severity:"technError",description:"Data is not available for filter {0}",key:"6010"},{code:"6011",severity:"fatal",description:"Smart Business service failed.Please try later",key:"6011"},{code:"7000",severity:"error",description:"Missing {0} in the configuration; contact your administrator.",key:"6001"}];};if(!jQuery.sap.isDeclared('sap.apf.core.messageObject')){jQuery.sap.declare("sap.apf.core.messageObject");sap.apf.core.MessageObject=function(c){var C=c.code;var p=c.aParameters||[];var o=c.oCallingObject;var m="";var s="";var P;var d=new Date();var r=c.rawText;this.type="messageObject";this.getCode=function(){return C;};this.setCode=function(a){C=a;};this.hasRawText=function(){return(r!==undefined);};this.getRawText=function(){return r;};this.getMessage=function(){return m;};this.setMessage=function(t){m=t;};this.setSeverity=function(a){s=a;};this.getSeverity=function(){return s;};this.setPrevious=function(a){P=a;};this.getPrevious=function(){return P;};this.getCallingObject=function(){return o;};this.getParameters=function(){return p;};this.getStack=function(){if(this.stack){return this.stack;}return"";};this.getTimestamp=function(){return d.getTime();};this.getTimestampAsdateObject=function(){return d;};this.getJQueryVersion=function(){return jQuery().jquery;};this.getSapUi5Version=function(){return sap.ui.version;};};sap.apf.core.MessageObject.prototype=new Error();sap.apf.core.MessageObject.prototype.constructor=sap.apf.core.MessageObject;};if(!jQuery.sap.isDeclared('sap.apf.core.metadataFactory')){jQuery.sap.declare("sap.apf.core.metadataFactory");sap.apf.core.MetadataFactory=function(i){this.type="metadataFactory";var t=this;var m=i.messageHandler;var c=i.configurationFactory;var h=i.hashtable;var M=i.metadata;var e=i.entityTypeMetadata;var f=i.metadataFacade;delete i.metadata;delete i.entityTypeMetadata;delete i.metadataFacade;delete i.metadataProperty;delete i.configurationFactory;var o=new h(m);this.getMetadata=function(a){var b;if(o.hasItem(a)===false){b=new M(i,a);if(!b.failed){o.setItem(a,{metadata:b});}else{return;}}return o.getItem(a).metadata;};this.getEntityTypeMetadata=function(a,E){var b;var d=this.getMetadata(a);b=o.getItem(a).entityTypes;if(!b){b=new h(m);o.getItem(a).entityTypes=b;}if(!b.getItem(E)){b.setItem(E,new e(m,E,d));}return b.getItem(E);};this.getMetadataFacade=function(a){return new f({messageHandler:m,metadataProperty:sap.apf.core.MetadataProperty,metadataFactory:t},a);};this.getServiceDocuments=function(){return c.getServiceDocuments();};this.getEntitySets=function(s){var a=this.getMetadata(s);return a.getEntitySets();};};};if(!jQuery.sap.isDeclared('sap.apf.core.metadataProperty')){jQuery.sap.declare("sap.apf.core.metadataProperty");sap.apf.core.MetadataProperty=function(a){var t=this;var k=false;var p=false;this.isKey=function(){return k;};this.isParameterEntitySetKeyProperty=function(){return p;};this.getAttribute=function(n){if(typeof this[n]!=="function"){return this[n];}};function b(n,v){switch(n){case"isKey":if(v===true){k=true;}break;case"isParameterEntitySetKeyProperty":if(v===true){p=true;}break;default:if(typeof t[n]!=="function"){t[n]=v;}}return t;}function i(){for(var n in a){switch(n){case"dataType":for(var d in a.dataType){b(d,a.dataType[d]);}break;default:b(n,a[n]);}}}i();};};if(!jQuery.sap.isDeclared('sap.apf.core.path')){jQuery.sap.declare("sap.apf.core.path");sap.apf.core.Path=function(I){this.type="path";var m=I.messageHandler;var c=I.coreApi;var t=this;var s=[];var a=[];var n=0;this.destroy=function(){a=[];s.forEach(function(f){f.destroy();});s=[];t=undefined;};this.getSteps=function(){return jQuery.extend(true,[],s);};this.addStep=function(S,f){s.push(S);t.update(f);};this.makeStepActive=function(S){var f=this.stepIsInPath(S);m.check(f,"An unknown step can't be an active step.",sap.apf.core.constants.message.code.errorCheckWarning);if(f){if(this.stepIsActive(S)===false){a.push(S);}}};this.makeStepInactive=function(S){var f=this.stepIsActive(S);m.check(f,"Only an active step can be removed from the active steps.",sap.apf.core.constants.message.code.errorCheckWarning);if(f){var i=jQuery.inArray(S,a);a.splice(i,1);}};this.stepIsActive=function(S){var i=jQuery.inArray(S,a);if(i>=0){return true;}return false;};this.stepIsInPath=function(S){var i=jQuery.inArray(S,s);if(i>=0){return true;}return false;};this.getActiveSteps=function(){return jQuery.extend(true,[],a);};this.getCumulativeFilterUpToActiveStep=function(){var f=jQuery.Deferred();c.getCumulativeFilter().done(function(C){var o=C.copy();var i,l=s.length;for(i=0;i<l;i++){o=o.addAnd(s[i].getFilter());if(t.stepIsActive(s[i])){f.resolve(o);return;}}f.resolve(o);});return f.promise();};this.moveStepToPosition=function(S,f,h){var i=jQuery.inArray(S,s);var j=f;m.check(typeof f==="number"&&f>=0&&f<s.length,"Path: moveStepToPosition invalid argument for nPosition");m.check(i>=0&&i<s.length,"Path: moveStepToPosition invalid step");if(i===f){return;}s.splice(i,1);s.splice(j,0,S);this.update(h);};this.removeStep=function(S,f){var h=this.stepIsInPath(S);var i=this.stepIsActive(S);var j=jQuery.inArray(S,s);m.check(h,"Path: remove step - invalid step");s.splice(j,1);if(i){this.makeStepInactive(S);}this.update(f);S.destroy();};this.update=function(S,C){if(!s[0]){return;}var f;var o=s[0];c.getCumulativeFilter().done(function(h){var i=h.copy();if(C===true){return;}n++;f=n;o.update(i,j);function j(r,l){var p=jQuery.inArray(o,s);var M;if(f===n){if(r instanceof Error){var q=p+1;M=m.createMessageObject({code:"5002",aParameters:[q],callingObject:o});M.setPrevious(r);m.putMessage(M);o.setData({data:[],metadata:undefined},i);S(o,true);p++;o=s[p];while(o){o.setData({data:[],metadata:undefined},i);S(o,true);p++;o=s[p];}return;}if(!l){o.setData(r,i);}S(o,!l);if(f!==n){return;}o.determineFilter(i.copy(),k);}}function k(F){var l=jQuery.inArray(o,s);i.addAnd(F);o=s[l+1];if(o){o.update(i,j);}else{i=undefined;}}});};this.serialize=function(){return{path:{steps:b(),indicesOfActiveSteps:g()}};};this.deserialize=function(S){var C;if(S.context){C=new sap.apf.utils.Filter(m);C.deserialize(S.context);c.setContext(C);}d(S.path.steps,this);e(S.path.indicesOfActiveSteps,this);};function g(){var f=[];for(var i=0;i<s.length;i++){for(var j=0;j<a.length;j++){if(s[i]===a[j]){f.push(i);}}}return f;}function b(){var S=[];for(var i=0;i<s.length;i++){S.push(s[i].serialize());}return S;}function d(S,C){var f=C.update;C.update=function(){};var i=0;for(i=0;i<S.length;i++){c.createStep(S[i].stepId);}for(i=0;i<s.length;i++){s[i].deserialize(S[i]);}C.update=f;}function e(f,C){for(var i=0;i<f.length;i++){var h=f[i];C.makeStepActive(s[h]);}}};};if(!jQuery.sap.isDeclared('sap.apf.core.persistence')){jQuery.sap.declare("sap.apf.core.persistence");(function(){'use strict';sap.apf.core.Persistence=function(I){var t=this;var l;this.createPath=function(n,C,E){var R;var S=I.coreApi.serializePath();if(E){S.filterIdHandler=E.filterIdHandler;S.startFilterHandler=E.startFilterHandler;}var o=e(S);j().then(function(l){R={data:{AnalysisPath:"",AnalysisPathName:n,LogicalSystem:l,ApplicationConfigurationURL:I.coreApi.getApplicationConfigurationURL(),SerializedAnalysisPath:JSON.stringify(S),StructuredAnalysisPath:JSON.stringify(o)},method:"POST"};if(I.coreApi.getStartParameterFacade().getAnalyticalConfigurationId()){R.data.AnalyticalConfiguration=I.coreApi.getStartParameterFacade().getAnalyticalConfigurationId().configurationId;}s(R,i.bind(t));},function(m){C({oResponse:undefined,status:"failed"},{},m);});function i(k,m,p){if(p){C({oResponse:k,status:"failed"},m,p);}else{I.messageHandler.check(k&&k.data&&k.statusCode===201&&k.statusText==="Created","Persistence create Path - proper response");C({AnalysisPath:k.data.AnalysisPath,status:"successful"},m,p);}}};this.readPaths=function(C){var R={method:"GET"};s(R,k.bind(this));function k(o,E,m){if(!m&&o&&o.data&&o.data.results){for(var i in o.data.results){o.data.results[i].StructuredAnalysisPath=JSON.parse(o.data.results[i].StructuredAnalysisPath);}}else if(!m||o.statusCode!==200||o.statusText!=="OK"){m=I.messageHandler.createMessageObject({code:'5211'});}if(m){C({oResponse:o,status:"failed"},E,m);}else{C({paths:o.data.results,status:"successful"},E,m);}}};this.deletePath=function(A,C){var R={method:"DELETE"};s(R,i.bind(this),A);function i(o,E,m){if((o.statusCode!==204||o.statusText!=="No Content")&&(!m)){m=I.messageHandler.createMessageObject({code:5201});m.setPrevious(I.messageHandler.createMessageObject({code:5200,aParameters:[o.statusCode,o.statusText]}));}if(m){C({oResponse:o,status:"failed"},E,m);}else{C({status:"successful"},E,m);}}};this.modifyPath=function(A,n,C,E){var S=I.coreApi.serializePath();if(E){S.filterIdHandler=E.filterIdHandler;S.startFilterHandler=E.startFilterHandler;}var o=e(S);j().then(function(l){var i={data:{AnalysisPathName:n,LogicalSystem:l,ApplicationConfigurationURL:I.coreApi.getApplicationConfigurationURL(),SerializedAnalysisPath:JSON.stringify(S),StructuredAnalysisPath:JSON.stringify(o)},method:"PUT"};s(i,R.bind(this),A);},function(m){C({oResponse:undefined,status:"failed"},{},m);});function R(i,k,m){if((i.statusCode!==204||i.statusText!=="No Content")&&(!m)){m=I.messageHandler.createMessageObject({code:5201});m.setPrevious(I.messageHandler.createMessageObject({code:5200,aParameters:[i.statusCode,i.statusText]}));}if(m){C({oResponse:i,status:"failed"},k,m);}else{C({AnalysisPath:A,status:"successful"},k,m);}}};this.openPath=function(A,C,n){var R={method:"GET"};s(R,i.bind(this),A);function i(o,E,m){var M;if(!m&&o&&o.statusCode===200&&o.data&&o.data.SerializedAnalysisPath){o.data.SerializedAnalysisPath=JSON.parse(o.data.SerializedAnalysisPath);m=a(o.data,n);}if(m){M=I.messageHandler.createMessageObject({code:'5210'});M.setPrevious(m);I.messageHandler.putMessage(M);}if(M){C({oResponse:o,status:"failed"},E,M);}else{C({path:o.data,status:"successful"},E,M);}}};function s(R,L,A){var S=function(D,o){L(o,f(),undefined);};var E=function(o){var m;if(o.messageObject&&o.messageObject.getCode&&o.messageObject.getCode()===5021){L(o,f(),o.messageObject);return;}var i=c(o.response.body);if(i!==undefined){m=I.messageHandler.createMessageObject({code:i});}if(o.response.body.match("274")){m=I.messageHandler.createMessageObject({code:'5207'});}if(o.response.statusCode===400){m=I.messageHandler.createMessageObject({code:'5203'});}if(o.response.statusCode===403){m=I.messageHandler.createMessageObject({code:'5206'});}if(o.response.statusCode===405){m=I.messageHandler.createMessageObject({code:'5202'});}if(o.response.statusCode===404){m=I.messageHandler.createMessageObject({code:'5208'});}if(!m&&o.response.statusCode===500){m=I.messageHandler.createMessageObject({code:'5200',aParameters:[o.response.statusCode,o.response.statusText]});}if(!m){m=I.messageHandler.createMessageObject({code:'5201'});}I.messageHandler.putMessage(m);L(o,f(),m);};var u=d();R.headers={"x-csrf-token":I.coreApi.getXsrfToken(d())};switch(R.method){case"GET":if(!R.data&&A){R.requestUri=u+"('"+A+"')";I.coreApi.odataRequest(R,S,E);}else if(!R.data&&!A){g().then(function(i){R.requestUri=u+i;I.coreApi.odataRequest(R,S,E);},function(m){L({},f(),m);});}break;case"POST":if(R.data&&!A){R.requestUri=u;}I.coreApi.odataRequest(R,S,E);break;case"DELETE":if(!R.data&&A){R.requestUri=u+"('"+A+"')";}I.coreApi.odataRequest(R,S,E);break;case"PUT":if(R.data&&A){R.requestUri=u+"('"+A+"')";}I.coreApi.odataRequest(R,S,E);break;default:I.coreApi.odataRequest(R,S,E);break;}}function g(){var i=jQuery.Deferred();j().then(function(l){var k="";if(I.coreApi.getStartParameterFacade().getAnalyticalConfigurationId()){k="AnalyticalConfiguration%20eq%20'"+I.coreApi.getStartParameterFacade().getAnalyticalConfigurationId().configurationId+"'%20and%20";}var u="?$select=AnalysisPath,AnalysisPathName,StructuredAnalysisPath,CreationUTCDateTime,LastChangeUTCDateTime&$filter=("+k+"LogicalSystem%20eq%20'"+l+"'%20and%20"+"ApplicationConfigurationURL%20eq%20'"+I.coreApi.getApplicationConfigurationURL()+"')"+"&$orderby=LastChangeUTCDateTime%20desc";i.resolve(u);},function(m){i.fail(m);});return i.promise();}function c(E){var i=E.match("52[0-9]{2}");if(i){return i[0];}return undefined;}function a(R,n){var p;var m;function i(){I.messageHandler.putMessage=p;}function k(){p=I.messageHandler.putMessage;I.messageHandler.putMessage=function(m){var o=I.messageHandler.getConfigurationByCode(m.getCode());if(o&&o.severity&&o.severity==="warning"){return;}throw m;};}if(n!==undefined){R.SerializedAnalysisPath.path.indicesOfActiveSteps[0]=n;}I.coreApi.resetPath(true);k();try{I.coreApi.deserializePath(R.SerializedAnalysisPath);}catch(E){I.coreApi.restoreOriginalPath();m=b(E);}finally{i();}return m;}function b(E){var m;if(E.type&&E.type==="messageObject"){m=E;}else{m=new sap.apf.core.MessageObject({code:sap.apf.core.constants.message.code.errorUnknown});m.setSeverity(sap.apf.core.constants.message.severity.error);m.setMessage("Unknown exception caught "+E.message);}return m;}function d(){var p=I.coreApi.getPersistenceConfiguration().path;var S=p.service+"/"+p.entitySet;return S;}function e(S){var k=[];var m=S.path.steps;var n;for(var i in m){k.push({stepId:m[i].stepId,selectedRepresentationId:m[i].binding.selectedRepresentationId});}n={steps:k,indexOfActiveStep:S.path.indicesOfActiveSteps[0]};return n;}function f(){var C=I.coreApi.getPersistenceConfiguration();var E=I.coreApi.getEntityTypeMetadata(C.path.service,C.path.entitySet);return E;}function h(C){var T=C&&C.getFilterTermsForProperty('SAPClient');if(T===undefined||T.length!==1){return undefined;}return T[0].getValue();}function r(i,k){var m=I.messageHandler;var n=I.coreApi.getPersistenceConfiguration().logicalSystem;if(!n){l=k;i.resolve(k);return i.promise();}var S=n.service;var E=n.entitySet||n.entityType;if(S===null){l=k;i.resolve(k);return i.promise();}if(E===undefined){E=sap.apf.core.constants.entitySets.logicalSystem;}var F=new sap.apf.core.utils.Filter(m,"SAPClient",'eq',k);var u=I.coreApi.getUriGenerator().getAbsolutePath(S);u=u+I.coreApi.getUriGenerator().buildUri(m,E,['LogicalSystem'],F,undefined,undefined,undefined,undefined,undefined,'Results');var R={requestUri:u,method:"GET",headers:{"x-csrf-token":I.coreApi.getXsrfToken(d())}};var o=function(D){var q;if(D&&D.results&&D.results instanceof Array&&D.results.length===1&&D.results[0].LogicalSystem){l=D.results[0].LogicalSystem;i.resolve(l);}else{q=m.createMessageObject({code:"5026",aParameters:[k]});i.fail(q);}};var p=function(q){var v=m.createMessageObject({code:"5026",aParameters:[k]});if(q.messageObject!==undefined&&q.messageObject.type==="messageObject"){v.setPrevious(q.messageObject);}i.fail(v);};I.coreApi.odataRequest(R,o,p);}function j(){var i=jQuery.Deferred();if(l){i.resolve(l);return i.promise();}var k=I.coreApi.getStartParameterFacade().getSapClient();if(k){r(i,k);return i.promise();}I.coreApi.getCumulativeFilter().done(function(C){k=h(C);if(!k){i.resolve('');}else{r(i,k);}});return i.promise();}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.representationTypes')){jQuery.sap.declare("sap.apf.core.representationTypes");sap.apf.core.representationTypes=function(){return[{"type":"representationType","id":"ColumnChart","constructor":"sap.apf.ui.representations.columnChart","picture":"sap-icon://bar-chart","label":{"type":"label","kind":"text","key":"ColumnChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.LEGEND,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"*"}]}}},{"type":"representationType","id":"BarChart","constructor":"sap.apf.ui.representations.barChart","picture":"sap-icon://horizontal-bar-chart","label":{"type":"label","kind":"text","key":"BarChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.LEGEND,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"*"}]}}},{"type":"representationType","id":"LineChart","constructor":"sap.apf.ui.representations.lineChart","picture":"sap-icon://line-chart","label":{"type":"label","kind":"text","key":"LineChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.LEGEND,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"*"}]}}},{"type":"representationType","id":"PieChart","constructor":"sap.apf.ui.representations.pieChart","picture":"sap-icon://pie-chart","label":{"type":"label","kind":"text","key":"PieChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.SECTORCOLOR,"min":"1","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.SECTORSIZE,"min":"1","max":"1"}]}}},{"type":"representationType","id":"ScatterPlotChart","constructor":"sap.apf.ui.representations.scatterPlotChart","picture":"sap-icon://scatter-chart","label":{"type":"label","kind":"text","key":"ScatterPlotChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.REGIONCOLOR,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.REGIONSHAPE,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"1"},{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"1"}]},"sortable":false}},{"type":"representationType","id":"BubbleChart","constructor":"sap.apf.ui.representations.bubbleChart","picture":"sap-icon://bubble-chart","label":{"type":"label","kind":"text","key":"BubbleChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.REGIONCOLOR,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.REGIONSHAPE,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"1"},{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"1"},{"kind":sap.apf.core.constants.representationMetadata.kind.BUBBLEWIDTH,"min":"1","max":"1"},{"kind":sap.apf.core.constants.representationMetadata.kind.BUBBLEHEIGHT,"min":"0","max":"1"}]},"sortable":false}},{"type":"representationType","id":"StackedColumnChart","constructor":"sap.apf.ui.representations.stackedColumnChart","picture":"sap-icon://vertical-stacked-chart","label":{"type":"label","kind":"text","key":"StackedColumnChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.LEGEND,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"*"}]}}},{"type":"representationType","id":"StackedBarChart","constructor":"sap.apf.ui.representations.stackedBarChart","picture":"sap-icon://horizontal-stacked-chart","label":{"type":"label","kind":"text","key":"StackedBarChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.LEGEND,"min":"1","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"*"}]}}},{"type":"representationType","id":"PercentageStackedColumnChart","constructor":"sap.apf.ui.representations.percentageStackedColumnChart","picture":"sap-icon://full-stacked-column-chart","label":{"type":"label","kind":"text","key":"PercentageStackedColumnChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.LEGEND,"min":"0","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"*"}]}}},{"type":"representationType","id":"PercentageStackedBarChart","constructor":"sap.apf.ui.representations.percentageStackedBarChart","picture":"sap-icon://full-stacked-chart","label":{"type":"label","kind":"text","key":"PercentageStackedBarChart"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.XAXIS,"min":"1","max":"*"},{"kind":sap.apf.core.constants.representationMetadata.kind.LEGEND,"min":"1","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.YAXIS,"min":"1","max":"*"}]}}},{"type":"representationType","id":"TableRepresentation","constructor":"sap.apf.ui.representations.table","picture":"sap-icon://table-chart","label":{"type":"label","kind":"text","key":"TableRepresentation"},"metadata":{"dimensions":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.COLUMN,"min":"1","max":"*"}]},"measures":{"supportedKinds":[{"kind":sap.apf.core.constants.representationMetadata.kind.COLUMN,"min":"1","max":"*"}]}}},{"type":"representationType","id":"ColumnChartSorted","constructor":"sap.apf.ui.representations.columnChart","picture":"sap-icon://vertical-bar-chart","label":{"type":"label","kind":"text","key":"ColumnChartSorted"}},{"type":"representationType","id":"ColumnChartClustered","constructor":"sap.apf.ui.representations.columnChart","picture":"sap-icon://bar-chart","label":{"type":"label","kind":"text","key":"ColumnChartClustered"}},{"type":"representationType","id":"ColumnChartClusteredSorted","constructor":"sap.apf.ui.representations.columnChart","picture":"sap-icon://vertical-bar-chart-2","label":{"type":"label","kind":"text","key":"ColumnChartClusteredSorted"}},{"type":"representationType","id":"StackedColumnSorted","constructor":"sap.apf.ui.representations.stackedColumnChart","picture":"sap-icon://upstacked-chart","label":{"type":"label","kind":"text","key":"StackedColumnSorted"}}];};};if(!jQuery.sap.isDeclared('sap.apf.core.utils.checkForTimeout')){jQuery.sap.declare('sap.apf.core.utils.checkForTimeout');sap.apf.core.utils.checkForTimeout=function(s){'use strict';var a;var m;var r=false;if(s&&s.headers&&s.headers['x-sap-login-page']){r=true;}if(s&&s.getResponseHeader&&s.getResponseHeader('x-sap-login-page')!==null){r=true;}if(s&&s.status){a=s.status;}if(s&&s.response&&s.response.statusCode){a=s.response.statusCode;}if(a===303||a===401||a===403||r){m=new sap.apf.core.MessageObject({code:"5021"});}return m;};};if(!jQuery.sap.isDeclared('sap.apf.core.utils.fileExists')){jQuery.sap.declare('sap.apf.core.utils.fileExists');sap.apf.core.utils.fileExists=function(u){'use strict';var f=false;jQuery.ajax({url:u,type:"HEAD",success:function(d,s,j){var m=sap.apf.core.utils.checkForTimeout(j);f=!m;},error:function(){f=false;},async:false});return f;};};if(!jQuery.sap.isDeclared('sap.apf.core.utils.uriGenerator')){jQuery.sap.declare("sap.apf.core.utils.uriGenerator");(function(){'use strict';sap.apf.core.utils.uriGenerator={};sap.apf.core.utils.uriGenerator.getAbsolutePath=function(p){if(p.slice(-1)==='/'){return p;}return p+"/";};sap.apf.core.utils.uriGenerator.getODataPath=function(p){var s=p.split('/');var i;var S=[];for(i=0;i<s.length;i++){if(s[i]!==""){S.push(s[i]);}}var r='';var l=S.length-1;for(i=0;i<l;i++){r=r+'/'+S[i];}return r+'/';};sap.apf.core.utils.uriGenerator.addRelativeToAbsoluteURL=function(a,r){var b=a.split('/');var c=r.split('/');c.forEach(function(p){if(p==='..'){b.pop();}else if(p!='.'){b.push(p);}});return b.join('/');};sap.apf.core.utils.uriGenerator.getBaseURLOfComponent=function(c){var b=c.split('.');b.pop();var a=b.join('.');return jQuery.sap.getModulePath(a);};sap.apf.core.utils.uriGenerator.getApfLocation=function(){return jQuery.sap.getModulePath("sap.apf")+'/';};sap.apf.core.utils.uriGenerator.buildUri=function(m,e,s,f,p,a,P,F,b,n){var r="";r+=e;r+=c(p,n);r=r+"?";r+=d(s);r+=g(f,b);r+=h(a,s);r+=j(P);r+=k(F);return r;function c(p,n){var r='';var i=false;var l;for(l in p){if(!i){r+='(';i=true;}else{r+=',';}r+=l.toString()+'='+p[l];}if(i){r+=')/';}r+=n||'';return r;}function d(s){if(!s[0]){return'';}var i;var R="$select=";for(i in s){R+=jQuery.sap.encodeURL(sap.apf.utils.escapeOdata(s[i]));if(i<s.length-1){R+=",";}}return R;}function g(f,b){if(!(f&&f instanceof sap.apf.core.utils.Filter)){return'';}var i=f.toUrlParam({formatValue:b});if(i===""||i==='()'){return'';}return'&$filter='+i;}function h(a,s){var o='';var S='';var i;if(!a){return'';}switch(true){case jQuery.isArray(a):for(i=0;i<a.length;i++){S=l(a[i],s);if(o.length>0&&S.length>0){o+=',';}o+=S;}break;case jQuery.isPlainObject(a):o+=l(a,s);break;case typeof a==='string':o+=l({property:a},s);break;}if(o.length>0){return"&$orderby="+o;}return'';function l(O,s){var v='';if(jQuery.inArray(O.property,s)>-1){v+=O.property;if(O.descending===true){v+=' desc';}else{v+=' asc';}}else{m.putMessage(m.createMessageObject({code:'5019',aParameters:[e,O.property]}));}return jQuery.sap.encodeURL(v);}}function j(P){function l(P){var o,i;o=Object.getOwnPropertyNames(P);for(i=0;i<o.length;i++){if(o[i]!=='top'&&o[i]!=='skip'&&o[i]!=='inlineCount'){m.putMessage(m.createMessageObject({code:'5032',aParameters:[e,o[i]]}));}}}var r='';if(!P){return r;}l(P);if(P.top){r+='&$top='+P.top;}if(P.skip){r+='&$skip='+P.skip;}if(P.inlineCount===true){r+='&$inlinecount=allpages';}return r;}function k(F){if(!F){F='json';}return'&$format='+F;}};}());};if(!jQuery.sap.isDeclared('sap.apf.library')){jQuery.sap.declare("sap.apf.library");jQuery.sap.require('sap.ui.core.Core');jQuery.sap.require('sap.ui.core.library');jQuery.sap.require('sap.ca.ui.library');jQuery.sap.require('sap.m.library');jQuery.sap.require('sap.ui.layout.library');jQuery.sap.require('sap.ushell.library');jQuery.sap.require('sap.viz.library');sap.ui.getCore().initLibrary({name:"sap.apf",dependencies:["sap.ui.core","sap.ca.ui","sap.m","sap.ui.layout","sap.ushell","sap.viz"],types:[],interfaces:[],controls:[],elements:[],noLibraryCSS:true,version:"1.32.6"});};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.configurationObjects')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.modeler.core.configurationObjects");(function(){'use strict';sap.apf.modeler.core.ConfigurationObjects=function(i){var t=this;var H,a,p,m;if(i.constructor.hashtable){H=i.constructor.hashtable;}if(i.instance.textPool){a=i.instance.textPool;}if(i.instance.persistenceProxy){p=i.instance.persistenceProxy;}if(i.instance.messageHandler){m=i.instance.messageHandler;}function c(j,k){var P=[];if(k){P.push(k);}m.putMessage(m.createMessageObject({code:j,aParameters:P}));}function b(l){var r=l&&l.type&&l.type==="label"&&l.kind&&l.kind==="text"&&l.key&&typeof l.key==="string";if(!r){c(11030,l.key);}return r;}this.serializeLabelKey=function(j){return{type:"label",kind:"text",key:a.getPersistentKey(j)};};this.serializeAndAddThumbnail=function(j,k){var l=j.getLeftLowerCornerTextKey();var n=j.getLeftUpperCornerTextKey();var r=j.getRightUpperCornerTextKey();var o=j.getRightLowerCornerTextKey();var q={type:"thumbnail"};if(n){q.leftUpper=this.serializeLabelKey(n);}if(l){q.leftLower=this.serializeLabelKey(l);}if(r){q.rightUpper=this.serializeLabelKey(r);}if(o){q.rightLower=this.serializeLabelKey(o);}if(q.leftLower||q.leftUpper||q.rightLower||q.rightUpper){k.thumbnail=q;}};this.serializeCategory=function(j,k){var T=a.get(j.labelKey);var l=[];if(k){k.forEach(function(o){l.push({type:"step",id:o});});}var n=(T&&T.TextElementDescription)||"";return{type:"category",description:n,id:j.getId(),label:t.serializeLabelKey(j.labelKey),steps:l};};this.validateCategory=function(j){var r=j&&j.type&&j.type==="category"&&j.id&&j.steps&&b(j.label);if(r){j.steps.forEach(function(o){if(!o.type||o.type!=="step"||!o.id){r=false;}});}if(!r){c(11031,j.id);}return r;};this.validateRequest=function(r){var j=r&&r.id&&r.type==="request"&&r.service&&typeof r.service==="string"&&((r.entityType&&typeof r.entityType==="string")||(r.entitySet&&typeof r.entitySet==="string"))&&r.selectProperties&&r.selectProperties&&r.selectProperties instanceof Array&&r.selectProperties.length>=0;if(!j){c(11032,r.id);}return j;};this.validateBinding=function(j){var r=j&&j.id&&j.type==="binding"&&j.requiredFilters&&j.requiredFilters instanceof Array&&j.requiredFilters.length>=0&&j.representations&&j.representations instanceof Array;if(!r){c(11033,j.id);}return r;};this.validateFacetFilter=function(j){var r=j&&j.id&&j.property&&j.type==="facetFilter";if(!r){c(11034,j.id);}return r;};this.validateNavigationTarget=function(n){var r=n&&n.id&&n.semanticObject&&n.action&&n.type==="navigationTarget"&&n.hasOwnProperty("isStepSpecific");if(!r){c(11040,n.id);}return r;};this.validateStep=function(j){var r=j&&j.id&&j.type==="step"&&b(j.title)&&b(j.longTitle)&&j.hasOwnProperty("navigationTargets");if(!r){c(11035,j.id);}return r;};this.validateConfiguration=function(j){var r=j&&j.applicationTitle&&j.applicationTitle.key&&typeof j.applicationTitle.key==='string'&&j.steps&&j.steps instanceof Array&&j.steps.length>=0&&j.requests&&j.requests instanceof Array&&j.requests.length>=0&&j.bindings&&j.bindings instanceof Array&&j.bindings.length>=0&&j.representationTypes&&j.representationTypes instanceof Array&&j.representationTypes.length>=0&&j.facetFilters&&j.facetFilters instanceof Array&&j.facetFilters.length>=0&&j.categories&&j.categories instanceof Array&&j.categories.length>=0;if(!r){c(11036);}return r;};function s(j){var r=[];var k,l;var n,o;var q;var u;var v;var w=j.getRepresentations();w.forEach(function(x){k=[];l=x.getDimensions();l.forEach(function(y){var z={fieldName:y};if(x.getDimensionKind(y)){z.kind=x.getDimensionKind(y);}if(x.getDimensionTextLabelKey(y)){z.fieldDesc={type:'label',kind:'text',key:x.getDimensionTextLabelKey(y)};}k.push(z);});n=[];o=x.getMeasures();o.forEach(function(y){var z={fieldName:y};if(x.getMeasureKind(y)){z.kind=x.getMeasureKind(y);}if(x.getMeasureTextLabelKey(y)){z.fieldDesc={type:'label',kind:'text',key:x.getMeasureTextLabelKey(y)};}n.push(z);});q=[];x.getOrderbySpecifications().forEach(function(y){q.push({property:y.property,ascending:y.ascending});});u={id:x.getId(),representationTypeId:x.getRepresentationType(),parameter:{dimensions:k,measures:n,alternateRepresentationTypeId:x.getAlternateRepresentationType()}};if(x.getWidthProperties()){u.parameter.width=x.getWidthProperties();}if(q.length>0){u.parameter.orderby=q;}v=x.getTopN();if(v&&v>0){u.parameter.top=v;}t.serializeAndAddThumbnail(x,u);r.push(u);});return r;}this.serializeBinding=function(j,k){var l="binding-for-"+j.getId();var T=a.get(j.getTitleId());var n=(T&&T.TextElementDescription)||"";k.bindings.push({type:"binding",id:l,stepDescription:n,requiredFilters:j.getFilterProperties(),representations:s(j)});return l;};this.serializeRequest=function(j,k){var r;var l="request-for-"+j.getId();r={type:"request",id:l,service:j.getService(),entitySet:j.getEntitySet(),selectProperties:j.getSelectProperties()};k.requests.push(r);return l;};this.serializeFilterMappingRequest=function(o,j){var r="request-for-FilterMapping"+o.getId();var k={type:"request",id:r,service:o.getFilterMappingService(),entitySet:o.getFilterMappingEntitySet(),selectProperties:o.getFilterMappingTargetProperties()};j.requests.push(k);return r;};this.serializeStep=function(j,k){var r=t.serializeRequest(j,k);var l=t.serializeBinding(j,k);var T=a.get(j.getTitleId());var n=(T&&T.TextElementDescription)||"";var o=j.getLongTitleId();var q;var u={type:"step",description:n,request:r,binding:l,id:j.getId(),title:t.serializeLabelKey(j.getTitleId()),navigationTargets:[]};if(j.getFilterMappingService()){u.filterMapping={requestForMappedFilter:t.serializeFilterMappingRequest(j,k),target:j.getFilterMappingTargetProperties(),keepSource:j.getFilterMappingKeepSource()?"true":"false"};}q=j.getTopN();if(q){u.topNSettings=q;}if(o!==""&&o!==undefined){u.longTitle=t.serializeLabelKey(j.getLongTitleId());}this.serializeAndAddThumbnail(j,u);j.getNavigationTargets().forEach(function(v){u.navigationTargets.push({type:"navigationTarget",id:v});});return u;};this.serializeFacetFilter=function(j,k){var r,l;if(j.getServiceOfFilterResolution()){r=o("FilterResolution",j,k);}if(j.getUseSameRequestForValueHelpAndFilterResolution()){l=r;}else if(j.getServiceOfValueHelp()){l=o("ValueHelp",j,k);}var T=a.get(j.getLabelKey());var n=(T&&T.TextElementDescription)||"";return{type:"facetFilter",description:n,id:j.getId(),alias:j.getAlias(),property:j.getProperty(),multiSelection:j.isMultiSelection()+"",preselectionFunction:j.getPreselectionFunction(),preselectionDefaults:j.getPreselectionDefaults(),label:t.serializeLabelKey(j.getLabelKey()),filterResolutionRequest:r,valueHelpRequest:l,hasAutomaticSelection:j.getAutomaticSelection()+"",useSameRequestForValueHelpAndFilterResolution:j.getUseSameRequestForValueHelpAndFilterResolution()+""};function o(q,j,k){var u;var v;var w;var x;switch(q){case"ValueHelp":v=j.getServiceOfValueHelp();w=j.getEntitySetOfValueHelp();x=j.getSelectPropertiesOfValueHelp();break;case"FilterResolution":v=j.getServiceOfFilterResolution();w=j.getEntitySetOfFilterResolution();x=j.getSelectPropertiesOfFilterResolution();break;}var y=q+"-request-for-"+j.getId();u={type:"request",id:y,service:v,entitySet:w,selectProperties:x};k.requests.push(u);return y;}};this.serializeNavigationTarget=function(n,j){var r={type:"navigationTarget",id:n.getId(),semanticObject:n.getSemanticObject(),action:n.getAction(),isStepSpecific:n.isStepSpecific()};if(n.getFilterMappingService()){r.filterMapping={requestForMappedFilter:t.serializeFilterMappingRequest(n,j),target:n.getFilterMappingTargetProperties()};}return r;};this.serializeConfiguration=function(j){var k={analyticalConfigurationName:j.getConfigurationName(),applicationTitle:t.serializeLabelKey(j.getApplicationTitle()),steps:[],requests:[],bindings:[],representationTypes:[],categories:[],facetFilters:[],navigationTargets:[]};var l={requests:k.requests,bindings:k.bindings};j.getCategories().forEach(function(n){var o=j.getCategoryStepAssignments(n.getId());k.categories.push(t.serializeCategory(n,o));});j.getSteps().forEach(function(n){var o=t.serializeStep(n,l);k.steps.push(o);});j.getFacetFilters().forEach(function(n){var o=t.serializeFacetFilter(n,l);k.facetFilters.push(o);});j.getNavigationTargets().forEach(function(n){var o=t.serializeNavigationTarget(n,l);k.navigationTargets.push(o);});return k;};function d(j,k){var l=j.thumbnail;if(!l){return;}if(l.leftLower){k.setLeftLowerCornerTextKey(l.leftLower.key);}if(l.leftUpper){k.setLeftUpperCornerTextKey(l.leftUpper.key);}if(l.rightLower){k.setRightLowerCornerTextKey(l.rightLower.key);}if(l.rightUpper){k.setRightUpperCornerTextKey(l.rightUpper.key);}}function e(j,r,k){var l=k.createStepWithId(j.id);var n=k.getStep(l);var o=r.getItem(j.request);if(o.entityType){o.entitySet=o.entityType;delete o.entityType;}if(o.service){k.registerService(o.service);}n.setService(o.service);n.setEntitySet(o.entitySet);n.setTitleId(j.title.key);if(j.longTitle&&j.longTitle.key){n.setLongTitleId(j.longTitle.key);}if(j.navigationTargets){j.navigationTargets.forEach(function(u){n.addNavigationTarget(u.id);});}d(j,n);o.selectProperties.forEach(function(u){n.addSelectProperty(u);});var q=r.getItem(j.binding);q.requiredFilters.forEach(function(u){n.addFilterProperty(u);});q.representations.forEach(function(u){var v;var w=n.getRepresentation(n.createRepresentation().getId());w.setRepresentationType(u.representationTypeId);w.setAlternateRepresentationType(u.parameter.alternateRepresentationTypeId);u.parameter.dimensions.forEach(function(x){w.addDimension(x.fieldName);if(x.fieldDesc){w.setDimensionTextLabelKey(x.fieldName,x.fieldDesc.key);}if(x.kind){w.setDimensionKind(x.fieldName,x.kind);}});u.parameter.measures.forEach(function(x){w.addMeasure(x.fieldName);if(x.fieldDesc){w.setMeasureTextLabelKey(x.fieldName,x.fieldDesc.key);}if(x.kind){w.setMeasureKind(x.fieldName,x.kind);}});if(u.parameter.width){for(v in u.parameter.width){if(u.parameter.width.hasOwnProperty(v)){w.setWidthProperty(v,u.parameter.width[v]);}}}if(u.parameter.orderby&&!u.parameter.topN){u.parameter.orderby.forEach(function(x){w.addOrderbySpec(x.property,x.ascending);});}d(u,w);});if(j.filterMapping){h(j.filterMapping,n,r);}if(j.topNSettings){n.setTopN(j.topNSettings.top,j.topNSettings.orderby);}}function f(j,r,k){var l=k.createFacetFilterWithId(j.id);var n=k.getFacetFilter(l);n.setLabelKey(j.label.key);n.setAlias(j.alias);n.setProperty(j.property);if(j.preselectionFunction&&j.preselectionFunction!==""){n.setPreselectionFunction(j.preselectionFunction);}else{n.setPreselectionDefaults(j.preselectionDefaults);}if(j.useSameRequestForValueHelpAndFilterResolution&&j.useSameRequestForValueHelpAndFilterResolution==="true"){n.setUseSameRequestForValueHelpAndFilterResolution(true);}else{n.setUseSameRequestForValueHelpAndFilterResolution(false);}if(j.multiSelection==="true"){n.setMultiSelection(true);}if(j.hasAutomaticSelection==="true"){n.setAutomaticSelection(true);}else{n.setAutomaticSelection(false);}if(j.valueHelpRequest){var o=r.getItem(j.valueHelpRequest);if(o.entityType){o.entitySet=o.entityType;delete o.entityType;}if(o.service){k.registerService(o.service);n.setServiceOfValueHelp(o.service);}if(o.entitySet){n.setEntitySetOfValueHelp(o.entitySet);}o.selectProperties.forEach(function(u){n.addSelectPropertyOfValueHelp(u);});}if(j.filterResolutionRequest){var q=r.getItem(j.filterResolutionRequest);if(q.entityType){q.entitySet=q.entityType;delete q.entityType;}if(q.service){k.registerService(q.service);n.setServiceOfFilterResolution(q.service);}if(q.entitySet){n.setEntitySetOfFilterResolution(q.entitySet);}q.selectProperties.forEach(function(u){n.addSelectPropertyOfFilterResolution(u);});}}function g(j,r,k){var l=k.createNavigationTargetWithId(j.id);var n=k.getNavigationTarget(l);n.setSemanticObject(j.semanticObject);n.setAction(j.action);if(j.isStepSpecific===true){n.setStepSpecific();}else{n.setGlobal();}if(j.filterMapping){h(j.filterMapping,n,r);}}function h(j,k,r){var l=r.getItem(j.requestForMappedFilter);if(l.entityType){l.entitySet=l.entityType;delete l.entityType;}k.setFilterMappingService(l.service);k.setFilterMappingEntitySet(l.entitySet);j.target.forEach(function(n){k.addFilterMappingTargetProperty(n);});if(j.hasOwnProperty("keepSource")){if(j.keepSource==="true"){k.setFilterMappingKeepSource(true);}else{k.setFilterMappingKeepSource(false);}}}this.mapToDesignTime=function(r,j){j.setApplicationTitle(r.getItem('applicationTitle').key);r.getSteps().forEach(function(k){e(k,r,j);});r.getCategories().forEach(function(k){j.createCategoryWithId({labelKey:k.label.key},k.id);k.steps.forEach(function(l){j.addCategoryStepAssignment(k.id,l.id);});});r.getFacetFilters().forEach(function(k){f(k,r,j);});r.getNavigationTargets().forEach(function(n){g(n,r,j);});};this.loadAllConfigurations=function(j,k){var l=new sap.apf.core.utils.Filter(m,'Application','eq',j);p.readCollection("configuration",function(r,n,o){k(r,n,o);},undefined,undefined,l,true);};this.getTextKeysFromAllConfigurations=function(j,k){this.loadAllConfigurations(j,function(l,n,o){var q=new H(m);if(o){k(undefined,o);return;}l.forEach(function(r){var u=JSON.parse(r.SerializedAnalyticalConfiguration);var v=sap.apf.modeler.core.ConfigurationObjects.getTextKeysFromConfiguration(u);v.forEach(function(w){q.setItem(w,w);});});k(q,undefined);});};};sap.apf.modeler.core.ConfigurationObjects.deepDataCopy=function deepDataCopy(i){var r;if(!i){r=i;}else if(i.copy&&typeof i.copy==="function"){r=i.copy();}else if(i&&typeof i==="object"){if(i instanceof Array){r=[];i.forEach(function(a){r.push(deepDataCopy(a));});}else{r={};for(var a in i){if(!i.hasOwnProperty(a)){continue;}r[a]=deepDataCopy(i[a]);}}}else{r=i;}return r;};sap.apf.modeler.core.ConfigurationObjects.getTextKeysFromConfiguration=function getTextKeysFromConfiguration(c){var r=[];if(!c){return;}if(c.type&&c.type==="label"&&c.kind&&c.kind==="text"&&c.key){return[c.key];}else{for(var i in c){if(typeof c[i]!=="object"||!c.hasOwnProperty(i)){continue;}Array.prototype.push.apply(r,getTextKeysFromConfiguration(c[i]));}return r;}};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.elementContainer')){jQuery.sap.declare("sap.apf.modeler.core.elementContainer");(function(){'use strict';sap.apf.modeler.core.ElementContainer=function(n,E,i,d){var e,a,r=new RegExp("^"+n+"-([123456789]\\d*)$"),b=new RegExp("^"+n);var t=this;i.instance.messageHandler.check(n!==undefined,"ElementContainer: Element has been created without name");if(!d){e=new i.constructor.hashtable(i.instance.messageHandler);a=0;}else{e=d.elements;a=d.elementCounter;}this.generateId=function(){return n+"-"+(++a);};this.createElement=function(f){var g;g=t.generateId();return c(f,g);};this.createElementWithProposedId=function(f,p){function g(k){var m=r.exec(k);if(m){var l=parseInt(m[1],10);if(l>a){a=l;}}}var h;var j=e.getItem(p);if(j){return t.createElement(f);}h=c(f,p);g(p);return h;};this.removeElement=function(f){return e.removeItem(f);};this.getElement=function(f){return e.getItem(f);};this.updateElement=function(f,g){i.instance.messageHandler.check(f!==undefined,"ElementContainer: Element has been updated with undefined elementId");if((!g.getId)||g.getId()!==f){g.getId=function(){return f;};}e.setItem(f,g);return f;};this.setElement=function(f,g){var h;if(g){if(!(e.getItem(g))){i.instance.messageHandler.putMessage(i.instance.messageHandler.createMessageObject({code:'11006',aParameters:[g]}));return undefined;}t.updateElement(g,f);return g;}h=t.createElement(f);return h.getId();};this.getElements=function(){var l=[];e.forEachOrdered(function(f,g){l.push(g);});return l;};this.moveUpOrDown=function(f,g){return e.moveUpOrDown(f,g);};this.moveBefore=function(f,m){return e.moveBefore(f,m);};this.moveToEnd=function(f){return e.moveToEnd(f);};this.copyElement=function(f){var g,h,j;g=e.getItem(f);if(!g){return;}j=t.generateId();if(g.copy&&typeof g.copy==="function"){h=g.copy(j);}else{h=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(g);}h.getId=function(){return j;};e.setItem(j,h);return j;};this.copy=function(f){var g={elements:new i.constructor.hashtable(i.instance.messageHandler),elementCounter:a};var h;var j;e.getKeysOrdered().forEach(function(k){h=e.getItem(k);j=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(h);if(f&&k.indexOf(n)===0){k=k.replace(b,f);}i.instance.messageHandler.check(k!==undefined,"ElementContainer: Element has been created without name in copy - 1");if(typeof j==="object"&&j.getId&&typeof j.getId==="function"){j.getId=function(){return k;};}g.elements.setItem(k,j);});i.instance.messageHandler.check(n!==undefined||f!==undefined,"ElementContainer: Element has been created without name in copy 2");return new sap.apf.modeler.core.ElementContainer((f||n),E,i,g);};function c(f,g){var h;i.instance.messageHandler.check(g!==undefined,"ElementContainer: Element has been created with undefined id");if(typeof E==='function'){if(E!==sap.apf.modeler.core.ElementContainer){h=new E(g,i);}else{h=new E(g,undefined,i);}}else{h={};}h.getId=function(){return g;};if(f){h=jQuery.extend(h,f);}e.setItem(g,h);return h;}};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.facetFilter')){jQuery.sap.declare("sap.apf.modeler.core.facetFilter");(function(){'use strict';sap.apf.modeler.core.FacetFilter=function(f,i,d){var r,s,a,m,l,p,b,c,e,g,h=true,j,u;if(!d){r={forValueHelp:{service:undefined,entitySet:undefined},forFilterResolution:{service:undefined,entitySet:undefined}};s=new i.constructor.elementContainer("SelectPropertyValueHelp",undefined,i);a=new i.constructor.elementContainer("SelectPropertyFilterResolution",undefined,i);m={};l={};p=[];j=false;u=false;}else{r=d.request;s=d.selectPropertyForValueHelp;a=d.selectPropertyForFilterResolution;m=d.metadata;l=d.label;p=d.preselectionDefaults;b=d.property;c=d.alias;e=d.labelKey;g=d.preselectionFunction;j=d.isMultiSelectionActive;h=d.hasAutomaticSelection;u=d.useSameRequestForValueHelpAndFilterResolution;}this.getId=function(){return f;};this.setMultiSelection=function(k){j=k;};this.isMultiSelection=function(){return j;};this.setAlias=function(k){c=k;};this.getAlias=function(){return c;};this.setAutomaticSelection=function(v){i.instance.messageHandler.check(typeof v==="boolean","facetFilter wrong input for setAutomaticSelection");h=v;if(h){this.removePreselectionFunction();this.removePreselectionDefaults();}};this.getAutomaticSelection=function(){return h;};this.setPreselectionFunction=function(v){g=v;h=false;this.removePreselectionDefaults();};this.getPreselectionFunction=function(){return g;};this.removePreselectionFunction=function(){g=undefined;};this.setPreselectionDefaults=function(k){p=k;h=false;this.removePreselectionFunction();};this.getPreselectionDefaults=function(){return p;};this.removePreselectionDefaults=function(){p=[];};this.setLabelKey=function(k){e=k;};this.getLabelKey=function(){return e;};this.setProperty=function(k){b=k;};this.getProperty=function(){return b;};this.setUseSameRequestForValueHelpAndFilterResolution=function(O){var t=this;if(O){var k=this.getServiceOfValueHelp();this.setServiceOfFilterResolution(k);var n=this.getEntitySetOfValueHelp();this.setEntitySetOfFilterResolution(n);var o=this.getSelectPropertiesOfFilterResolution();o.forEach(function(b){t.removeSelectPropertyOfFilterResolution(b);});o=this.getSelectPropertiesOfValueHelp();o.forEach(function(b){t.addSelectPropertyOfFilterResolution(b);});}u=O;};this.getUseSameRequestForValueHelpAndFilterResolution=function(){return u;};this.setServiceOfValueHelp=function(k){r.forValueHelp.service=k;if(u){r.forFilterResolution.service=k;}};this.getServiceOfValueHelp=function(){return r.forValueHelp.service;};this.setEntitySetOfValueHelp=function(k){r.forValueHelp.entitySet=k;if(u){r.forFilterResolution.entitySet=k;}};this.getEntitySetOfValueHelp=function(){return r.forValueHelp.entitySet;};this.getSelectPropertiesOfValueHelp=function(){var k=[];var n;n=s.getElements();n.forEach(function(o){k.push(o.getId());});return k;};this.removeSelectPropertyOfValueHelp=function(k){s.removeElement(k);if(u){a.removeElement(k);}};this.addSelectPropertyOfValueHelp=function(k){s.createElementWithProposedId(undefined,k);if(u){a.createElementWithProposedId(undefined,k);}};this.setServiceOfFilterResolution=function(k){if(u){return;}r.forFilterResolution.service=k;};this.getServiceOfFilterResolution=function(){return r.forFilterResolution.service;};this.setEntitySetOfFilterResolution=function(k){if(u){return;}r.forFilterResolution.entitySet=k;};this.getEntitySetOfFilterResolution=function(){return r.forFilterResolution.entitySet;};this.getSelectPropertiesOfFilterResolution=function(){var k=[];var n;n=a.getElements();n.forEach(function(o){k.push(o.getId());});return k;};this.removeSelectPropertyOfFilterResolution=function(k){if(u){return;}a.removeElement(k);};this.addSelectPropertyOfFilterResolution=function(k){if(u){return;}a.createElementWithProposedId(undefined,k);};this.copy=function(n){var k={request:r,selectPropertyForValueHelp:s,selectPropertyForFilterResolution:a,metadata:m,label:l,preselectionDefaults:p,property:b,alias:c,labelKey:e,preselectionFunction:g,isMultiSelectionActive:j,hasAutomaticSelection:h};var d=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(k);return new sap.apf.modeler.core.FacetFilter((n||this.getId()),i,d);};};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.lazyLoader')){jQuery.sap.declare("sap.apf.modeler.core.lazyLoader");(function(){'use strict';sap.apf.modeler.core.LazyLoader=function(a,l,d){var o={id:null,instance:null,messageObject:null,isInitializing:false,callbacksFromAsyncGet:new a.constructor.hashtable(a.instance.messageHandler)},b=null;if(d){o.id=d.id;o.instance=d.instance;}this.type="lazyLoader";this.getId=function(){return o.id;};this.getInstance=function(){return o.instance;};this.isInitializing=function(){return o.isInitializing;};this.reset=function(){b=o.instance;o={id:null,instance:null,messageObject:null,isInitializing:false,callbacksFromAsyncGet:new a.constructor.hashtable(a.instance.messageHandler)};};this.asyncGetInstance=function(i,e){if(!i){return;}if(o.id&&i!==o.id){this.reset();}if(o.id&&(o.instance||o.messageObject)){e(o.instance,o.messageObject,o.id);return;}m(e);if(!o.isInitializing){o.isInitializing=true;o.id=i;l(i,c,b);}};function c(i,e,f){if(i!==o.id){return;}o.isInitializing=false;if(!f){o.instance=e;}else{o.messageObject=f;}o.callbacksFromAsyncGet.each(function(k,g){g.forEach(function(h){h(o.instance,f,o.id);});});o.callbacksFromAsyncGet=null;}function m(e){var i;var f,g;g=o.callbacksFromAsyncGet.getItem(e);if(!g){o.callbacksFromAsyncGet.setItem(e,[e]);return;}f=false;for(i=0;i<g.length;i++){if(g[i]===e){f=true;break;}}if(!f){g.push(e);}}};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.messageDefinition')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.apf.modeler.core.messageDefinition");sap.apf.modeler.core.messageDefinition=[{code:"11005",severity:"technError",text:"Bad HTTP request returned status code {0} with status text {1}."},{code:"11006",severity:"technError",text:"Unknown identifier: {0}"},{code:"11007",severity:"technError",text:"Cannot export unsaved configuration. Configuration ID: {0}"},{code:"11008",severity:"error",description:"Format information is missing at least for text element {0} - please edit the exported text property file manually",key:"11008"},{code:"11009",severity:"error",description:"Application id {0} cannot be used as translation uuid in text property file - please edit the exported text property file manually",key:"11009"},{code:"11010",severity:"error",description:"Imported text property file does not contain the APF application id - expected an entry like #ApfApplicationId=543EC63F05550175E10000000A445B6D.",key:"11010"},{code:"11011",severity:"error",description:"Expected a valid text entry <key>=<value> in line {0}, but could not find - key must be in valid guid format.",key:11011},{code:"11012",severity:"error",description:"No valid text entry <key>=<value> in line {0}, key is not in valid guid format like 543EC63F05550175E10000000A445B6D.",key:11012},{code:"11013",severity:"technError",text:"Metadata request {3} to server failed with http status code {0}, http error message {1}, and server response {2}",key:"11013"},{code:"11014",severity:"error",description:"ApfApplicationId in line {0} has invalid format - a valid application id looks like 543EC63F05550175E10000000A445B6D.",key:"11014"},{code:"11015",severity:"error",description:"Date in line {0} has invalid format.",key:"11015"},{code:"11016",severity:"error",description:"Sorting options must be supplied when setting top n",key:"11016"},{code:"11020",severity:"error",description:"Text property has invalid format and cannot be imported - see previous messages for details",key:"11020"},{code:"11021",severity:"error",description:"ApfApplicationId {0} referenced in the text property is not yet existing - please load one configuration of the application before importing the texts.",key:"11021"},{code:"11030",severity:"error",description:"Label {0} is not valid",key:"11030"},{code:"11031",severity:"error",description:"Category {0} is not valid",key:"11031"},{code:"11032",severity:"error",description:"Request {0} is not valid",key:"11032"},{code:"11033",severity:"error",description:"Binding {0} is not valid",key:"11033"},{code:"11034",severity:"error",description:"Facet filter {0} is not valid",key:"11034"},{code:"11035",severity:"error",description:"Step {0} is not valid",key:"11035"},{code:"11036",severity:"error",description:"Configuration is not valid",key:"11036"},{code:"11037",severity:"error",description:"Invalid application guid {0}",key:"11037"},{code:"11038",severity:"error",description:"Invalid configuration guid {0}",key:"11038"},{code:"11039",severity:"error",description:"Invalid text guid {0}",key:"11039"},{code:"11040",severity:"error",description:"Navigation target {0} is not valid",key:"11040"},{code:"11041",severity:"technError",text:"Network service for retrieving semantic objects failed - see console."},{code:"11042",severity:"technError",text:"Error occurred when retrieving actions for semantic object - see console."},{code:"11500",severity:"error",description:"An error occurred while attempting to save the application.",key:"11500"},{code:"11501",severity:"error",description:"An error occurred while attempting to delete the application.",key:"11501"},{code:"11502",severity:"error",description:"An error occurred while importing the configuration.",key:"11502"},{code:"11503",severity:"error",description:"An error occurred while importing the text properties file.",key:"11503"},{code:"11504",severity:"error",description:"An error occurred while retrieving the semantic objects available.",key:"11504"},{code:"11505",severity:"error",description:"An error occurred while retrieving the actions for the given semantic object.",key:"11505"}];};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.navigationTarget')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2015 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.modeler.core.navigationTarget");(function(){'use strict';sap.apf.modeler.core.NavigationTarget=function(n,i,d){var s,a,b=false,r,t;if(d){s=d.semObject;a=d.actn;b=d.isStepSpecific;r=d.requestForFilterMapping;t=d.targetPropertiesForFilterMapping;}else{r={};t=new i.constructor.elementContainer("TargetPropertyForFilterMapping",undefined,i);}this.getId=function(){return n;};this.setSemanticObject=function(c){s=c;};this.getSemanticObject=function(){return s;};this.setAction=function(c){a=c;};this.getAction=function(){return a;};this.isGlobal=function(){return!b;};this.isStepSpecific=function(){return b;};this.setGlobal=function(){b=false;};this.setStepSpecific=function(){b=true;};this.setFilterMappingService=function(c){r.service=c;};this.getFilterMappingService=function(){return r.service;};this.setFilterMappingEntitySet=function(e){r.entitySet=e;};this.getFilterMappingEntitySet=function(){return r.entitySet;};this.addFilterMappingTargetProperty=function(p){t.createElementWithProposedId(undefined,p);};this.getFilterMappingTargetProperties=function(){var p=[];var c=t.getElements();c.forEach(function(e){p.push(e.getId());});return p;};this.removeFilterMappingTargetProperty=function(p){t.removeElement(p);};this.copy=function(c){var e={semObject:s,actn:a,isStepSpecific:b,requestForFilterMapping:r,targetPropertiesForFilterMapping:t};var d=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(e);return new sap.apf.modeler.core.NavigationTarget((c||this.getId()),i,d);};};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.registryWrapper')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.modeler.core.registryWrapper");(function(){'use strict';sap.apf.modeler.core.RegistryWrapper=function(h){function g(t){var r=[];if(h.getNumberOfItems()!==0){h.each(function(i,e){if(e.type===t){r.push(e);}});}return r;}this.getItem=function(k){return h.getItem(k);};this.getSteps=function(){return g("step");};this.getCategories=function(){return g("category");};this.getFacetFilters=function(){return g("facetFilter");};this.getNavigationTargets=function(){return g("navigationTarget");};};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.representation')){jQuery.sap.declare("sap.apf.modeler.core.representation");(function(){'use strict';sap.apf.modeler.core.Representation=function(r,i,d){var a,b,w,c,m,l,e,f,g,o,t;if(!d){w={};c=new i.constructor.elementContainer("dimension",undefined,i);m=new i.constructor.elementContainer("measure",undefined,i);o=new i.constructor.elementContainer("orderBy",undefined,i);}else{a=d.representationTypeId;b=d.alternateRepresentationTypeId;w=d.width;c=d.dimensions;m=d.measures;l=d.leftUpperCornerTextKey;e=d.rightUpperCornerTextKey;f=d.leftLowerCornerTextKey;g=d.rightLowerCornerTextKey;o=d.orderByProperties;t=d.topN;}this.getId=function(){return r;};this.setRepresentationType=function(h){a=h;};this.getRepresentationType=function(){return a;};this.setAlternateRepresentationType=function(h){b=h;};this.getAlternateRepresentationType=function(){return b;};this.getDimensions=function(){var h=[];c.getElements().forEach(function(j){h.push(j.propertyName);});return h;};this.addDimension=function(p,h){var j;if(c.getElement(p)){return null;}j={propertyName:p,textLabelKey:h};return c.createElementWithProposedId(j,p).getId();};this.removeDimension=function(p){c.removeElement(p);};this.setDimensionKind=function(p,k){var h=c.getElement(p);if(h){h.kind=k;}};this.getDimensionKind=function(p){var h=c.getElement(p);if(h){return h.kind;}return undefined;};this.setDimensionTextLabelKey=function(p,h){var j=c.getElement(p);if(j){j.textLabelKey=h;}};this.getDimensionTextLabelKey=function(p){var h=c.getElement(p);if(h){return h.textLabelKey;}return undefined;};this.getMeasures=function(){var h=[];m.getElements().forEach(function(j){h.push(j.propertyName);});return h;};this.addMeasure=function(p){var h;if(m.getElement(p)){return null;}h={propertyName:p};return m.createElementWithProposedId(h,p).getId();};this.removeMeasure=m.removeElement;this.setMeasureTextLabelKey=function(p,h){var j=m.getElement(p);if(j){j.textLabelKey=h;}};this.getMeasureTextLabelKey=function(p){var h=m.getElement(p);if(h){return h.textLabelKey;}return undefined;};this.setMeasureKind=function(p,k){var h=m.getElement(p);if(h){h.kind=k;}};this.getMeasureKind=function(p){var h=m.getElement(p);if(h){return h.kind;}return undefined;};this.setWidthProperty=function(p,h){w[p]=h;};this.getWidthProperties=function(){return w;};this.setLeftUpperCornerTextKey=function(h){l=h;};this.getLeftUpperCornerTextKey=function(){return l;};this.setRightUpperCornerTextKey=function(h){e=h;};this.getRightUpperCornerTextKey=function(){return e;};this.setLeftLowerCornerTextKey=function(h){f=h;};this.getLeftLowerCornerTextKey=function(){return f;};this.setRightLowerCornerTextKey=function(h){g=h;};this.getRightLowerCornerTextKey=function(){return g;};this.setTopN=function(h){t=h;};this.getTopN=function(){return t;};this.addOrderbySpec=function(p,h){var j;j=o.getElement(p);if(j){j.ascending=h;return j;}j={property:p,ascending:h};return o.createElementWithProposedId(j,p).getId();};this.removeOrderbySpec=function(p){o.removeElement(p);};this.getOrderbySpecifications=function(){var h=[];o.getElements().forEach(function(j){h.push({property:j.property,ascending:j.ascending});});return h;};this.copy=function(n){var h={representationTypeId:a,alternateRepresentationTypeId:b,width:w,dimensions:c,measures:m,leftUpperCornerTextKey:l,rightUpperCornerTextKey:e,leftLowerCornerTextKey:f,rightLowerCornerTextKey:g,orderByProperties:o,topN:t};var d=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(h);return new sap.apf.modeler.core.Representation((n||this.getId()),i,d);};};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.step')){jQuery.sap.declare("sap.apf.modeler.core.step");(function(){'use strict';sap.apf.modeler.core.Step=function(s,i,d){var r,a,b,f,c,e,t,n,k,g,l,h,j,m,o,p,q;q=i.instance.messageHandler;if(!d){r=new i.constructor.elementContainer(s+"-Representation",i.constructor.representation,i);a={};b=new i.constructor.elementContainer("SelectProperty",undefined,i);f=new i.constructor.elementContainer("FilterProperty",undefined,i);c={};e=new i.constructor.elementContainer("SelectPropertyForFilterMapping",undefined,i);t=new i.constructor.elementContainer("TargetPropertyForFilterMapping",undefined,i);k=false;n=new i.constructor.elementContainer("NavigationTarget",undefined,i);}else{r=d.representationContainer;a=d.request;b=d.selectProperties;f=d.filterProperties;c=d.requestForFilterMapping;e=d.selectPropertiesForFilterMapping;t=d.targetPropertiesForFilterMapping;k=d.keepSourceForFilterMapping;n=d.navigationTargets;g=d.titleId;l=d.longTitleId;h=d.leftUpperCornerTextKey;j=d.rightUpperCornerTextKey;m=d.leftLowerCornerTextKey;o=d.rightLowerCornerTextKey;p=d.topNSettings;}this.getId=function(){return s;};this.setTopN=function(u,v){this.resetTopN();p={};p.top=u;if(v&&v instanceof Array&&v.length>0){p.orderby=v;}else{q.putMessage(q.createMessageObject({code:11016}));return;}r.getElements().forEach(function(w){w.setTopN(u);p.orderby.forEach(function(v){w.addOrderbySpec(v.property,v.ascending);})});};this.getTopN=function(){if(p&&p.top>0){return jQuery.extend({},true,p);}else{return undefined;}};this.resetTopN=function(){p=undefined;r.getElements().forEach(function(u){u.setTopN(undefined);u.getOrderbySpecifications().forEach(function(v){u.removeOrderbySpec(v.property);})});};this.getService=function(){return a.service;};this.setService=function(u){a.service=u;};this.getEntitySet=function(){return a.entitySet;};this.setEntitySet=function(u){a.entitySet=u;};this.setTitleId=function(u){g=u;};this.getTitleId=function(){return g;};this.setLongTitleId=function(u){l=u;};this.getLongTitleId=function(){return l;};this.getSelectProperties=function(){var u=[];var v=b.getElements();v.forEach(function(w){u.push(w.getId());});return u;};this.addSelectProperty=function(u){b.createElementWithProposedId(undefined,u);};this.removeSelectProperty=function(u){b.removeElement(u);};this.getFilterProperties=function(){var u=[];var v=f.getElements();v.forEach(function(w){u.push(w.getId());});return u;};this.addFilterProperty=function(u){return f.createElementWithProposedId(undefined,u).getId();};this.removeFilterProperty=function(u){f.removeElement(u);};this.setFilterMappingService=function(u){c.service=u;};this.getFilterMappingService=function(){return c.service;};this.setFilterMappingEntitySet=function(u){c.entitySet=u;};this.getFilterMappingEntitySet=function(){return c.entitySet;};this.addFilterMappingTargetProperty=function(u){t.createElementWithProposedId(undefined,u);};this.getFilterMappingTargetProperties=function(){var u=[];var v=t.getElements();v.forEach(function(w){u.push(w.getId());});return u;};this.removeFilterMappingTargetProperty=function(u){t.removeElement(u);};this.addNavigationTarget=function(u){n.createElementWithProposedId(undefined,u);};this.getNavigationTargets=function(){var u=[];var v=n.getElements();v.forEach(function(w){u.push(w.getId());});return u;};this.removeNavigationTarget=function(u){n.removeElement(u);};this.setFilterMappingKeepSource=function(u){k=u;};this.getFilterMappingKeepSource=function(){return k;};this.getRepresentations=r.getElements;this.getRepresentation=r.getElement;this.createRepresentation=function(u){var v=r.createElement(u);if(p&&p.top){v.setTopN(p.top);p.orderby.forEach(function(w){v.addOrderbySpec(w.property,w.ascending);});}return v;};this.removeRepresentation=r.removeElement;this.copyRepresentation=r.copyElement;this.moveRepresentationBefore=function(u,v){return r.moveBefore(u,v);};this.moveRepresentationUpOrDown=function(u,v){return r.moveUpOrDown(u,v);};this.moveRepresentationToEnd=function(u){return r.moveToEnd(u);};this.setLeftUpperCornerTextKey=function(u){h=u;};this.getLeftUpperCornerTextKey=function(){return h;};this.setRightUpperCornerTextKey=function(u){j=u;};this.getRightUpperCornerTextKey=function(){return j;};this.setLeftLowerCornerTextKey=function(u){m=u;};this.getLeftLowerCornerTextKey=function(){return m;};this.setRightLowerCornerTextKey=function(u){o=u;};this.getRightLowerCornerTextKey=function(){return o;};this.copy=function(u){var v={request:a,selectProperties:b,filterProperties:f,requestForFilterMapping:c,selectPropertiesForFilterMapping:e,targetPropertiesForFilterMapping:t,navigationTargets:n,keepSourceForFilterMapping:k,titleId:g,longTitleId:l,leftUpperCornerTextKey:h,rightUpperCornerTextKey:j,leftLowerCornerTextKey:m,rightLowerCornerTextKey:o,topNSettings:p};var d=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(v);d.representationContainer=r.copy(u+"-Representation");return new sap.apf.modeler.core.Step((u||this.getId()),i,d);};};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.textHandler')){jQuery.sap.declare("sap.apf.modeler.core.textHandler");(function(){'use strict';sap.apf.modeler.core.TextHandler=function(){var b,B;this.getMessageText=function(r,p){return this.getText(r,p);};this.getText=function(r,p){var t;t=B.getText(r,p);if(t!==r){return t;}return b.getText(r,p);};function i(){var u;var I=sap.ui.getCore().getConfiguration().getOriginInfo();var m=jQuery.sap.getModulePath("sap.apf");u=m+'/modeler/resources/i18n/texts.properties';B=jQuery.sap.resources({url:u,includeInfo:I});u=m+'/resources/i18n/apfUi.properties';b=jQuery.sap.resources({url:u,includeInfo:I});}i();};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.utils.APFRouter')){jQuery.sap.declare('sap.apf.modeler.ui.utils.APFRouter');sap.apf.modeler.ui.utils.APFRouter={patternMatch:function(c){this.params={};var s=this;sap.ui.core.UIComponent.getRouterFor(c).attachRoutePatternMatched(function(e){var a={};s.params={name:e.getParameter("name"),arguments:e.getParameter("arguments")};if(s.params.name!=="applicationList"){var C=c.oCoreApi;c.appId=s.params.arguments.appId;c.configId=s.params.arguments.configId;C.getApplicationHandler(function(A){c.applicationHandler=A;c.appName=A.getApplication(c.appId).ApplicationName;var t=c.byId("idConfigTitleMaster").getText();if(t===""||s.params.name==="configurationList"){c.setConfigListMasterTitle(c.appName);}C.getConfigurationHandler(c.appId,function(b){c.configurationHandler=b;c.oTextPool=c.configurationHandler.getTextPool();if(c.configurationHandler.getList().length>c.getView().getModel().getData().aConfigDetails.length){c.createConfigList();if(s.params.name==="configurationList"){c.updateConfigListView();}}if(c.configurationHandler.getList().length===0&&(c.configId===undefined)){c.oTreeInstance.addNodeInTree(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION);var d=c.oTreeInstance.getNodes();var n=d[d.length-1];c.oTreeInstance.setSelectedNode(n);}if(c.configId!==undefined){var E=b.getConfiguration(c.configId);if(E){b.loadConfiguration(c.configId,function(f){c.configEditor=f;var p=c.getSPathForConfig(c.configId);if(c.oModel.getData().aConfigDetails[p.split('/')[2]].bIsLoaded===false){c.updateTree();if(s.params.name!=="navigationTarget"){s.setCurrentSelectionState(s.params,c);}}else{s.setCurrentSelectionState(s.params,c);}});}else{s.setCurrentSelectionState(s.params,c);}}});});}});},setCurrentSelectionState:function(p,c){var v=c.getSPathFromURL(p);if(p.name!=="configurationList"){if(v&&v.objectType){c.updateSubView(p);if(v.sPath){c.setSelectionOnTree(v.sPath);}c.updateTitleAndBreadCrumb();}else{c.showNoConfigSelectedText();c.removeSelectionOnTree();}}}};};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.utils.constants')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare('sap.apf.modeler.ui.utils.constants');sap.apf.modeler.ui.utils.CONSTANTS={configurationObjectTypes:{CONFIGURATION:"configuration",FACETFILTER:"facetFilter",CATEGORY:"category",STEP:"step",REPRESENTATION:"representation",NAVIGATIONTARGET:"navigationTarget",ISNEWCONFIG:"apf1972-"}};};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.utils.helper')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.apf.modeler.ui.utils.helper');sap.apf.modeler.ui.utils.helper={onResize:function(c){jQuery(window).resize(function(){c();});},applySize:function(w,h,c,o){var a,b;if(h!==undefined){if(h.getDomRef!==undefined){b=jQuery(h.getDomRef()).height();}else if(jQuery.isNumeric(h)){b=h;}else{b=jQuery(h).height();}}if(w!==undefined){if(w.getDomRef!==undefined){a=jQuery(h.getDomRef()).width();}else if(jQuery.isNumeric(w)){a=w;}else{b=jQuery(w).width();}}var d=(c.getDomRef!==undefined)?jQuery(c.getDomRef()):jQuery(c);var e=(o===undefined)?0:(o.offsetHeight||0);var f=(o===undefined)?0:(o.offsetWidth||0);d.css({height:(h===undefined)?"100%":b+e+"px",width:(w===undefined)?"100%":a+f+"px"});}};};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.utils.navigationHandler')){jQuery.sap.declare('sap.apf.modeler.ui.utils.navigationHandler');sap.apf.modeler.ui.utils.navigationHandler=(function(){var i,d={};var t=function(l,m){b(l,{isSwitchConfiguration:true},m);};var a=function(l,m){_(l,{isValidationCheck:true},m);};var _=function(l,s,m){var C=l.oCoreApi;var n=C.getText("mandatoryField");var o=Object.keys(s)[0];var p={_handleValidationNavigation:f,_handlePreventNavigation:j,configListInstance:l,callback:m};p[o]=s[o];d.oConfirmValidationDialog=sap.ui.xmlfragment("idMandatoryValidationDialogFragement","sap.apf.modeler.ui.fragment.mandatoryDialog",p);l.getView().addDependent(d.oConfirmValidationDialog);e(C,"validationDialog");var v=new sap.m.Label();v.addStyleClass("dialogText");v.setText(n);d.oConfirmValidationDialog.removeAllContent();d.oConfirmValidationDialog.addContent(v);d.oConfirmValidationDialog.open();};var b=function(l,s,m){var C=l.oCoreApi;var n=C.getText("unsavedConfiguration");var o=Object.keys(s)[0];var p={_handleNavigationWithSave:g,_handleNavigateWithoutSave:h,_handlePreventNavigation:j,configListInstance:l,callback:m};p[o]=s[o];d.oConfirmNavigationDialog=sap.ui.xmlfragment("idMessageDialogFragment","sap.apf.modeler.ui.fragment.messageDialog",p);l.getView().addDependent(d.oConfirmNavigationDialog);e(C,"naviagtionDialog");var q=new sap.m.Label();q.addStyleClass("dialogText");q.setText(n);d.oConfirmNavigationDialog.removeAllContent();d.oConfirmNavigationDialog.addContent(q);d.oConfirmNavigationDialog.open();};var c=function(d){d.close();d.destroy();};var e=function(C,l){if(l==="naviagtionDialog"){sap.ui.core.Fragment.byId("idMessageDialogFragment","idMessageDialog").setTitle(C.getText("warning"));sap.ui.core.Fragment.byId("idMessageDialogFragment","idYesButton").setText(C.getText("yes"));sap.ui.core.Fragment.byId("idMessageDialogFragment","idNoButton").setText(C.getText("no"));sap.ui.core.Fragment.byId("idMessageDialogFragment","idCancelButton").setText(C.getText("cancel"));}else if(l==="validationDialog"){sap.ui.core.Fragment.byId("idMandatoryValidationDialogFragement","idMandatoryValidationDialog").setTitle(C.getText("warning"));sap.ui.core.Fragment.byId("idMandatoryValidationDialogFragement","idYesButton").setText(C.getText("yes"));sap.ui.core.Fragment.byId("idMandatoryValidationDialogFragement","idNoButton").setText(C.getText("no"));}};var f=function(){var l=this.configListInstance;var m=this.callback;c(d.oConfirmValidationDialog);if(typeof m.yes==="function"){m.yes();}};var g=function(){var l=this.configListInstance;var m=this.callback;var s=function(m){l.configEditor.save(function(n,o,p){l.configId=n;if(p===undefined){if(typeof m==="function"){m();}var q=l.oCoreApi.getText("successOnSave");sap.m.MessageToast.show(q,{width:"20em"});}else{var M=l.oCoreApi.createMessageObject({code:"12000"});M.setPrevious(p);l.oCoreApi.putMessage(M);var r=l.oCoreApi.getText("errorOnSave");sap.m.MessageToast.show(r,{width:"20em"});}});};c(d.oConfirmNavigationDialog);if(typeof m.yes==="function"){m.yes(s);}};var h=function(){var l=this.configListInstance;var m=this.callback;c(d.oConfirmNavigationDialog);l.configurationHandler.resetConfiguration(l.configId);if(typeof m.no==="function"){m.no();}};var j=function(){var l=this.isTraverseBack;var m=this.isSwitchConfiguration;var n=this.isValidationCheck;var o=this.configListInstance;var p=this.callback;if(!n){c(d.oConfirmNavigationDialog);}else{c(d.oConfirmValidationDialog);}if(typeof p.cancel==="function"){p.cancel();}else if(typeof p.no==="function"&&n){p.no();}};var k=function(){return{throwLossOfDataPopup:t,throwMandatoryPopup:a};};return{getInstance:function(){return i||(i=k());}};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.utils.textPoolHelper')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare('sap.apf.modeler.ui.utils.textPoolHelper');sap.apf.modeler.ui.utils.TextPoolHelper=function(t){this.oTextPool=t;};sap.apf.modeler.ui.utils.TextPoolHelper.prototype={setAutoCompleteOn:function(i,d){i.setShowSuggestion(true);var s=[];if(d.type==="text"){var e=this._getSuggestionItems(d.oTranslationFormat);e.forEach(function(t){var o={};o.suggetionText=t.TextElementDescription;s.push(o);});}else if(d.type==="service"){var E=d.oConfigurationEditor.getAllServices();E.forEach(function(a){var o={};o.suggetionText=a;s.push(o);});}var I=i.getModel();var m=I||new sap.ui.model.json.JSONModel({});if(!m.getData().suggestions){m.getData().suggestions=s;}if(!I){i.setModel(m);}i.bindAggregation("suggestionItems",{path:"/suggestions",template:new sap.ui.core.Item({text:"{suggetionText}"})});i.attachSuggest(this._handleSuggestion);},_handleSuggestion:function(e){var v=e.getParameter("suggestValue");var f=new sap.ui.model.Filter("suggetionText",sap.ui.model.FilterOperator.Contains,v);e.getSource().getBinding("suggestionItems").filter([f]);},_getSuggestionItems:function(t){return this.oTextPool.getTextsByTypeAndLength(t.TextElementType,t.MaximumLength);}};sap.apf.modeler.ui.utils.TranslationFormatMap={APPLICATION_TITLE:{TextElementType:"XTIT",MaximumLength:250},CATEGORY_TITLE:{TextElementType:"XTIT",MaximumLength:60},FACETFILTER_LABEL:{TextElementType:"XFLD",MaximumLength:50},STEP_TITLE:{TextElementType:"XTIT",MaximumLength:100},STEP_LONG_TITLE:{TextElementType:"XTIT",MaximumLength:200},STEP_CORNER_TEXT:{TextElementType:"XFLD",MaximumLength:25},REPRESENTATION_LABEL:{TextElementType:"XTIT",MaximumLength:80},REPRESENTATION_CORNER_TEXT:{TextElementType:"XFLD",MaximumLength:25}};};if(!jQuery.sap.isDeclared('sap.apf.ui.controls.draggableCarousel.DraggableCarousel')){jQuery.sap.declare("sap.apf.ui.controls.draggableCarousel.DraggableCarousel");(function(u){"use strict";var a;var d=(function(){a=window.hasOwnProperty('ontouchstart')||window.hasOwnProperty('onmsgesturechange');}());sap.apf.ui.controls.draggableCarousel.DraggableCarousel=function(o){var b=o||{};this.eleRefs={blocks:[],containerEle:o.containerEle};this._editState=b.editable===u?true:b.editable;this._dragState=this._editState;this._removeState=this._editState;this.styles={containerHeight:b.containerHeight,containerWidth:b.containerWidth,blockHeight:b.blockHeight,blockWidth:b.blockWidth,blockMargin:b.blockMargin,separatorHeight:b.separatorHeight,removeIconHeight:b.removeIconHeight};this.elems={separator:b.separator,removeIcon:b.removeIcon};this.callbacks={onBeforeDrag:b.onBeforeDrag,onAfterDrop:b.onAfterDrop,onAfterRemove:b.onAfterRemove,onAfterSelect:b.onAfterSelect};this.eleRefs.containerEle=this._drawSkeleton();this._initDimensions();this._isMouseDown=false;};sap.apf.ui.controls.draggableCarousel.DraggableCarousel.prototype={_initDimensions:function(){var m=this.styles.blockMargin;this._blockMargin=parseInt(m.replace("px"),10);var b=this.styles.blockHeight;this._blockHeight=parseInt(b.replace("px"),10);this._blockTotalHeight=this._blockHeight+(2*this._blockMargin);this._separatorHeight=0;if(this.elems.separator!==u){var s=this.styles.separatorHeight;this._separatorHeight=parseInt(s.replace("px"),10);}this._mFactor=this._blockTotalHeight+this._separatorHeight;},_drawSkeleton:function(){var c;if(this.eleRefs.containerEle===u){c=document.createElement('div');}else{c=this.eleRefs.containerEle;}c.style.cssText+=this._getContainerStyles();c.classList.add('DnD-container');var s=this;var t=a?"touchend":"mouseup";document.addEventListener(t,function(e){s._onMouseUp(e,s);});return c;},_getBlockWrapper:function(b){var c=b.blockElement;var f=this.eleRefs.blocks;var g=b.dragState===u?true:b.dragState;var h=b.dropState===u?true:b.dropState;var r=b.removable===u?true:b.removable;var i=document.createElement('div');i.style.cssText+=this._getBlockStyles();i.setAttribute('class','DnD-block');i.setAttribute('drag-state',g);i.setAttribute('drop-state',h);if(r){var j=this._getRemoveIconEle();i.appendChild(j);}var s=this;var t=a?"touchstart":"mousedown";i.addEventListener(t,function(e){s._onMouseDown(e,s,this);});var k=a?"touchmove":"mousemove";i.addEventListener(k,function(e){window.clearTimeout(s._TIMEOUTID);});this._keypress(i,13,function(l,e){var m=f.indexOf(l);s.callbacks.onAfterSelect.apply(l,[m]);});this._keypress(i,32,function(l,e){var m=f.indexOf(l);s.callbacks.onAfterSelect.apply(l,[m]);});this._keypress(i,36,function(l,e){jQuery(f).removeAttr("tabindex");jQuery(f).attr("tabindex",-1);jQuery(f[0]).attr("tabindex",0);jQuery(f[0]).focus();});this._keypress(i,35,function(l,e){jQuery(f).removeAttr("tabindex");jQuery(f).attr("tabindex",-1);jQuery(f[f.length-1]).attr("tabindex",0);jQuery(f[f.length-1]).focus();});if(r===true){this._keypress(i,46,function(l,e){var m=f.indexOf(l);s.removeBlock(m,s.callbacks.onAfterRemove);s._grouping(f);jQuery(f).parent().wrap("<div>").find("[tabindex='0']").focus();});}i.appendChild(c);return i;},_getSeparatorEle:function(){var s=document.createElement('div');s.style.cssText+=this._getSeparatorStyles();s.setAttribute('class','DnD-separator');s.innerHTML=this.elems.separator.outerHTML;return s;},_getRemoveIconEle:function(){var r=this.elems.removeIcon;var b=document.createElement('div');b.style.cssText+=this._getRemoveIconStyles();b.setAttribute('class','DnD-removeIconWrapper');b.innerHTML=r.outerHTML;var s=this;var t=a?"touchstart":"mousedown";b.addEventListener(t,function(e){s._onRemoveBlock(e,s,this);});return b;},addBlock:function(b){if(b instanceof Array){var i;for(i=0;i<b.length;i++){this.addBlock(b[i]);}return;}var c=this._getBlockWrapper(b);var e=this.eleRefs.blocks.length;var f=this.eleRefs.blocks;var s=this;var y=e*this._mFactor;c.style.cssText=c.style.cssText+this._getTransformCss(y);this.eleRefs.blocks.push(c);var g=this.eleRefs.containerEle;g.appendChild(c);this._setHorizontalBlockMargin();if(this.elems.separator!==u){var h=this._getSeparatorEle();var j=y+this._blockHeight+2*this._blockMargin;h.style.cssText=h.style.cssText+this._getTransformCss(j);g.appendChild(h);}this._grouping(f);},swapBlocks:function(f,t){var b=this.eleRefs.blocks[f];var c=this.eleRefs.blocks[t];if((b.getAttribute('drag-state')!=="true"&&b.getAttribute('drop-state')!=="true")||(c.getAttribute('drag-state')!=="true"&&c.getAttribute('drop-state')!=="true")){return false;}var e=f*this._mFactor;var g=t*this._mFactor;var h=g;var i=h+this._blockHeight+(2*this._blockMargin);var j=document.getElementsByClassName('scrollContainerEle')[0]?document.getElementsByClassName('scrollContainerEle')[0]:this.eleRefs.containerEle;var s=j.scrollTop;if((f>t)&&h<j.scrollTop){s=h;}if((f<t)&&i-j.offsetHeight>j.scrollTop){s=i-j.offsetHeight;}var p;var k=40;var l=window.setInterval(function(){j.scrollTop+=(s-j.scrollTop)/k;if(j.scrollTop===p){window.clearInterval(l);}p=j.scrollTop;},1000/60);this._setTransformYValue(b,g);this._setTransformYValue(c,e);this._swapArray(this.eleRefs.blocks,f,t);return true;},insertBlock:function(b,c){var e=this.eleRefs.blocks;e.push({});var i;for(i=e.length-1;i>c;i--){e[i]=e[i-1];var f=i*this._mFactor;this._setTransformYValue(e[i],f);}var g=this._getBlockWrapper(b);e[i]=g;var y=c*this._mFactor;g.style.cssText=g.style.cssText+this._getTransformCss(y);var h=this.eleRefs.containerEle;h.appendChild(g);this._setHorizontalBlockMargin();if(this.elems.separator!==u){var s=this._getSeparatorEle();var j=y+this._blockHeight+2*this._blockMargin;s.style.cssText=s.style.cssText+this._getTransformCss(j);h.appendChild(s);}this._grouping(e);},removeBlock:function(b,c){var e=this.eleRefs.blocks;var f=this.eleRefs.containerEle;var i;var r=e[b];f.removeChild(r);for(i=b;i<e.length-1;i++){e[i]=e[i+1];var y=i*this._mFactor;this._setTransformYValue(e[i],y);}e.pop();if(this.elems.separator!==u){var s=f.querySelectorAll('.DnD-separator');var l=s[s.length-1];f.removeChild(l);}c.apply(f,[b]);this._grouping(e);},placeAt:function(i){var e=document.getElementById(i);e.appendChild(this.eleRefs.containerEle);this._setHorizontalBlockMargin();},getEditable:function(){return this._editState;},setEditable:function(e){this._editState=e;this._setDragState(e);this._setRemoveState(e);},_setDragState:function(b){this._dragState=b;},_setRemoveState:function(r){this._removeState=r;var b=this.eleRefs.containerEle.querySelectorAll('.DnD-removeIconWrapper');var c;if(r){c="display : block";}else{c="display : none";}var i;for(i=0;i<b.length;i++){b[i].style.cssText+=c;}},_getContainerStyles:function(){var s=["height : ",this.styles.containerHeight,";width : ",this.styles.containerWidth,"overflow : auto; position : relative"].join("");return s;},_getBlockStyles:function(){if(this.styles.horizontalBlockMargin===u){var c=this.eleRefs.containerEle.clientWidth;var b=this.eleRefs.blocks[0]===u?0:this.eleRefs.blocks[0].clientWidth;this.styles.horizontalBlockMargin=((c-b)/2)+"px";}var s=["height : ",this.styles.blockHeight,";width : ",this.styles.blockWidth,";margin : ",this.styles.blockMargin," ",this.styles.horizontalBlockMargin,";position : absolute"].join("");return s;},_getSeparatorStyles:function(){var s=["height : ",this.styles.separatorHeight,";width : 100%",";position : absolute"].join("");return s;},_getRemoveIconStyles:function(){var s=["height : ",this.styles.removeIconHeight,";width : ",this.styles.removeIconHeight,";float : right",";margin : -10px -13px -10px 0",";z-index : 2",";position : relative",";cursor : pointer"].join("");if(this._removeState){s+=";display : block";}else{s+=";display : none";}return s;},_getTransformCss:function(y){var Y=y+"px";var t=["transform","-webkit-transform","-moz-transform","-ms-transform","-o-transform"];var c="";var i;for(i=0;i<t.length;i++){c+=t[i]+": translate3d(0px,"+Y+", 0px); ";}return c;},_setTransformYValue:function(e,y){var v=[{"WebkitTransform":"-webkit-transform"},{"MozTransform":"-moz-transform"},{"MsTransform":"-ms-transform"},{"OTransform":"-o-transform"}];var t="transform";var i;for(i=0;i<v.length;i++){if(e.style.hasOwnProperty(Object.keys(v[i])[0])){t=v[i][Object.keys(v[i])[0]];}}var Y=y+'px';e.style.cssText=e.style.cssText+" "+t+": translate3d(0px,"+Y+", 0px);";},_setHorizontalBlockMargin:function(){var b=this.eleRefs.blocks;var c=this.eleRefs.containerEle;var e=b[0]===u?0:b[0].clientWidth;var f=c.clientWidth;this.styles.horizontalBlockMargin=((f-e)/2)+"px";var m=this.styles.horizontalBlockMargin;[].forEach.call(b,function(g){g.style.cssText+="margin-right : "+m+";margin-left : "+m;});},_onMouseDown:function(e,c,b){c._isMouseDown=true;c._TIMEOUTID=window.setTimeout(function(){if(c._isMouseDown){c._onDragStart(e,c,b);}},500);},_onMouseUp:function(e,c){c._isMouseDown=false;if(c._dragEle!==u&&c._dragEle.ele!==u){c._onDrop(e,c);}},_onDragStart:function(e,c,b){if(!c._dragState||b.getAttribute('drag-state')!=='true'){return;}c._dragIndex=c.eleRefs.blocks.indexOf(b);var y=c._dragIndex*c._mFactor;var f=document.getElementsByClassName('scrollContainerEle')[0]?document.getElementsByClassName('scrollContainerEle')[0]:c.eleRefs.containerEle;c._containerEleOffsetHeight=f.offsetHeight;c._containerEleScrollHeight=f.scrollHeight;c._blockEleOffsetHeight=b.offsetHeight;c._containerEleScrollTop=f.scrollTop;var g=y+c._blockMargin;var h=g+c._blockHeight;if(g<c._containerEleScrollTop){f.scrollTop=g;c._containerEleScrollTop=Math.max(0,g);}if(h-c._containerEleOffsetHeight>f.scrollTop){f.scrollTop=h-c._containerEleOffsetHeight;c._containerEleScrollTop=Math.min(c._containerEleScrollHeight-c._containerEleOffsetHeight,h-c._containerEleOffsetHeight);}c._diffTop=e.pageY-y+c._containerEleScrollTop;c._dragEle={ele:b,pos:{y:y}};c.callbacks.onBeforeDrag.apply(b,[c._dragIndex]);c._dragEle.ele.className=c._dragEle.ele.className+" "+"DnD-drag";var t=a?"touchmove":"mousemove";document.addEventListener(t,function(e){if(c._dragEle.ele!==u){e.preventDefault();c._onDrag(e,c);e.stopPropagation();}});},_onDrag:function(e,c){var b=document.getElementsByClassName('scrollContainerEle')[0]?document.getElementsByClassName('scrollContainerEle')[0]:c.eleRefs.containerEle;var y=e.pageY-c._diffTop+c._containerEleScrollTop;var f=y+c._blockMargin;var g=f+c._blockHeight;var h=((e.pageY-c._diffTop)>c._prevPageY);var j=((e.pageY-c._diffTop)<c._prevPageY);c._prevPageY=(e.pageY-c._diffTop);if(j&&(f<c._containerEleScrollTop)){b.scrollTop=f;c._containerEleScrollTop=Math.max(0,f);y=e.pageY-c._diffTop+c._containerEleScrollTop;}if(h&&((g-c._containerEleOffsetHeight)>c._containerEleScrollTop)){b.scrollTop=g-c._containerEleOffsetHeight;c._containerEleScrollTop=Math.min(c._containerEleScrollHeight-c._containerEleOffsetHeight,g-c._containerEleOffsetHeight);y=e.pageY-c._diffTop+c._containerEleScrollTop;}c._setTransformYValue(c._dragEle.ele,y);var m=c.styles.blockMargin;var k=parseInt(m.replace("px"),10);var l=y;var n=y+c._blockEleOffsetHeight;var o=c._dragEle.pos.y-(c._mFactor-(c._blockHeight/2));var p=(c._dragEle.pos.y+c._blockEleOffsetHeight)+(c._mFactor-(c._blockHeight/2));var q=c._dragEle.pos.y;var r=q/(c._mFactor);var s=c.eleRefs.blocks;var t=-1,v=s.length;var i,w;for(i=r-1;i>=0;i--){w=s[i];if(w.getAttribute('drop-state')==='true'){t=i;break;}}for(i=r+1;i<s.length;i++){w=s[i];if(w.getAttribute('drop-state')==='true'){v=i;break;}}o=c._dragEle.pos.y-((r-t)*c._mFactor-(c._blockHeight/2));p=(c._dragEle.pos.y+c._blockEleOffsetHeight)+((v-r)*c._mFactor-(c._blockHeight/2));var x;var S=false;if(l<o){S=true;x=t;}else if(n>p){S=true;x=v;}if(S&&(x>=0)&&(x<=s.length-1)){c._dragEle.pos.y=x*(c._mFactor);var z=s[x];if(z!==u){c._setTransformYValue(z,q);c._swapArray(s,r,x);}}},_onDrop:function(e,c){c._dragEle.ele.className=c._dragEle.ele.className.replace(" DnD-drag","");var b=c.eleRefs.containerEle.querySelectorAll('.DnD-drag');var i;for(i=0;i<b.length;i++){b[i].className=b[i].className.replace(" DnD-drag","");}var f=c._dragEle.pos.y;c._dropIndex=f/(c._mFactor);c._setTransformYValue(c._dragEle.ele,f);c.callbacks.onAfterDrop.apply(c._dragEle.ele,[c._dragIndex,c._dropIndex]);c._dragEle={};},_onRemoveBlock:function(e,c,r){e.stopPropagation();var b=r.parentElement;var f=c.eleRefs.blocks.indexOf(b);c.removeBlock(f,c.callbacks.onAfterRemove);},_swapArray:function(b,f,t){var c=b[f];b[f]=b[t];b[t]=c;return b;},_grouping:function(b){var c=b;var f=(b.length>2)?b.length-2:0;jQuery(c).removeAttr("tabindex");jQuery(c).attr("tabindex",-1);jQuery(c[f]).attr("tabindex",0);this._keypress(c,38,function(g,e){var i=c.indexOf(g);if(i===0){return;}jQuery(c).removeAttr("tabindex");jQuery(c).attr("tabindex",-1);jQuery(c[i-1]).attr("tabindex",0);jQuery(c[i-1]).focus();});this._keypress(c,40,function(g,e){var i=c.indexOf(g);if(i===c.length-1){return;}jQuery(c).removeAttr("tabindex");jQuery(c).attr("tabindex",-1);jQuery(c[i+1]).attr("tabindex",0);jQuery(c[i+1]).focus();});},_keypress:function(b,k,c){jQuery(b).keydown(function(e){var f=e.keyCode||e.which;if(f===k){c(this,e);return false;}});}};}(undefined));};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.representationInterface')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.apf.ui.representations.representationInterface');(function(){'use strict';sap.apf.ui.representations.RepresentationInterfaceProxy=function(c,u){this.type='RepresentationInterfaceProxy';this.putMessage=function(m){return c.putMessage(m);};this.createMessageObject=function(C){return c.createMessageObject(C);};this.getActiveStep=function(){return c.getActiveStep();};this.setActiveStep=function(s){return c.setActiveStep(s);};this.getTextNotHtmlEncoded=function(l,p){return c.getTextNotHtmlEncoded(l,p);};this.updatePath=function(s){return c.updatePath(s);};this.createFilter=function(){return c.createFilter();};this.selectionChanged=function(r){return u.selectionChanged(r);};this.getEventCallback=function(e){return u.getEventCallback(e);};};sap.apf.ui.representations.representationInterface=function(d,c){this.setData=function(m,D){};this.getSelectionAsArray=function(){return[0,2];};this.adoptSelection=function(s){};this.getFilterMethodType=function(){return sap.apf.constants.filterMethodTypes.selectionAsArray;};this.getRequestOptions=function(){return{};};this.getParameter=function(){var p={dimensions:[],measures:[]};return p;};this.getMainContent=function(){var u={};return u;};this.getThumbnailContent=function(){var u={};return u;};this.getPrintContent=function(){var u={};return u;};this.getTooltipContent=function(){var u={};return u;};this.removeAllSelection=function(){};this.serialize=function(){var s={};return s;};this.deserialize=function(s){};this.getAlternateRepresentation=function(){return this.oAlternateRepresentation;};this.getMetaData=function(){return this.metadata;};this.getData=function(){return this.aDataResponse;};};}());};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.utils.UI5ChartHelper')){jQuery.sap.declare("sap.apf.ui.representations.utils.UI5ChartHelper");sap.apf.ui.representations.utils.UI5ChartHelper=function(a,p){var s=this;this.parameter=p;this.classifiedData=[];this.extendedDataSet=[];this.fieldKeysLookup={};this.displayNameLookup={};this.fieldNameLookup={};this.filterLookup={};this.datasetObj={};this.cachedSelection=[];this.filterValues=[];this.dataAlreadySorted=false;this.init=function(D,m,i,o,f){this.metadata=m;this.formatter=f;b.bind(this)(m,D);c.bind(this)(D);d.bind(this)(i,o);if(this.parameter.requiredFilters!==undefined&&this.parameter.requiredFilters.length!==0){v();}};var v=function(){s.filterValues=s.filterValues.filter(function(f){for(var i=0;i<s.extendedDataResponse.length;i++){var h=0;for(var j=0;j<s.parameter.requiredFilters.length;j++){if(f[j]===s.extendedDataResponse[i][s.parameter.requiredFilters[j]]){h=h+1;}}if(h===s.parameter.requiredFilters.length){return true;}else if(i===s.extendedDataResponse.length-1){return false;}}});s.cachedSelection=e();};var b=function(m,D){var f=this.parameter.dimensions.concat(this.parameter.measures);var r=[];var h=function(n){var o=0;for(var i=0;i<f.length;i++){if(f[i].fieldName===n){o++;}}return(o===0?false:true);};if(this.parameter.requiredFilters){this.parameter.requiredFilters.forEach(function(n){if(!h(n)){var o={fieldName:n};r.push(o);}});}if(r.length!==0){f=f.concat(r);}for(var i=0;i<f.length;i++){var j=f[i];var k=j.fieldName;this.displayNameLookup[k]={};if(m!==undefined){if(m.getPropertyMetadata(k).hasOwnProperty('text')&&(m.getPropertyMetadata(k)["aggregation-role"]!=="measure")){var t=m.getPropertyMetadata(k).text;var l=m.getPropertyMetadata(t).label;this.displayNameLookup[k].DISPLAY_NAME=l;this.displayNameLookup[k].VALUE="formatted_"+k;}else if(m.getPropertyMetadata(k)["aggregation-role"]==="dimension"){this.displayNameLookup[k].DISPLAY_NAME=m.getPropertyMetadata(k).label;this.displayNameLookup[k].VALUE="formatted_"+k;}else{this.displayNameLookup[k].DISPLAY_NAME=m.getPropertyMetadata(k).label;this.displayNameLookup[k].VALUE=k;}if(j.fieldDesc!==undefined&&a.getTextNotHtmlEncoded(j.fieldDesc).length){this.displayNameLookup[k].DISPLAY_NAME=a.getTextNotHtmlEncoded(j.fieldDesc);}if(m.getPropertyMetadata(k).unit!==undefined){var u=m.getPropertyMetadata(k).unit;var U;if(D!==undefined&&D.length!==0){U=D[0][u];this.displayNameLookup[k].DISPLAY_NAME=this.displayNameLookup[k].DISPLAY_NAME+' ('+U+')';}}}this.fieldNameLookup[this.displayNameLookup[k].DISPLAY_NAME]={};this.fieldNameLookup[this.displayNameLookup[k].DISPLAY_NAME].FIELD_NAME=k;this.fieldNameLookup[this.displayNameLookup[k].DISPLAY_NAME].VALUE=this.displayNameLookup[k].VALUE;}};var c=function(D){this.extendedDataResponse=jQuery.extend([],true,D);var i,j,k;if(this.extendedDataResponse.length!==0){for(i=0;i<this.extendedDataResponse.length;i++){for(k=0;k<this.parameter.measures.length;k++){if(this.extendedDataResponse[i][this.parameter.measures[k].fieldName]!==null){this.extendedDataResponse[i][this.parameter.measures[k].fieldName]=parseFloat(this.extendedDataResponse[i][this.parameter.measures[k].fieldName]);}}for(j=0;j<Object.keys(this.displayNameLookup).length;j++){var f=Object.keys(this.displayNameLookup)[j];var h=(this.displayNameLookup[f].VALUE.search('formatted_')!==-1);if(h){var t=this.metadata.getPropertyMetadata(f).hasOwnProperty('text');if(!t){this.extendedDataResponse[i][this.displayNameLookup[f].VALUE]=this.formatter.getFormattedValue(f,this.extendedDataResponse[i][f]);}else{var l=this.metadata.getPropertyMetadata(f).text;var T={text:this.extendedDataResponse[i][l],key:this.extendedDataResponse[i][f]};this.extendedDataResponse[i][this.displayNameLookup[f].VALUE]=this.formatter.getFormattedValueForTextProperty(f,T);}}}var m="";for(j=0;j<this.parameter.dimensions.length;j++){var n=this.displayNameLookup[this.parameter.dimensions[j].fieldName].VALUE;this.extendedDataResponse[i][n]=this.extendedDataResponse[i][n]===null?this.extendedDataResponse[i][n]:this.extendedDataResponse[i][n].toString();m=m+this.extendedDataResponse[i][n];this.filterLookup[m]=[];if(this.parameter.requiredFilters){for(k=0;k<this.parameter.requiredFilters.length;k++){var o={};o.id=this.extendedDataResponse[i][this.parameter.requiredFilters[k]];o.text=this.extendedDataResponse[i][this.displayNameLookup[this.parameter.requiredFilters[k]].VALUE];this.filterLookup[m].push(o);}}}}}else{var q={};for(k=0;k<this.parameter.measures.length;k++){q[s.displayNameLookup[this.parameter.measures[k].fieldName].VALUE]=undefined;}for(j=0;j<this.parameter.dimensions.length;j++){q[s.displayNameLookup[this.parameter.dimensions[j].fieldName].VALUE]=undefined;}this.extendedDataResponse.push(q);}};var d=function(I,D){var o=this.extendedDataResponse;var m=new sap.ui.model.json.JSONModel();m.setData({data:o});var f=[];var M=[];var i=0;for(i=0;i<this.parameter.dimensions.length;i++){f[i]={name:this.displayNameLookup[this.parameter.dimensions[i].fieldName].DISPLAY_NAME,value:this.displayNameLookup[this.parameter.dimensions[i].fieldName].VALUE,kind:this.parameter.dimensions[i].kind?this.parameter.dimensions[i].kind:undefined,axisfeedItemId:this.parameter.dimensions[i].axisfeedItemId?this.parameter.dimensions[i].axisfeedItemId:undefined};}s.measureAxisType=I;for(i=0;i<this.parameter.measures.length;i++){M[i]={name:this.displayNameLookup[this.parameter.measures[i].fieldName].DISPLAY_NAME,value:this.displayNameLookup[this.parameter.measures[i].fieldName].VALUE,kind:this.parameter.measures[i].kind?this.parameter.measures[i].kind:undefined,axisfeedItemId:this.parameter.measures[i].axisfeedItemId?this.parameter.measures[i].axisfeedItemId:undefined};}var P={dimensions:f,measures:M};var h=D.getDataset(P);if(this.metadata!==undefined){for(i=0;i<this.parameter.dimensions.length;i++){var j=this.metadata.getPropertyMetadata(this.parameter.dimensions[i].fieldName);if(j.isCalendarYearMonth==="true"){if(this.parameter.dimensions.length>1){h.data.sorter=new sap.ui.model.Sorter(this.parameter.dimensions[0].fieldName,false);}}}}this.datasetObj=h;};this.getDataset=function(){return new sap.viz.ui5.data.FlattenedDataset(this.datasetObj);};this.getModel=function(){var o=this.extendedDataResponse;var m=new sap.ui.model.json.JSONModel();m.setData({data:o});return m;};this.getFilterCount=function(){return this.filterValues.length;};this.getFilters=function(){var f=Object.keys(this.filterLookup);var F=[];var s=this;var h=function(k){for(var i=0;i<f.length;i++){var l={};var m=f[i];for(var j=0;j<s.filterLookup[m].length;j++){if(k===s.filterLookup[m][j].id){l.id=k;l.text=s.filterLookup[m][j].text;F.push(l);return;}}}};for(var i=0;i<this.filterValues.length;i++){h(this.filterValues[i][0]);}return F;};this.getSelectionFromFilter=function(){if(this.parameter.requiredFilters===undefined||this.parameter.requiredFilters.length===0){return[];}var h=e();return h;};this.getHighlightPointsFromSelectionEvent=function(f){var h=[];var n=[];h=g(f,this.cachedSelection);for(var i=0;i<h.length;i++){var k=h[i];if(this.parameter.measures.length===1){var m=this.displayNameLookup[this.parameter.measures[0].fieldName].DISPLAY_NAME;if(k.data[m]===undefined||k.data[m]===null){continue;}}var l="";for(var j=0;j<this.parameter.dimensions.length;j++){var o=this.displayNameLookup[this.parameter.dimensions[j].fieldName].DISPLAY_NAME;l=l+k.data[o];}var q=this.filterLookup[l];var r=this.filterValues.filter(function(t){var u=0;for(var i=0;i<s.parameter.requiredFilters.length;i++){if(t[i]===q[i].id){u=u+1;}else{break;}}if(u===s.parameter.requiredFilters.length){return true;}else if(i===s.parameter.requiredFilters.length){return false;}});if(r.length===0){var M=q.map(function(t){return t.id;});this.filterValues.push(M);}}n=e();this.cachedSelection=n;return n;};var g=function(f,n){var h=f.filter(function(k){for(var i=0;i<n.length;i++){var l=0;for(var j=0;j<Object.keys(k.data).length;j++){if(n[i].data[Object.keys(k.data)[j]]===k.data[Object.keys(k.data)[j]]){l=l+1;}else{break;}}if(l===Object.keys(k.data).length){return false;}else if(j===Object.keys(k.data).length){return true;}}return true;});return h;};this.getFilterFromSelection=function(){var r=[];var i;for(i=0;i<s.filterValues.length;i++){r.push(s.filterValues[i][0]);}var f=a.createFilter();var E=f.getOperators().EQ;var F;var A=f.getTopAnd().addOr('exprssionOr');for(i=0;i<r.length;i++){var h=this.metadata.getPropertyMetadata(s.parameter.requiredFilters[0]).dataType.type;if(h==="Edm.Int32"){r[i]=r[i]===null?r[i]:parseFloat(r[i]);}F={id:r[i],name:s.parameter.requiredFilters[0],operator:E,value:r[i]};A.addExpression(F);}return f;};var e=function(){var r=[];r[0]=[];var i,j,k,l;for(i=0;i<s.filterValues.length;i++){r[0].push(s.filterValues[i][0]);}var n=[];for(i=0;i<s.extendedDataResponse.length;i++){var f=s.extendedDataResponse[i];for(j=0;j<r[0].length;j++){var h=0;for(k=0;k<r.length;k++){if(f[s.parameter.requiredFilters[k]]===r[k][j]){h=h+1;}}if(h===r.length){var m={data:{}};var o;var q;for(k=0;k<s.getDataset().getDimensions().length;k++){var t=s.getDataset().getDimensions()[k].getName();var u=s.fieldNameLookup[t].VALUE;m.data[t]=f[u];}if(!s.measureAxisType){var w;var x;for(l=0;l<s.getDataset().getMeasures().length;l++){var y=jQuery.extend(true,{},m);w=s.getDataset().getMeasures()[l].getName();x=s.fieldNameLookup[w].VALUE;y.data[w]=f[x]===null?f[x]:parseFloat(f[x]);n.push(y);}}else{for(k=0;k<s.getDataset().getMeasures().length;k++){o=s.getDataset().getMeasures()[k].getName();q=s.fieldNameLookup[o].VALUE;m.data[o]=f[q]===null?f[q]:parseFloat(f[q]);}n.push(m);}}}}return n;};this.getHighlightPointsFromDeselectionEvent=function(f){var i,j;var h=g(this.cachedSelection,f);for(i=0;i<h.length;i++){var k=h[i];var l="";for(j=0;j<this.parameter.dimensions.length;j++){var m=this.displayNameLookup[this.parameter.dimensions[j].fieldName].DISPLAY_NAME;l=l+k.data[m];}var n=this.filterLookup[l];this.filterValues=this.filterValues.filter(function(q,r){var t=0;for(var i=0;i<n.length;i++){if(n[i].id===q[i]){t=t+1;}}if(t===n.length){return false;}else{return true;}});}var o=e();this.cachedSelection=o;return o;};this.destroy=function(){if(s.formatter){s.formatter.destroy();s.formatter=null;}s.metadata=null;s.extendedDataResponse=null;};};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.utils.vizDatasetHelper')){jQuery.sap.declare("sap.apf.ui.representations.utils.vizDatasetHelper");sap.apf.ui.representations.utils.VizDatasetHelper=function(i){var g=function(k){var n;var s=sap.apf.core.constants.representationMetadata.kind;if(!i){if(k===s.LEGEND){n=2;}else if(k===s.XAXIS||k===s.SECTORCOLOR){n=1;}}else{if(k===s.REGIONCOLOR){n=1;}else if(k===s.REGIONSHAPE){n=2;}}return n;};this.getDataset=function(p){this.parameter=p;var d=[];var m=[];this.parameter.dimensions.forEach(function(a,b){if(a.kind!==undefined){d[b]={name:a.name,value:'{'+a.value+'}',axis:g(a.kind)};}else{d[b]={name:a.name,value:'{'+a.value+'}',axis:b===0?1:2};}});this.parameter.measures.forEach(function(a,b){var A;if(i){A=sap.apf.ui.utils.CONSTANTS.axisTypes.GROUP;}else{A=sap.apf.ui.utils.CONSTANTS.axisTypes.AXIS;}if(a.kind!==undefined){m[b]={name:a.name,value:'{'+a.value+'}'};var s=sap.apf.core.constants.representationMetadata.kind;switch(a.kind){case s.XAXIS:m[b][A]=1;break;case s.YAXIS:if(!i){m[b][A]=1;}else{m[b][A]=2;}break;case s.SECTORSIZE:m[b][A]=1;break;case s.BUBBLEWIDTH:m[b][A]=3;break;case s.BUBBLEHEIGHT:m[b][A]=4;break;default:break;}}else{m[b]={name:a.name,value:'{'+a.value+'}'};m[b][A]=b+1;}});var f={dimensions:d,measures:m,data:{path:"/data"}};return f;};};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.utils.vizFrameDatasetHelper')){jQuery.sap.declare("sap.apf.ui.representations.utils.vizFrameDatasetHelper");sap.apf.ui.representations.utils.vizFrameDatasetHelper=function(i){var g=function(k){var s=sap.apf.core.constants.representationMetadata.kind;var f=sap.apf.core.constants.vizFrame.feedItemTypes;var a;switch(k){case s.XAXIS:if(!i){a=sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS;}else{a=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;}break;case s.YAXIS:if(!i){a=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;}else{a=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS2;}break;case s.SECTORCOLOR:a=sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;break;case s.LEGEND:a=sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;break;case s.REGIONCOLOR:a=sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;break;case s.SECTORSIZE:a=sap.apf.core.constants.vizFrame.feedItemTypes.SIZE;break;case s.REGIONSHAPE:a=sap.apf.core.constants.vizFrame.feedItemTypes.SHAPE;break;case s.BUBBLEWIDTH:a=sap.apf.core.constants.vizFrame.feedItemTypes.BUBBLEWIDTH;break;case s.BUBBLEHEIGHT:a=sap.apf.core.constants.vizFrame.feedItemTypes.BUBBLEHEIGHT;break;default:break;}return a;};this.getDataset=function(p){this.parameter=p;var d=[];var m=[];this.parameter.dimensions.forEach(function(a,b){if(a.kind!==undefined){d[b]={name:a.name,value:'{'+a.value+'}',axisfeedItemId:g(a.kind)};}else{d[b]={name:a.name,value:'{'+a.value+'}',axisfeedItemId:a.axisfeedItemId};}});this.parameter.measures.forEach(function(a,b){if(a.kind!==undefined){m[b]={name:a.name,value:'{'+a.value+'}',axisfeedItemId:g(a.kind)};}else{m[b]={name:a.name,value:'{'+a.value+'}',axisfeedItemId:a.axisfeedItemId};}});var f={dimensions:d,measures:m,data:{path:"/data"}};return f;};};};if(!jQuery.sap.isDeclared('sap.apf.ui.utils.constants')){jQuery.sap.declare("sap.apf.ui.utils.constants");sap.apf.ui.utils.CONSTANTS={step:{OPEN_OVERLAY_IMAGE_HEIGHT:15,DROP_MARKER_HEIGHT:1},representationTypes:{FORM_REPRESENTATION:"FormRepresentation",TABLE_REPRESENTATION:"TableRepresentation",COLUMN_CHART:"ColumnChart",LINE_CHART:"LineChart",PIE_CHART:"PieChart",GEO_MAP:"GeoMap",STACKED_COLUMN_CHART:"StackedColumnChart",SCATTERPLOT_CHART:"ScatterPlotChart",PERCENTAGE_STACKED_COLUMN_CHART:"PercentageStackedColumnChart",BUBBLE_CHART:"BubbleChart",BAR_CHART:"BarChart",STACKED_BAR_CHART:"StackedBarChart",PERCENTAGE_STACKED_BAR_CHART:"PercentageStackedBarChart"},vizChartTypes:{COLUMN:"Column",LINE:"Line",PIE:"Pie",STACKED_COLUMN:"StackedColumn",PERCENTAGE_STACKED_COLUMN:"StackedColumn100",SCATTERPLOT:"Scatter",BUBBLE:"Bubble"},vizFrameChartTypes:{COLUMN:"column",LINE:"line",PIE:"pie",STACKED_COLUMN:"stacked_column",PERCENTAGE_STACKED_COLUMN:"100_stacked_column",SCATTERPLOT:"scatter",BUBBLE:"bubble",BAR:"bar",STACKED_BAR:"stacked_bar",PERCENTAGE_STACKED_BAR:"100_stacked_bar"},axisTypes:{AXIS:"axis",GROUP:"group"},thumbnailDimensions:{HEIGHT:"75px",WIDTH:"180px",STEP_WIDTH:"202px",STEP_HEIGHT:"170px",STEP_MARGIN:"20px",SEPARATOR_HEIGHT:"25px",REMOVE_ICON_HEIGHT:"20px",TOTAL_STEP_HEIGHT:215},printChartDimensions:{WIDTH:"0.89",POTRAITWIDTH:"793.700787402",LANDSCAPEWIDTH:"1122.519685039"},analysisPathArea:{HEADERHEIGHT:140},chartArea:{CHARTHEADERHEIGHT:120},carousel:{SCROLLCONTAINER:275,DNDBOX:280},landingPage:"landingPage"};};if(!jQuery.sap.isDeclared('sap.apf.ui.utils.facetFilterListConverter')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare('sap.apf.ui.utils.facetFilterListConverter');sap.apf.ui.utils.FacetFilterListConverter=function(){"use strict";this.getFFListDataFromFilterValues=function(f,p){var m=[];f.forEach(function(F){var o={};o.key=F[p];o.text=F.formattedValue;o.selected=false;m.push(o);});return m;};};};if(!jQuery.sap.isDeclared('sap.apf.ui.utils.formatter')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.ui.utils.formatter");sap.apf.ui.utils.formatter=function(f,m,d){var s=this;this.metadata=m;this.dataResponse=d;this.getPropertyMetadata=function(a){if(this.metadata&&this.metadata.getPropertyMetadata){return this.metadata.getPropertyMetadata(a);}return this.metadata;};this.getFormattedValue=function(a,o){var b,y,q,c,e,w,g;var M=this.getPropertyMetadata(a);if(M.isCalendarYearMonth){if(o!==null){b=this.doYearMonthFormat(o);}else{b="";}}else if(M.dataType&&M.dataType.type==="Edm.DateTime"){if(o!==null){g=new Date(parseInt(o.slice(6,o.length-2),10));g=g.toLocaleDateString();if(g==="Invalid Date"){b="-";}else{b=g;}}else{b="-";}}else if(M.unit){if(o!==null){var h=s.getPropertyMetadata(M.unit);if(h.semantics==="currency-code"){var p=this.dataResponse[0][M.scale];o=parseFloat(o).toFixed(p).toString();var i=o.split(".");var j=parseFloat(i[0]).toLocaleString();var k=0.1;k=k.toLocaleString();if(j.split(k.substring(1,2)).length>1){j=j.split(k.substring(1,2))[0];}j=j.concat(k.substring(1,2),i[1]);b=j;}else{b=o;}}else{b="-";}}else if(M.isCalendarDate){if(o!==null){y=o.substr(0,4);var l=parseInt(o.substr(4,2),10)-1;var n=o.substr(6,2);g=new Date(y,l,n);g=g.toLocaleDateString();if(g==="Invalid Date"){b="-";}else{b=g;}}else{b="-";}}else if(M.isCalendarYearQuarter){if(o!==null){y=o.substr(0,4);q=o.substr(4,1);c=new Date(y);e=c.getFullYear();var r;r="Q"+q;var t=r+" "+e;b=t;}else{b="";}}else if(M.isCalendarYearWeek){if(o!==null){y=o.substr(0,4);w=o.substr(4,2);c=new Date(y);e=c.getFullYear();var u;u="CW"+w;var v=u+" "+e;b=v;}else{b="";}}else{if(o===null){b="null";}else{b=o;}}var x=jQuery.extend({},this.getPropertyMetadata(a));b=this._applyCustomFormatting(x,a,o,b);return b;};this.doYearMonthFormat=function(a){var j=f.getTextNotHtmlEncoded("month-1-shortName");var b=f.getTextNotHtmlEncoded("month-2-shortName");var c=f.getTextNotHtmlEncoded("month-3-shortName");var e=f.getTextNotHtmlEncoded("month-4-shortName");var g=f.getTextNotHtmlEncoded("month-5-shortName");var h=f.getTextNotHtmlEncoded("month-6-shortName");var i=f.getTextNotHtmlEncoded("month-7-shortName");var k=f.getTextNotHtmlEncoded("month-8-shortName");var l=f.getTextNotHtmlEncoded("month-9-shortName");var o=f.getTextNotHtmlEncoded("month-10-shortName");var n=f.getTextNotHtmlEncoded("month-11-shortName");var p=f.getTextNotHtmlEncoded("month-12-shortName");var q=[j,b,c,e,g,h,i,k,l,o,n,p];var y=a.substr(0,4);var r=q[a.substr(4,6)-1];return r+" "+y;};this.isAmountField=function(a){var i=false;if(this.metadata&&this.dataResponse){var M=this.getPropertyMetadata(a);if(M!==undefined&&M.unit){var c=this.getPropertyMetadata(M.unit);if(c!==undefined&&c.semantics==="currency-code"){i=true;}}}return i;};this.getPrecision=function(a){var M=this.getPropertyMetadata(a);if(M!==undefined&&this.dataResponse!==undefined&&this.dataResponse[0]!==undefined){return this.dataResponse[0][M.scale];}};this.getFormatString=function(a){var z="";var F;var b=a.fieldName;var c=this.isAmountField(b);if(c===true){var p=this.getPrecision(b);if(p!==undefined){for(var i=0;i<p;i++){z=z+"0";}F="#,#0"+"."+z;}else{F="";}}else{F="";}return F;};this.getFormattedValueForTextProperty=function(a,t){var F;if(t.key){F=t.text+"("+t.key+")";}else{F=t.text;}var b=jQuery.extend({},this.getPropertyMetadata(a));F=this._applyCustomFormatting(b,a,t.text,F);return F;};this._applyCustomFormatting=function(a,b,o,c){var e=f.getEventCallback(sap.apf.core.constants.eventTypes.format);if(typeof e==="function"){var g=e.apply(f,[a,b,o,c]);if(g!==undefined){c=g;}if(g===null){c="";}}return c;};this.destroy=function(){s.metadata=null;s.dataResponse=null;};};};if(!jQuery.sap.isDeclared('sap.apf.ui.utils.helper')){jQuery.sap.declare('sap.apf.ui.utils.helper');sap.apf.ui.utils.Helper=function(c){"use strict";this.oCoreApi=c;this.getRepresentationSortInfo=function(r){var s=this;var C=r.parameter.dimensions.concat(r.parameter.measures);var S=r.parameter.orderby;var a=S.map(function(o){var b;C.forEach(function(d){if(o.property===d.fieldName&&d.fieldDesc&&s.oCoreApi.getTextNotHtmlEncoded(d.fieldDesc)){b=s.oCoreApi.getTextNotHtmlEncoded(d.fieldDesc);return;}});if(!b){s.oCoreApi.getMetadataFacade().getProperty(o.property,function(m){if(m.label||m.name){if(m.label){b=m.label;}else if(m.name){b=m.name;}else{b="";}}});}return b;});return a.join(", ");};};};if(!jQuery.sap.isDeclared('sap.apf.ui.utils.print')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.apf.ui.utils.print");sap.apf.ui.utils.PrintHelper=function(I){"use strict";var c=I.oCoreApi;var u=I.uiApi;var f=I.oFilterIdHandler;var n,C,a;this.oPrintLayout={};function _(){n++;if(a===n){C.resolve();}}function b(o){if(!jQuery.isEmptyObject(o.oPrintLayout)){o.oPrintLayout.removeContent();}jQuery('#apfPrintArea').remove();jQuery("body").append('<div id="apfPrintArea"></div>');u.createApplicationLayout(false).setBusy(true);}function d(A){var s;a=0;n=0;A.forEach(function(S){s=S.getSelectedRepresentation();s=s.bIsAlternateView?s.toggleInstance:s;if(s.type!==sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){a++;}});}function e(){var i=new Date();var A=c.getApplicationConfigProperties().appName;var s=u.getAnalysisPath().oSavedPathName.getTitle();var j=new sap.ui.core.HTML({id:'idAPFHeaderForFirstPage',content:['<div class="subHeaderPrintWrapper"><p class="printHeaderTitle"> '+c.getTextHtmlEncoded(A)+' : '+jQuery.sap.encodeHTML(s)+'</p>','<p class="printHeaderDate"> '+i.toTimeString()+' </p></div><div class="clear"></div>'].join(""),sanitizeContent:true});return j;}function g(){var i,j,m,F,A,o,p,q,r,s,t,S,v;var w=[],x=[],y="",z="",B=[],D=[],E=[],G=[],H={};var J=u.getEventCallback(sap.apf.core.constants.eventTypes.printTriggered);var K={getTextNotHtmlEncoded:c.getTextNotHtmlEncoded};var L=f.getAllInternalIds();if(L.length>0){for(i=0;i<L.length;i++){A=f.get(L[i]).getExpressions();w.push(A[0]);}}function M(){function O(P){z="";D=[];s=new sap.apf.ui.utils.formatter({getEventCallback:u.getEventCallback.bind(u),getTextNotHtmlEncoded:c.getTextNotHtmlEncoded},P);z=P.label;D.push(s.getFormattedValue(P.name,w[i][j].value));}for(i=0;i<w.length;i++){for(j=0;j<w[i].length;j++){r=w[i][j];c.getMetadataFacade().getProperty(w[i][j].name,O);r["sName"]=z;r["value"]=D;x.push(r);}}return x;}if(J!==undefined){E=J.apply(K,w)||[];E=(E.length>0)?E:M();}else{E=M();}t=u.getFacetFilterForPrint();function N(S){B=[];S.forEach(function(O){B.push(O.getText());});}if(t){F=t.getLists();for(m=0;m<F.length;m++){S=[];H={};H.sName=F[m].getTitle();if(!F[m].getSelectedItems().length){S=F[m].getItems();}else{S=F[m].getSelectedItems();}N(S);H.value=B;G.push(H);}}q=E.length>0?E.concat(G):G;v=new sap.ui.layout.VerticalLayout({id:'idAPFFacetAndFooterLayout'});for(i=0;i<q.length;i++){z=q[i].sName;for(j=0;j<q[i].value.length;j++){if(j!==q[i].value.length-1){y+=q[i].value[j]+", ";}else{y+=q[i].value[j];}}o=new sap.m.Text({text:z}).addStyleClass("printFilterName");p=new sap.m.Text({text:y}).addStyleClass("printFilterValue");v.addContent(o);v.addContent(p);y="";}return v;}function h(i,j){var m;var o=new Date();var A=c.getApplicationConfigProperties().appName;var s=u.getAnalysisPath().oSavedPathName.getTitle();if(!A){m=c.createMessageObject({code:"6003",aParameters:["sAppName"]});c.putMessage(m);}var p=new sap.ui.core.HTML({id:'idAPFHeaderForEachStep'+i,content:['<div class="subHeaderPrintWrapper"><p class="printHeaderTitle"> '+c.getTextHtmlEncoded(A)+' : '+jQuery.sap.encodeHTML(s)+'</p>','<p class="printHeaderDate"> '+o.toTimeString()+' </p></div><div class="clear"></div>','<div class="printChipName"><p>'+c.getTextHtmlEncoded("print-step-number",[i,j])+'</p></div>'].join(""),sanitizeContent:true});return p;}function k(s){var i,m,p,j=false,r={};var S=c.getTextNotHtmlEncoded(s.title);var o=s.getSelectedRepresentation();var q=o.bIsAlternateView?o.toggleInstance:o;if(o.bIsAlternateView){i=s.getSelectedRepresentation().getData();m=s.getSelectedRepresentation().getMetaData();q.setData(i,m);}if(q.type===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){r=q.getPrintContent(S);r.setWidth("1000px");}else{p=q.getPrintContent(S);r=p.oChartForPrinting;if(r.vizSelection){r.attachEventOnce("renderComplete",function(){r.vizSelection(p.aSelectionOnChart);_();});}else{r.attachInitialized(function(){r.selection(p.aSelectionOnChart);_();});}}if(q.bIsLegendVisible===undefined||q.bIsLegendVisible===true){j=true;}if(r.setVizProperties){r.setVizProperties({legend:{visible:j},sizeLegend:{visible:j}});}else{if(r.setLegend!==undefined){r.setLegend(new sap.viz.ui5.types.legend.Common({visible:j}));}if(r.setSizeLegend!==undefined){r.setSizeLegend(new sap.viz.ui5.types.legend.Common({visible:j}));}}return r;}function l(s,i,j){var S;var o=new sap.ui.layout.VerticalLayout({id:'idAPFChartLayout'+i});o.addContent(k(s));S=new sap.ui.layout.VerticalLayout({id:'idAPFStepLayout'+i,content:[h(i,j),o]}).addStyleClass("representationContent");return S;}this.doPrint=function(){var i,j,m,o,p,t,s,S,P;var q="",r=2000,v=this;var A=c.getSteps();this.oPrintLayout=new sap.ui.layout.VerticalLayout({id:"idAPFPrintLayout"});b(this);C=new jQuery.Deferred();d(A);if(a===0){C.resolve();}P=new sap.ui.layout.VerticalLayout({id:'idAPFPrintFirstPageLayout',content:[e(),g()]}).addStyleClass("representationContent");this.oPrintLayout.addContent(P);for(j=0;j<A.length;j++){m=parseInt(j,10)+1;this.oPrintLayout.addContent(l(A[j],m,A.length));}this.oPrintLayout.placeAt("apfPrintArea");if(jQuery(".v-geo-container").length){r=4000;}window.setTimeout(function(){u.createApplicationLayout(false).setBusy(false);},r-150);window.setTimeout(function(){jQuery("#"+v.oPrintLayout.sId+" > div").after("<div class='page-break'> </div>");q=v.oPrintLayout.getDomRef();t=jQuery('#apfPrintArea .sapUiTable');if(t.length){p=jQuery('#apfPrintArea .printTable .sapMListTblHeader .sapMListTblCell').length;if(p>11){jQuery("#setPrintMode").remove();jQuery("<style id='setPrintMode' > @media print and (min-resolution: 300dpi) { @page {size : landscape;}}</style>").appendTo("head");}else{jQuery("#setPrintMode").remove();jQuery("<style id='setPrintMode'>@media print and (min-resolution: 300dpi) { @page {size : portrait;}}</style>").appendTo("head");}}jQuery("#apfPrintArea").empty();jQuery("#sap-ui-static > div").hide();jQuery("#apfPrintArea").append(jQuery(q).html());for(i=0;i<jQuery("#apfPrintArea").siblings().length;i++){jQuery("#apfPrintArea").siblings()[i].hidden=true;}C.then(function(){window.print();});window.setTimeout(function(){for(i=0;i<jQuery("#apfPrintArea").siblings().length;i++){jQuery("#apfPrintArea").siblings()[i].hidden=false;}for(s=0;s<A.length;s++){S=A[s].getSelectedRepresentation();S=S.bIsAlternateView?S.toggleInstance:S;if(S.type!==sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){o=v.oPrintLayout.getContent()[s+1].getContent()[1].getContent()[0];o.destroy();o=null;}}v.oPrintLayout.destroy();v.oPrintLayout=null;},10);},r);};};};if(!jQuery.sap.isDeclared('sap.apf.utils.filterIdHandler')){jQuery.sap.declare('sap.apf.utils.filterIdHandler');(function(){'use strict';sap.apf.utils.FilterIdHandler=function(i){var m=i.instance.messageHandler;var u=1;var a=[];var f={};this.add=function(c){f[u]=g(c);a.push(u);i.functions.setRestrictionByProperty(c);return u++;};this.update=function(c,d){if(c&&typeof c=='number'){m.check((c>0&&c<u),'Passed unknown numeric identifier during update of path context handler');if(!(c>0&&c<u)){return;}}else if(!c||typeof c!='string'){m.check(false,'Passed false identifier during update of path context handler');return;}i.functions.setRestrictionByProperty(d);f[c]=g(d);};this.get=function(c){switch(typeof c){case'number':m.check((c>0&&c<u),'Passed unknown numeric identifier during get from path context handler');break;case'string':m.check(f[c],'Passed unknown string identifier during get from path context handler');break;}return i.functions.getRestrictionByProperty(f[c]);};this.getAllInternalIds=function(c){return jQuery.sap.extend(true,[],a);};this.serialize=function(){return jQuery.extend(true,{},f);};this.deserialize=function(d){u=1;var p;for(p in d){if(typeof b(p)==='number'){u++;}}f=jQuery.extend(true,{},d);};function g(c){return c.getInternalFilter().getProperties()[0];}function b(p){if(isNaN(Number(p))){return p;}return Number(p);}};}());};if(!jQuery.sap.isDeclared('sap.apf.utils.hashtable')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.apf.utils.hashtable');(function(){'use strict';sap.apf.utils.Hashtable=function(m){var n=0;var i={};var o=[];this.type="hashTable";this.setItem=function(k,v){var p;m.check((k!==undefined&&k!==null),"sap.apf.utils.HashTable.setItem: key undefined");m.check((v!==undefined&&v!==null),"sap.apf.utils.HashTable.setItem: value undefined");if(this.hasItem(k)){p=i[k];}else{n++;o.push(k);}i[k]=v;return p;};this.getNumberOfItems=function(){return n;};this.getItem=function(k){m.check((k!==undefined&&k!==null),"sap.apf.utils.HashTable.getItem key undefined");return this.hasItem(k)?i[k]:undefined;};this.hasItem=function(k){m.check((k!==undefined&&k!==null),"sap.apf.utils.HashTable.hasItem key undefined");return i.hasOwnProperty(k);};this.removeItem=function(k){m.check((k!==undefined&&k!==null),"sap.apf.utils.HashTable.removeItem key undefined");var I;if(this.hasItem(k)){I=i[k];n--;o.splice(o.indexOf(k),1);delete i[k];return I;}return undefined;};this.getKeys=function(){var K=[];var k;for(k in i){if(this.hasItem(k)){K.push(k);}}return K;};this.each=function(f){var k;for(k in i){if(this.hasItem(k)){f(k,i[k]);}}};this.forEachOrdered=function(f){var t=this;o.forEach(function(k){if(!t.hasItem(k)){m.check(false,"sap.apf.utils.HashTable.forEachOrdered: key not contained");}else{f(k,i[k]);}});};this.getKeysOrdered=function(){var l=[];this.forEachOrdered(function(k){l.push(k);});return l;};this.moveUpOrDown=function(a,d){m.check((a!==undefined&&a!==null),"sap.apf.utils.HashTable.moveItemUpOrDown movedKey undefined");var b=o.indexOf(a);var c=b+d;if(b<0){return null;}if(d<0){o.splice(b,1);if(c<0){o.splice(0,0,a);return 0;}else{o.splice(b+d,0,a);return b+d;}}else if(d===0){return b;}else if(d>0){o.splice(b,1);if(c>=o.length){o.splice(o.length,0,a);return o.length;}else{o.splice(c,0,a);return c;}}};this.moveBefore=function(b,a){if(o.indexOf(b)<0||o.indexOf(a)<0){return null;}if(b===a){return o.indexOf(a);}o.splice(o.indexOf(a),1);o.splice(o.indexOf(b),0,a);return o.indexOf(a);};this.moveToEnd=function(a){if(o.indexOf(a)<0){return null;}o.splice(o.indexOf(a),1);o.push(a);return o.indexOf(a);};this.reset=function(){i={};o=[];n=0;};};}());};if(!jQuery.sap.isDeclared('sap.apf.utils.navigationHandler')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
(function(){'use strict';jQuery.sap.declare("sap.apf.utils.navigationHandler");jQuery.sap.require('sap.ui.core.routing.HashChanger');sap.apf.utils.NavigationHandler=function(I){var c;var e;var m=I.instances.messageHandler;this.getNavigationTargets=function(){var d;var n=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation");var s=[];if(e){d=jQuery.Deferred();d.resolve(b(e));return d.promise();}if(!c){a();}c.forEach(function(i){if(jQuery.inArray(i.semanticObject,s)===-1){s.push(i.semanticObject);}});e=jQuery.extend(true,[],c);e.forEach(function(i){i.text="";});d=jQuery.Deferred();h(0).done(function(){d.resolve(b(e));}).fail(function(){d.resolve(b(e));});return d.promise();function f(i,j,t){e.forEach(function(k){if(i===k.semanticObject&&j===k.action){k.text=t;}});}function h(i){var d=jQuery.Deferred();var j=[];if(i===s.length){d=jQuery.Deferred();e.forEach(function(l){if(l.text!==""){j.push(l);}});e=j;d.resolve(e);return d.promise();}var k=s[i];n.getSemanticObjectLinks(k,undefined,false,I.instances.component,undefined).done(function(l){l.forEach(function(o){var p=o.intent.split("-");var q=p[1].split("?");q=q[0].split("~");f(k,q[0],o.text);});h(i+1).done(function(){d.resolve(e);});}).fail(function(){return h(i+1);});return d.promise();}};this.navigateToApp=function(n){if(!c){a();}var N=g(n);if(!N){return;}var h=sap.ui.core.routing.HashChanger&&sap.ui.core.routing.HashChanger.getInstance();I.functions.getCumulativeFilterUpToActiveStep().done(function(C){if(!N.filterMapping||!N.filterMapping.requestForMappedFilter){d(null,null);}else{var M=I.functions.createRequest(N.filterMapping.requestForMappedFilter);sap.apf.utils.executeFilterMapping(C,M,N.filterMapping.target,d,m);}function d(f,o){var i;if(o){return;}if(f){C=C.addAnd(f);}var j=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation");if(j){var s={sapApfState:I.functions.serializePath()};I.instances.startFilterHandler.serialize().done(function(k){s.sapApfState.filterIdHandler=I.functions.serializeFilterIds();s.sapApfState.startFilterHandler=k;s.sapApfCumulativeFilter=C.mapToSapUI5FilterExpression();i=j.createEmptyAppState(I.instances.component);i.setData(s);i.save();if(h){h.replaceHash("sap-iapp-state="+i.getKey());}j.toExternal({target:{semanticObject:N.semanticObject,action:N.action},appStateKey:i.getKey()});});}}});};this.checkMode=function(){var d=jQuery.Deferred();var h=sap.ui.core.routing.HashChanger&&sap.ui.core.routing.HashChanger.getInstance&&sap.ui.core.routing.HashChanger.getInstance();var i=/(?:sap-iapp-state=)([^&=]+)/;var f,j,k,l;if(h){k=i.exec(h.getHash());if(k){f=k[1];}}j=I.functions.getXappStateId();if(f){sap.ushell.Container.getService("CrossApplicationNavigation").getAppState(I.instances.component,f).done(function(n){l=n.getData();if(l.sapApfState){I.functions.deserializeFilterIds(l.sapApfState.filterIdHandler);I.functions.deserializePath(l.sapApfState);I.instances.startFilterHandler.getStartFilters().done(function(){I.instances.startFilterHandler.deserialize(l.sapApfState.startFilterHandler);d.resolve({navigationMode:"backward"});});}});}else if(j){sap.ushell.Container.getService("CrossApplicationNavigation").getAppState(I.instances.component,j).done(function(n){l=n.getData();if(l&&l.sapApfCumulativeFilter){d.resolve({navigationMode:"forward",sapApfCumulativeFilter:l.sapApfCumulativeFilter});}else{d.resolve({navigationMode:"forward"});}});}else{d.resolve({navigationMode:"forward"});}if(h){h.replaceHash("");}return d.promise();};function a(){c=I.functions.getNavigationTargets();}function g(n){for(var i=0,l=c.length;i<l;i++){if(c[i].id===n){return c[i];}}}function b(t){var d=jQuery.extend(true,[],t);var r={global:[],stepSpecific:[]};d.forEach(function(f){if(f.isStepSpecific&&i(f.id)){delete f.isStepSpecific;r.stepSpecific.push(f);}else if(!f.isStepSpecific){delete f.isStepSpecific;r.global.push(f);}});return r;function i(f){var h=false;var j;var k=I.functions.getActiveStep();if(k&&k.getAssignedNavigationTargets){j=k.getAssignedNavigationTargets();if(j&&jQuery.isArray(j)){j.forEach(function(l){if(f===l.id){h=true;}});}}return h;}}};}());};if(!jQuery.sap.isDeclared('sap.apf.utils.parseTextPropertyFile')){jQuery.sap.declare("sap.apf.utils.parseTextPropertyFile");jQuery.sap.require('sap.ui.core.format.DateFormat');(function(){'use strict';sap.apf.utils.parseTextPropertyFile=function(t,a){function c(v,w){var x=m.createMessageObject({code:v,aParameters:[w]});s.Messages.push(x);}function b(v){c(11013,v);}function d(v){c(11011,v);}function e(v,w){var x=sap.apf.utils.isValidGuid(v);if(!x){c(11012,w);return false;}else{return true;}}function f(v){c(11015,v);}function g(v){c(11012,v);}var m=a.instance.messageHandler;var D=sap.ui.core.format.DateFormat.getDateTimeInstance({pattern:"yyyy/MM/dd HH:mm:ss"});var o;var l=t.split(/\r?\n/);var h=l.length;var i;var j=-1;var k=-1;var n;var p,q,r;var A=false;var s={Application:undefined,TextElements:[],Messages:[]};for(i=0;i<h;i++){if(!A){var u=/^\#\s*ApfApplicationId=[0-9A-F]+\s*$/.exec(l[i]);if(u!==null){s.Application=l[i].split('=')[1];if(!sap.apf.utils.isValidGuid(s.Application)){s.Application="";b(i);}A=true;continue;}}if(l[i]===""){continue;}if(k===i&&/^\#\s*LastChangeDate/.exec(l[i])){r=l[i].split('=');if(r.length===2){o=D.parse(r[1]);if(!o){f(i);n.LastChangeUTCDateTime="";}else{n.LastChangeUTCDateTime='/Date('+o.getTime()+')/';}s.TextElements.push(n);}else{f(i);}n=null;continue;}if(j===i){r=l[i].split('=');if(r.length===2){if(e(r[0],i)){n.TextElement=r[0];n.TextElementDescription=r[1];}else{g(i);}}else{d(i);}continue;}p=/^\#(X|Y)[A-Z]{3},[0-9]+:/.exec(l[i]);if(p){if(j===i){d(i);}n={};n.Language=sap.apf.core.constants.developmentLanguage;n.Application=s.Application;n.TextElementType=l[i].match(/(X|Y)[A-Z]{3}/)[0];n.MaximumLength=l[i].match(/,[0-9]+/);n.MaximumLength=parseInt(n.MaximumLength[0].substring(1),10);n.TranslationHint=l[i].match(/:\s*[0-9a-zA-Z\s]+$/);n.TranslationHint=n.TranslationHint[0].substring(1);j=i+1;k=i+2;}else{q=/^\#(X|Y)[A-Z]{3},[0-9]+/.exec(l[i]);if(q){if(j===i){d(i);}n={};n.Language=sap.apf.core.constants.developmentLanguage;n.Application=s.Application;n.TextElementType=l[i].match(/(X|Y)[A-Z]{3}/)[0];n.MaximumLength=l[i].match(/,[0-9]+/);n.MaximumLength=parseInt(n.MaximumLength[0].substring(1),10);n.TranslationHint="";j=i+1;k=i+2;}}}if(!A){c(11010,0);}return s;};}());};if(!jQuery.sap.isDeclared('sap.apf.utils.serializationMediator')){jQuery.sap.declare("sap.apf.utils.serializationMediator");sap.apf.utils.SerializationMediator=function(i){this.savePath=function(a,b,c){var e;i.startFilterHandler.serialize().done(d);function d(s){e={filterIdHandler:i.filterIdHandler.serialize(),startFilterHandler:s};if(typeof a==='string'&&typeof b==='function'){i.coreApi.savePath(a,b,e);}else if(typeof a==='string'&&typeof b==='string'&&typeof c==='function'){i.coreApi.savePath(a,b,c,e);}}};this.openPath=function(p,c,n){var C=function(r,e,m){if(r&&r.path&&r.path.SerializedAnalysisPath&&r.path.SerializedAnalysisPath.filterIdHandler){i.filterIdHandler.deserialize(r.path.SerializedAnalysisPath.filterIdHandler);delete r.path.SerializedAnalysisPath.filterIdHandler;}if(r&&r.path&&r.path.SerializedAnalysisPath&&r.path.SerializedAnalysisPath.startFilterHandler){i.startFilterHandler.deserialize(r.path.SerializedAnalysisPath.startFilterHandler);delete r.path.SerializedAnalysisPath.startFilterHandler;}c(r,e,m);};i.coreApi.openPath(p,C,n);};this.deletePath=function(p,c){i.coreApi.deletePath(p,c);};this.readPaths=function(c){i.coreApi.readPaths(c);};};};if(!jQuery.sap.isDeclared('sap.apf.utils.startFilter')){jQuery.sap.declare('sap.apf.utils.startFilter');sap.apf.utils.StartFilter=function(a,c,b){'use strict';var e;var r;var d;var f;var g;j=j.bind(this);k=k.bind(this);s=s.bind(this);this.getPropertyName=function(){return c.property;};this.getLabel=function(){return c.label;};this.getAliasNameIfExistsElsePropertyName=function(){return c.alias||c.property;};this.isMultiSelection=function(){if(c.multiSelection==='true'||c.multiSelection===true){return true;}return false;};this.isVisible=function(){if(b&&b.type==='internalFilter'&&!c.filterResolutionRequest){return false;}return!c.invisible;};this.setRestriction=function(i){d=undefined;f=undefined;r=i;};this.getValues=function(){var l;var v=[];var p;n=n.bind(this);m=m.bind(this);if(c.valueHelpRequest&&jQuery.isArray(b)){return h().then(function(i){var v=i.data;n(b,v);return v;});}else if(b&&b.type==='internalFilter'&&c.valueHelpRequest&&c.filterResolutionRequest){l=jQuery.when(h(),s());return l.then(function(i,o){var v=i.data;m(o.data,v);return v;});}else if(c.valueHelpRequest&&((c.preselectionDefaults&&c.preselectionDefaults.length>0)||jQuery.isFunction(c.preselectionFunction))){return h().then(function(i){var v=i.data;var p;if(c.preselectionDefaults&&c.preselectionDefaults.length>0){p=c.preselectionDefaults;}else{p=c.preselectionFunction();}n(p,v);return v;});}else if(c.valueHelpRequest){return h().then(function(i){return i.data;});}else if(b&&b.type==='internalFilter'&&c.filterResolutionRequest){return s().then(function(i){return i.data;});}else if(jQuery.isArray(b)&&c.filterResolutionRequest&&!c.valueHelpRequest){return s().then(function(i){return i.data;});}else if(jQuery.isArray(b)){l=jQuery.Deferred();n(b,v);l.resolve(v);return l.promise();}else if(((c.preselectionDefaults&&c.preselectionDefaults.length>0)||jQuery.isFunction(c.preselectionFunction))&&!c.valueHelpRequest&&!c.filterResolutionRequest&&!b){if(c.preselectionDefaults&&c.preselectionDefaults.length>0){p=c.preselectionDefaults;}else{p=c.preselectionFunction();}if(this.isMultiSelection()){n(p,v);}else{n([p[0]],v);}return jQuery.Deferred().resolve(v).promise();}else if(((c.preselectionDefaults&&c.preselectionDefaults.length>0)||jQuery.isFunction(c.preselectionFunction))&&c.filterResolutionRequest&&!b){if(c.preselectionDefaults&&c.preselectionDefaults.length>0){p=c.preselectionDefaults;}else{p=c.preselectionFunction();}if(this.isMultiSelection()){n(p,v);}else{n([p[0]],v);}return jQuery.Deferred().resolve(v).promise();}else if(b&&b.type==='internalFilter'||!b){return jQuery.Deferred().resolve(null).promise();}function m(o,q){var t=k(q);for(var i=o.length-1;i>=0;i--){if(!t[o[i][this.getAliasNameIfExistsElsePropertyName()]]){q.unshift(o[i]);}}}function n(o,q){var t=k(q);var u;for(var i=o.length-1;i>=0;i--){if(!t[o[i]]){u={};u[this.getAliasNameIfExistsElsePropertyName()]=o[i];q.unshift(u);}}}};this.getMetadata=function(){if(c.valueHelpRequest){return h().then(function(i){return i.metadata.getPropertyMetadata(this.getAliasNameIfExistsElsePropertyName());}.bind(this));}else if(c.filterResolutionRequest){return s().then(function(i){return i.metadata.getPropertyMetadata(this.getAliasNameIfExistsElsePropertyName());}.bind(this));}return jQuery.Deferred().resolve({});};this.setSelectedValues=function(v){if(!g){g=true;this.getSelectedValues().done(function(i){g=i;});}if(v.type==='internalFilter'){e=v;}else{e=jQuery.extend(true,[],v);}};this.getSelectedValues=function(){var i=jQuery.Deferred();var l;var p;var m;if(e){if(!c.invisible){this.getValues().done(function(v){if(v!==null){l=[];m=k(v);e.forEach(function(o){if(m[o]){l.push(o);}});e=l;}else{l=null;}n();});}else{l=e;n();}}else if(jQuery.isFunction(c.preselectionFunction)&&!c.valueHelpRequest){l=c.preselectionFunction();n();}else if(b&&b.type==='internalFilter'&&!c.filterResolutionRequest){i.resolve(b);}else if(c.filterResolutionRequest&&!b&&!c.valueHelpRequest&&!(c.preselectionDefaults&&c.preselectionDefaults.length>0)){i.resolve(null);}else if(b&&b.type==='internalFilter'&&c.filterResolutionRequest){s().then(function(o){var q=j(o);if(this.isMultiSelection()){l=q;}else{l=[q[0]];}n();}.bind(this));}else if(c.valueHelpRequest&&!jQuery.isArray(b)){h().then(function(o){var v=[];var q=j(o);if(c.preselectionDefaults&&c.preselectionDefaults.length>0){p=c.preselectionDefaults;}else{p=c.preselectionFunction&&c.preselectionFunction();}if(p){p.forEach(function(t){if(jQuery.inArray(t,q)>-1){v.push(t);}});}else{v=q;}if(this.isMultiSelection()){l=v;}else{l=[v[0]];}n();}.bind(this));}else if(jQuery.isArray(b)){if(this.isMultiSelection()){l=b;}else{l=b[0]?[b[0]]:[];}n();}else if(c.preselectionDefaults&&c.preselectionDefaults.length>0){l=c.preselectionDefaults;if(!this.isMultiSelection()){l=[l[0]];}n();}else{i.resolve(null);}return i.promise();function n(){if(l&&l.type==='internalFilter'){i.resolve(l);}else{i.resolve(jQuery.extend(true,[],l));}}};this.serialize=function(){var i=jQuery.Deferred();var l={propertyName:this.getPropertyName()};this.getSelectedValues().done(function(v){if(v.type==='internalFilter'){v=v.mapToSapUI5FilterExpression();}l.selectedValues=v;i.resolve(l);});return i;};this.deserialize=function(i){if(i.selectedValues.filters||i.selectedValues.path){i.selectedValues=sap.apf.core.utils.Filter.transformUI5FilterToInternal(a.instance.messageHandler,i.selectedValues);}e=undefined;g=undefined;b=i.selectedValues;};this.reset=function(){if(g){e=g;}};function s(){var i;var m;var l;if(jQuery.isArray(b)){l=new sap.apf.core.utils.Filter(a.instance.messageHandler);b.forEach(function(v){l.addOr(this.getAliasNameIfExistsElsePropertyName(),'eq',v);}.bind(this));}else{l=b;}if(f){return f;}f=jQuery.Deferred();if(r){m=new sap.apf.core.utils.Filter(a.instance.messageHandler);m.addAnd(r).addAnd(l);}else{m=l;}i=a.functions.createRequest(c.filterResolutionRequest);i.sendGetInBatch(m,n,undefined);return f.promise();function n(o){f.resolve(o);}}function h(){var i;if(d){return d;}d=jQuery.Deferred();i=a.functions.createRequest(c.valueHelpRequest);i.sendGetInBatch(r,l,undefined);return d.promise();function l(m){d.resolve(m);}}function j(i){var v=[];i.data.forEach(function(l){v.push(l[this.getAliasNameIfExistsElsePropertyName()]);}.bind(this));return v;}function k(i){var v={};i.forEach(function(l){v[l[this.getAliasNameIfExistsElsePropertyName()]]=true;}.bind(this));return v;}};};if(!jQuery.sap.isDeclared('sap.apf.utils.startParameter')){(function(){'use strict';jQuery.sap.declare('sap.apf.utils.startParameter');sap.apf.utils.StartParameter=function(c){var a=null;var s=null;var r=null;var b;var e;var d;var l=false;var f;var g=false;if(c&&c.getComponentData&&c.getComponentData()&&c.getComponentData().startupParameters){d=c.getComponentData().startupParameters;if(d['sap-apf-configuration-id']){a=d['sap-apf-configuration-id'][0];}if(d['sap-apf-step-id']){s=d['sap-apf-step-id'][0];}if(d['sap-apf-representation-id']){r=d['sap-apf-representation-id'][0];}if(d['sap-apf-app-config-path']){b=d['sap-apf-app-config-path'][0];}if(d['evaluationId']){e=d['evaluationId'][0];}if(d['sap-apf-activate-lrep']){l=d['sap-apf-activate-lrep'][0];}if(d['sap-client']){f=d['sap-client'][0];}if(d['sap-apf-filter-reduction']){g=d['sap-apf-filter-reduction'][0];}}this.getAnalyticalConfigurationId=function(){var p,h;if(!a){a=jQuery.sap.getUriParameters().get('sap-apf-configuration-id');}if(a){h={};p=a.split(".");if(p.length===2){h.applicationId=p[0];h.configurationId=p[1];}else{h.configurationId=a;}}return h;};this.getSteps=function(){if(!s){s=jQuery.sap.getUriParameters().get('sap-apf-step-id');}if(!r){r=jQuery.sap.getUriParameters().get('sap-apf-representation-id');}if(!s){return null;}else{return[{stepId:s,representationId:r}];}};this.getXappStateId=function(){var x=/(?:sap-xapp-state=)([^&=]+)/;var h=x.exec(window.location.hash);if(h){return h[1];}else{return null;}};this.getApplicationConfigurationPath=function(){return b;};this.getEvaluationId=function(){return e;};this.isLrepActive=function(){return l;};this.getSapClient=function(){return f;};this.isFilterReductionActive=function(){return g;}};}());};if(!jQuery.sap.isDeclared('sap.apf.utils.utils')){jQuery.sap.declare('sap.apf.utils.utils');jQuery.sap.require('sap.ui.core.format.DateFormat');(function(){'use strict';var f;sap.apf.utils.renderHeaderOfTextPropertyFile=function(a,m){var t=a.toLowerCase();var c=/^[0-9a-f]+$/;var i=c.test(t);if(!i||a.length!==32){m.putMessage(m.createMessageObject({code:"11009",aParameters:[a]}));t="<please enter valid translation uuid, if you want to upload into a SAP translation system>";}else{t=t.substring(0,8)+'-'+t.substring(8,12)+'-'+t.substring(12,16)+'-'+t.substring(16,20)+'-'+t.substring(20);}return"#FIORI: insert Fiori-Id\n"+"# __ldi.translation.uuid="+t+"\n"+"#ApfApplicationId="+a+"\n\n";};sap.apf.utils.getUriParameters=function(){return jQuery.sap.getUriParameters().mParams;};sap.apf.utils.renderTextEntries=function(h,m){f=false;var k=h.getKeys();k.sort(function(a,b){var v=h.getItem(a);var c=h.getItem(b);if(v.LastChangeUTCDateTime<c.LastChangeUTCDateTime){return-1;}if(v.LastChangeUTCDateTime>c.LastChangeUTCDateTime){return 1;}return 0;});var l=k.length;var r='';var i;for(i=0;i<l;i++){r=r+sap.apf.utils.renderEntryOfTextPropertyFile(h.getItem(k[i]),m);}return r;};sap.apf.utils.renderEntryOfTextPropertyFile=function(t,m){var d,D;if(!f&&(!t.TextElementType||!t.MaximumLength)){f=true;m.putMessage(m.createMessageObject({code:"11008",aParameters:[t.TextElement]}));}var e="#"+(t.TextElementType||"<Add text type>")+","+(t.MaximumLength||"<Add maximum length>");if(t.TranslationHint&&t.TranslationHint!==""){e=e+':'+t.TranslationHint;}e=e+"\n"+t.TextElement+"="+t.TextElementDescription+"\n";var o=sap.ui.core.format.DateFormat.getDateTimeInstance({pattern:"yyyy/MM/dd HH:mm:ss"});if(t.LastChangeUTCDateTime&&t.LastChangeUTCDateTime!==""){d=t.LastChangeUTCDateTime.replace(/\/Date\(/,'').replace(/\)\//,'');D=new Date(parseInt(d,10));}else{D=new Date();}e=e+"# LastChangeDate="+o.format(D)+'\n\n';return e;};sap.apf.utils.eliminateDuplicatesInArray=function(m,w){m.check((w!==undefined&&typeof w==='object'&&w.hasOwnProperty('length')===true),'Error - aArray is undefined');var r=[];var i,j;for(i=0;i<w.length;i++){for(j=i+1;j<w.length;j++){if(w[i]===w[j]){j=++i;}}r.push(w[i]);}return r;};sap.apf.utils.hashCode=function(v){var n=0;var i;var a=0;v=v.toString();var l=v.length;for(i=0;i<l;i++){a=v.charCodeAt(i);n=(17*n+a)<<0;}return n;};sap.apf.utils.escapeOdata=function(v){if(typeof v==="string"){return v.replace("'","''");}return v;};sap.apf.utils.json2javascriptFormat=function(v,t){var i;switch(t){case"Edm.Boolean":if(typeof v==="boolean"){return v;}if(typeof v==="string"){return v.toLowerCase()==="true";}return false;case"Edm.Decimal":case"Edm.Guid":case"Edm.Int64":case"Edm.String":return v;case"Edm.Int16":case"Edm.Int32":return parseInt(v,10);case"Edm.Single":case"Edm.Float":return parseFloat(v);case"Edm.Time":return v;case"Edm.DateTime":i=v.replace('/Date(','').replace(')/','');i=parseFloat(i);return new Date(i);case"Edm.DateTimeOffset":i=v.replace('/Date(','');i=i.replace(')/','');i=parseFloat(i);return new Date(i);}return v;};sap.apf.utils.formatValue=function(a,t){function c(v){var b;if(v instanceof Date){return v;}if(typeof v==='string'){if(v.substring(0,6)==='/Date('){b=v.replace('/Date(','');b=b.replace(')/','');b=parseInt(b,10);return new Date(b);}return new Date(v);}}var d;var F="";if(a===null||a===undefined){return"null";}switch(t){case"Edm.String":F="'"+String(a).replace(/'/g,"''")+"'";break;case"Edm.Time":if(typeof a==='number'){d=new Date();d.setTime(a);var h=d.getUTCHours();if(h<10){h='0'+h;}var m=d.getUTCMinutes();if(m<10){m='0'+m;}var s=d.getUTCSeconds();if(s<10){s='0'+s;}F="time'"+h+':'+m+':'+s+"'";}else{F="time'"+a+"'";}break;case"Edm.DateTime":if(!sap.apf.utils.formatValue.oDateTimeFormat){sap.apf.utils.formatValue.oDateTimeFormat=sap.ui.core.format.DateFormat.getDateInstance({pattern:"'datetime'''yyyy-MM-dd'T'HH:mm:ss''"});}d=c(a);F=sap.apf.utils.formatValue.oDateTimeFormat.format(d,true);break;case"Edm.DateTimeOffset":if(!sap.apf.utils.formatValue.oDateTimeOffsetFormat){sap.apf.utils.formatValue.oDateTimeOffsetFormat=sap.ui.core.format.DateFormat.getDateInstance({pattern:"'datetimeoffset'''yyyy-MM-dd'T'HH:mm:ss'Z'''"});}d=c(a);F=sap.apf.utils.formatValue.oDateTimeOffsetFormat.format(d,true);break;case"Edm.Guid":F="guid'"+a+"'";break;case"Edm.Decimal":F=a+"M";break;case"Edm.Int64":F=String(a)+"L";break;case"Edm.Single":F=a+"f";break;case"Edm.Binary":F="binary'"+a+"'";break;default:F=a;break;}return F;};sap.apf.utils.extractFunctionFromModulePathString=function(F){if(jQuery.isFunction(F)){return F;}var d,n,s;n=F.split('.');d=window;var i;for(i=0;i<n.length-1;i++){d=d[n[i]];if(!d){return undefined;}}s=n[n.length-1];return d[s];};sap.apf.utils.isValidGuid=function(a){return/^[0-9A-F]{32}$/.test(a);};sap.apf.utils.isValidPseudoGuid=function(a){return/^[0-9A-F]{32}$/.test(a);};sap.apf.utils.createPseudoGuid=function(l){if(!l){l=32;}var a=Date.now().toString();var d=l-a.length;a+=g(d);return a;};function g(l){var r="";var a,m;while(r.length<l){a=Math.min(10,l-r.length);m=Math.pow(10,a);r+=Math.floor((Math.random()*m));}return r;}sap.apf.utils.migrateConfigToCategoryStepAssignment=function(a,i){var c=new i.constructor.hashtable(i.instance.messageHandler);if(a.steps){a.steps.forEach(function(s){if(s.categories){s.categories.forEach(function(b){var d=c.getItem(b.id);if(!d){d={category:b.id,steps:[{type:"step",id:s.id}]};c.setItem(b.id,d);}else{d.steps.push({type:"step",id:s.id});}});delete s.categories;}});}if(a.categories){a.categories.forEach(function(b){if(!b.steps){var d=c.getItem(b.id);if(d){b.steps=d.steps;}else{b.steps=[];}}});}};sap.apf.utils.executeFilterMapping=function(i,m,t,c,M){m.sendGetInBatch(i,a);function a(r){var F;if(r&&r.type&&r.type==="messageObject"){M.putMessage(r);c(undefined,r);}else{F=new sap.apf.core.utils.Filter(M);r.data.forEach(function(d){var o=new sap.apf.core.utils.Filter(M);t.forEach(function(T){o.addAnd(new sap.apf.core.utils.Filter(M,T,sap.apf.core.constants.FilterOperators.EQ,d[T]));});F.addOr(o);});c(F,undefined);}}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.ajax')){jQuery.sap.declare("sap.apf.core.ajax");sap.apf.core.ajax=function(s){var a=jQuery.extend(true,{},s);var b=a.beforeSend;var S=a.success;var e=a.error;a.beforeSend=function(j,c){if(b){b(j,c);}};a.success=function(d,t,j){var m=sap.apf.core.utils.checkForTimeout(j);if(m){e(d,"error",undefined,m);}else{S(d,t,j);}};a.error=function(j,t,c){var m=sap.apf.core.utils.checkForTimeout(j);if(m){e(j,t,c,m);}else{e(j,t,c);}};return jQuery.ajax(a);};};if(!jQuery.sap.isDeclared('sap.apf.core.layeredRepositoryProxy')){jQuery.sap.declare("sap.apf.core.layeredRepositoryProxy");jQuery.sap.require('sap.ui.thirdparty.datajs');jQuery.sap.require('sap.ui.fl.LrepConnector');(function(){'use strict';sap.apf.core.LayeredRepositoryProxy=function(s,a){var c=a.instance.coreApi;var b;var m=a.instance.messageHandler;var n='sap/apf/dt';var t='text.properties';var d=new sap.apf.utils.Hashtable(a.instance.messageHandler);var e=new sap.apf.utils.Hashtable(a.instance.messageHandler);function f(i){var j=(i&&i.layer)||"CUSTOMER";if(j==="ALL"){return undefined;}return j;}function g(i,j){return m.createMessageObject({code:i,aParameters:j});}function h(){return{};}function k(i){return n+'/'+i;}function l(i,j){var H=i.application;var I=i.inputParameters[0].value;var J;p(H).done(function(){J=d.getItem(H);J.removeItem(I);j(i,h());}).fail(function(){j(undefined,h(),g('5201'));})}function o(i,j,H){var O;var P=[];var R="/sap/bc/lrep/content/";R+=n+"/"+i+'/'+t;P.push({name:"layer",value:"CUSTOMER"});O={async:!H,contentType:'text/plain'};if(H){O.complete=j;}R+=b._buildParams(P);return b.send(R,'GET',{},O);}function p(i,j){var H=jQuery.Deferred();var I;var J=d.getItem(i);var K=function(L){var M=(L&&L.response)||(L&&L.responseText)||"";var N=sap.apf.utils.parseTextPropertyFile(M,{instance:{messageHandler:m}});J=new sap.apf.utils.Hashtable(a.instance.messageHandler);N.TextElements.forEach(function(O){J.setItem(O.TextElement,O);});d.setItem(i,J);H.resolve({});};if(J===undefined){if(j!==undefined&&j===false){o(i,K,true);}else{I=o(i,undefined,false);I.then(function(L){K(L);},function(L){H.reject(g('5201'));});}}else{H.resolve({});}return H.promise();}function q(i,j,H){var I=i.Application;if(i.TextElement===undefined||!sap.apf.utils.isValidGuid(i.TextElement)){i.TextElement=sap.apf.utils.createPseudoGuid();}p(I,H).done(function(){var J=d.getItem(I);J.setItem(i.TextElement,i);j(i,h());}).fail(function(){j(undefined,h(),g('5201'));})}function r(j,H){var i,I;var J=k(j);var K=b.listContent(J,'CUSTOMER');K.then(function(L){var M=L.response;I=[];for(i=0;i<M.length;i++){if(M[i].fileType==="apfconfiguration"){I.push(M[i].name);}}H(I);},function(L){H([]);});}function u(i,j,H){function I(){var M=sap.apf.utils.renderHeaderOfTextPropertyFile(i,m);M=M+sap.apf.utils.renderTextEntries(K,m);var N=b.upsert(J,'text','properties',"CUSTOMER",M,'text/plain');N.then(function(O){j(h());},function(O){j(h(),g('5201'));});}var J=k(i);var K=d.getItem(i);if(!K){j(h());return;}if(H){I();}else{var L=o(i,undefined,false);L.then(function(M){var N=(M&&M.response)||(M&&M.responseText)||"";var O=sap.apf.utils.parseTextPropertyFile(N,{instance:{messageHandler:m}});O.TextElements.forEach(function(P){K.setItem(P.TextElement,P);});I();},function(M){j(h(),g('5201'));});}}function v(i,j,H){var I=k(i);var J=b.getFileAttributes(I,j,'apfconfiguration',"CUSTOMER");J.then(function(K){var L=K.response;var M=e.getItem(i);if(M===undefined){M=new sap.apf.utils.Hashtable(a.instance.messageHandler);}M.setItem(j,L);e.setItem(i,M);u(i,H);},function(K){H(undefined,h(),g('5201'));});}function w(i,j){var H=i.Application;var I=i.AnalyticalConfiguration;var J=JSON.parse(i.SerializedAnalyticalConfiguration);var K=k(H);var L=b.getStaticResource(K,"metadata","apfapplication");L.then(function(M){var N={Application:H,ApplicationName:M.response.ApplicationName,SemanticObject:M.response.SemanticObject,AnalyticalConfiguration:I,AnalyticalConfigurationName:i.AnalyticalConfigurationName,CreationUTCDateTime:i.CreationUTCDateTime,LastChangeUTCDateTime:i.LastChangeUTCDateTime};J=jQuery.extend(true,J,{configHeader:N});J=JSON.stringify(J);var O=b.upsert(K,I,'apfconfiguration','CUSTOMER',J,'application/json');return O;},function(M){j(undefined,h(),g('5201'));}).then(function(M){v(H,I,j);},function(M){j(h(),g('5201'));});}function x(i,j,H){var I=f(H);function J(K,L,P,M,j){var N=k(K);var Q=b.upsert(N,L,'apfconfiguration',I,M,'application/json');Q.then(function(R){v(K,L,function(S,T,U){if(!U){j({AnalyticalConfiguration:L,AnalyticalConfigurationName:i.AnalyticalConfigurationName},h());}else{j(undefined,h(),g('5201'));}});},function(R){j(undefined,h(),g('5201'));});}var K=i.Application;var L=i.AnalyticalConfiguration;if(L===undefined||!sap.apf.utils.isValidGuid(L)){L=sap.apf.utils.createPseudoGuid(32);}var M=JSON.parse(i.SerializedAnalyticalConfiguration);var N=k(K);var O=b.getStaticResource(N,"metadata","apfapplication");O.then(function(P){var Q={Application:K,ApplicationName:P.response.ApplicationName,SemanticObject:P.response.SemanticObject,AnalyticalConfiguration:L,AnalyticalConfigurationName:M.analyticalConfigurationName,CreationUTCDateTime:i.CreationUTCDateTime,LastChangeUTCDateTime:i.LastChangeUTCDateTime};M=jQuery.extend(true,M,{configHeader:Q});M=JSON.stringify(M);J(K,L,i.AnalyticalConfigurationName,M,j);},function(P){j(undefined,h(),g('5201'));});}function y(i,j,H){var I=i[0].value;m.check(I!==undefined,"configuration may not be undefined");m.check(H!==undefined,"application of configuration not found");var J=k(H);var K=b.deleteFile(J,I,'apfconfiguration','CUSTOMER');K.then(function(L){j(h());},function(L){j(h(),g('5201'));});}function z(j,H){var i=0;var I={Application:j};var J,K;for(i=0;i<H.length;i++){J=H[i].name;K=H[i].value;if(J==="apfdt-applname"){J="ApplicationName";}else if(J==='createdAt'){J="CreationUTCDateTime";}else if(J==='createdBy'){J="CreatedByUser";}else if(J==='lastChangedAt'){J="LastChangeUTCDateTime";}else if(J==='lastChangedBy'){J="LastChangedByUser";}else if(J==="apfdt-configname"){J='AnalyticalConfigurationName';}else if(J==='size'||J==='layer'){continue;}I[J]=K;}return I;}function A(i,j,H){m.check(i.ApplicationName!==undefined&&i.ApplicationName!=="","Valid application name is required");var I=i.Application;if(I===undefined||!sap.apf.utils.isValidGuid(I)){I=sap.apf.utils.createPseudoGuid(32);}var J=JSON.stringify({ApplicationName:i.ApplicationName,SemanticObject:i.SemanticObject,Application:I});var K=sap.apf.utils.renderHeaderOfTextPropertyFile(I,m);var L=f(H);function M(){j(undefined,h(),g('5201'));}var N=k(I);var O=b.upsert(N,'metadata','apfapplication',L,J,'application/json');O.then(function(P){return b.upsert(N,'text','properties',L,K,'text/plain');},M).then(function(P){d.setItem(I,new sap.apf.utils.Hashtable(a.instance.messageHandler));j({Application:I,ApplicationName:i.ApplicationName,SemanticObject:i.SemanticObject},h());},M);}function B(i,j){m.check(i.ApplicationName!==undefined&&i.ApplicationName!=="","Valid application name is required");var H=i.Application;var I=JSON.stringify({ApplicationName:i.ApplicationName,SemanticObject:i.SemanticObject,Application:H});function J(){j(undefined,g('5201'));}var K=k(H);var L=b.upsert(K,'metadata','apfapplication','CUSTOMER',I,'application/json');L.then(function(M){j({Application:H,ApplicationName:i.ApplicationName,SemanticObject:i.SemanticObject});},J);}function C(i,j){var H=i[0].value;function I(L){var M=D(L);j(h(),M);}var J=k(H);var K=b.listContent(J,'CUSTOMER');K.then(function(L){var M=L.response;var P=[];M.forEach(function(O){P.push(b.deleteFile(J,O.name,O.fileType,O.layer));});var N=Promise.all(P);return N;},I).then(function(L){j(h());},I);}function D(i){var j;if(i.messageObject&&i.messageObject.getCode){j=i.messageObject;}else if(i.response&&i.response.statusCode&&i.response.statusCode>=400){j=m.createMessageObject({code:'11005',aParameters:[i.response.statusCode.toString(),i.response.statusText]});}else{j=m.createMessageObject({code:'5201'});}m.putMessage(j);return j;}function E(H){function I(i){H(undefined,h(),m.createMessageObject({code:'5201'}));}var J=b.listContent(n,'CUSTOMER');var K=0;var L=[];J.then(function(j){var M=j.response.length;for(var i=0;i<M;i++){var N=j.response[i].name;if(sap.apf.utils.isValidPseudoGuid(N)){var O=k(N);var P=b.getStaticResource(O,'metadata','apfapplication');K++;L.push(P);}}return Promise.all(L);},I).then(function(M){var N=[];var O=M;if(O.length===undefined&&K>0){for(var j=0;j<K;j++){N.push(L[j].response);}}var i;for(i=0;i<O.length;i++){N.push(O[i].response);}H(N,h());},I);}function F(i,j,H,I,J){var K=f(J);var O={async:false,complete:function(M){var N={};N.SerializedAnalyticalConfiguration=M.responseText;i(N,h());}};var P=[];var L;var R="/sap/bc/lrep/content/";a.instance.messageHandler.check(I===undefined||I.indexOf("SerializedAnalyticalConfiguration")>=0,"layered repository proxy - read configuration async without analytical configuration - not supported call");R+=n+"/"+H+'/'+j+'.apfconfiguration';if(K){P.push({name:"layer",value:K});}R+=b._buildParams(P);L=b.send(R,'GET',{},O);L.then(function(M){},function(M){i(undefined,h(),g('5201'));});}function G(){if(a.constructor&&a.constructor.LrepConnector){b=a.constructor.LrepConnector.createConnector();}else{b=sap.ui.fl.LrepConnector.createConnector();}if(!b._sClient){b._sClient=c.getStartParameterFacade().getSapClient();}}this.getConnector=function(){return b;};this.readEntity=function(j,H,I,J,K,L,M){var N=I[0].value;var O=k(L);var P=[];var Q=false;var R=1;var S=0;var T;var U=e.getItem(L);var V;var W;var i;var X;var Y;var Z;var $;var _=f(M);a.instance.messageHandler.check(j==='configuration',"layered repository proxy - only read entity of configuration supported");if(K!==undefined&&K===false){return F(H,N,L,J,M);}if(J===undefined||J.indexOf("SerializedAnalyticalConfiguration")>=0){Q=true;var a1=b.getStaticResource(O,N,'apfconfiguration');P.push(a1);}else{R=0;}if(U===undefined){U=new sap.apf.utils.Hashtable(a.instance.messageHandler);}T=U.getItem(N);if(T===undefined){var b1=b.getFileAttributes(O,N,'apfconfiguration',_);P.push(b1);}V=Promise.all(P);V.then(function(c1){U=e.getItem(L);if(U===undefined){U=new sap.apf.utils.Hashtable(a.instance.messageHandler);}T=U.getItem(N);if(T===undefined){T=c1[R].response;}U.setItem(N,T);e.setItem(L,U);W=z(L,T);if(Q){$=c1[S].response;W.SerializedAnalyticalConfiguration=JSON.stringify($);W=jQuery.extend({},true,$,W);}W.AnalyticalConfiguration=N;if(J&&J.length!==0){X=J.length;Y={};for(i=0;i<X;i++){Z=J[i];Y[Z]=W[Z];}W=Y;}H(W,h());},function(c1){H(undefined,h(),g('5201'));});};this.doChangeOperationsInBatch=function(j,H,I){function J(M,N){H(N);}var i,K;function L(){}p(I).then(function(){for(i=0;i<j.length;i++){K=j[i];K.application=I;if(K.method==='DELETE'&&K.entitySetName==='texts'){l(K,L);}else if(K.method==='POST'&&sap.apf.utils.isValidPseudoGuid(K.data.TextElement)){q(K.data,L);}else{q(K.data,L);}}u(I,J,true);}).fail(function(M){H(M);});};this.readCollectionsInBatch=function(j,H,I){var J=this;var K=j.length;var L=[];var M=0;function N(P){function Q(R,S,T){if(T){H(undefined,T);}else{M++;L[P]=R;if(M===K){H(L);}}}return Q;}for(var i=0;i<K;i++){var O=j[i];J.readCollection(O.entitySetName,N(i),O.inputParameters,O.selectList,O.filter,I);}};this.readCollection=function(i,j,H,I,J,K){var L=this;var T,M,N;var O;var P=function(N){var R=new sap.apf.utils.Hashtable(a.instance.messageHandler);var S=[];var U=(N&&N.response)||(N&&N.responseText)||"";var V=sap.apf.utils.parseTextPropertyFile(U,{instance:{messageHandler:m}});R=new sap.apf.utils.Hashtable(a.instance.messageHandler);V.TextElements.forEach(function(W){R.setItem(W.TextElement,W);S.push(W);});d.setItem(M,R);j(S,h());};if(i==='application'){m.check(!H&&!I&&!J,"unsupported parameters when calling readCollection for application");m.check(K===undefined||K===true,'no async readCollection of application supported');E(j);}else if(i==='texts'){T=J.getFilterTermsForProperty('Application');M=T[0].getValue();if(K!==undefined&&K===false){o(M,P,true);}else{O=o(M,undefined,false);O.then(function(N){P(N);},function(R){var S=D(Error);j(undefined,h(),S);});}}else if(i==='configuration'){T=J.getFilterTermsForProperty('Application');M=T[0].getValue();N=[];var Q=function(R,S){function U(V,W,S){N.push(V);if(N.length===R.length){j(N,h(),S);}}if(R.length===0){j(N,h(),S);}R.forEach(function(V){L.readEntity('configuration',U,[{value:V}],I,K,M);});};r(M,Q);}};this.remove=function(i,j,H,I,J){if(i==='application'){C(j,H);}else if(i==='configuration'){y(j,H,J);}else{m.check(false,'the remove operation on entity set '+i+' is currently not supported by the lrep proxy');}};this.create=function(i,j,H,I,J){if(i==='application'){m.check(I===undefined||I===true,'no async creation of application supported');A(j,H,J);}else if(i==='configuration'){m.check(I===undefined||I===true,'no async creation of configuration supported');x(j,H,J);}else if(i==='texts'&&I===false){q(j,H,false);}else{m.check(false,'the create operation on entity set '+i+' is currently not supported by the lrep proxy');}};this.update=function(i,j,H,I){if(i==='configuration'){w(j,H);}else if(i==='application'){B(j,H);}else{m.check(false,'the update operation on entity set '+i+' is currently not supported by the lrep proxy');}};G();};}());};if(!jQuery.sap.isDeclared('sap.apf.core.messageHandler')){jQuery.sap.declare("sap.apf.core.messageHandler");sap.apf.core.MessageHandler=function(l){var t=this;var T;var L=[];var n=0;var a;var m;var A=function(){};var o=false;var d=false;var D=false;var h=false;var u="";var b={code:sap.apf.core.constants.message.code.errorUnknown,severity:sap.apf.core.constants.message.severity.error,rawText:"Unknown Error occurred"};this.createMessageObject=function(C){if(l){var M=new sap.apf.core.MessageObject(C);if(M.getCode()===undefined){M.setCode(sap.apf.core.constants.message.code.errorUnknown);}p.bind(this)(M);q(M,1);}return new sap.apf.core.MessageObject(C);};this.activateOnErrorHandling=function(O){o=O;if(o===true){jQuery(window).on("error",v);}else{jQuery(window).off("error");}};this.setTextResourceHandler=function(i){T=i;};this.loadConfig=function(M,R){if(a===undefined||R){a=new sap.apf.utils.Hashtable(t);}for(var i=0;i<M.length;i++){r(M[i]);}};this.setMessageCallback=function(C){if(C!==undefined&&typeof C==="function"){m=C;}else{m=undefined;}};this.setApplicationMessageCallback=function(C){if(C!==undefined&&typeof C==="function"){A=C;}else{A=function(){};this.putMessage(this.createMessageObject({code:"5031"}));}};this.putMessage=function(M){var P;var i=0;var x;if(M.getCode()===undefined){M.setCode(sap.apf.core.constants.message.code.errorUnknown);}p.bind(this)(M);if(M.getSeverity()===sap.apf.core.constants.message.severity.fatal){x=t.createMessageObject({code:sap.apf.core.constants.message.code.errorExitTriggered});p.bind(this)(x);x.setSeverity(sap.apf.core.constants.message.severity.fatal);if(x.getMessage()===""){x.setMessage("You must log out of the application due to a critical error");}}P=M.getPrevious();while(P!==undefined&&P.type&&P.type==="messageObject"&&i<10){if(P.getCode()===undefined){P.setCode(sap.apf.core.constants.message.code.errorUnknown);}p.bind(this)(P);P=P.getPrevious();i++;}if(x!==undefined){x.setPrevious(M);M=x;}if(!l){q(M,10);}if(d){return;}if(m!==undefined){d=true;m(M,A);d=false;}if(M.getSeverity()===sap.apf.core.constants.message.severity.fatal){if(sap.ui.Device.browser.firefox){h=true;}throw new Error(u);}};this.check=function(i,M,C){var E=C||sap.apf.core.constants.message.code.errorCheck;if(!i){var x=this.createMessageObject({code:E,aParameters:[M]});t.putMessage(x);}};this.getConfigurationByCode=function(E){if(a===undefined){return undefined;}return a.getItem(E);};this.getLogMessages=function(){return jQuery.extend(true,[],L);};this.reset=function(){a=undefined;m=undefined;A=undefined;L=[];};function c(E){if(sap.ui.Device.browser.firefox){return h;}return(E.originalEvent&&E.originalEvent.message&&E.originalEvent.message.search(u)>-1);}function e(E){return(E.originalEvent&&E.originalEvent.message&&E.originalEvent.message.search(u)===-1&&E.originalEvent.message.search(sap.apf.core.constants.message.code.suppressFurtherException)>-1);}function g(){var i=new Date();var x=Math.random()*i.getTime();return sap.apf.core.constants.message.code.suppressFurtherException+x;}function f(C){var N=parseInt(C,10);if(N==sap.apf.core.constants.message.code.errorExitTriggered){return true;}else if(N>=sap.apf.core.constants.message.code.errorUnknown&&N<=sap.apf.core.constants.message.code.warningAnalyticalConfig){return true;}return false;}function j(C){var N=parseInt(C,10);if(N>sap.apf.core.constants.message.code.errorUnknown&&N<=sap.apf.core.constants.message.code.errorInAnalyticalConfig){return true;}return false;}function k(C){var N=parseInt(C,10);if(N===sap.apf.core.constants.message.code.warningAnalyticalConfig){return true;}return false;}function p(M){var C=M.getCode();var i=t.getConfigurationByCode(C);if(i===undefined){i=jQuery.extend(true,{},b);if(f(C)){if(M.hasRawText()){i.rawText=M.getRawText();}i.rawText+=' '+M.getParameters();if(j(C)){i.severity=sap.apf.core.constants.message.severity.fatal;}else if(k(C)){i.severity=sap.apf.core.constants.message.severity.warning;}}else{i.rawText="Message "+C+"  "+M.getParameters()+" (Message Code has no Configuration)";}if(!f(C)){M.setCode(i.code);}}if(i.severity!==undefined){M.setSeverity(i.severity);}else{M.setSeverity(sap.apf.core.constants.message.severity.technError);}if(i.rawText){M.setMessage(i.rawText);}else{var P=M.getParameters();if(M.getSeverity()===sap.apf.core.constants.message.severity.technError){var x=t.getConfigurationByCode(i.code).text;if(!x){x=t.getConfigurationByCode(i.code).description;}var y=0;while(x.indexOf("{"+y+"}")>-1){if(typeof P[y]==="string"){x=x.replace("{"+y+"}",P[y]);}else{x=x.replace("{"+y+"}","undefined");}y++;}M.setMessage(x);}else{try{if(T){M.setMessage(T.getMessageText(i.key,M.getParameters()));}else{M.setMessage("Message Code: "+C+" "+P.toString());}}catch(E){M.setMessage("Message Code: "+C+" "+P.toString());}}}}function q(M,i){var x="APF message ";var P="";var y=i-1;if(i===0){return;}var z=M.getPrevious();if(z!==undefined){q(z,y);P=" - (see previous message for more information)";}n++;var B=x+'('+n+'): '+M.getCode()+" - "+M.getMessage()+P;if(D){alert("Fatal Error during Log Writing "+B);return;}D=true;if(M.getSeverity()===sap.apf.core.constants.message.severity.fatal){if(L.length<2){L.unshift(B);}}switch(M.getSeverity()){case sap.apf.core.constants.message.severity.warning:jQuery.sap.log.warning(B);break;case sap.apf.core.constants.message.severity.error:jQuery.sap.log.error(B);break;case sap.apf.core.constants.message.severity.fatal:jQuery.sap.log.error(B);break;case sap.apf.core.constants.message.severity.technError:jQuery.sap.log.error(B);break;default:jQuery.sap.log.info(B);}D=false;}function s(i){t.check(i!==undefined&&i.hasOwnProperty("code")!==false,"MessageHandler setItem: oItem is undefined or property 'code' is missing",sap.apf.core.constants.message.code.errorStartUp);var x=a.setItem(i.code,i);t.check((x===undefined),"MessageHandler setItem: Configuration includes duplicated codes",sap.apf.core.constants.message.code.errorStartUp);}function r(M){if(M.type===undefined){M.type="message";}s(M);}function v(E){var M;var i="";var x="";var U="";var y="";var B=true;if(sap.ui.Device.browser.firefox){B=false;}if(B&&E&&E.originalEvent){i=E.originalEvent.message;U=E.originalEvent.filename;x=E.originalEvent.lineno;}if(c(E)){E.stopImmediatePropagation();E.preventDefault();}else if(e(E)){return;}else if(d){M=new sap.apf.core.MessageObject({code:sap.apf.core.constants.message.code.errorStopProcessing});M.setSeverity(sap.apf.core.constants.message.severity.error);y="Unknown exception happened during processing of error by callback function ";if(B){y=y+i+" (source: "+U+":"+x+")";}M.setMessage(y);q(M,1);}else{M=new sap.apf.core.MessageObject({code:sap.apf.core.constants.message.code.errorUnknown});M.setSeverity(sap.apf.core.constants.message.severity.error);y="Unknown exception ";if(B){y=y+i+" (source: "+U+":"+x+")";}M.setMessage(y);q(M,1);}}function w(){u=g();}w();};};if(!jQuery.sap.isDeclared('sap.apf.core.metadata')){jQuery.sap.declare("sap.apf.core.metadata");sap.apf.core.Metadata=function(I,a){'use strict';this.type="metadata";var t=this;var c=I.coreApi;var A=[];var b=[];var h=new I.hashtable(I.messageHandler);var H=new I.hashtable(I.messageHandler);var o=new I.hashtable(I.messageHandler);var d=new I.hashtable(I.messageHandler);var e=new I.hashtable(I.messageHandler);var f=new I.hashtable(I.messageHandler);var g=new I.hashtable(I.messageHandler);var j=new I.hashtable(I.messageHandler);var k=new I.hashtable(I.messageHandler);var l=new I.hashtable(I.messageHandler);var m=new I.hashtable(I.messageHandler);var O=I.ODataModel||sap.ui.model.odata.ODataModel;var D=false;if(I.deactivateFatalError){D=true;}var M;var E;var s;function n(){return A;}function p(i){var L;function N(Q){if(!L.dataType){L.dataType={};}L.dataType[Q]=L[Q];delete L[Q];}function P(Q,R){if(jQuery.isArray(L[R])===true){(L[R]).forEach(function(S){L[S.name]=S.value;});delete L[R];}else if(R!=="dataType"&&typeof(L[R])==="object"){if(Object.keys(L[R]).length===0){L[Q]="true";}jQuery.each(L[R],function(S,T){L[Q]=T;});delete L[R];}else{L[Q]=L[R];}}if(i===null){return{};}L=jQuery.extend(true,{},i);jQuery.each(L,function(Q){switch(Q){case'type':N(Q);break;case'maxLength':N(Q);break;case'precision':N(Q);break;default:var R=Q.split(".").pop();if(R.search("ISO")===0){P(R,Q);}else{P(R.replace(/^./,R[0].toLowerCase()),Q);}break;}});r(L);return L;}function r(L){for(var i in L){if(/^sap:/.test(i)){delete L[i];}}}function q(i,L){if(d.hasItem(i)!==true){var N;var P={};var R={allParameters:[],keyParameters:[]};if(z(i)){N=J(i);if(N.key&&N.key.propertyRef){N.key.propertyRef.forEach(function(Q){P[Q.name]=null;});}N.property.forEach(function(Q){var S=p(Q);S.isKey=P.hasOwnProperty(S.name);R.allParameters.push(S);if(S.isKey){R.keyParameters.push(S);}});}d.setItem(i,R);}if(!L){return d.getItem(i).allParameters;}return d.getItem(i).keyParameters;}function u(i){var P=[];if(z(i)){i=G(i);}if(B(i)){var L=J(i);L.property.forEach(function(N){P.push(N.name);});}return P;}function v(L){var i;if(o.hasItem(L)===true){return o.getItem(L);}var N;var P=[];var Q=[];var R=G(L);if(R&&B(R)){var S=J(R);S.property.forEach(function(U){P.push(U.name);});}var T=q(L,false);for(i=0;i<T.length;i++){Q.push(T[i].name);}N=P.concat(Q);o.setItem(L,N);return N;}function w(i){return f.getItem(i);}function x(i){var L;if(J(i)){L=i;}else{L=w(i);L=L||w(i+"Results");}return L;}function y(i){if(H.hasItem(i)===false){var R=[];if(B(i)){var L=J(i);L.property.forEach(function(N){if(!(N["sap:filterable"]==="false"||N.filterable&&N.filterable==="true")){R.push(N.name);}});}H.setItem(i,R);}return H.getItem(i);}function z(i){return C(i)==="parameters";}function B(i){return C(i)==="aggregate";}function C(i){if(!g.hasItem(i)){var L=J(i);var N=L&&L["sap:semantics"]||"undefined";g.setItem(i,N);}return g.getItem(i);}function F(i,P){if(h.hasItem(i+P)===false){var L=z(i);var N=J(i);var Q=M.getODataProperty(N,P);if(!Q&&L){var R=G(i);N=J(R);Q=M.getODataProperty(N,P);}h.setItem(i+P,p(Q));}return h.getItem(i+P);}function G(i){var R=k.getItem(i);if(R){return w(R.toAggregateEntitySet);}else{return i;}}function J(i){if(!i){return;}if(!m.hasItem(i)){var L=M.getODataEntityType(E+i);if(!L){return L;}m.setItem(i,L);}return m.getItem(i);}function K(){var i=S();var L;if(!i.getServiceMetadata()){L="5018";if(D){L="11013";}I.messageHandler.putMessage(I.messageHandler.createMessageObject({code:L,aParameters:[a],oCallingObject:t}));t.failed=true;return;}M=i.getMetaModel();N();P();Q(i);R();function N(){var T={};M.getODataEntityContainer().entitySet.forEach(function(U){var V=U.entityType.split(/[. ]+/).pop();f.setItem(U.name,V);if(!T.hasOwnProperty(V)){T[V]=true;A.push(V);}});}function P(){var T=M.getODataEntityContainer().entitySet[0].entityType.split(".");T.pop();E=T.join(".")+".";}function Q(T){var U=T.getServiceAnnotations();if(U&&U.aliasDefinitions&&U.aliasDefinitions.Capabilities){s=U.aliasDefinitions.Capabilities+".";}}function R(){var T=M.getODataEntityContainer();if(!T.associationSet){return;}T.associationSet.forEach(function(U){var V=U.end[0].entitySet,W=U.end[1].entitySet,X,Y;if(z(w(V))){X=V;}else if(B(w(V))){Y=V;}if(z(w(W))){X=W;}else if(B(w(W))){Y=W;}if(!X||!Y){return;}var Z;var $=J(w(X));var _;$.navigationProperty.forEach(function(b1){if(_){return;}if(b1.relationship===U.association){Z=b1.name;_=true;}});if(!Z){return;}var a1={navigationProperty:Z,fromParameterEntitySet:X,toAggregateEntitySet:Y,fromIsUnique:undefined,toIsUnique:undefined};if(j.hasItem(X)){a1.fromIsUnique=false;j.getItem(X).fromIsUnique=false;}else{a1.fromIsUnique=true;j.setItem(X,a1);k.setItem(w(X),a1);}if(l.hasItem(Y)){l.getItem(Y).toIsUnique=false;}else{a1.toIsUnique=true;l.setItem(Y,a1);}});}function S(){var T=c.getUriGenerator().getODataPath(a)+"annotation.xml";var U=sap.apf.core.utils.fileExists(T);if(U){var V={loadMetadataAsync:false,annotationURI:T,json:true};}else{V={loadMetadataAsync:false,json:true};}return new O(a,V);}}this.getPropertyMetadata=function(i,P){I.messageHandler.check(i!==undefined&&typeof i==="string","sap.apf.core.Metadata:getPropertyMetadata incorrect EntityType name or type");I.messageHandler.check(P!==undefined&&typeof P==="string","sap.apf.core.Metadata:getPropertyMetadata incorrect sPropertyName name or type");var L=x(i);if(!L){return{};}return F(L,P);};this.getUriComponents=function(i){if(!w(i)){if(w(i+"Results")){return{entitySet:i+"Results",navigationProperty:""};}return null;}var R;switch(C(w(i))){case"undefined":return{entitySet:i,navigationProperty:""};case"parameters":R=j.getItem(i);if(!R||R.fromIsUnique===false){return{entitySet:i,navigationProperty:undefined};}return{entitySet:i,navigationProperty:R.navigationProperty};case"aggregate":R=l.getItem(i);if(!R){return{entitySet:i,navigationProperty:""};}if(R.toIsUnique===false){return{entitySet:undefined,navigationProperty:undefined};}return{entitySet:R.fromParameterEntitySet,navigationProperty:R.navigationProperty};}};this.getFilterableProperties=function(i){I.messageHandler.check(i!==undefined&&typeof i==="string","sap.apf.core.Metadata:getFilterableProperties incorrect EntityType name or type");var L=x(i);if(!L){return[];}L=G(L);return y(L);};this.getAllPropertiesOfExtendedEntityType=function(i){I.messageHandler.check(i!==undefined&&typeof i==="string","sap.apf.core.Metadata:getAllProperties incorrect EntityType name or type");var L=x(i);if(!L){return[];}return v(L);};this.getAllAggregatePropertiesOfEntitySet=function(i){I.messageHandler.check(i!==undefined&&typeof i==="string","sap.apf.core.Metadata:getAllProperties incorrect EntityType name or type");var L=x(i);return u(L);};this.getAllAggregateProperties=function(){if(b.length===0){n().forEach(function(i){if(z(i)!==false){return;}b=b.concat(u(i));});b=sap.apf.utils.eliminateDuplicatesInArray(I.messageHandler,b);}return b;};this.getAllProperties=function(){var i=[];n().forEach(function(L){i=i.concat(v(L));});i=sap.apf.utils.eliminateDuplicatesInArray(I.messageHandler,i);return i;};this.getParameterEntitySetKeyPropertiesForService=function(){var i=[];n().forEach(function(L){q(L,true).forEach(function(N){i.push(N.name);});});i=sap.apf.utils.eliminateDuplicatesInArray(I.messageHandler,i);return i;};this.getAllKeys=function(){var i=[];var L=[];n().forEach(function(N){if(!z(N)&&!B(N)){return;}var P=J(N);L=[];if(P.key&&P.key.propertyRef){P.key.propertyRef.forEach(function(Q){L.push(Q.name);});}i=i.concat(L);});i=sap.apf.utils.eliminateDuplicatesInArray(I.messageHandler,i);return i;};this.getAttributes=function(P){var i=false;var L;n().forEach(function(N){if(i){return;}L=F(N,P);if(L.name){i=true;}});return L;};this.getParameterEntitySetKeyProperties=function(i){I.messageHandler.check(i!==undefined&&typeof i==="string","sap.apf.core.Metadata:getParameterEntitySetKeyProperties incorrect EntityType name or type");var L=x(i);if(!L){return[];}return q(L,true);};this.getEntityTypeAnnotations=function(i){I.messageHandler.check(i!==undefined&&typeof i==="string","sap.apf.core.Metadata:getEntityTypeAnnotations incorrect EntityType name or type");var L=x(i);if(e.hasItem(L)===true){return e.getItem(L);}else{var N={};Q(L,N);var P=G(L);if(P!==L){Q(P,N);}e.setItem(L,N);return e.getItem(L);}function Q(L,R){var S=J(L);for(var T in S){if(T.indexOf(s)!==0){continue;}var U=T.split(".").pop();U=U.replace(/^./,U[0].toLowerCase());for(var V in S[T]){R[U]=S[T][V];}}}};this.getEntitySets=function(){var i={};var L=[];var N=M.getODataEntityContainer();if(N.associationSet){N.associationSet.forEach(function(P){var Q,R;Q=P.end[1].entitySet;R=x(Q);if(!z(R)){i[P.end[1].entitySet]=true;}});}if(N.entitySet){N.entitySet.forEach(function(P){if(!i[P.name]){L.push(P.name);}});}return L;};K();};};if(!jQuery.sap.isDeclared('sap.apf.core.metadataFacade')){jQuery.sap.declare("sap.apf.core.metadataFacade");sap.apf.core.MetadataFacade=function(I,a){this.type="metadataFacade";var m=I.metadataProperty;var M=I.messageHandler;var o=I.metadataFactory;var p;var P;var b={};this.getAllProperties=function(c){if(p){c(p);}else{var d=g();var e;p=[];for(var i=0;i<d.length;i++){e=o.getMetadata(d[i]);p=p.concat(e.getAllProperties());}p=sap.apf.utils.eliminateDuplicatesInArray(M,p);c(p);}};this.getAllParameterEntitySetKeyProperties=function(c){if(P){c(P);}else{var d=g();var e;P=[];for(var i=0;i<d.length;i++){e=o.getMetadata(d[i]);P=P.concat(e.getParameterEntitySetKeyPropertiesForService());}P=sap.apf.utils.eliminateDuplicatesInArray(M,P);c(P);}};this.getProperty=function(n,c){if(b[n]){c(b[n]);}else{var d=g();var e;var f;for(var i=0;i<d.length;i++){f=o.getMetadata(d[i]);e=f.getAttributes(n);if(e.name){if(f.getParameterEntitySetKeyPropertiesForService().indexOf(n)>-1){e.isParameterEntitySetKeyProperty=true;}if(f.getAllKeys().indexOf(n)>-1){e.isKey=true;}break;}}for(var h in e){if(h==="dataType"){for(var j in e.dataType){e[j]=e.dataType[j];}}}var k=new m(e);b[n]=k;c(b[n]);}};function g(){if(typeof a==="string"){return[a];}else{return o.getServiceDocuments();}}};};if(!jQuery.sap.isDeclared('sap.apf.core.odataProxy')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.core.odataProxy");jQuery.sap.require('sap.ui.thirdparty.datajs');(function(){'use strict';sap.apf.core.OdataProxy=function(s,a){var c=a.instance.coreApi;var m=a.instance.messageHandler;var b=s.serviceRoot;var e="";function d(i){if(i===undefined){return true;}return i;}function g(b,i){return c.getEntityTypeMetadata(b,i);}function f(j){var i,u,v;if(!j){return"";}u=j.length;if(u===1){return"('"+j[0].value+"')";}v="(";for(i=0;i<u;i++){if(i>0){v=v+",";}v=v+j[i].name+"='"+j[i].value+"'";}return v+")";}function h(E){var i;if(E.messageObject&&E.messageObject.getCode){i=E.messageObject;}else if(E.response&&E.response.statusCode&&E.response.statusCode>=400){i=m.createMessageObject({code:'11005',aParameters:[E.response.statusCode.toString(),E.response.statusText]});}else{i=m.createMessageObject({code:'5201'});}m.putMessage(i);return i;}function k(E,i){var j=h(E);i(undefined,undefined,j);}function l(D,b,i,j){var u;var v;if(D&&D.results){u=D.results;}else if(D){u=D;}else{v=m.createMessageObject({code:'5201'});}j(u,g(b,i),v);}this.readEntity=function(i,j,u,v,w,x){var A=d(w);var y=sap.apf.core.constants.entitySets[i];var z=c.getXsrfToken(b);var B=b+'/'+y;B=B+f(u);if(v&&v.length>0){B=B+"?$select="+v.join();}var C={requestUri:B,async:A,method:"GET",headers:{"x-csrf-token":z}};c.odataRequest(C,function(D){l(D,b,y,j);},function(E){k(E,j);});};function n(P,v){var i="'";var E=g(b,e).getPropertyMetadata(P);if(E&&E.dataType){return sap.apf.utils.formatValue(v,E.dataType.type);}if(typeof v==='number'){return v;}return i+sap.apf.utils.escapeOdata(v)+i;}function o(j){var x=c.getXsrfToken(b);var u=[];var i,v=j.length;var w,y,S,z,A;for(i=0;i<v;i++){S=false;y=sap.apf.core.constants.entitySets[j[i].entitySetName];w=y;w=w+f(j[i].inputParameters);if(j[i].selectList&&j[i].selectList.length>0){w=w+"?$select="+j[i].selectList.join();S=true;}if(j[i].filter){if(S){w=w+'&';}else{w=w+'?';}e=y;w=w+'$filter='+j[i].filter.toUrlParam({formatValue:n});}z=j[i].method||'GET';A={requestUri:w,method:z,headers:{"Accept-Language":sap.ui.getCore().getConfiguration().getLanguage(),"x-csrf-token":x}};if(z!=="GET"){A.data=j[i].data;}u.push(A);}return u;}function p(i,j,u,v){var Q='';var w=i+f(j);if(u&&u.length>0){Q="$select="+u.join();}if(v){if(Q){Q=Q+'&';}e=i;Q=Q+'$filter='+v.toUrlParam({formatValue:n});}if(i===sap.apf.core.constants.entitySets.application){if(Q){Q=Q+'&';}Q=Q+'$orderby=ApplicationName';}if(Q){w=w+'?'+Q;}return w;}function q(i,j){var u="unknown error";var v="unknown error";var w="";if(i.message!==undefined){u=i.message;}var x="unknown";if(i.response&&i.response.statusCode){x=i.response.statusCode;v=i.response.statusText||"";w=i.response.requestUri;}if(i.messageObject&&i.messageObject.type==="messageObject"){j([],i.messageObject);}else{j([],m.createMessageObject({code:"5001",aParameters:[x,u,v,w]}));}}this.doChangeOperationsInBatch=function(u,v){var x=c.getXsrfToken(b);var w=o(u);var y={requestUri:b+'/'+'$batch',method:"POST",headers:{"x-csrf-token":x},data:{__batchRequests:[{__changeRequests:w}]}};var S=function(z,A){var B;var C;var D="";var i,j;if(z&&z.__batchResponses){for(i=0;i<z.__batchResponses.length;i++){if(z.__batchResponses[i].message){var F=z.__batchResponses[i].message;var G="";D=A.requestUri;B=m.createMessageObject({code:"5001",aParameters:[G,F,"",D]});break;}for(j=0;j<z.__batchResponses[i].__changeResponses.length;j++){C=z.__batchResponses[i].__changeResponses[j];if(C.message){var F=C.message;var H=C.data;var G=C.statusCode;D=A.requestUri;B=m.createMessageObject({code:"5001",aParameters:[G,F,H,D]});break;}}}v(B);}};var E=function(i){q(i,v);};c.odataRequest(y,S,E,OData.batchHandler);};this.readCollectionsInBatch=function(j,u,v){var x=c.getXsrfToken(b);var w=o(j);var A=d(v);var y={requestUri:b+'/'+'$batch',async:A,method:"POST",headers:{"x-csrf-token":x},data:{__batchRequests:w}};var S=function(z){var B=[];var C;var D="";var i;if(z&&z.__batchResponses){for(i=0;i<z.__batchResponses.length;i++){if(z.__batchResponses[i].data&&z.__batchResponses[i].data.results){B.push(z.__batchResponses[i].data.results);}else if(z.__batchResponses[i].message){var F=z.__batchResponses[i].message;var G=z.__batchResponses[i].response.body;var H=z.__batchResponses[i].response.statusCode;D=B.requestUri;C=m.createMessageObject({code:"5001",aParameters:[H,F,G,D]});break;}else{D=B.requestUri;C=m.createMessageObject({code:"5001",aParameters:["unknown","unknown error","unknown error",D]});break;}}u(B,C);}};var E=function(i){q(i,u);};c.odataRequest(y,S,E,OData.batchHandler);};this.readCollection=function(i,j,u,v,w,x){var A=d(x);if(A){t(i,j,u,v,w);}else{r(i,j,u,v,w);}};function r(i,j,u,v,w){var x=sap.apf.core.constants.entitySets[i];var y=c.getXsrfToken(b);var z=b+'/'+p(x,u,v,w);var A={requestUri:z,async:false,method:"GET",headers:{"x-csrf-token":y}};c.odataRequest(A,function(D){l(D,b,x,j);},function(E){k(E,j);});}function t(i,j,u,v,w){var x=sap.apf.core.constants.entitySets[i];var y=function(B,C){var C;var D;var E="";if(B&&B.__batchResponses){if(B.__batchResponses[0].data&&B.__batchResponses[0].data.results){C=B.__batchResponses[0].data.results;}else if(B.__batchResponses[0].message){var F=B.__batchResponses[0].message;var G=B.__batchResponses[0].response.body;var H=B.__batchResponses[0].response.statusCode;E=C.requestUri;D=m.createMessageObject({code:"5001",aParameters:[H,F,G,E]});}else{E=C.requestUri;D=m.createMessageObject({code:"5001",aParameters:["unknown","unknown error","unknown error",E]});}j(C,g(b,x),D);}};var z=c.getXsrfToken(b);var A={requestUri:b+'/'+'$batch',async:true,method:"POST",headers:{"x-csrf-token":z},data:{__batchRequests:[{requestUri:p(x,u,v,w),method:"GET",headers:{"x-csrf-token":z,"Accept-Language":sap.ui.getCore().getConfiguration().getLanguage()}}]}};c.odataRequest(A,y,function(E){k(E,j);},OData.batchHandler);}this.create=function(i,j,u,v){var A=d(v);var w=sap.apf.core.constants.entitySets[i];var x=c.getXsrfToken(b);var y=b+'/'+w;var z={requestUri:y,async:A,method:"POST",headers:{"x-csrf-token":x},data:j};function B(D,R){var E;var F;if(D&&R.statusText==="Created"){E=D;}else{F=m.createMessageObject({code:'5201'});}u(E,g(b,w),F);}function C(E){var D=h(E);u(undefined,undefined,D);}c.odataRequest(z,B,C);};this.update=function(i,j,u,v){var w=sap.apf.core.constants.entitySets[i];var x=c.getXsrfToken(b);var y=b+'/'+w+f(v);var z={requestUri:y,method:"PUT",headers:{"x-csrf-token":x},data:j};function A(D,R){var C;if(R.statusCode!==204){C=m.createMessageObject({code:'5201'});}u(g(b,w),C);}function B(E){var C=h(E);u(undefined,C);}c.odataRequest(z,A,B);};this.remove=function(i,j,u,v){var w=sap.apf.core.constants.entitySets[i];var x=c.getXsrfToken(b);var y=b+'/'+w+f(j);if(v){e=w;y=y+'$filter='+v.toUrlParam({formatValue:n});}var z={requestUri:y,method:"DELETE",headers:{"x-csrf-token":x}};function A(D,R){var C;var E;if(R.statusText==="No Content"){E=g(b,w);}else{C=m.createMessageObject({code:'5201'});}u(E,C);}function B(E){var C=h(E);u(undefined,C);}c.odataRequest(z,A,B);};};}());};if(!jQuery.sap.isDeclared('sap.apf.core.odataRequest')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.apf.core.odataRequest");jQuery.sap.require('sap.ui.thirdparty.datajs');sap.apf.core.odataRequestWrapper=function(m,r,s,e,b){function a(d,f){var M=sap.apf.core.utils.checkForTimeout(f);var E={};if(M){E.messageObject=M;e(E);}else{s(d,f);}}function c(E){var M=sap.apf.core.utils.checkForTimeout(E);if(M){E.messageObject=M;}e(E);}OData.request(r,a,c,b);};};if(!jQuery.sap.isDeclared('sap.apf.core.textResourceHandler')){jQuery.sap.declare("sap.apf.core.textResourceHandler");jQuery.sap.require('jquery.sap.resources');(function(){'use strict';sap.apf.core.TextResourceHandler=function(I){var t=this;var m=I.messageHandler;var c=I.coreApi;var h=new sap.apf.utils.Hashtable(m);var H=new sap.apf.utils.Hashtable(m);this.getTextNotHtmlEncoded=function(L,p){if(typeof L==="string"){return b(L,p);}m.check((L!==undefined&&L.kind!==undefined),"Error - oLabel is not compatible");if(L.kind==="text"){m.check((L.key!==undefined),"Error - oLabel is not compatible");return a(L,p);}return"";};this.getTextHtmlEncoded=function(L,p){return jQuery.sap.encodeHTML(this.getTextNotHtmlEncoded(L,p));};this.getMessageText=function(r,p){var T;l(sap.apf.core.constants.resourceLocation.apfUiTextBundle,sap.apf.core.constants.resourceLocation.applicationMessageTextBundle);if(h.hasItem(sap.apf.core.constants.resourceLocation.applicationMessageTextBundle)){T=h.getItem(sap.apf.core.constants.resourceLocation.applicationMessageTextBundle).getText(r,p);if(T!==r){return T;}}return h.getItem(sap.apf.core.constants.resourceLocation.apfUiTextBundle).getText(r,p);};this.loadTextElements=function(e){var i,f;f=e.length;for(i=0;i<f;i++){H.setItem(e[i].TextElement,e[i].TextElementDescription);}};function l(A,o){var u;if(h.hasItem(A)===false){u=c.getResourceLocation(A);d(A,u);}u=c.getResourceLocation(o);if(u!==""&&h.hasItem(o)===false){d(o,u);}}function a(L,p){if(L.key===sap.apf.core.constants.textKeyForInitialText){return"";}l(sap.apf.core.constants.resourceLocation.apfUiTextBundle,sap.apf.core.constants.resourceLocation.applicationUiTextBundle);if(k(L.key,sap.apf.core.constants.resourceLocation.applicationUiTextBundle)){return h.getItem(sap.apf.core.constants.resourceLocation.applicationUiTextBundle).getText(L.key,p);}else if(k(L.key,sap.apf.core.constants.resourceLocation.apfUiTextBundle)){return h.getItem(sap.apf.core.constants.resourceLocation.apfUiTextBundle).getText(L.key,p);}else if(H.hasItem(L.key)){return H.getItem(L.key);}m.putMessage(m.createMessageObject({code:"3001",aParameters:[L.key],oCallingObject:t}));return"# text not available: "+L.key;}function b(e,p){if(e===sap.apf.core.constants.textKeyForInitialText){return"";}l(sap.apf.core.constants.resourceLocation.apfUiTextBundle,sap.apf.core.constants.resourceLocation.applicationUiTextBundle);if(k(e,sap.apf.core.constants.resourceLocation.applicationUiTextBundle)){return h.getItem(sap.apf.core.constants.resourceLocation.applicationUiTextBundle).getText(e,p);}else if(k(e,sap.apf.core.constants.resourceLocation.apfUiTextBundle)){return h.getItem(sap.apf.core.constants.resourceLocation.apfUiTextBundle).getText(e,p);}else if(H.hasItem(e)){return H.getItem(e);}m.putMessage(m.createMessageObject({code:"3001",aParameters:[e],oCallingObject:this}));return"# text not available: "+e;}function k(e,T){var o=h.getItem(T);var i;if(o){o.getText(e);}if(o&&o.aPropertyFiles&&o.aPropertyFiles.length>0&&o.aPropertyFiles[0].aKeys instanceof Array){for(i=0;i<o.aPropertyFiles.length;i++){if(jQuery.inArray(e,o.aPropertyFiles[i].aKeys)>=0){return true;}}}return false;}function d(K,u){var B=jQuery.sap.resources({url:u,includeInfo:sap.ui.getCore().getConfiguration().getOriginInfo()});h.setItem(K,B);}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.utils.filterTerm')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2015 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.apf.core.utils.filterTerm');(function(){'use strict';sap.apf.core.utils.FilterTerm=function(m,p,o,v,h){this.type="filterTerm";var P=p;var O=o;var a=v;if(O.length==2){O=O.toUpperCase();}m.check(O!==undefined,"sap.apf.utils.FilterTerm.constructor operator undefined");m.check(jQuery.inArray(O,sap.apf.core.constants.aSelectOpt)>-1,"sap.apf.core.utils.FilterTerm operator "+O+" not supported");m.check(P!==undefined,"sap.apf.utils.core.FilterTerm sProperty undefined");m.check(a!==undefined,"sap.apf.utils.FilterTerm value undefined");var c=function(b,d){var e;var i;if(b!==P){return true;}if(O===sap.apf.core.constants.FilterOperators.EQ){if(v instanceof Date&&d instanceof Date){return(v.valueOf()===d.valueOf());}return(v===d);}else if(O===sap.apf.core.constants.FilterOperators.LT){if(v instanceof Date&&d instanceof Date){return(v.valueOf()>d.valueOf());}return(v>d);}else if(O===sap.apf.core.constants.FilterOperators.LE){if(v instanceof Date&&d instanceof Date){return(v.valueOf()>=d.valueOf());}return(v>=d);}else if(O===sap.apf.core.constants.FilterOperators.GT){if(v instanceof Date&&d instanceof Date){return(v.valueOf()<d.valueOf());}return(v<d);}else if(O===sap.apf.core.constants.FilterOperators.BT){if(v instanceof Date&&d instanceof Date){return(v.valueOf()<=d.valueOf()&&d.valueOf()<=h.valueOf());}return(v<=d&&d<=h);}else if(O===sap.apf.core.constants.FilterOperators.GE){if(v instanceof Date&&d instanceof Date){return(v.valueOf()<=d.valueOf());}return(v<=d);}else if(O===sap.apf.core.constants.FilterOperators.NE){if(v instanceof Date&&d instanceof Date){return!(v.valueOf()===d.valueOf());}return!(v===d);}else if(O===sap.apf.core.constants.FilterOperators.StartsWith){if(v.length>d.length){return false;}e=d.slice(0,v.length);return(e===v);}else if(O===sap.apf.core.constants.FilterOperators.EndsWith){if(v.length>d.length){return false;}e=d.slice(-v.length);return(e===v);}else if(O===sap.apf.core.constants.FilterOperators.Contains){i=d.indexOf(v);return(i>-1);}};this.isConsistentWithFilter=function(b,v){return c(b,v);};this.toUrlParam=function(b){var s="'";var d=" ";var e="";var f=[];var v,g;if(b&&b.formatValue){v=b.formatValue(P,a);if(h){g=b.formatValue(P,h);}}else{if(typeof a==='number'){v=a;}else{v=s+sap.apf.utils.escapeOdata(a)+s;}if(h){if(typeof a==='number'){g=h;}else{g=s+sap.apf.utils.escapeOdata(h)+s;}}}if(O===sap.apf.core.constants.FilterOperators.StartsWith){e='startswith('+sap.apf.utils.escapeOdata(P)+','+v+')';e=jQuery.sap.encodeURL(e);}else if(O===sap.apf.core.constants.FilterOperators.EndsWith){e='endswith('+sap.apf.utils.escapeOdata(P)+','+v+')';e=jQuery.sap.encodeURL(e);}else if(O===sap.apf.core.constants.FilterOperators.Contains){e='substringof('+v+','+sap.apf.utils.escapeOdata(P)+')';e=jQuery.sap.encodeURL(e);}else if(O===sap.apf.core.constants.FilterOperators.BT){e='(('+jQuery.sap.encodeURL(sap.apf.utils.escapeOdata(P)+d+"ge"+d+v)+')'+jQuery.sap.encodeURL(d+'and'+d)+'('+jQuery.sap.encodeURL(sap.apf.utils.escapeOdata(P)+d+"le"+d+g)+'))';}else{e='('+jQuery.sap.encodeURL(sap.apf.utils.escapeOdata(P)+d+O.toLowerCase()+d+v)+')';}if(b&&b.asFilterArray===true){f.push(e);return f;}return e;};this.getProperty=function(){return P;};this.getOp=function(){return O;};this.getValue=function(){return a;};this.getHighValue=function(){return h;};this.getHash=function(){var s=P+O+a;return sap.apf.utils.hashCode(s);};this.copy=function(){return new sap.apf.core.utils.FilterTerm(m,P,O,a,h);};this.removeTermsByProperty=function(b){var i=0;var l=0;if(b instanceof Array){l=b.length;for(i=0;i<l;i++){if(P===b[i]){return undefined;}}return this.copy();}if(P===b){return undefined;}return this.copy();};this.removeTerms=function(b,d,v){var i=0;var l=0;if(b instanceof Array){l=b.length;for(i=0;i<l;i++){if(P===b[i]&&O===d&&a===v){return undefined;}}return this.copy();}if(P===b&&O===d&&a===v){return undefined;}return this.copy();};this.mapToSapUI5FilterExpression=function(){if(O===sap.apf.core.constants.FilterOperators.BT){return{path:P,operator:O,value1:a,value2:h};}return{path:P,operator:O,value1:a};};this.traverse=function(b){return b.processTerm(this);};};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.applicationHandler')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.modeler.core.applicationHandler");(function(){'use strict';sap.apf.modeler.core.ApplicationHandler=function(i,a){var t=this;var p=i.instance.persistenceProxy;var m=i.instance.messageHandler;var H=i.constructor.hashtable;var b;this.type="application";this.setAndSave=function(d,e,f,g){if(typeof d==="object"&&typeof e==="function"&&typeof f==="string"&&!g){var h=function(k,l){if(l){e(undefined,k,l);}else{b.setItem(d.Application,d);e(d.Application,k,l);}};if(!d.SemanticObject){d.SemanticObject="";}d.Application=f;p.update(this.type,d,h,[{name:"Application",value:f}]);}else if(typeof d==="object"&&typeof e==="function"){var j=function(r,k,l){if(l){e(r,k,l);}else{b.setItem(r.Application,{Application:r.Application,ApplicationName:r.ApplicationName,SemanticObject:r.SemanticObject});e(r.Application,k,l);}};if(!d.SemanticObject){d.SemanticObject="";}if(g&&f){d.Application=f;}else{d.Application="";}p.create(this.type,d,j);}};this.removeApplication=function(d,e){var f=function(g,h){if(!h){b.removeItem(d);}i.functions.resetConfigurationHandler(d);e(d,g,h);};p.remove(this.type,[{name:"Application",value:d}],f);};this.getList=function(){var d=[];var e=function(k,f){d.push(f);};b.forEachOrdered(e);return d;};this.getApplication=function(d){return b.getItem(d);};function c(){b=new H(m);var d=function(r,e,f){if(r instanceof Array&&f===undefined){r.forEach(function(o){b.setItem(o.Application,{Application:o.Application,ApplicationName:o.ApplicationName,SemanticObject:o.SemanticObject});});}a(t,f);};p.readCollection(t.type,d);}c();};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.configurationEditor')){jQuery.sap.declare("sap.apf.modeler.core.configurationEditor");(function(){'use strict';sap.apf.modeler.core.ConfigurationEditor=function(c,a,b,d){var t=this;var e;var f;var g=a.instance.configurationHandler;var p=a.instance.persistenceProxy;var m=a.instance.messageHandler;var h=a.instance.metadataFactory;var j=true;var s,k,l,n,o,q;var r=new a.constructor.configurationObjects(a);var u=new a.constructor.configurationFactory({messageHandler:m,constructor:{registryProbe:a.constructor.registryProbe}});if(!d){s=new a.constructor.elementContainer("Step",a.constructor.step,a);k=new a.constructor.elementContainer("Category",undefined,a);l=new a.constructor.elementContainer("FacetFilter",a.constructor.facetFilter,a);n=new a.constructor.elementContainer("NavigationTarget",a.constructor.navigationTarget,a);o=new a.constructor.elementContainer("CategoryStepAssignment",a.constructor.elementContainer,a);q=[];}else{s=d.stepContainer;k=d.categoryContainer;l=d.facetFilterContainer;n=d.navigationTargetContainer;o=d.categoryStepAssignmentContainer;q=d.serviceList;}this.registerService=function(i){var y=false;if(q.indexOf(i)===-1){if(h.getMetadata(i)){q.push(i);y=true;}}else{y=true;}return y;};this.getAllServices=function(){return q;};this.getAllEntitySetsOfService=function(i){var y=[];if(q.indexOf(i)>-1){y=h.getEntitySets(i);}return y;};this.getAllEntitySetsOfServiceWithGivenProperties=function(y,z){var A=[],B;var C=this.getAllEntitySetsOfService(y);if(!z||z.length===0){return C;}B=h.getMetadata(y);C.forEach(function(D){var E=B.getFilterableProperties(D);var F=true;for(var i=0;i<z.length;i++){if(E.indexOf(z[i])<=-1){F=false;break;}}if(F){A.push(D);}});return A;};this.getAllPropertiesOfEntitySet=function(i,y){var z=[];if(q.indexOf(i)>-1){z=h.getMetadata(i).getAllAggregatePropertiesOfEntitySet(y);}return z;};this.getAllKnownProperties=function(){var i=[];var y;q.forEach(function(z){y=h.getMetadata(z);i=i.concat(y.getAllProperties());});i=sap.apf.utils.eliminateDuplicatesInArray(m,i);return i;};this.setApplicationTitle=function(i){j=false;e=i;};this.getApplicationTitle=function(){return e;};this.getConfigurationName=function(){if(!f){f=g&&g.getConfiguration&&g.getConfiguration(c.id||c).AnalyticalConfigurationName;}return f;};this.getCategoryStepAssignments=function(i){var y=[];if(!this.getCategory(i)){return false;}var z=o.getElement(i);if(z){z.getElements().forEach(function(A){y.push(A.stepId);});}return y;};this.addCategoryStepAssignment=function(i,y){if(!this.getCategory(i)||!this.getStep(y)){return false;}var z=o.getElement(i);if(!z){o.createElementWithProposedId({},i);z=o.getElement(i);}if(!z.getElement(y)){z.createElementWithProposedId({stepId:y},y);return true;}return false;};this.removeCategoryStepAssignment=function(i,y){var z;if(!y){var A=this.getCategoryStepAssignments(i);z=o.removeElement(i);if(z){_(A);}return!!z;}var B=o.getElement(i);if(!B){return false;}z=B.removeElement(y);if(B.getElements().length===0){o.removeElement(i);}if(z){_([y]);}return!!z;};function _(i){if(!i){return;}i.forEach(function(y){if(t.getCategoriesForStep(y).length===0){v(y);}});}this.moveCategoryStepAssignmentBefore=function(i,y,z){var A=o.getElement(i);if(!A){return null;}return A.moveBefore(y,z);};this.moveCategoryStepAssignmentToEnd=function(i,y){var z=o.getElement(i);if(!z){return null;}return z.moveToEnd(y);};this.moveCategoryStepAssignmentUpOrDown=function(i,y,z){var A=o.getElement(i);if(!A){return null;}return A.moveUpOrDown(y,z);};this.getCategory=k.getElement;this.setCategory=function(i,y){j=false;return k.setElement(i,y);};this.createCategoryWithId=function(i,y){j=false;return k.createElementWithProposedId(i,y).getId();};this.removeCategory=function(i){var y=t.getCategoryStepAssignments(i);if(y){y.forEach(function(z){var A=t.getCategoriesForStep(z);if(!A||A.length<2){v(z);}});}k.removeElement(i);};this.getCategories=k.getElements;this.copyCategory=function(i){var y=k.copyElement(i),z;if(!y){return;}t.getCategoryStepAssignments(i).forEach(function(A){z=w(A,y);});return y;};this.moveCategoryBefore=function(i,y){return k.moveBefore(i,y);};this.moveCategoryToEnd=function(i){return k.moveToEnd(i);};this.moveCategoryUpOrDown=function(i,y){return k.moveUpOrDown(i,y);};this.serialize=function(){return r.serializeConfiguration(t);};this.isSaved=function(){return j;};this.setIsUnsaved=function(){j=false;};this.save=function(i){function y(B,C,D){if(!D){j=true;f=A.AnalyticalConfigurationName;g.replaceConfigurationId(c.id||c,B.AnalyticalConfiguration);c=B.AnalyticalConfiguration;}i(c,C,D);}function z(B,C){if(!C){j=true;f=A.AnalyticalConfigurationName;}i(c.id||c,B,C);}var A={AnalyticalConfiguration:"",AnalyticalConfigurationName:g.getConfiguration(c.id||c).AnalyticalConfigurationName,Application:g.getApplicationId(),SerializedAnalyticalConfiguration:JSON.stringify(this.serialize()),CreatedByUser:"",CreationUTCDateTime:null,LastChangeUTCDateTime:null,LastChangedByUser:""};if(typeof c==='string'){if(c.indexOf("apf1972-")===0){p.create("configuration",A,y);}else{A.AnalyticalConfiguration=c;p.update("configuration",A,z,[{name:"AnalyticalConfiguration",value:c}]);}}else{if(c.id.indexOf("apf1972-")===0){A.AnalyticalConfiguration="";A.CreationUTCDateTime=null;A.LastChangeUTCDateTime=null;}else{A.AnalyticalConfiguration=c.id;A.CreationUTCDateTime=c.creationDate;A.LastChangeUTCDateTime=c.lastChangeDate;}if(c.updateExisting){p.update("configuration",A,z,[{name:"AnalyticalConfiguration",value:c.id}]);}else{p.create("configuration",A,y);}}};this.createFacetFilterWithId=function(i){return l.createElementWithProposedId(undefined,i).getId();};this.createFacetFilter=function(){return l.createElement().getId();};this.removeFacetFilter=l.removeElement;this.getFacetFilter=l.getElement;this.getFacetFilters=l.getElements;this.copyFacetFilter=l.copyElement;this.moveFacetFilterBefore=function(i,y){return l.moveBefore(i,y);};this.moveFacetFilterToEnd=function(i){return l.moveToEnd(i);};this.moveFacetFilterUpOrDown=function(i,y){return l.moveUpOrDown(i,y);};this.createNavigationTargetWithId=function(i){return n.createElementWithProposedId(undefined,i).getId();};this.createNavigationTarget=function(){return n.createElement().getId();};this.removeNavigationTarget=n.removeElement;this.getNavigationTarget=n.getElement;this.getNavigationTargets=n.getElements;this.copyNavigationTarget=n.copyElement;this.moveNavigationTargetBefore=function(i,y){return n.moveBefore(i,y);};this.moveNavigationTargetToEnd=function(i){return n.moveToEnd(i);};this.moveNavigationTargetUpOrDown=function(i,y){return n.moveUpOrDown(i,y);};this.createStepWithId=function(i){return s.createElementWithProposedId(undefined,i).getId();};this.createStep=function(i){if(!this.getCategory(i)){return;}var y=s.createElement().getId();this.addCategoryStepAssignment(i,y);return y;};var v=s.removeElement;this.getStep=s.getElement;this.getSteps=s.getElements;this.getStepsNotAssignedToCategory=function(i){var y=this.getCategoryStepAssignments(i);var z=[];t.getSteps().forEach(function(A){var B=A.getId();if(y.indexOf(B)===-1){z.push(B);}});return z;};this.copyStep=function(i){var y=w(i);if(!y){return false;}var z=this.getCategoriesForStep(i);if(z){z.forEach(function(A){t.addCategoryStepAssignment(A,y);});}return y;};function w(i,y){if(y&&!t.getCategory(y)){return false;}var z=s.copyElement(i);if(!z){return false;}if(y){t.addCategoryStepAssignment(y,z);}return z;}this.getCategoriesForStep=function getCategoriesForStep(i){var y=[];var z=t.getCategories();if(z){z.forEach(function(A){var B=A.getId();var C=t.getCategoryStepAssignments(B);if(C&&C.indexOf(i)>-1){y.push(B);}});}return y;};this.getAssignableStepsForNavigationTarget=function(i){var y=[];t.getSteps().forEach(function(z){var A=false;z.getNavigationTargets().forEach(function(B){if(i===B){A=true;}});if(!A){y.push(z.getId());}});return y;};this.getStepsAssignedToNavigationTarget=function(i){var y=[];t.getSteps().forEach(function(z){var A=false;z.getNavigationTargets().forEach(function(B){if(i===B){A=true;}});if(A){y.push(z.getId());}});return y;};this.copy=function(i){var y={stepContainer:s,categoryContainer:k,facetFilterContainer:l,navigationTargetContainer:n,categoryStepAssignmentContainer:o,serviceList:q};var d=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(y);return new sap.apf.modeler.core.ConfigurationEditor(i,a,undefined,d);};if(typeof c==='string'){if(c.indexOf("apf1972-")===0){j=false;if(b){b(t,undefined);}}else{if(!d){x(c,p,function(i,y){if(!y){var z=JSON.parse(i.SerializedAnalyticalConfiguration);t.setApplicationTitle(z.applicationTitle);u.loadConfig(z);r.mapToDesignTime(u.getRegistry(),t);j=true;f=i.AnalyticalConfigurationName;b(t,undefined);}else{b(undefined,y);}});}}}else{u.loadConfig(c.content);r.mapToDesignTime(u.getRegistry(),this);if(b){b(t,undefined);}}function x(i,y,b){y.readEntity("configuration",function(z,A,B){b(z,B);},[{name:"AnalyticalConfiguration",value:i}],undefined,true,g.getApplicationId());}};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.configurationHandler')){jQuery.sap.declare("sap.apf.modeler.core.configurationHandler");(function(){'use strict';sap.apf.modeler.core.ConfigurationHandler=function(a){var t=this;var m=a.instance.messageHandler;var p=a.instance.persistenceProxy;var C=a.constructor.configurationEditor;var H=a.constructor.hashtable;var L=a.constructor.lazyLoader;var c=new H(m);var l=new H(m);var b=new H(m);var d,e;var f={constructor:{hashtable:H},instance:{messageHandler:m}};this.exportTexts=function(){return e.exportTexts();};this.getTextPool=function(){return e;};this.setApplicationIdAndContext=function(h,j,T){e=T||e;c=new H(m);var i,k=j.length;for(i=0;i<k;i++){c.setItem(j[i].AnalyticalConfiguration,j[i]);}d=h;};this.getApplicationId=function(){return d;};this.setConfiguration=function(h,i){h.AnalyticalConfiguration=i||g();h.Application=d;c.setItem(h.AnalyticalConfiguration,h);return h.AnalyticalConfiguration;};this.getList=function(){var h=[];var i=function(k,j){h.push(j);};c.each(i);return h;};this.getConfiguration=function(i){return c.getItem(i);};this.loadConfiguration=function(h,i){var j,k=h.id||h;if(!h.updateExisting){j=l.getItem(k);}if(!j){j=new L(f,o);l.setItem(k,j);}j.asyncGetInstance(k,n);function n(q,r,s){i(q,r);}function o(k,q,r){var s={instance:{coreApi:a.instance.coreApi,messageHandler:m,datajs:a.instance.datajs,configurationHandler:t,persistenceProxy:p,textPool:e,metadataFactory:a.instance.metadataFactory},constructor:{hashtable:H,step:a.constructor.step,facetFilter:a.constructor.facetFilter,navigationTarget:a.constructor.navigationTarget,representation:a.constructor.representation,configurationObjects:a.constructor.configurationObjects,elementContainer:a.constructor.elementContainer,configurationFactory:a.constructor.configurationFactory,registryProbe:a.constructor.registryProbe}};new C(h,s,function(u,v){q(k,u,v);});}};this.resetConfiguration=function(h){var i;if(l.hasItem(h)){i=c.getItem(h);i.AnalyticalConfigurationName=l.getItem(h).getInstance().getConfigurationName();l.removeItem(h);return h;}};this.copyConfiguration=function(i,h){var j=this.getConfiguration(i);if(!j){h(null);return;}t.loadConfiguration(i,k);function k(n){var o,q,r,s;s=sap.apf.modeler.core.ConfigurationObjects.deepDataCopy(j);o=g();s.AnalyticalConfiguration=o;t.setConfiguration(s,o);q=n.copy(o);r=new L(f,undefined,{id:o,instance:q});l.setItem(o,r);h(o);}};this.replaceConfigurationId=function(h,s){if(h.indexOf("apf1972-")===0){var i=c.getItem(h);var j=l.getItem(h).getInstance();var n=new L(f,undefined,{id:s,instance:j});i.AnalyticalConfiguration=s;c.setItem(s,i);c.removeItem(h);l.setItem(s,n);l.removeItem(h);}};this.exportConfiguration=function(h,i){var o;this.loadConfiguration(h,j);function j(k){if(!k.isSaved()){m.putMessage(m.createMessageObject({code:"11007",aParameters:[h]}));i(null);}else{var n=a.functions.getApplication(d);o=k.serialize();o.configHeader={Application:d,ApplicationName:n.ApplicationName,SemanticObject:n.SemanticObject,AnalyticalConfiguration:h,AnalyticalConfigurationName:t.getConfiguration(h).AnalyticalConfigurationName,UI5Version:sap.ui.version};p.readEntity("configuration",function(r,q,s){if(s){m.putMessage(m.createMessageObject({code:"5022",aParameters:[h]}));i(null);}else{o.configHeader.CreationUTCDateTime=r.CreationUTCDateTime;o.configHeader.LastChangeUTCDateTime=r.LastChangeUTCDateTime;i(JSON.stringify(o));}},[{name:"AnalyticalConfiguration",value:h}],["CreationUTCDateTime","LastChangeUTCDateTime"],true,d);}}};this.memorizeConfiguration=function(h){var i,j;j=l.getItem(h);if(!j){return null;}i=j.getInstance();if(i){b.setItem(h,i.copy(h));return h;}return null;};this.restoreMemorizedConfiguration=function(h){var n,i;i=b.removeItem(h);if(i){n=new L(f,undefined,{id:h,instance:i});l.setItem(h,n);return i;}return null;};this.removeConfiguration=function(h,r){function i(j,k){if(!k){c.removeItem(h);l.removeItem(h);}r(h,j,k);}if(h.indexOf("apf1972-")!==0){p.remove("configuration",[{name:"AnalyticalConfiguration",value:h}],i,undefined,d);}else{c.removeItem(h);l.removeItem(h);r(h,undefined,undefined);}};this.removeAllConfigurations=function(){c=new H(m);};function g(){return"apf1972-"+(Math.random()*new Date().getTime());}};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.applicationList.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.applicationList.controller');sap.ui.controller("sap.apf.modeler.ui.controller.applicationList",{onInit:function(){var v=this.getView();v.addStyleClass("sapUiSizeCompact");this._addApplicationStyleClass();var c=this.getOwnerComponent();if(c!==undefined){this.oCoreApi=c.oCoreApi;this._setDisplayText();var s=this;this.oCoreApi.getApplicationHandler(function(A){s.applicationHandler=A;s._updateAppList();});}this.oModel=new sap.ui.model.json.JSONModel({});this.oModel.setSizeLimit(1000);this.bIsEditMode=false;this.byId("idAppDescription").attachBrowserEvent("click",this.navToConfigList().fn);this.byId("idSemanticObject").attachBrowserEvent("click",this.navToConfigList().fn);var a=v.byId("idApplicationTable");var b=v.byId("idAppListScrollContainer");b.addEventDelegate({onAfterRendering:function(){var w=jQuery(v.byId("idAppPage").getDomRef()).width();var h=jQuery(window).height();var d=jQuery(v.byId("idAppTitle").getDomRef()).height();var e=jQuery(v.byId("idApplicationToolbar").getDomRef()).height();var f=jQuery(v.byId("idAppPage").getDomRef()).find("header").height();var g=jQuery(v.byId("idAppPage").getDomRef()).find("footer").height();var o;if(d>0){d=d+80;o=d+e+f+g+25;}else{o=232;}b.setHeight(h-o+"px");b.setWidth("100%");sap.apf.modeler.ui.utils.helper.onResize(function(){if(jQuery(s.getView().getDomRef()).css("display")==="block"){w=jQuery(v.byId("idAppPage").getDomRef()).width();h=jQuery(v.byId("idAppPage").getDomRef()).height();b.setHeight(h-o+"px");b.setWidth("100%");}});sap.ui.core.UIComponent.getRouterFor(s).attachRoutePatternMatched(function(E){if(E.getParameter("name")==="applicationList"){w=jQuery(v.getDomRef()).width();h=jQuery(v.getDomRef()).height();b.setHeight(h-o+"px");b.setWidth("100%");}});}});},_setDisplayText:function(){this.byId("idAppPage").setTitle(this.oCoreApi.getText("configModelerTitle"));this.byId("idAppTitle").setText(this.oCoreApi.getText("applicationOverview"));this.byId("idAppNumberTitle").setText(this.oCoreApi.getText("applications"));this.byId("idDescriptionLabel").setText(this.oCoreApi.getText("description"));this.byId("idSemanticObjectLabel").setText(this.oCoreApi.getText("semanticObject"));this.byId("idEditButton").setText(this.oCoreApi.getText("edit"));this.byId("idSaveButton").setText(this.oCoreApi.getText("save"));this.byId("idCancelButton").setText(this.oCoreApi.getText("cancel"));this.byId("idTextCleanupButton").setText(this.oCoreApi.getText("textCleanUp"));this.byId("idImportButton").setText(this.oCoreApi.getText("import"));this.byId("idNewButton").setTooltip(this.oCoreApi.getText("newApplication"));},_addConfigStyleClass:function(){sap.ui.core.Fragment.byId("idImportConfigurationFragment","idJsonFileLabel").addStyleClass("importFileUploaderDialogLabels");sap.ui.core.Fragment.byId("idImportConfigurationFragment","idTextFileLabel").addStyleClass("importFileUploaderDialogLabels");},_setOverwriteConfirmationDialogText:function(){sap.ui.core.Fragment.byId("idOverwriteConfirmationFragment","idOverwriteConfirmationDialog").setTitle(this.oCoreApi.getText("warning"));sap.ui.core.Fragment.byId("idOverwriteConfirmationFragment","idConfirmationMessage").setText(this.oCoreApi.getText("overwriteConfirmationMsg"));sap.ui.core.Fragment.byId("idOverwriteConfirmationFragment","idConfirmationMessage").addStyleClass("dialogText");sap.ui.core.Fragment.byId("idOverwriteConfirmationFragment","idYesButton").setText(this.oCoreApi.getText("yes"));sap.ui.core.Fragment.byId("idOverwriteConfirmationFragment","idNoButton").setText(this.oCoreApi.getText("no"));},_setImportConfigDialogText:function(){sap.ui.core.Fragment.byId("idImportConfigurationFragment","idImportConfigDialog").setTitle(this.oCoreApi.getText("importConfig"));sap.ui.core.Fragment.byId("idImportConfigurationFragment","idJsonFileLabel").setText(this.oCoreApi.getText("jsonFile"));sap.ui.core.Fragment.byId("idImportConfigurationFragment","idJsonFileUploader").setPlaceholder(this.oCoreApi.getText("jsonFileInputPlaceHolder"));sap.ui.core.Fragment.byId("idImportConfigurationFragment","idTextFileLabel").setText(this.oCoreApi.getText("textFile"));sap.ui.core.Fragment.byId("idImportConfigurationFragment","idTextFileUploader").setPlaceholder(this.oCoreApi.getText("textFileInputPlaceHolder"));sap.ui.core.Fragment.byId("idImportConfigurationFragment","idUploadOfConfig").setText(this.oCoreApi.getText("upload"));sap.ui.core.Fragment.byId("idImportConfigurationFragment","idCancelImportOfConfig").setText(this.oCoreApi.getText("cancel"));},_setConfirmationDialogText:function(){sap.ui.core.Fragment.byId("idConfirmationDialogFragment","idDeleteConfirmation").setTitle(this.oCoreApi.getText("confirmation"));sap.ui.core.Fragment.byId("idConfirmationDialogFragment","idDeleteButton").setText(this.oCoreApi.getText("deleteButton"));sap.ui.core.Fragment.byId("idConfirmationDialogFragment","idCancelButtonDialog").setText(this.oCoreApi.getText("cancel"));},_setNewApplicationText:function(){sap.ui.core.Fragment.byId("idAddNewApplicationFragment","idNewApp").setTitle(this.oCoreApi.getText("newApplication"));sap.ui.core.Fragment.byId("idAddNewApplicationFragment","idDescriptionLabelApp").setText("*"+this.oCoreApi.getText("description"));sap.ui.core.Fragment.byId("idAddNewApplicationFragment","idSemanticObjectLabelApp").setText(this.oCoreApi.getText("semanticObject"));sap.ui.core.Fragment.byId("idAddNewApplicationFragment","idSaveButtonApp").setText(this.oCoreApi.getText("save"));sap.ui.core.Fragment.byId("idAddNewApplicationFragment","idCancelButtonApp").setText(this.oCoreApi.getText("cancel"));},_addApplicationStyleClass:function(){this.byId("idAppNumberTitle").addStyleClass("appCountLabel");this.byId("idAppDescription").addStyleClass("cursor");this.byId("idSemanticObject").addStyleClass("cursor");this.byId("idNewButton").addStyleClass("newButton");this.byId("idAppListScrollContainer").addStyleClass("applicationListScroll");this.byId("idNoOfConfig").addStyleClass("applicationCount");this.byId("idAppTitle").addStyleClass("applicationTitle");this.byId("idApplicationToolbar").addStyleClass("applicationTitleLayout");},_updateAppList:function(){var a=this.applicationHandler.getList();var b=a.length;var A=[];a.forEach(function(c){var o={};o.id=c.Application;o.description=c.ApplicationName;o.semanticObject=c.SemanticObject;A.push(o);});var j={appCount:"("+b+")",tableData:A};if(this.oModel!==undefined){this.oModel.setSizeLimit(1000);this.oModel.setData(j);this.getView().setModel(this.oModel);}},_enableDisplayMode:function(){this.bIsEditMode=false;this.byId("idEditButton").setVisible(true);this.byId("idSaveButton").setVisible(false);this.byId("idSaveButton").setEnabled(false);this.byId("idTextCleanupButton").setEnabled(false);this.byId("idCancelButton").setVisible(false);this.byId("idTextCleanupButton").setVisible(false);this.byId("idApplicationTable").setMode("None");var i=this.byId("idApplicationTable").getItems();i.forEach(function(a){a.setType("Navigation");a.getCells()[0].setEditable(false);a.getCells()[1].setEditable(false);a.getCells()[2].setVisible(false);});this._updateAppList();},enableEditMode:function(){this.bIsEditMode=true;this.byId("idEditButton").setVisible(false);this.byId("idSaveButton").setVisible(true);this.byId("idCancelButton").setVisible(true);this.byId("idTextCleanupButton").setVisible(true);this.byId("idApplicationTable").setMode("SingleSelectMaster");var i=this.byId("idApplicationTable").getItems();if(i.length!==0){i.forEach(function(a){a.getCells()[0].setEditable(true);a.getCells()[1].setEditable(true);a.getCells()[2].setVisible(true);a.setType("Inactive");});}},handleDeletePress:function(e){var p=e.getSource().getBindingContext().getPath().split("/")[2];var r=this.getView().getModel().getData().tableData[p].id;var c=new sap.ui.core.CustomData({value:{removeId:r,sPath:p}});if(!this.confirmationDialog){this.confirmationDialog=sap.ui.xmlfragment("idConfirmationDialogFragment","sap.apf.modeler.ui.fragment.confirmationDialog",this);this.getView().addDependent(this.confirmationDialog);this._setConfirmationDialogText();}var a=new sap.m.Label();a.addStyleClass("dialogText");a.setText(this.oCoreApi.getText("deleteApp"));this.confirmationDialog.removeAllContent();this.confirmationDialog.addContent(a);this.confirmationDialog.removeAllCustomData();this.confirmationDialog.addCustomData(c);jQuery.sap.syncStyleClass("sapUiSizeCompact",this.getView(),this.confirmationDialog);this.confirmationDialog.open();},handleConfirmDeletion:function(){var r=this.confirmationDialog.getCustomData()[0].getValue().removeId;if(r!==undefined){var s=this;this.applicationHandler.removeApplication(r,function(R,m,a){if(a===undefined&&(typeof R==="string")){s.confirmationDialog.close();s._updateAppList();s.enableEditMode();}else{var M=s.oCoreApi.createMessageObject({code:"11501"});M.setPrevious(a);s.oCoreApi.putMessage(M);}});}},closeDialog:function(){if(this.confirmationDialog.isOpen()){this.confirmationDialog.close();}},handleSavePress:function(){var s=this;var j;var u=[];var a=this.applicationHandler.getList();var t=this.getView().getModel().getData().tableData;for(j=0;j<a.length;j++){if(t[j].description!==a[j].ApplicationName||t[j].semanticObject!==a[j].SemanticObject){u.push(t[j]);}}u.forEach(function(b){var c={ApplicationName:b.description,SemanticObject:b.semanticObject};s.applicationHandler.setAndSave(c,function(r,m,d){if(d===undefined&&(typeof r==="string")){s._enableDisplayMode();}else{var M=s.oCoreApi.createMessageObject({code:"11500"});M.setPrevious(d);s.oCoreApi.putMessage(M);}},b.id);});},handleCancelPress:function(){var j;var u=[];var a=this.applicationHandler.getList();var t=this.getView().getModel().getData().tableData;for(j=0;j<a.length;j++){if(t[j].description!==a[j].ApplicationName||t[j].semanticObject!==a[j].SemanticObject){u.push(t[j]);}}if(u.length!==0){this.unsavedDataConfirmationDialog=sap.ui.xmlfragment("idMessageDialogFragment","sap.apf.modeler.ui.fragment.messageDialog",this);this.getView().addDependent(this.unsavedDataConfirmationDialog);this._setUnsavedDataConfirmationDialogText();jQuery.sap.syncStyleClass("sapUiSizeCompact",this.getView(),this.unsavedDataConfirmationDialog);this.unsavedDataConfirmationDialog.open();}else{this._enableDisplayMode();}},_handleNavigationWithSave:function(){this.handleSavePress();if(this.unsavedDataConfirmationDialog.isOpen()){this.unsavedDataConfirmationDialog.close();this.unsavedDataConfirmationDialog.destroy();}},_handleNavigateWithoutSave:function(){if(this.unsavedDataConfirmationDialog.isOpen()){this.unsavedDataConfirmationDialog.close();this.unsavedDataConfirmationDialog.destroy();}this._enableDisplayMode();},_handlePreventNavigation:function(){if(this.unsavedDataConfirmationDialog.isOpen()){this.unsavedDataConfirmationDialog.close();this.unsavedDataConfirmationDialog.destroy();}},_setUnsavedDataConfirmationDialogText:function(){sap.ui.core.Fragment.byId("idMessageDialogFragment","idMessageDialog").setTitle(this.oCoreApi.getText("confirmation"));sap.ui.core.Fragment.byId("idMessageDialogFragment","idYesButton").setText(this.oCoreApi.getText("yes"));sap.ui.core.Fragment.byId("idMessageDialogFragment","idNoButton").setText(this.oCoreApi.getText("no"));sap.ui.core.Fragment.byId("idMessageDialogFragment","idCancelButton").setText(this.oCoreApi.getText("cancel"));var c=new sap.m.Label();c.addStyleClass("dialogText");c.setText(this.oCoreApi.getText("unsavedConfiguration"));this.unsavedDataConfirmationDialog.removeAllContent();this.unsavedDataConfirmationDialog.addContent(c);},handleListItemSelect:function(e){var b=e.getParameter("listItem").getBindingContext().getPath().split("/")[2];this.appId=this.getView().getModel().getData().tableData[b].id;this.byId("idTextCleanupButton").setEnabled(true);},handleListItemPress:function(e){var b=e.getParameter("listItem").getBindingContext().getPath().split("/")[2];var a=this.getView().getModel().getData().tableData[b].id;sap.ui.core.UIComponent.getRouterFor(this).navTo("configurationList",{appId:a});},onLiveChange:function(){this.byId("idSaveButton").setEnabled(true);},addNewApplication:function(){if(!this.addNewItemDialog){this.addNewItemDialog=sap.ui.xmlfragment("idAddNewApplicationFragment","sap.apf.modeler.ui.fragment.newApplication",this);this.getView().addDependent(this.addNewItemDialog);this._setNewApplicationText();}this.addNewItemDialog.getContent()[0].getContent()[1].setValue("");this.addNewItemDialog.getContent()[0].getContent()[3].setValue("FioriApplication");this.addNewItemDialog.getBeginButton().setEnabled(false);jQuery.sap.syncStyleClass("sapUiSizeCompact",this.getView(),this.addNewItemDialog);this.addNewItemDialog.open();},applicationDescChange:function(e){this.isAppDesc=e.getParameters().value.trim().length!==0?true:false;if(this.isAppDesc){this.addNewItemDialog.getBeginButton().setEnabled(true);}else{this.addNewItemDialog.getBeginButton().setEnabled(false);}},closeNewAppDialog:function(){if(this.addNewItemDialog.isOpen()){this.addNewItemDialog.close();}},handleSaveDialogPress:function(){var s=this;var d=this.getView().getDependents();var a={};d.forEach(function(D){if(D.sId==="idAddNewApplicationFragment--idNewApp"){a.ApplicationName=D.getContent()[0].getContent()[1].getValue()!==""?D.getContent()[0].getContent()[1].getValue():undefined;a.SemanticObject=D.getContent()[0].getContent()[3].getValue()!==""?D.getContent()[0].getContent()[3].getValue():undefined;}});this.applicationHandler.setAndSave(a,function(r,m,b){if(b===undefined&&(typeof r==="string")){s._enableDisplayMode();s.byId('idApplicationTable').rerender();var c=s.byId('idApplicationTable').getItems()[s.byId('idApplicationTable').getItems().length-1].$();if(c.length!==0){c[0].scrollIntoView();}s.addNewItemDialog.close();}else{var M=s.oCoreApi.createMessageObject({code:"12000"});M.setPrevious(b);s.oCoreApi.putMessage(M);}});},handleImportButtonPress:function(){if(!this.importConfigurationDialog){this.importConfigurationDialog=sap.ui.xmlfragment("idImportConfigurationFragment","sap.apf.modeler.ui.fragment.importConfiguration",this);this.getView().addDependent(this.importConfigurationDialog);this._setImportConfigDialogText();this._addConfigStyleClass();}sap.ui.core.Fragment.byId("idImportConfigurationFragment","idJsonFileUploader").setValue("");sap.ui.core.Fragment.byId("idImportConfigurationFragment","idTextFileUploader").setValue("");jQuery.sap.syncStyleClass("sapUiSizeCompact",this.getView(),this.importConfigurationDialog);this.importConfigurationDialog.open();},handleUploadOfConfig:function(){this.oJSONFileUploader=sap.ui.core.Fragment.byId("idImportConfigurationFragment","idJsonFileUploader");this.oTextPropertyFileUploader=sap.ui.core.Fragment.byId("idImportConfigurationFragment","idTextFileUploader");if((this.oJSONFileUploader.getValue()&&this.oTextPropertyFileUploader.getValue())||this.oJSONFileUploader.getValue()){this.oJSONFileUploader.upload();}else{this.oTextPropertyFileUploader.upload();}},addAcceptAttribute:function(){var j=jQuery("#idImportConfigurationFragment--idJsonFileUploader-fu");var p=jQuery("#idImportConfigurationFragment--idTextFileUploader-fu");j.attr('accept','.json');p.attr('accept','.properties');},closeImportConfigDialog:function(){if(this.importConfigurationDialog.isOpen()){this.importConfigurationDialog.close();}},handleJSONFileUploadComplete:function(e){var s=this;var m=this.oCoreApi.getText("errorReadingJSONFile");var f=e.getSource().oFileUpload.files[0];if(f){var r=new FileReader();r.readAsText(f,"UTF-8");r.onload=function(a){s.parsedConfigString=JSON.parse(a.target.result);s.appIdFromConfigFile=s.parsedConfigString.configHeader.Application;s._importConfigurationFile(s.parsedConfigString);};r.onerror=function(){sap.m.MessageToast.show(m);};}this.importConfigurationDialog.close();},handleTextFileUploadComplete:function(e){var s=this;var m=this.oCoreApi.getText("errorReadingPropertiesFile");var a=this.oCoreApi.getText("asyncMsg");var f=e.getSource().oFileUpload.files[0];if(f){var r=new FileReader();r.readAsText(f,"UTF-8");r.onload=function(b){var l=b.target.result.split(/\r?\n/);var c=l.length;var d,i;for(i=0;i<c;i++){d=/^\#\s*ApfApplicationId=[0-9A-F]+\s*$/.exec(l[i]);if(d!==null){s.appIdFromTextFile=l[i].split('=')[1];}}var E;for(i=0;i<s.applicationHandler.getList().length;i++){if(s.appIdFromTextFile===s.applicationHandler.getList()[i].Application){E=true;break;}else{E=false;}}if(!E&&!s.oJSONFileUploader.getValue()){sap.m.MessageToast.show("chooseJsonFile");}else if(s.oJSONFileUploader.getValue()){if(s.appIdFromConfigFile&&s.appIdFromTextFile&&s.appIdFromTextFile!==s.appIdFromConfigFile){sap.m.MessageToast.show(a);}else{s._importPropertiesFile(b.target.result);}}else if(E&&!s.oJSONFileUploader.getValue()){s._importPropertiesFile(b.target.result);}};r.onerror=function(){sap.m.MessageToast.show(m);};}this.importConfigurationDialog.close();},_importConfigurationFile:function(p){var s=this;var a=this.oCoreApi.getText("successsMsgForConfigFileImport");this.oCoreApi.importConfiguration(JSON.stringify(p),function(b,d){s.callbackOverwrite=b;s.callbackCreateNew=d;s._openConfirmationDialog();},c);function c(b,m,d){if(d===undefined){s._updateAppList();sap.m.MessageToast.show(a);if(s.oTextPropertyFileUploader.getValue()){s.oTextPropertyFileUploader.upload();}}else{var M=s.oCoreApi.createMessageObject({code:"11502"});M.setPrevious(d);s.oCoreApi.putMessage(M);}}},_importPropertiesFile:function(p){var s=this;var a=this.oCoreApi.getText("successsMsgForPropertyFileImport");this.oCoreApi.importTexts(p,function(m){if(m===undefined){sap.m.MessageToast.show(a);}else{var M=s.oCoreApi.createMessageObject({code:"11503"});M.setPrevious(m);s.oCoreApi.putMessage(M);}});},handleTypeMissmatchForJSONFile:function(){var m=this.oCoreApi.getText("jsonFileMissmatch");sap.m.MessageToast.show(m);},handleTypeMissmatchForPropertiesFile:function(){var m=this.oCoreApi.getText("propertiesFileMissmatch");sap.m.MessageToast.show(m);},_openConfirmationDialog:function(){if(!this.overwriteConfirmationDialog){this.overwriteConfirmationDialog=sap.ui.xmlfragment("idOverwriteConfirmationFragment","sap.apf.modeler.ui.fragment.overwriteConfirmation",this);this.getView().addDependent(this.overwriteConfirmationDialog);this._setOverwriteConfirmationDialogText();}jQuery.sap.syncStyleClass("sapUiSizeCompact",this.getView(),this.overwriteConfirmationDialog);this.overwriteConfirmationDialog.open();},handleConfirmOverwriting:function(){this.callbackOverwrite();this.overwriteConfirmationDialog.close();},handleNoButtonPress:function(){this.callbackCreateNew();this.overwriteConfirmationDialog.close();},handleTextCleanUpPress:function(){var s=this;this.oCoreApi.getConfigurationHandler(this.appId,function(c){s.oTextPool=c.getTextPool();s.oCoreApi.getUnusedTextKeys(s.appId,function(u,m){if(m===undefined){s.oTextPool.removeTexts(u,s.appId,function(m){if(m===undefined){var a=s.oCoreApi.getText("successtextCleanup");sap.m.MessageToast.show(a,{width:"20em"});}});}else{var M=s.oCoreApi.createMessageObject({code:"12000"});M.setPrevious(m);s.oCoreApi.putMessage(M);}});});},navToConfigList:function(){var s=this;return{fn:function(){if(!s.bIsEditMode){var b=this.getBindingContext().getPath().split("/")[2];var a=s.getView().getModel().getData().tableData[b].id;sap.ui.core.UIComponent.getRouterFor(s).navTo("configurationList",{appId:a});}}};},handleNavBack:function(){window.history.go(-1);}});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.category.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.category.controller');sap.ui.controller("sap.apf.modeler.ui.controller.category",{onInit:function(){this.getView().addStyleClass("sapUiSizeCompact");this.oViewData=this.getView().getViewData();this.oConfigurationHandler=this.oViewData.oConfigurationHandler;this.oConfigurationEditor=this.oViewData.oConfigurationEditor;this.oTextPool=this.oConfigurationHandler.getTextPool();this.getText=this.oViewData.getText;this.params=this.oViewData.oParams;var s=this;if(!this.oConfigurationEditor){this.oConfigurationHandler.loadConfiguration(this.params.arguments.configId,function(c){s.oConfigurationEditor=c;});}this._setDisplayText();this.setDetailData();var m=[];m.push(this.byId("idCategoryTitle"));this._setMandatoryFields(m);},_setDisplayText:function(){this.byId("idCategoryBasicData").setTitle(this.getText("categoryData"));this.byId("idCategoryTitleLabel").setText(this.getText("categoryTitle"));this.byId("idCategoryTitleLabel").setRequired(true);this.byId("idCategoryTitle").setPlaceholder(this.getText("newCategory"));this.byId("idTotalStepsLabel").setText(this.getText("totalSteps"));},_addAutoCompleteFeatureOnInputs:function(){if(this.oConfigurationHandler){var i=this.byId("idCategoryTitle");var t=new sap.apf.modeler.ui.utils.TextPoolHelper(this.oTextPool);var T=sap.apf.modeler.ui.utils.TranslationFormatMap.CATEGORY_TITLE;var d={oTranslationFormat:T,type:"text"};t.setAutoCompleteOn(i,d);}},setDetailData:function(){var s=this;if(this.params&&this.params.arguments&&this.params.arguments.categoryId){this.oCategory=this.oConfigurationEditor.getCategory(this.params.arguments.categoryId);}if(this.oCategory){var n=this.oConfigurationEditor.getCategoryStepAssignments(this.oCategory.getId()).length;if(this.oTextPool.get(this.oCategory.labelKey)!==undefined){this.byId("idCategoryTitle").setValue(this.oTextPool.get(this.oCategory.labelKey).TextElementDescription);}else{this.byId("idCategoryTitle").setValue(this.oCategory.labelKey);}this.byId("idTotalSteps").setValue(n);}else{var a=this.oConfigurationEditor.setCategory();this.oCategory=this.oConfigurationEditor.getCategory(a);var c={id:a,icon:"sap-icon://open-folder"};this.oViewData.updateSelectedNode(c);}this._addAutoCompleteFeatureOnInputs();},handleChangeDetailValue:function(e){this.oConfigurationEditor.setIsUnsaved();var c=this.byId("idCategoryTitle").getValue().trim();var t=sap.apf.modeler.ui.utils.TranslationFormatMap.CATEGORY_TITLE;var C=this.oTextPool.setText(c,t);this.categoryObj={labelKey:C};var o={};if(c){this.oConfigurationEditor.setCategory(this.categoryObj,this.oCategory.getId());o.name=c;if(c){this.oViewData.updateSelectedNode(o);var T=this.getText("category")+": "+c;this.oViewData.updateTitleAndBreadCrumb(T);}}},_setMandatoryFields:function(f){this.mandatoryFields=this.mandatoryFields||[];for(var i=0;i<f.length;i++){f[i].isMandatory=true;this.mandatoryFields.push(f[i]);}},_getMandatoryFields:function(){return this.mandatoryFields;},_setValidationState:function(){var m=this._getMandatoryFields();for(var i=0;i<m.length;i++){if(m[i].isMandatory===true){this.isValidState=(m[i].getValue().trim()!=="")?true:false;if(this.isValidState===false){break;}}}},getValidationState:function(){this._setValidationState();var i=(this.isValidState!==undefined)?this.isValidState:true;return i;}});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.configuration.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.configuration.controller');sap.ui.controller("sap.apf.modeler.ui.controller.configuration",{onInit:function(){this.getView().addStyleClass("sapUiSizeCompact");this.oViewData=this.getView().getViewData();this.oApplicationHandler=this.oViewData.oApplicationHandler;this.oConfigurationHandler=this.oViewData.oConfigurationHandler;this.oTextPool=this.oConfigurationHandler.getTextPool();this.oConfigurationEditor=this.oViewData.oConfigurationEditor;this.getText=this.oViewData.getText;this.params=this.oViewData.oParams;this._setDisplayText();this.setDetailData();var m=[];m.push(this.byId("idConfigTitle"));this._setMandatoryFields(m);},_setDisplayText:function(){this.byId("idConfigurationBasicData").setTitle(this.getText("configurationData"));this.byId("idConfigTitleLabel").setText(this.getText("configTitle"));this.byId("idConfigTitleLabel").setRequired(true);this.byId("idConfigTitle").setPlaceholder(this.getText("newConfiguration"));this.byId("idConfigurationIdLabel").setText(this.getText("configurationId"));this.byId("idSemanticObjectLabel").setText(this.getText("semanticObject"));this.byId("idNoOfCategoriesLabel").setText(this.getText("noOfCategories"));this.byId("idNoOfStepsLabel").setText(this.getText("noOfSteps"));},setDetailData:function(){if(this.params&&this.params.arguments&&this.params.arguments.configId){var e=this.oConfigurationHandler.getConfiguration(this.params.arguments.configId);}if(e){this.byId("idConfigTitle").setValue(e.AnalyticalConfigurationName);if(e.AnalyticalConfiguration.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===-1){this.byId("idConfigurationId").setValue(e.AnalyticalConfiguration);}var n=this.oConfigurationEditor.getCategories().length;var a=this.oConfigurationEditor.getSteps().length;this.byId("idNoOfCategories").setValue(n);this.byId("idNoOfSteps").setValue(a);var b=this.oApplicationHandler.getApplication(this.params.arguments.appId);if(b!==undefined){this.byId("idSemanticObject").setValue(b.SemanticObject);}}else{var c=this.oApplicationHandler.getApplication(this.params.arguments.appId);if(c){this.byId("idSemanticObject").setValue(c.SemanticObject);}}},handleChangeDetailValue:function(){var s=this;var c={};var C=this.byId("idConfigTitle").getValue().trim();var a={AnalyticalConfigurationName:C};if(this.oConfigurationEditor){this.oConfigurationEditor.setIsUnsaved();}var t;var o=this.oConfigurationHandler.getConfiguration(this.params.arguments.configId);if(C!==""&&C!==undefined){if(o!==undefined){this.oConfigurationHandler.setConfiguration(a,this.params.arguments.configId);this.oConfigurationHandler.loadConfiguration(this.params.arguments.configId,function(b){var T=sap.apf.modeler.ui.utils.TranslationFormatMap.APPLICATION_TITLE;var A=s.oTextPool.setText(C,T);b.setApplicationTitle(A);c.name=C;var d=s.getText("configuration")+": "+C;if(C){s.oViewData.updateSelectedNode(c);s.oViewData.updateTitleAndBreadCrumb(d);}});}else{t=this.oConfigurationHandler.setConfiguration(a);this.oConfigurationHandler.loadConfiguration(t,function(b){var T=sap.apf.modeler.ui.utils.TranslationFormatMap.APPLICATION_TITLE;var A=s.oTextPool.setText(C,T);b.setApplicationTitle(A);var d={appId:s.params.arguments.appId,configId:t};c.name=C;var e=s.getText("configuration")+": "+C;c.id=o===undefined?a.AnalyticalConfiguration:undefined;if(C){s.oViewData.updateSelectedNode(c,d);s.oViewData.updateTitleAndBreadCrumb(e);}});}}},_setMandatoryFields:function(f){this.mandatoryFields=this.mandatoryFields||[];for(var i=0;i<f.length;i++){f[i].isMandatory=true;this.mandatoryFields.push(f[i]);}},_getMandatoryFields:function(){return this.mandatoryFields;},_setValidationState:function(){var m=this._getMandatoryFields();for(var i=0;i<m.length;i++){if(m[i].isMandatory===true){this.isValidState=(m[i].getValue().trim()!=="")?true:false;if(this.isValidState===false){break;}}}},getValidationState:function(){this._setValidationState();var i=(this.isValidState!==undefined)?this.isValidState:true;return i;}});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.facetFilter.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.facetFilter.controller');sap.ui.controller("sap.apf.modeler.ui.controller.facetFilter",{onInit:function(){this.getView().addStyleClass("sapUiSizeCompact");this.oViewData=this.getView().getViewData();this.getText=this.oViewData.getText;this.params=this.oViewData.oParams;this.oConfigurationHandler=this.oViewData.oConfigurationHandler;this.oConfigurationEditor=this.oViewData.oConfigurationEditor;var s=this;if(!this.oConfigurationEditor){this.oConfigurationHandler.loadConfiguration(this.params.arguments.configId,function(c){s.oConfigurationEditor=c;});}this.oTextPool=this.oConfigurationHandler.getTextPool();var m=[];m.push(this.byId("idffProperty"));m.push(this.byId("idLabel"));m.push(this.byId("idVHDefaultValues"));m.push(this.byId("idVHfunction"));m.push(this.byId("idVHEntity"));m.push(this.byId("idVHSelectProperties"));m.push(this.byId("idFREntity"));m.push(this.byId("idFRSelectProperties"));this._setMandatoryFields(m);this._setDisplayText();this.setDetailData();},_addAutoCompleteFeatureOnInputs:function(){if(this.oConfigurationHandler){var t=new sap.apf.modeler.ui.utils.TextPoolHelper(this.oTextPool);var T=sap.apf.modeler.ui.utils.TranslationFormatMap.FACETFILTER_LABEL;var d={oTranslationFormat:T,type:"text"};var f=this.byId("idLabel");t.setAutoCompleteOn(f,d);var D={oConfigurationEditor:this.oConfigurationEditor,type:"service"};var F=this.byId("idVHSource");t.setAutoCompleteOn(F,D);var o=this.byId("idFRSource");t.setAutoCompleteOn(o,D);}},_setDisplayText:function(){this.byId("idFacetFilterBasicData").setTitle(this.getText("basicData"));this.byId("idLabel").setPlaceholder(this.getText("New Filter"));this.byId("idValueHelpTitle").setTitle(this.getText("valueHelp"));this.byId("idFilterResolutionTitle").setTitle(this.getText("filterResolution"));this.byId("idFfPropertyLabel").setText(this.getText("ffProperty"));this.byId("idFfPropertyLabel").setRequired(true);this.byId("idFfLabel").setText(this.getText("ffLabel"));this.byId("idFfLabel").setRequired(true);this.byId("idFfAliasLabel").setText(this.getText("ffAlias"));this.byId("idSelectionModeLabel").setText(this.getText("ffSelectionMode"));this.byId("idVhSourceLabel").setText(this.getText("vhSource"));this.byId("idVhEntityLabel").setText(this.getText("vhEntity"));this.byId("idVhEntityLabel").setRequired(false);this.byId("idVhSelectPropertiesLabel").setText(this.getText("vhSelectProperties"));this.byId("idVhSelectPropertiesLabel").setRequired(false);this.byId("idVhDefaultValueModeLabel").setText(this.getText("vhDefaultValueMode"));this.byId("idVhDefaultValuesLabel").setText(this.getText("vhDefaultValues"));this.byId("idVhDefaultValuesLabel").setRequired(false);this.byId("idVhFunctionLabel").setText(this.getText("function"));this.byId("idVhFunctionLabel").setRequired(false);this.byId("idVhCheckBoxLabel").setText(this.getText("vhCheckBoxLabel"));this.byId("idVhSourceLabel1").setText(this.getText("vhSource"));this.byId("idVhSourceLabel1").setRequired(false);this.byId("idVhEntityLabel1").setText(this.getText("vhEntity"));this.byId("idVhEntityLabel1").setRequired(false);this.byId("idVhSelectPropertiesLabel1").setText(this.getText("vhSelectProperties"));this.byId("idVhSelectPropertiesLabel1").setRequired(false);this.byId("single").setText(this.getText("singleSelection"));this.byId("multi").setText(this.getText("multipleSelection"));},setDetailData:function(){var p=[];this._addAutoCompleteFeatureOnInputs();var a=this.oConfigurationEditor.getAllKnownProperties();a.forEach(function(t){var u={};u.propertyKey=t;u.propertyName=t;p.push(u);});var d={Properties:p};var m=new sap.ui.model.json.JSONModel();m.setSizeLimit(500);m.setData(d);this.byId("idffProperty").setModel(m);var M=new sap.ui.model.json.JSONModel();M.setSizeLimit(500);M.setData(d);this.byId("idAlias").setModel(M);var D=[{dvKey:this.getText("fixedValues"),dvName:this.getText("fixedValues")},{dvKey:this.getText("function"),dvName:this.getText("function")}];var o={DVModes:D};var b=new sap.ui.model.json.JSONModel();b.setSizeLimit(500);b.setData(o);this.byId("idVHDefaultValueMode").setModel(b);if(this.params&&this.params.arguments&&this.params.arguments.facetFilterId){this.facetFilter=this.oConfigurationEditor.getFacetFilter(this.params.arguments.facetFilterId);}if(this.facetFilter){if(this.params&&this.params.arguments&&this.params.arguments.facetFilterId){this.facetFilter=this.oConfigurationEditor.getFacetFilter(this.params.arguments.facetFilterId);}if(this.facetFilter.getProperty()!==undefined&&this.facetFilter.getProperty()!==null){this.byId("idffProperty").setValue(this.facetFilter.getProperty());}if(this.facetFilter.getLabelKey()!==undefined&&this.facetFilter.getLabelKey()!==null&&this.oTextPool.get(this.facetFilter.getLabelKey())){this.byId("idLabel").setValue(this.oTextPool.get(this.facetFilter.getLabelKey()).TextElementDescription);}else{this.byId("idLabel").setValue(this.params.arguments.facetFilterId);}if(this.facetFilter.getAlias()!==undefined){this.byId("idAlias").setValue(this.facetFilter.getAlias());}if(this.facetFilter.isMultiSelection()!==undefined){this.byId("multi").setSelected(this.facetFilter.isMultiSelection());this.byId("single").setSelected(!this.facetFilter.isMultiSelection());}if(this.facetFilter.getServiceOfValueHelp()!==undefined){this.byId("idVHSource").setValue(this.facetFilter.getServiceOfValueHelp());var s=this.facetFilter.getServiceOfValueHelp();var A=[];var c=[];A=this.oConfigurationEditor.getAllEntitySetsOfService(s);A.forEach(function(t){var u={};u.entityKey=t;u.entityName=t;c.push(u);});var e={Entities:c};var f=new sap.ui.model.json.JSONModel();f.setSizeLimit(500);f.setData(e);this.byId("idVHEntity").setModel(f);this.byId("idVhEntityLabel").setText(this.getText("vhEntity"));this.byId("idVhEntityLabel").setRequired(true);this.byId("idVhSelectPropertiesLabel").setText(this.getText("vhSelectProperties"));this.byId("idVhSelectPropertiesLabel").setRequired(true);}if(this.facetFilter.getEntitySetOfValueHelp()!==undefined){this.byId("idVHEntity").setSelectedKey(this.facetFilter.getEntitySetOfValueHelp());var E=this.facetFilter.getEntitySetOfValueHelp();var S=this.facetFilter.getServiceOfValueHelp();var P=[];p=[];P=this.oConfigurationEditor.getAllPropertiesOfEntitySet(S,E);var g=P[0];P.forEach(function(t){var u={};u.propertyKey=t;u.propertyName=t;p.push(u);});var h={Properties:p};var i=new sap.ui.model.json.JSONModel();i.setSizeLimit(500);i.setData(h);this.byId("idVHSelectProperties").setModel(i);}if(this.facetFilter.getSelectPropertiesOfValueHelp()&&this.facetFilter.getSelectPropertiesOfValueHelp().length>0){this.byId("idVHSelectProperties").setSelectedKeys(this.facetFilter.getSelectPropertiesOfValueHelp());}if(this.facetFilter.getPreselectionFunction()!==undefined){this._hideAndResetPreselectionDefault();this._showPreselectionFunction();this.byId("idVHDefaultValueMode").setSelectedKey(this.getText("function"));this.byId("idVHfunction").setValue(this.facetFilter.getPreselectionFunction());}else{this._hideAndResetPreselectionFunction();this._showPreselectionDefault();this.byId("idVHDefaultValueMode").setSelectedKey(this.getText("fixedValues"));var j;if(this.facetFilter.isMultiSelection()){j=this.facetFilter.getPreselectionDefaults()?this.facetFilter.getPreselectionDefaults().join(','):"";}else{j=this.facetFilter.getPreselectionDefaults()[0];}this.byId("idVHDefaultValues").setValue(j);}if(this.facetFilter.getUseSameRequestForValueHelpAndFilterResolution()){this.byId("idVhCheckBox").setSelected(true);this._disableFilterResolutionSourceFields();this._setValueHelpSourceAsFilterResolution();}else{this.byId("idVhCheckBox").setSelected(false);this._enableFilterResolutionSourceFields();if(this.facetFilter.getServiceOfFilterResolution()!==undefined&&this.facetFilter.getServiceOfFilterResolution()!==""&&this.facetFilter.getServiceOfFilterResolution()!==null){s=this.facetFilter.getServiceOfFilterResolution();this.byId("idFRSource").setValue(s);A=[];c=[];A=this.oConfigurationEditor.getAllEntitySetsOfService(s);A.forEach(function(t){var u={};u.entityKey=t;u.entityName=t;c.push(u);});var k={Entities:c};var l=new sap.ui.model.json.JSONModel();l.setSizeLimit(500);l.setData(k);this.byId("idFREntity").setModel(l);this.byId("idVhEntityLabel1").setText(this.getText("vhEntity"));this.byId("idVhEntityLabel1").setRequired(true);this.byId("idVhSelectPropertiesLabel1").setText(this.getText("vhSelectProperties"));this.byId("idVhSelectPropertiesLabel1").setRequired(true);}if(this.facetFilter.getEntitySetOfFilterResolution()!==undefined&&this.facetFilter.getEntitySetOfFilterResolution()!==null&&this.facetFilter.getEntitySetOfFilterResolution()!==""){E=this.facetFilter.getEntitySetOfFilterResolution();S=this.facetFilter.getServiceOfFilterResolution();this.byId("idFREntity").setSelectedKey(this.facetFilter.getEntitySetOfFilterResolution());P=[];p=[];P=this.oConfigurationEditor.getAllPropertiesOfEntitySet(S,E);g=P[0];P.forEach(function(t){var u={};u.propertyKey=t;u.propertyName=t;p.push(u);});var n={Properties:p};var q=new sap.ui.model.json.JSONModel();q.setSizeLimit(500);q.setData(n);this.byId("idFRSelectProperties").setModel(q);}if(this.facetFilter.getSelectPropertiesOfFilterResolution()!==undefined&&this.facetFilter.getSelectPropertiesOfFilterResolution().length>0){this.byId("idFRSelectProperties").setSelectedKeys(this.facetFilter.getSelectPropertiesOfFilterResolution());}}}else{var F=this.oConfigurationEditor.createFacetFilter();this.facetFilter=this.oConfigurationEditor.getFacetFilter(F);this.facetFilter.setMultiSelection(true);this.byId("idVHDefaultValueMode").setSelectedKey(this.getText("fixedValues"));this.byId("idVHDefaultValues").isMandatory=false;this.byId("idVhDefaultValuesLabel").setRequired(false);this._showPreselectionDefault();this._hideAndResetPreselectionFunction();this.byId("multi").setSelected(true);var r={id:F,icon:"sap-icon://filter"};this.oViewData.updateSelectedNode(r);}},handleChangeForProperty:function(e){this.oConfigurationEditor.setIsUnsaved();var p=this.byId("idffProperty").getValue().trim();if(p!==""&&p!==null){this.facetFilter.setProperty(p);}},handleChangeForLabel:function(e){this.oConfigurationEditor.setIsUnsaved();var s=this;var t=sap.apf.modeler.ui.utils.TranslationFormatMap.FACETFILTER_LABEL;var f=this.byId("idLabel").getValue().trim();var F=s.oTextPool.setText(f,t);if(f!==""&&f!==null){this.facetFilter.setLabelKey(F);}var a={};a.name=f;a.id=this.facetFilter.getId();if(f!==""&&f!==null){this.oViewData.updateSelectedNode(a,this.bIsNew);var T=this.getText("facetFilter")+": "+f;this.oViewData.updateTitleAndBreadCrumb(T);}},handleChangeForAlias:function(){this.oConfigurationEditor.setIsUnsaved();var a=this.byId("idAlias").getValue().trim();this.facetFilter.setAlias(a);},_setPreselectionDefaultValue:function(){if(!this.facetFilter.isMultiSelection()){var p=this.facetFilter.getPreselectionDefaults();if(p&&p.length>0){this.facetFilter.setPreselectionDefaults([p[0]]);if(this.byId("idVHDefaultValues")){this.byId("idVHDefaultValues").setValue(p[0]);}}}},handleChangeForSelectionModeSingle:function(){this.facetFilter.setMultiSelection(false);this.oConfigurationEditor.setIsUnsaved();this._changeMandatoryTagForSelectionMode();this._setPreselectionDefaultValue();},handleChangeForSelectionModeMulti:function(){this.facetFilter.setMultiSelection(true);this.oConfigurationEditor.setIsUnsaved();this._changeMandatoryTagForSelectionMode();},_changeMandatoryTagForSelectionMode:function(){if(jQuery(this.byId("idVHfunction").getDomRef()).length>=1){this.byId("idVhFunctionLabel").setRequired(true);this.byId("idVHfunction").isMandatory=true;this.byId("idVHDefaultValues").isMandatory=false;}else if(jQuery(this.byId("idVHDefaultValues").getDomRef()).length>=1){this.byId("idVhFunctionLabel").setRequired(true);this.byId("idVHfunction").isMandatory=false;if(this.facetFilter.isMultiSelection()){this.byId("idVHDefaultValues").isMandatory=false;this.byId("idVhDefaultValuesLabel").setRequired(false);}else{this.byId("idVHDefaultValues").isMandatory=true;this.byId("idVhDefaultValuesLabel").setRequired(true);}}},_checkValidationStateForService:function(v,p){var s=this;var S,o,V={source:undefined,entitySet:undefined,selectProperty:undefined};if(v){S=this.byId("idVHSource").getValue().trim();}else{S=this.byId("idFRSource").getValue().trim();}var b=this.oConfigurationEditor.registerService(S);var a=[];var A=[];if(b){V.source=S;a=this.oConfigurationEditor.getAllEntitySetsOfService(S);var c;if(p==="entitySet"||p==="selectProperties"){if(v){c=this.byId("idVHEntity").getSelectedKey();}else{c=this.byId("idFREntity").getSelectedKey();}}else{if(v){c=this.facetFilter.getEntitySetOfValueHelp();}else{c=this.facetFilter.getEntitySetOfFilterResolution();}}if(c){a.forEach(function(e){if(c===e){V.entitySet=c;if(p==="source"){if(v){s.byId("idVHEntity").setSelectedKey(c);}else{s.byId("idFREntity").setSelectedKey(c);}}}});var d,C=[];if(p==="selectProperties"){if(v){d=this.byId("idVHSelectProperties").getSelectedKeys();}else{d=this.byId("idFRSelectProperties").getSelectedKeys();}}else{if(v){d=this.facetFilter.getSelectPropertiesOfValueHelp();}else{d=this.facetFilter.getSelectPropertiesOfFilterResolution();}}var P=this.oConfigurationEditor.getAllPropertiesOfEntitySet(S,c);P.forEach(function(e){d.forEach(function(f){if(f===e){C.push(f);}});});if(C.length>0){V.selectProperty=C;if(p!=="selectProperties"){if(v){this.byId("idVHSelectProperties").setSelectedKeys(C);}else{this.byId("idFRSelectProperties").setSelectedKeys(C);}}}else{if(this.byId("idVhCheckBox").getSelected()===true){this._resetFilterResolutionSelectProperty();}}}}if(V.selectProperty&&V.entitySet&&V.source){if(v){this.facetFilter.setServiceOfValueHelp(V.source);this.facetFilter.setEntitySetOfValueHelp(V.entitySet);o=this.facetFilter.getSelectPropertiesOfValueHelp();o.forEach(function(e){s.facetFilter.removeSelectPropertyOfValueHelp(e);});V.selectProperty.forEach(function(e){s.facetFilter.addSelectPropertyOfValueHelp(e);});if(this.byId("idVhCheckBox").getSelected()===true){this._setValueHelpSourceAsFilterResolution();}}else{this.facetFilter.setServiceOfFilterResolution(V.source);this.facetFilter.setEntitySetOfFilterResolution(V.entitySet);o=this.facetFilter.getSelectPropertiesOfFilterResolution();o.forEach(function(e){s.facetFilter.removeSelectPropertyOfFilterResolution(e);});V.selectProperty.forEach(function(e){s.facetFilter.addSelectPropertyOfFilterResolution(e);});}}},handleChangeForVHSource:function(){var s=this;this.oConfigurationEditor.setIsUnsaved();var S=this.byId("idVHSource").getValue().trim();var b;if(S){b=this.oConfigurationEditor.registerService(S);if(b){this.byId("idVhEntityLabel").setText(this.getText("vhEntity"));this.byId("idVhEntityLabel").setRequired(true);this.byId("idVhSelectPropertiesLabel").setText(this.getText("vhSelectProperties"));this.byId("idVhSelectPropertiesLabel").setRequired(true);}}else{this.facetFilter.setServiceOfValueHelp(S);this.facetFilter.setEntitySetOfValueHelp(undefined);var o=this.facetFilter.getSelectPropertiesOfValueHelp();o.forEach(function(e){s.facetFilter.removeSelectPropertyOfValueHelp(e);});this.byId("idVhEntityLabel").setText(this.getText("vhEntity"));this.byId("idVhEntityLabel").setRequired(false);this.byId("idVhSelectPropertiesLabel").setText(this.getText("vhSelectProperties"));this.byId("idVhSelectPropertiesLabel").setRequired(false);if(this.byId("idVhCheckBox").getSelected()===true){this._resetFilterResolutionFields();}}var d,a=[],A=[];a=this.oConfigurationEditor.getAllEntitySetsOfService(S);a.forEach(function(e){var E={};E.entityKey=e;E.entityName=e;A.push(E);});var D={Entities:A};var m=new sap.ui.model.json.JSONModel();m.setSizeLimit(500);m.setData(D);this.byId("idVHEntity").setModel(m);var p=[],P=[];if(a.length>=1){this.byId("idVHEntity").setSelectedKey(a[0]);this.facetFilter.setEntitySetOfValueHelp(a[0]);p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(S,a[0]);p.forEach(function(e){var f={};f.propertyKey=e;f.propertyName=e;P.push(f);});}var c={Properties:P};var M=new sap.ui.model.json.JSONModel();M.setSizeLimit(500);M.setData(c);this.byId("idVHSelectProperties").setModel(M);this._checkValidationStateForService(true,"source");if(this.byId("idVhCheckBox").getSelected()===true){this._populateServiceForFilterResolution();}},handleChangeForVHEntity:function(){var s=this;this.oConfigurationEditor.setIsUnsaved();var e=this.byId("idVHEntity").getSelectedKey();var S=this.byId("idVHSource").getValue().trim();var p=[],P=[];if(S&&S!==null&&S!==""){p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(S,e);p.forEach(function(a){var o={};o.propertyKey=a;o.propertyName=a;P.push(o);});var d={Properties:P};var m=new sap.ui.model.json.JSONModel();m.setSizeLimit(500);m.setData(d);this.byId("idVHSelectProperties").setModel(m);this._checkValidationStateForService(true,"entitySet");if(this.byId("idVhCheckBox").getSelected()===true){this._populateEntityForFilterResolution();}}},handleChangeForVHSelectProperties:function(){this.oConfigurationEditor.setIsUnsaved();this._checkValidationStateForService(true,"selectProperties");if(this.byId("idVhCheckBox").getSelected()===true){this._populateSelectPropertyForFilterResolution();}},handleChangeForDVMode:function(){var d=this.byId("idVHDefaultValueMode").getSelectedKey();if(d===this.getText("fixedValues")){this._hideAndResetPreselectionFunction();this._showPreselectionDefault();}else if(d===this.getText("Function")){this._showPreselectionFunction();this._hideAndResetPreselectionDefault();}},handleChangeForVHFixedValues:function(){this.oConfigurationEditor.setIsUnsaved();var p=this.byId("idVHDefaultValues").getValue().trim();var P=p.split(',');var v=[];if(this.facetFilter.getPreselectionFunction()){this.facetFilter.removePreselectionFunction();}P.forEach(function(d){var V=d.trim();if(V){v.push(V);}});if(v.length>0){if(this.facetFilter.isMultiSelection()){this.facetFilter.setPreselectionDefaults(v);this.byId("idVHDefaultValues").isMandatory=false;}else{this.facetFilter.setPreselectionDefaults([v[0]]);this.facetFilter.setMultiSelection(false);this.byId("idVHDefaultValues").isMandatory=true;}}},handleChangeForPreselectionFunction:function(){this.oConfigurationEditor.setIsUnsaved();var p=this.byId("idVHfunction").getValue().trim();if(this.facetFilter.getPreselectionDefaults().length){this.facetFilter.removePreselectionDefaults();}this.byId("idVHfunction").isMandatory=true;if(p){this.facetFilter.setPreselectionFunction(p);}},handleChangeForFRSource:function(){var s=this;this.oConfigurationEditor.setIsUnsaved();var S=this.byId("idFRSource").getValue().trim();var b;var a=[];var A=[];if(S){b=this.oConfigurationEditor.registerService(S);if(b){this.byId("idVhEntityLabel1").setText(this.getText("vhEntity"));this.byId("idVhEntityLabel1").setRequired(true);this.byId("idVhSelectPropertiesLabel1").setText(this.getText("vhSelectProperties"));this.byId("idVhSelectPropertiesLabel1").setRequired(true);}}else{this.facetFilter.setServiceOfFilterResolution(S);this.facetFilter.setEntitySetOfFilterResolution(undefined);var o=this.facetFilter.getSelectPropertiesOfFilterResolution();o.forEach(function(c){s.facetFilter.removeSelectPropertyOfFilterResolution(c);});this.byId("idVhEntityLabel1").setText(this.getText("vhEntity"));this.byId("idVhEntityLabel1").setRequired(false);this.byId("idVhSelectPropertiesLabel1").setText(this.getText("vhSelectProperties"));this.byId("idVhSelectPropertiesLabel1").setRequired(false);}a=this.oConfigurationEditor.getAllEntitySetsOfService(S);a.forEach(function(e){var E={};E.entityKey=e;E.entityName=e;A.push(E);});var d={Entities:A};var m=new sap.ui.model.json.JSONModel();m.setSizeLimit(500);m.setData(d);this.byId("idFREntity").setModel(m);var p=[],P=[];if(a.length>=1){this.byId("idFREntity").setSelectedKey(a[0]);this.facetFilter.setEntitySetOfFilterResolution(a[0]);p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(S,a[0]);p.forEach(function(c){var e={};e.propertyKey=c;e.propertyName=c;P.push(e);});}var D={Properties:P};var M=new sap.ui.model.json.JSONModel();M.setSizeLimit(500);M.setData(D);this.byId("idFRSelectProperties").setModel(M);this._checkValidationStateForService(false,"source");},handleChangeForFREntity:function(){var s=this;this.oConfigurationEditor.setIsUnsaved();var e=this.byId("idFREntity").getSelectedKey();var S=this.byId("idFRSource").getValue().trim();var p=[],P=[];if(S&&S!==null&&S!==""){p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(S,e);var d=p[0];p.forEach(function(a){var o={};o.propertyKey=a;o.propertyName=a;P.push(o);});var D={Properties:P};var m=new sap.ui.model.json.JSONModel();m.setSizeLimit(500);m.setData(D);this.byId("idFRSelectProperties").setModel(m);this._checkValidationStateForService(false,"entitySet");}},handleChangeForFRSelectProperties:function(){this.oConfigurationEditor.setIsUnsaved();this._checkValidationStateForService(false,"selectProperties");},handleChangeForVHCheckBox:function(e){this.oConfigurationEditor.setIsUnsaved();if(e.getParameter("selected")){this.facetFilter.setUseSameRequestForValueHelpAndFilterResolution(true);this._disableFilterResolutionSourceFields();}else{this.facetFilter.setUseSameRequestForValueHelpAndFilterResolution(false);this._enableFilterResolutionSourceFields();}},_enableFilterResolutionSourceFields:function(){this.byId("idFRSource").setEnabled(true);this.byId("idFREntity").setEnabled(true);this.byId("idFRSelectProperties").setEnabled(true);},_disableFilterResolutionSourceFields:function(){this.byId("idFRSource").setEnabled(false);this.byId("idFREntity").setEnabled(false);this.byId("idFRSelectProperties").setEnabled(false);this._setValueHelpSourceAsFilterResolution();},_setValueHelpSourceAsFilterResolution:function(){this._populateServiceForFilterResolution();this._populateEntityForFilterResolution();this._populateSelectPropertyForFilterResolution();},_populateServiceForFilterResolution:function(){this.byId("idFRSource").setModel(this.byId("idVHSource").getModel());this.byId("idFRSource").setValue(this.byId("idVHSource").getValue());this.facetFilter.setServiceOfFilterResolution(this.facetFilter.getServiceOfValueHelp());},_populateEntityForFilterResolution:function(){this.byId("idFREntity").setModel(this.byId("idVHEntity").getModel());this.byId("idFREntity").setSelectedKey(this.byId("idVHEntity").getSelectedKey());this.facetFilter.setEntitySetOfFilterResolution(this.facetFilter.getEntitySetOfValueHelp());},_populateSelectPropertyForFilterResolution:function(){var s=this;this.byId("idFRSelectProperties").setModel(this.byId("idVHSelectProperties").getModel());this.byId("idFRSelectProperties").setSelectedKeys(this.byId("idVHSelectProperties").getSelectedKeys());var o=this.facetFilter.getSelectPropertiesOfFilterResolution();o.forEach(function(p){s.facetFilter.removeSelectPropertyOfFilterResolution(p);});this.facetFilter.getSelectPropertiesOfValueHelp().forEach(function(p){s.facetFilter.addSelectPropertyOfFilterResolution(p);});},_resetFilterResolutionFields:function(){this._resetFilterResolutionService();this._resetFilterResolutionEntity();this._resetFilterResolutionSelectProperty();},_resetFilterResolutionService:function(){this.byId("idFRSource").setValue("");this.facetFilter.setServiceOfFilterResolution("");},_resetFilterResolutionEntity:function(){this.byId("idFREntity").setSelectedKey();var e=new sap.ui.model.json.JSONModel().setData({NoData:[]});this.byId("idFREntity").setModel(e);this.facetFilter.setEntitySetOfFilterResolution(undefined);},_resetFilterResolutionSelectProperty:function(){var s=this;this.byId("idFRSelectProperties").setSelectedKeys([]);var e=new sap.ui.model.json.JSONModel().setData({NoData:[]});this.byId("idFRSelectProperties").setModel(e);var S=this.byId("idFRSelectProperties").getSelectedKeys();this.byId("idFRSelectProperties").removeSelectedKeys(S);var o=this.facetFilter.getSelectPropertiesOfFilterResolution();o.forEach(function(p){s.facetFilter.removeSelectPropertyOfFilterResolution(p);});},_hideAndResetPreselectionFunction:function(){this.byId("idVHfunction").setValue("");if(this.facetFilter.getPreselectionFunction()){this.facetFilter.removePreselectionFunction();}this.byId("idVhFunctionLabel").setRequired(false);this.byId("idVhFunctionLabel").setVisible(false);this.byId("idVHfunction").setVisible(false);this.byId("idVHfunction").isMandatory=false;},_hideAndResetPreselectionDefault:function(){this.byId("idVHDefaultValues").setValue("");if(this.facetFilter.getPreselectionDefaults()){this.facetFilter.removePreselectionDefaults();}this.byId("idVhDefaultValuesLabel").setRequired(false);this.byId("idVhDefaultValuesLabel").setVisible(false);this.byId("idVHDefaultValues").setVisible(false);this.byId("idVHDefaultValues").isMandatory=false;},_showPreselectionFunction:function(){this.byId("idVhFunctionLabel").setRequired(true);this.byId("idVhFunctionLabel").setVisible(true);this.byId("idVHfunction").setVisible(true);this.byId("idVHfunction").isMandatory=true;},_showPreselectionDefault:function(){this.byId("idVhDefaultValuesLabel").setVisible(true);this.byId("idVHDefaultValues").setVisible(true);if(this.facetFilter.isMultiSelection()){this.byId("idVHDefaultValues").isMandatory=false;this.byId("idVhDefaultValuesLabel").setRequired(false);}else{this.byId("idVHDefaultValues").isMandatory=true;this.byId("idVhDefaultValuesLabel").setRequired(true);}},_setSourceValidationState:function(){var s=this.byId("idVHSource").getValue().trim();var f=this.byId("idFRSource").getValue().trim();var S;var F;if(s!==""){S=this.oConfigurationEditor.registerService(s);if(S){this.byId("idVHEntity").isMandatory=true;this.byId("idVHSelectProperties").isMandatory=true;}else{this.byId("idVHEntity").isMandatory=false;this.byId("idVHSelectProperties").isMandatory=false;}}else{this.byId("idVHEntity").isMandatory=false;this.byId("idVHSelectProperties").isMandatory=false;}if(f){F=this.oConfigurationEditor.registerService(s);if(F){this.byId("idFREntity").isMandatory=true;this.byId("idFRSelectProperties").isMandatory=true;}else{this.byId("idFREntity").isMandatory=false;this.byId("idFRSelectProperties").isMandatory=false;}}else{this.byId("idFREntity").isMandatory=false;this.byId("idFRSelectProperties").isMandatory=false;}},_setMandatoryFields:function(f){this.mandatoryFields=this.mandatoryFields||[];for(var i=0;i<f.length;i++){f[i].isMandatory=true;this.mandatoryFields.push(f[i]);}},_getMandatoryFields:function(){return this.mandatoryFields;},_setValidationState:function(){var m=this._getMandatoryFields();for(var i=0;i<m.length;i++){if(m[i].isMandatory===true){if(typeof m[i].getSelectedKeys==="function"){this.isValidState=(m[i].getSelectedKeys().length>=1)?true:false;}else if(typeof m[i].getValue==="function"){this.isValidState=(m[i].getValue().trim()!=="")?true:false;}else{this.isValidState=(m[i].getSelectedKey().length>=1)?true:false;}if(this.isValidState===false){break;}}}},getValidationState:function(){this._setSourceValidationState();this._setValidationState();var i=(this.isValidState!==undefined)?this.isValidState:true;return i;}});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.navigationTarget.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.navigationTarget.controller');sap.ui.controller("sap.apf.modeler.ui.controller.navigationTarget",{onInit:function(){this.getView().addStyleClass("sapUiSizeCompact");this.oViewData=this.getView().getViewData();this.oConfigurationHandler=this.oViewData.oConfigurationHandler;this.oConfigurationEditor=this.oViewData.oConfigurationEditor;this.oTextPool=this.oConfigurationHandler.getTextPool();this.getText=this.oViewData.getText;this.params=this.oViewData.oParams;this.createMessageObject=this.oViewData.createMessageObject;this.putMessage=this.oViewData.putMessage;this.updateTitleAndBreadCrumb=this.oViewData.updateTitleAndBreadCrumb;this.getAllAvailableSemanticObjects=this.oViewData.getAllAvailableSemanticObjects;this.getSemanticActions=this.oViewData.getSemanticActions;this.setNavigationTargetName=this.oViewData.setNavigationTargetName;var s=this;if(!this.oConfigurationEditor){this.oConfigurationHandler.loadConfiguration(this.params.arguments.configId,function(c){s.oConfigurationEditor=c;});}this._setDisplayText();this._prepareNavTargetTypeModel();var m=[];m.push(this.byId("idSemanticObjectField"));m.push(this.byId("idActionField"));m.push(this.byId("idContextMapEntitySelect"));m.push(this.byId("idMappedPropertiesCombo"));this._setMandatoryFields(m);this.getAllAvailableSemanticObjects(function(a,b){if(b===undefined){s._populateSemanticObjectModel(a);s.setDetailData();if(s.oNavTarget&&(s.oNavTarget.getFilterMappingService()===undefined||s.oNavTarget.getFilterMappingService()==="")){s._removeMandatoryFromContextMap();}}else{var M=s.createMessageObject({code:"11504"});M.setPrevious(b);s.putMessage(M);}});},_populateSemanticObjectModel:function(a){var A;var b=[];a.forEach(function(S){var o={};o.semanticObjectKey=S.id;o.semanticObjectName=S.id;b.push(o);});var s={aAllSemanticObjects:b};A=new sap.ui.model.json.JSONModel();A.setSizeLimit(500);A.setData(s);this.byId("idSemanticObjectField").setModel(A);},_setDisplayText:function(){this.byId("idNavigationTargetHeaderLabel").setTitle(this.getText("basicData"));this.byId("idSemanticObjectLabel").setText(this.getText("semanticObject"));this.byId("idSemanticObjectLabel").setRequired(true);this.byId("idActionLabel").setText(this.getText("action"));this.byId("idActionLabel").setRequired(true);this.byId("idDescriptionLabel").setText(this.getText("navigationTargetTitle"));this.byId("idNavigationTargetTypeHeaderLabel").setTitle(this.getText("navigationTargetType"));this.byId("idNavigationTargetTypeLabel").setText(this.getText("assignmentType"));this.byId("idAssignedStepsLabel").setText(this.getText("assignedSteps"));this.byId("idContextMapping").setTitle(this.getText("contextMapping"));this.byId("idContextMapSourceLabel").setText(this.getText("source"));this.byId("idContextMapEntityLabel").setText(this.getText("entity"));this.byId("idMappedPropertiesLabel").setText(this.getText("mappedProperties"));},_prepareNavTargetTypeModel:function(){var n=[{typeKey:this.getText("globalNavTargets"),typeName:this.getText("globalNavTargets")},{typeKey:this.getText("stepSpecific"),typeName:this.getText("stepSpecific")}];var N=new sap.ui.model.json.JSONModel();var o={navTargetType:n};N.setData(o);this.byId("idNavigationTargetTypeField").setModel(N);},_prepareAssignStepModel:function(){var a=[];var A=new sap.ui.model.json.JSONModel();var s=this.oConfigurationEditor.getSteps();for(var i=0;i<s.length;i++){var S={};S.stepKey=s[i].getId();S.stepName=this.oTextPool.get(s[i].getTitleId()).TextElementDescription;a.push(S);}var o={allSteps:a};A.setData(o);this.byId("idAssignedStepsCombo").setModel(A);},setDetailData:function(){var s=this.byId("idSemanticObjectField").getModel().getData().aAllSemanticObjects;if(this.params&&this.params.arguments&&this.params.arguments.navTargetId){this.oNavTarget=this.oConfigurationEditor.getNavigationTarget(this.params.arguments.navTargetId);}if(this.oNavTarget){var S;var a=this.oNavTarget.getSemanticObject();for(var i=0;i<s.length;i++){if(a===s[i].semanticObjectKey){S=true;break;}}this.byId("idSemanticObjectField").setValue(a);var b={changeSemanticObject:false,semanticObjectInList:S?true:false};this._populateActions(a,b);var n=this.oNavTarget.isStepSpecific()?this.getText("stepSpecific"):this.getText("globalNavTargets");if(n===this.getText("stepSpecific")){this.byId("idAssignedStepsLabel").setVisible(true);this.byId("idAssignedStepsCombo").setVisible(true);this._prepareAssignStepModel();var A=this.oConfigurationEditor.getStepsAssignedToNavigationTarget(this.oNavTarget.getId());this.byId("idAssignedStepsCombo").setSelectedKeys(A);}this.byId("idNavigationTargetTypeField").setSelectedKey(n);if(this.oNavTarget.getFilterMappingService&&this.oNavTarget.getFilterMappingService()!==undefined&&this.oNavTarget.getFilterMappingService().length!==0){this.byId("idContextMapSourceSelect").setValue(this.oNavTarget.getFilterMappingService());var c=this.oNavTarget.getFilterMappingService();var d=[];var e=[];d=this.oConfigurationEditor.getAllEntitySetsOfService(c);d.forEach(function(r){var E={};E.entityKey=r;E.entityName=r;e.push(E);});var D={Entity:e};var m=new sap.ui.model.json.JSONModel();m.setSizeLimit(500);m.setData(D);this.byId("idContextMapEntitySelect").setModel(m);this._addMandatoryToContextMap();}else{this._removeMandatoryFromContextMap();this._resetContextMappingFields();}if(this.oNavTarget.getFilterMappingEntitySet&&this.oNavTarget.getFilterMappingEntitySet()!==undefined&&this.oNavTarget.getFilterMappingEntitySet().length!==0){this.byId("idContextMapEntitySelect").setSelectedKey(this.oNavTarget.getFilterMappingEntitySet());var f=this.oNavTarget.getFilterMappingService();var F=this.oNavTarget.getFilterMappingEntitySet();var g=[],p=[];if(f&&f!==null&&f!==""){g=this.oConfigurationEditor.getAllPropertiesOfEntitySet(f,F);g.forEach(function(r){var P={};P.propertyKey=r;P.propertyName=r;p.push(P);});var o={Properties:p};var M=new sap.ui.model.json.JSONModel();M.setSizeLimit(500);M.setData(o);this.byId("idMappedPropertiesCombo").setModel(M);}}if(this.oNavTarget.getFilterMappingTargetProperties&&this.oNavTarget.getFilterMappingTargetProperties()!==undefined&&this.oNavTarget.getFilterMappingTargetProperties().length!==0){this.byId("idMappedPropertiesCombo").setSelectedKeys(this.oNavTarget.getFilterMappingTargetProperties());}}else{var h=this.oConfigurationEditor.createNavigationTarget();this.oNavTarget=this.oConfigurationEditor.getNavigationTarget(h);s.splice(0,0,{semanticObjectKey:"",semanticObjectName:""});var j={aAllSemanticObjects:s};this.byId("idSemanticObjectField").getModel().setData(j);this.byId("idSemanticObjectField").setSelectedKey("");var k=new sap.ui.model.json.JSONModel();var l={aActions:[{id:"",text:""}]};k.setData(l);this.byId("idActionField").setModel(k);this.byId("idActionField").setSelectedKey("");var q={id:h,icon:"sap-icon://BusinessSuiteInAppSymbols/icon-where-used"};this.oViewData.updateSelectedNode(q);this.oNavTarget.setGlobal();this.byId("idNavigationTargetTypeField").setSelectedKey(this.getText("globalNavTargets"));}this._addAutoCompleteFeatureOnInputs();},handleChangeSemanticObjectValue:function(e){var s=this.byId("idSemanticObjectField").getModel().getData().aAllSemanticObjects;if(s[0].semanticObjectKey===""){s.splice(0,1);var S={aAllSemanticObjects:s};this.byId("idSemanticObjectField").getModel().setData(S);}var a=e.getParameter("value");var b=this.byId("idSemanticObjectField").getSelectedKey();var c={changeSemanticObject:true,semanticObjectInList:a===b?true:false};if(a!==""&&a!==null){this.oConfigurationEditor.setIsUnsaved();this.oNavTarget.setSemanticObject(a);this._populateActions(a,c);}},_getActionText:function(){var t;var s=this.byId("idActionField").getModel().getData().aActions;for(var i=0;i<s.length;i++){if(s[i].id===this.oNavTarget.getAction()){t=s[i].text;break;}}return t;},handleChangeofAction:function(e){var t;var a=e.getParameter("value");if(a!==""&&a!==null){this.oNavTarget.setAction(a);t=this._getActionText();}this.oConfigurationEditor.setIsUnsaved();if(t===undefined){t=this.oNavTarget.getSemanticObject();}var A={name:t,icon:this.oNavTarget.isGlobal()?"sap-icon://BusinessSuiteInAppSymbols/icon-where-used":"sap-icon://pushpin-off"};this.byId("idDescription").setValue(t);var n={key:this.oNavTarget.getId(),value:t};this.setNavigationTargetName(n);this.oViewData.updateSelectedNode(A);t=this.getText("navigationTarget")+": "+t;this.updateTitleAndBreadCrumb(t);},_updateDescriptionAndTitle:function(s,t){if(s.changeSemanticObject){if(t===undefined){t=this.oNavTarget.getSemanticObject();}var a={name:t,icon:this.oNavTarget.isGlobal()?"sap-icon://BusinessSuiteInAppSymbols/icon-where-used":"sap-icon://pushpin-off"};this.byId("idDescription").setValue(t);this.oViewData.updateSelectedNode(a);var n={key:this.oNavTarget.getId(),value:t};this.setNavigationTargetName(n);t=this.getText("navigationTarget")+": "+t;this.updateTitleAndBreadCrumb(t);}},_populateActions:function(s,a){var b=this;var t;if(a&&a.semanticObjectInList){var p=this.getSemanticActions(s);p.then(function(S){var A={aActions:S.semanticActions};var o=new sap.ui.model.json.JSONModel();o.setData(A);b.byId("idActionField").setModel(o);if(b.oNavTarget.getAction()&&a&&a.changeSemanticObject===false){b.byId("idActionField").setValue(b.oNavTarget.getAction());var T=b._getActionText()?b._getActionText():b.oNavTarget.getSemanticObject();b.byId("idDescription").setValue(T);}else if(o.getData().aActions.length>0){b.byId("idActionField").setSelectedKey(o.getData().aActions[0].id);b.oNavTarget.setAction(o.getData().aActions[0].id);t=o.getData().aActions[0].text;}b._updateDescriptionAndTitle(a,t);},function(c){var M=b.createMessageObject({code:"11505"});M.setPrevious(c);b.putMessage(M);});}else{var m=new sap.ui.model.json.JSONModel();var d={aActions:[]};m.setData(d);this.byId("idActionField").setModel(m);if(this.oNavTarget.getAction()&&a&&a.changeSemanticObject===false){this.byId("idActionField").setValue(this.oNavTarget.getAction());var T=b.oNavTarget.getSemanticObject();b.byId("idDescription").setValue(T);}else{this.byId("idActionField").setValue("");}this._updateDescriptionAndTitle(a,t);}},handleChangeOfNavigationTargetType:function(){this.oConfigurationEditor.setIsUnsaved();var n={};var a=this.byId("idNavigationTargetTypeField").getSelectedKey();if(a===this.getText("stepSpecific")){this.byId("idAssignedStepsLabel").setVisible(true);this.byId("idAssignedStepsCombo").setVisible(true);this._prepareAssignStepModel();this.oNavTarget.setStepSpecific();n.name=this.byId("idDescription").getValue();n.icon="sap-icon://pushpin-off";}else{this.byId("idAssignedStepsLabel").setVisible(false);this.byId("idAssignedStepsCombo").setVisible(false);this.byId("idAssignedStepsCombo").setSelectedKeys([]);this.oNavTarget.setGlobal();var b=this.oConfigurationEditor.getStepsAssignedToNavigationTarget(this.oNavTarget.getId());for(var i=0;i<b.length;i++){var s=this.oConfigurationEditor.getStep(b[i]);s.removeNavigationTarget(this.oNavTarget.getId());}n.name=this.byId("idDescription").getValue();n.icon="sap-icon://BusinessSuiteInAppSymbols/icon-where-used";}this.oViewData.updateSelectedNode(n);},handleChangeForAssignedSteps:function(){var s=this;this.oConfigurationEditor.setIsUnsaved();var a=this.byId("idAssignedStepsCombo").getSelectedKeys();var p=this.oConfigurationEditor.getStepsAssignedToNavigationTarget(this.oNavTarget.getId());p.forEach(function(S){if(a.indexOf(S)===-1){var o=s.oConfigurationEditor.getStep(S);o.removeNavigationTarget(s.oNavTarget.getId());}});a.forEach(function(S){if(p.indexOf(S)===-1){var o=s.oConfigurationEditor.getStep(S);o.addNavigationTarget(s.oNavTarget.getId());}});},handleChangeForService:function(){this.oConfigurationEditor.setIsUnsaved();var a,A=[],s=[];var S=this.byId("idContextMapSourceSelect").getValue().trim();var b=this.oConfigurationEditor.registerService(S);if(b){this._addMandatoryToContextMap();a=this.oConfigurationEditor.getAllEntitySetsOfService(S);if(a.length>0){a.forEach(function(d){var f={};f.entityKey=d;f.entityName=d;A.push(f);});}var e={Entity:A};var E=new sap.ui.model.json.JSONModel();E.setSizeLimit(500);E.setData(e);this.byId("idContextMapEntitySelect").setModel(E);if(a.length>=1){var p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(S,a[0]);this.oNavTarget.setFilterMappingEntitySet(a[0]);this.byId("idContextMapEntitySelect").setSelectedKey(a[0]);p.forEach(function(d){var P={};P.propertyKey=d;P.propertyName=d;s.push(P);});}var o={Properties:s};var c=new sap.ui.model.json.JSONModel();c.setSizeLimit(500);c.setData(o);this.byId("idMappedPropertiesCombo").setModel(c);this._validateAndSetDataForContextMapping();}else{this._resetContextMappingFields();this._removeMandatoryFromContextMap();}},handleChangeForEntity:function(){this.oConfigurationEditor.setIsUnsaved();var p=[];var e=this.byId("idContextMapEntitySelect").getSelectedKey();var s=this.byId("idContextMapSourceSelect").getValue().trim();var P=this.oConfigurationEditor.getAllPropertiesOfEntitySet(s,e);P.forEach(function(a){var b={};b.propertyKey=a;b.propertyName=a;p.push(b);});var S={Properties:p};var o=new sap.ui.model.json.JSONModel();o.setSizeLimit(500);o.setData(S);this.byId("idMappedPropertiesCombo").setModel(o);var m=this.oNavTarget.getFilterMappingTargetProperties();var c=[];P.forEach(function(a){m.forEach(function(b){if(b===a){c.push(b);}});});this.byId("idMappedPropertiesCombo").setSelectedKeys(c);this._validateAndSetDataForContextMapping();},handleChangeForMappedProperties:function(){this.oConfigurationEditor.setIsUnsaved();var s=this.byId("idMappedPropertiesCombo").getSelectedKeys();if(s.length!==0){this._validateAndSetDataForContextMapping();}},_getMandatoryFields:function(){return this.mandatoryFields;},_setMandatoryFields:function(f){this.mandatoryFields=this.mandatoryFields||[];for(var i=0;i<f.length;i++){f[i].isMandatory=true;this.mandatoryFields.push(f[i]);}},_setValidationState:function(){var m=this._getMandatoryFields();if(m.length!==0){for(var i=0;i<m.length;i++){if(m[i].isMandatory===true){if(typeof m[i].getSelectedKeys==="function"){this.isValidState=(m[i].getSelectedKeys().length>=1)?true:false;}else if(typeof m[i].getValue==="function"){this.isValidState=(m[i].getValue().trim()!=="")?true:false;}else{this.isValidState=(m[i].getSelectedKey()!==""&&m[i].getSelectedKey()!==undefined)?true:false;}if(this.isValidState===false){break;}}}}},getValidationState:function(){this._setValidationState();var i=(this.isValidState!==undefined)?this.isValidState:true;return i;},_validateAndSetDataForContextMapping:function(){var s=this;var S=this.byId("idContextMapSourceSelect").getValue().trim();var a=this.byId("idContextMapEntitySelect").getSelectedKey();var m=this.byId("idMappedPropertiesCombo").getSelectedKeys();if((S!==""||S!==undefined)&&(a!==""||a!==undefined)&&(m.length!==0)){this.oNavTarget.setFilterMappingService(S);this.oNavTarget.setFilterMappingEntitySet(a);var o=this.oNavTarget.getFilterMappingTargetProperties();o.forEach(function(p){s.oNavTarget.removeFilterMappingTargetProperty(p);});m.forEach(function(p){s.oNavTarget.addFilterMappingTargetProperty(p);});}},_addMandatoryToContextMap:function(){this.byId("idContextMapEntitySelect").isMandatory=true;this.byId("idMappedPropertiesCombo").isMandatory=true;this.byId("idContextMapEntityLabel").setRequired(true);this.byId("idMappedPropertiesLabel").setRequired(true);},_removeMandatoryFromContextMap:function(){this.byId("idContextMapEntitySelect").isMandatory=false;this.byId("idMappedPropertiesCombo").isMandatory=false;this.byId("idContextMapEntityLabel").setRequired(false);this.byId("idMappedPropertiesLabel").setRequired(false);},_resetContextMappingFields:function(){var s=this;this.oNavTarget.setFilterMappingService("");this.oNavTarget.setFilterMappingEntitySet(undefined);var o=this.oNavTarget.getFilterMappingTargetProperties();o.forEach(function(p){s.oNavTarget.removeFilterMappingTargetProperty(p);});var e=new sap.ui.model.json.JSONModel();var E={NoData:[]};e.setData(E);this.byId("idContextMapSourceSelect").setValue("");this.byId("idContextMapEntitySelect").setModel(e);this.byId("idContextMapEntitySelect").setSelectedKey();this.byId("idMappedPropertiesCombo").setModel(e);var S=this.byId("idMappedPropertiesCombo").getSelectedKeys();this.byId("idMappedPropertiesCombo").removeSelectedKeys(S);},_addAutoCompleteFeatureOnInputs:function(){if(this.oConfigurationHandler){var t=new sap.apf.modeler.ui.utils.TextPoolHelper(this.oTextPool);var d={oConfigurationEditor:this.oConfigurationEditor,type:"service"};var s=this.byId("idContextMapSourceSelect");t.setAutoCompleteOn(s,d);}}});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.previewContent.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.previewContent.controller');sap.ui.getCore().loadLibrary("sap.viz");sap.ui.controller("sap.apf.modeler.ui.controller.previewContent",{onInit:function(){this.oView=this.getView();this.oView.addStyleClass("sapUiSizeCompact");this.oMainChartHolder=this.oView.byId("idMainChart");this.oThumbnailChartHolder=this.oView.byId("idThumbnailChartLayout");this.mParam=this.oView.getViewData();this._prepareRepresentationInstance();this._drawContent();},_drawContent:function(){this._drawMainChart();this._drawThumbnailContent();this._addStyleClasses();},_drawMainChart:function(){var m=this.oRepresentationInstance.getMainContent(this.mParam.sStepLongTitle,480,330);this.oMainChartHolder.addItem(m);},_drawThumbnailContent:function(){this._drawThumbnailChart();this.oView.byId("idStepTitleText").setText(this.mParam.sStepTitle);this._drawCornerTexts();},_drawThumbnailChart:function(){var t=this.oRepresentationInstance.getThumbnailContent();this.oThumbnailChartHolder.addItem(t);},_drawCornerTexts:function(){this.oView.byId("idLeftUpperCornerText").setText(this.mParam.aCornerTexts.sLeftUpper);this.oView.byId("idRightUpperCornerText").setText(this.mParam.aCornerTexts.sRightUpper);this.oView.byId("idLeftLowerCornerText").setText(this.mParam.aCornerTexts.sLeftLower);this.oView.byId("idRightLowerCornerText").setText(this.mParam.aCornerTexts.sRightLower);},_addStyleClasses:function(){this.oView.byId("idChartHolder").addStyleClass("supressDialogPadding");this.oView.byId("idMainChart").addStyleClass("previewMainChartHolder");this.oView.byId("idThumbnail").addStyleClass("previewThumbnailHolder");this.oView.byId("idThumbnailLayout").addStyleClass("previewThumbnailLayout");this.oView.byId("idThumbnailChartLayout").addStyleClass("previewThumbnailChartLayout");this.oView.byId("idTopLayout").addStyleClass("previewThumbnailTopLayout");this.oView.byId("idBottomLayout").addStyleClass("previewThumbnailBottomLayout");this.oView.byId("idLeftUpperCornerText").addStyleClass("previewThumbnailText");this.oView.byId("idRightUpperCornerText").addStyleClass("previewThumbnailText");this.oView.byId("idLeftLowerCornerText").addStyleClass("previewThumbnailText");this.oView.byId("idRightLowerCornerText").addStyleClass("previewThumbnailText");},_generateSampleData:function(){var s=[];var n=3;var i=0;var d=this.mParam.aDimensions;var m=this.mParam.aMeasures;var S=this.mParam.oChartParameter.dimensions;var a=this.mParam.oChartParameter.measures;var I=function(b,f,v,r){var c=b.filter(function(o){return o.fieldName===f;});c.forEach(function(C){if(!C.fieldDesc||!C.fieldDesc.length){C.fieldDesc=C.fieldName;}r[C.fieldDesc]=v;});};var l=Math.pow(n,this.mParam.aDimensions.length);for(i=0;i<l;i++){var r={};d.forEach(function(D,b){var c=D+" - "+(Math.floor(i/Math.pow(n,b))%n+1);r[D]=c;I(S,D,c,r);});m.forEach(function(M){var b=Math.round(Math.random()*500);r[M]=b;I(a,M,b,r);});s.push(r);}if(this.mParam.aSort&&this.mParam.aSort.length){s=this._sortData(s,this.mParam.aSort);}return s;},_sortData:function(d,p){return d.sort(function(r,R){var n,i;for(i=0;i<p.length;i++){n=0;if(r[p[i].sSortField]<R[p[i].sSortField]){n=-1;}else if(r[p[i].sSortField]>R[p[i].sSortField]){n=1;}n=n*[1,-1][+!!p[i].bDescending];if(n!==0){return n;}}});},_getRepresentationConstructor:function(c){var r=sap.apf.core.representationTypes();var R=r.filter(function(R){return R.id===c;})[0];var C=R.constructor;return C;},_prepareRepresentationInstance:function(){var r=this._getRepresentationConstructor(this.mParam.sChartType);jQuery.sap.require(r);var F=sap.apf.utils.extractFunctionFromModulePathString(r);var a={getTextNotHtmlEncoded:function(t){return t;},getTextHtmlEncoded:function(t){return t;},getEventCallback:function(){return;}};this.oRepresentationInstance=new F(a,this.mParam.oChartParameter);var m={getPropertyMetadata:function(){return{};}};var s=this._generateSampleData();this.oRepresentationInstance.setData(s,m);}});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.representation.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.representation.controller');sap.ui.controller("sap.apf.modeler.ui.controller.representation",{onInit:function(){this.getView().addStyleClass("sapUiSizeCompact");this.oViewData=this.getView().getViewData();this.oConfigurationHandler=this.oViewData.oConfigurationHandler;this.oConfigurationEditor=this.oViewData.oConfigurationEditor;this.oTextPool=this.oConfigurationHandler.getTextPool();this.getText=this.oViewData.getText;this.getEntityTypeMetadata=this.oViewData.getEntityTypeMetadata;this.getRepresentationTypes=this.oViewData.getRepresentationTypes;this.mParam=this.oViewData.oParams;var s=this;if(!this.oConfigurationEditor){this.oConfigurationHandler.loadConfiguration(this.mParam.arguments.configId,function(c){s.oConfigurationEditor=c;});}this._addConfigStyleClass();this._setDisplayText();this.setDetailData();this._oPreviewButton=new sap.m.Button({text:this.getText("preview"),press:s._handlePreviewButtonPress.bind(this)});this._insertPreviewButtonInFooter();},_addConfigStyleClass:function(){this.byId("idBasicDataLayout").addStyleClass("basicLayoutData");this.byId("idChartTypeLabel").addStyleClass("chartTypeLabel");this.byId("idSortLayout").addStyleClass("sortLayoutData");this.byId("idChartIcon").addStyleClass("repChartIcon");this.byId("idRightUpper").addStyleClass("repRightCornerText");this.byId("idRightLower").addStyleClass("repRightCornerText");this.byId("idLeftUpper").addStyleClass("repLeftCornerText");this.byId("idLeftLower").addStyleClass("repLeftCornerText");},_setDisplayText:function(){this.byId("idVisualization").setTitle(this.getText("visualization"));this.byId("idChartTypeLabel").setText(this.getText("chartType"));this.byId("idBasicData").setTitle(this.getText("basicData"));this.byId("idSorting").setTitle(this.getText("sorting"));this.byId("idThumbnailTexts").setTitle(this.getText("cornerTextLabel"));this.byId("idLeftUpper").setPlaceholder(this.getText("leftTop"));this.byId("idRightUpper").setPlaceholder(this.getText("rightTop"));this.byId("idLeftLower").setPlaceholder(this.getText("leftBottom"));this.byId("idRightLower").setPlaceholder(this.getText("rightBottom"));},handleChangeForChartType:function(e){var n=e.getParameter("selectedItem").getKey();var p=this.sCurrentChartType;this.sCurrentChartType=n;this._updateAndSetDatasetsByChartType(n);var r=sap.apf.ui.utils.CONSTANTS.representationTypes;var b=r.BAR_CHART;var c=[r.COLUMN_CHART,r.STACKED_COLUMN_CHART,r.PERCENTAGE_STACKED_COLUMN_CHART,r.LINE_CHART];var i=(b===n);this.bIsBarClassType=i;var I=c.indexOf(n)!==-1;var a=(c.indexOf(n)!==-1&&c.indexOf(p)!==-1);if(i||(I&&!a)){this._switchLabelForCharts();}this.oRepresentation.setRepresentationType(n);var A;if(n!==sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){A=sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION;}var s=this._getChartPictureDataset().sSelectedChartPicture;this.oRepresentation.setAlternateRepresentationType(A);var R=this.getText(this.oRepresentation.getRepresentationType());var S=this.oConfigurationEditor.getCategoriesForStep(this.oParentStep.getId());if(S.length===1){this.oViewData.updateSelectedNode({name:R,icon:s});}else{this.oViewData.updateTree();}var t=this.getText("representation")+": "+R;this.oViewData.updateTitleAndBreadCrumb(t);this.oConfigurationEditor.setIsUnsaved();},_switchLabelForCharts:function(){var s=this;var b=this.byId("idBasicDataLayout").getItems();var a,k;b.forEach(function(d){a=d.getContent()[0].getBindingContext().getProperty("sAggregationRole");k=d.getContent()[0].getBindingContext().getProperty("sKind");if(a&&k){var t=s._createDimMeasForCharts(a,k);d.getContent()[0].setText(t);}});},_createDimMeasForCharts:function(a,k){var h=sap.apf.core.constants.representationMetadata.kind.XAXIS;var v=sap.apf.core.constants.representationMetadata.kind.YAXIS;if(a==="dimension"&&k===h){k=h;if(this.bIsBarClassType){k=v;}}else if(a==="measure"){k=v;if(this.bIsBarClassType){k=h;}}a=this.getText(a);k=this.getText(k);var t=this.getText("dim-measure-label",[a,k]);return t;},handleChangeForCornerText:function(e){var c=e.getSource();var C=c.getValue();var t=sap.apf.modeler.ui.utils.TranslationFormatMap.REPRESENTATION_CORNER_TEXT;var s=this.oTextPool.setText(C,t);var a=c.getBindingPath('value').replace("/","");var S=["set",a,"CornerTextKey"].join("");this.oRepresentation[S](s);this.oConfigurationEditor.setIsUnsaved();this.mDataset.oCornerTextsDataset[a]=this._getCornerTextsDataset()[a];this.mModel.oCornerTextsModel.updateBindings();},_addAutoCompleteFeatureOnInputs:function(){var s=this;var t=new sap.apf.modeler.ui.utils.TextPoolHelper(this.oTextPool);var d={oTranslationFormat:sap.apf.modeler.ui.utils.TranslationFormatMap.REPRESENTATION_CORNER_TEXT,type:"text"};var c=["idLeftUpper","idRightUpper","idLeftLower","idRightLower"];c.forEach(function(i){var I=s.getView().byId(i);t.setAutoCompleteOn(I,d);});},_bindBasicRepresentationData:function(){var s=this;var b=this.byId("idBasicDataLayout");var p=new sap.ui.layout.Grid({width:"100%"});var a=new sap.m.Label({width:"100%",textAlign:"End",layoutData:new sap.ui.layout.GridData({span:"L3 M3 S3"}),text:{path:"/",formatter:function(){var c=this.getBindingContext().getProperty("sAggregationRole");var k=this.getBindingContext().getProperty("sKind");var C=s.sCurrentChartType;var R=sap.apf.ui.utils.CONSTANTS.representationTypes;var B=[R.BAR_CHART,R.STACKED_BAR_CHART,R.PERCENTAGE_STACKED_BAR_CHART];s.bIsBarClassType=(B.indexOf(C)!==-1);if(c&&k){if(s.bIsBarClassType){return s._createDimMeasForCharts(c,k);}else{c=s.getText(c);k=s.getText(k);return s.getText("dim-measure-label",[c,k]);}}}}});p.addContent(a);var P=new sap.m.Select({width:"100%",layoutData:new sap.ui.layout.GridData({span:"L3 M3 S3"}),items:{path:"aAllProperties",template:new sap.ui.core.ListItem({key:"{sName}",text:"{sName}"})},selectedKey:"{sSelectedProperty}",change:s._handleChangeForBasicDataSelectProperty.bind(this)});p.addContent(P);var l=new sap.m.Label({textAlign:"End",width:"100%",layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2"}),text:{path:"/",formatter:function(){var t;var d,S;var L=this.getBindingContext().getProperty("sLabel");if(this.getParent().getContent()[1].getSelectedItem()){S=this.getParent().getContent()[1].getSelectedItem().getText();}else{S=this.getBindingContext().getProperty("sSelectedProperty");}t=s.getText("label");if(S&&S!==s.getText("none")){d=s.oEntityMetadata.getPropertyMetadata(S).label;if(!L||(L&&d&&(L===d))){t=s.getText("label")+"("+s.getText("default")+")";}}return t;}}}).addStyleClass("repFormRightLabel");p.addContent(l);var i=new sap.m.Input({width:"100%",layoutData:new sap.ui.layout.GridData({span:"L3 M2 S2"}),value:{path:"sLabel",formatter:function(){var d,S;if(this.getParent().getContent()[1].getSelectedItem()){S=this.getParent().getContent()[1].getSelectedItem().getText();}else{S=this.getBindingContext().getProperty("sSelectedProperty");}if(S&&S!==s.getText("none")){d=s.oEntityMetadata.getPropertyMetadata(S).label;}var L=this.getBindingContext().getProperty("sLabel");if((S&&S!==s.getText("none")&&!L)||(L&&d&&(L===d))){return d;}else{return L;}}},visible:{path:"sLabel",formatter:function(){if(!this.mEventRegistry.suggest){var t=new sap.apf.modeler.ui.utils.TextPoolHelper(s.oTextPool);var d={oTranslationFormat:sap.apf.modeler.ui.utils.TranslationFormatMap.REPRESENTATION_LABEL,type:"text"};t.setAutoCompleteOn(this,d);}return true;}},change:s._handleChangeForBasicDataPropertyRowLabelInput.bind(this)});p.addContent(i);var A=new sap.ui.core.Icon({width:"100%",src:"sap-icon://add",tooltip:s.getText("addButton"),visible:{path:"nMax",formatter:function(n){return(n==="*");}},press:s._handlerForBasicDataAddPropertyRow.bind(this)}).addStyleClass("addIconRepresentation");var r=new sap.ui.core.Icon({width:"100%",src:"sap-icon://less",tooltip:s.getText("deleteButton"),visible:{path:"/",formatter:function(){var c=true;var B=this.getBindingContext();var n=parseInt(B.getPath().split("/").pop(),10);if(n){var d=s.mDataset.oPropertyDataset.aPropertyRows;var C=d[n].sKind;var e=d[n].sAggregationRole;var f=n-1;var g=d[f].sKind;var h=d[f].sAggregationRole;c=!(C===g&&e===h);}return!c;}},press:s._handlerForBasicDataDeletePropertyRow.bind(this)}).addStyleClass("lessIconRepresentation");var I=new sap.m.HBox({layoutData:new sap.ui.layout.GridData({span:"L1 M2 S2"}),items:[A,r]});p.addContent(I);b.bindAggregation("items","/aPropertyRows",function(c){return p.clone(c);});},_handleChangeForBasicDataSelectProperty:function(s){var S=this;var a=s.getSource().getSelectedKey();var l=s.getSource().getParent().getContent()[2];if(a&&(a!==S.getText("none"))){S._setDefaultLabelForSelectedProperty(a,l);}else{l.setText(S.getText("label"));s.getSource().getParent().getContent()[3].setValue("");}S._setPropertiesFromCurrentDataset();S.oConfigurationEditor.setIsUnsaved();},_handleChangeForBasicDataPropertyRowLabelInput:function(i){var p=i.getSource().getBindingContext().getProperty("sSelectedProperty");if(p&&p!==this.getText("none")){this._updatLabelInPropertyRow(p,i.getSource().getValue(),i.getSource().getParent().getContent()[2]);}this._setPropertiesFromCurrentDataset();this.oConfigurationEditor.setIsUnsaved();},_handlerForBasicDataAddPropertyRow:function(a){var b=a.getSource().getBindingContext();var c=jQuery.extend(true,{},b.getObject());delete c.sSelectedProperty;delete c.sLabel;var n=parseInt(b.getPath().split("/").pop(),10);var p=this.mDataset.oPropertyDataset.aPropertyRows;p.splice(n+1,0,c);this.mModel.oPropertyModel.updateBindings();this._setPropertiesFromCurrentDataset();this.oConfigurationEditor.setIsUnsaved();},_handlerForBasicDataDeletePropertyRow:function(d){var b=d.getSource().getBindingContext();var n=parseInt(b.getPath().split("/").pop(),10);var p=this.mDataset.oPropertyDataset.aPropertyRows;p.splice(n,1);this.mModel.oPropertyModel.updateBindings();this._setPropertiesFromCurrentDataset();this.oConfigurationEditor.setIsUnsaved();},_updatLabelInPropertyRow:function(s,l,L){var d=this.oEntityMetadata.getPropertyMetadata(s).label;var a,b;if(d!==l&&l.length!==0){a=this.getText("label");b=l;}else{a=this.getText("label")+"("+this.getText("default")+")";b=d;}this.mDataset.oPropertyDataset.aPropertyRows.forEach(function(p){if(p.sSelectedProperty===s){p.sLabel=b;}});this.mModel.oPropertyModel.updateBindings();L.setText(a);},_setDefaultLabelForSelectedProperty:function(s,l){var d=this.oEntityMetadata.getPropertyMetadata(s).label;var L=this.getText("label")+"("+this.getText("default")+")";this.mDataset.oPropertyDataset.aPropertyRows.forEach(function(p){if(p.sSelectedProperty===s){p.sLabel=d;}});this.mModel.oPropertyModel.updateBindings();l.setText(L);},_bindSortLayoutData:function(){var s=this;var S=this.byId("idSortLayout");var o=new sap.ui.layout.Grid({width:"100%"});var a=new sap.m.Label({width:"100%",textAlign:"End",layoutData:new sap.ui.layout.GridData({span:"L3 M3 S3"}),text:this.getText("sortingField")});o.addContent(a);var b=new sap.m.Select({width:"100%",layoutData:new sap.ui.layout.GridData({span:"L3 M3 S3"}),items:{path:"aAllProperties",template:new sap.ui.core.ListItem({key:"{sName}",text:"{sName}"})},selectedKey:"{sSortProperty}",change:s._handleChangeForSortDataProperty.bind(this)});o.addContent(b);var d=new sap.m.Label({layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2"}),width:"100%",textAlign:"End",text:this.getText("direction")});o.addContent(d);var D=new sap.m.Select({width:"100%",layoutData:new sap.ui.layout.GridData({span:"L3 M2 S2"}),items:[{key:this.getText("ascending"),text:this.getText("ascending")},{key:this.getText("descending"),text:this.getText("descending")}],selectedKey:"{sDirection}",change:s._handleChangeForSortDirection.bind(this)});o.addContent(D);var A=new sap.ui.core.Icon({width:"100%",src:"sap-icon://add",tooltip:this.getText("addButton"),visible:true,press:s._handleChangeForAddSortRow.bind(this)}).addStyleClass("addIconRepresentation");var r=new sap.ui.core.Icon({width:"100%",src:"sap-icon://less",tooltip:this.getText("deleteButton"),visible:{path:"/",formatter:function(){var B=this.getBindingContext();var n=parseInt(B.getPath().split("/").pop(),10);return!!n;}},press:s._handleChangeForDeleteSortRow.bind(this)}).addStyleClass("lessIconRepresentation");var i=new sap.m.HBox({layoutData:new sap.ui.layout.GridData({span:"L1 M2 S2"}),items:[A,r]});o.addContent(i);S.bindAggregation("items","/aSortRows",o);},_handleChangeForSortDataProperty:function(){this._setSortFieldsFromCurrentDataset();this.oConfigurationEditor.setIsUnsaved();},_handleChangeForSortDirection:function(s){var S=s.getSource().getBindingContext().getProperty("sSortProperty");if(S!==this.getText("none")){this._setSortFieldsFromCurrentDataset();this.oConfigurationEditor.setIsUnsaved();}},_handleChangeForAddSortRow:function(a){var b=a.getSource().getBindingContext();var c=jQuery.extend(true,{},b.getObject());delete c.sSortProperty;delete c.sDirection;var n=parseInt(b.getPath().split("/").pop(),10);var s=this.mDataset.oSortDataset.aSortRows;s.splice(n+1,0,c);this.mModel.oSortModel.updateBindings();this._setSortFieldsFromCurrentDataset();this.oConfigurationEditor.setIsUnsaved();},_handleChangeForDeleteSortRow:function(d){var b=d.getSource().getBindingContext();var n=parseInt(b.getPath().split("/").pop(),10);var s=this.mDataset.oSortDataset.aSortRows;s.splice(n,1);this.mModel.oSortModel.updateBindings();this._setSortFieldsFromCurrentDataset();this.oConfigurationEditor.setIsUnsaved();},_validateRepresentationData:function(){var s=this;var d=this.oRepresentation.getDimensions().map(function(a){return{sType:"Dimension",sName:a};});var m=this.oRepresentation.getMeasures().map(function(a){return{sType:"Measure",sName:a};});var r=d.concat(m);r.forEach(function(a){var p=false;s.aSelectProperties.forEach(function(b){if(a.sName===b.sName){p=true;}});if(p===false){var R=["remove",a.sType].join("");s.oRepresentation[R](a.sName);s.oConfigurationEditor.setIsUnsaved();}});},setDetailData:function(){var c=this.mParam.arguments;this.oParentStep=this.oConfigurationEditor.getStep(c.stepId);this.oEntityMetadata=this.getEntityTypeMetadata(this.oParentStep.getService(),this.oParentStep.getEntitySet());this.aSelectProperties=this._getSelectPropertiesFromParentStep();this.oRepresentation=this.oParentStep.getRepresentation(c.representationId);if(!this.oRepresentation){this.oRepresentation=this.oParentStep.createRepresentation();this._setDefaultRepresentationType();this._setDefaultProperties();this.oConfigurationEditor.setIsUnsaved();}this._validateRepresentationData();var C=this._getChartTypeDataset();var p=this._getPropertyDataset();var s=this._getSortDataset();var o=this._getCornerTextsDataset();var a=this._getChartPictureDataset();this.mDataset={oChartTypeDataset:C,oPropertyDataset:p,oSortDataset:s,oCornerTextsDataset:o,oChartPictureDataset:a};var b=new sap.ui.model.json.JSONModel(this.mDataset.oChartTypeDataset);var P=new sap.ui.model.json.JSONModel(this.mDataset.oPropertyDataset);var S=new sap.ui.model.json.JSONModel(this.mDataset.oSortDataset);var d=new sap.ui.model.json.JSONModel(this.mDataset.oCornerTextsDataset);var e=new sap.ui.model.json.JSONModel(this.mDataset.oChartPictureDataset);this.mModel={oChartTypeModel:b,oPropertyModel:P,oSortModel:S,oCornerTextsModel:d,oChartPictureModel:e};this.byId("idChartType").setModel(this.mModel.oChartTypeModel);var f=this.sCurrentChartType;this._updateAndSetDatasetsByChartType(f);this.byId("idBasicDataLayout").setModel(this.mModel.oPropertyModel);this._bindBasicRepresentationData();this.byId("idSortLayout").setModel(this.mModel.oSortModel);this._bindSortLayoutData();this.byId("idLeftLower").setModel(this.mModel.oCornerTextsModel);this.byId("idRightLower").setModel(this.mModel.oCornerTextsModel);this.byId("idLeftUpper").setModel(this.mModel.oCornerTextsModel);this.byId("idRightUpper").setModel(this.mModel.oCornerTextsModel);this.byId("idChartIcon").setModel(this.mModel.oChartPictureModel);this._addAutoCompleteFeatureOnInputs();},_insertPreviewButtonInFooter:function(){var f=this.oViewData.oFooter;f.addContentRight(this._oPreviewButton);},_removePreviewButtonFromFooter:function(){var f=this.oViewData.oFooter;f.removeContentRight(this._oPreviewButton);},_handlePreviewButtonPress:function(){var p=this._getPreviewDetails();var P=new sap.ui.view({type:sap.ui.core.mvc.ViewType.XML,viewName:"sap.apf.modeler.ui.view.previewContent",viewData:p});var o=new sap.m.Dialog({title:this.getText("preview"),content:P,endButton:new sap.m.Button({text:this.getText("close"),press:function(){o.close();}})});o.open();},onExit:function(){this._removePreviewButtonFromFooter();},_getPreviewDetails:function(){var s=this;var c=this.mDataset.oChartTypeDataset.sSelectedChartType;var S=this._getParentStepTitle();var a=this._getParentStepLongTitle()||S;var d=[],m=[];this.aSelectProperties.forEach(function(o){if(o.sAggregationRole==="dimension"){d.push(o.sName);}else if(o.sAggregationRole==="measure"){m.push(o.sName);}});var C={dimensions:[],measures:[]};this.mDataset.oPropertyDataset.aPropertyRows.forEach(function(p){if(p.sSelectedProperty!==s.getText("none")){var A=p.sAggregationRole+"s";C[A].push({fieldDesc:p.sLabel,fieldName:p.sSelectedProperty,kind:p.sKind});}});var b=[];this.mDataset.oSortDataset.aSortRows.forEach(function(o){var f=o.sSortProperty||(o.aAllProperties.length&&o.aAllProperties[0].sName);if(f&&f!==s.getText("none")){var A=!o.sDirection||(o.sDirection===s.getText("ascending"));b.push({sSortField:f,bDescending:!A});}});var e={sLeftUpper:this.mDataset.oCornerTextsDataset.LeftUpper,sRightUpper:this.mDataset.oCornerTextsDataset.RightUpper,sLeftLower:this.mDataset.oCornerTextsDataset.LeftLower,sRightLower:this.mDataset.oCornerTextsDataset.RightLower};return{sChartType:c,sStepTitle:S,sStepLongTitle:a,aDimensions:d,aMeasures:m,oChartParameter:C,aSort:b,aCornerTexts:e};},_getParentStepLongTitle:function(){var s=this.oParentStep.getLongTitleId();s=!this.oTextPool.isInitialTextKey(s)?s:undefined;var S=s&&this.oTextPool.get(s);var a=S&&S.TextElementDescription;return a;},_getParentStepTitle:function(){var s=this.oParentStep.getTitleId();var S=s&&this.oTextPool.get(s);var a=S&&S.TextElementDescription;return a;},_getSelectPropertiesFromParentStep:function(){var a=this.oParentStep.getService();var e=this.oParentStep.getEntitySet();var E=this.getEntityTypeMetadata(a,e);var s=this.oParentStep.getSelectProperties();var r=s.map(function(p){var m=E.getPropertyMetadata(p);return{sName:p,sAggregationRole:m["aggregation-role"],sLabel:m["label"]};});return r;},_getCornerTextsFromConfigObject:function(c){var s=this;var C=["LeftUpper","RightUpper","LeftLower","RightLower"];var d={};C.forEach(function(a){var m=["get",a,"CornerTextKey"].join("");var b=c[m]();var o=b&&s.oTextPool.get(b);var e=o&&o.TextElementDescription;d[a]=e;});return d;},_getChartTypeDataset:function(){var s=this;var k=Object.keys(this._getRepresentationMetadata());var c=k.map(function(K){return{sId:K,sText:s.getText(K)};});var d={aChartTypes:c,sSelectedChartType:this.oRepresentation.getRepresentationType()};this.sCurrentChartType=d.sSelectedChartType;return d;},_getChartPictureDataset:function(){var r=this.getRepresentationTypes();var d={};r.forEach(function(o){var i=o.id;d[i]=o.picture;});d.sSelectedChartPicture=d[this.oRepresentation.getRepresentationType()];return d;},_updatePictureDataset:function(c){var d=this.mModel.oChartPictureModel.getData();d.sSelectedChartPicture=d[c];},_getPropertyDataset:function(){var s=this;var p=[];var a=function(t){var g=["get",t,"s"].join("");var P=s.oRepresentation[g]();P.forEach(function(b){var l=["get",t,"TextLabelKey"].join("");var L=s.oRepresentation[l](b);var o=L&&s.oTextPool.get(L);var c=o&&o.TextElementDescription;if(c===undefined||c.length===0){c=s.oEntityMetadata.getPropertyMetadata(b).label;}var k=["get",t,"Kind"].join("");var K=s.oRepresentation[k](b);var C=s.oRepresentation.getRepresentationType();var r=s._getRepresentationMetadata()[C];var S=r[t.toLowerCase()+"s"].supportedKinds;var n,d;S.forEach(function(e){if(e.kind===K){n=e.min;d=e.max;}});p.push({sSelectedProperty:b,sAggregationRole:t.toLowerCase(),sLabel:c,sKind:K,nMin:n,nMax:d});});};a("Dimension");a("Measure");return{aPropertyRows:p};},_getSortDataset:function(){var s=this;var o=this.oRepresentation.getOrderbySpecifications();var a=this.aSelectProperties.slice();a.unshift({sName:this.getText("none")});if(!o.length){o.push({});}var S=o.map(function(O){var b=O.property;var c=O.ascending!==undefined&&!O.ascending?s.getText("descending"):s.getText("ascending");return{sSortProperty:b,sDirection:c,aAllProperties:a};});return{aSortRows:S};},_getCornerTextsDataset:function(){var r=this._getCornerTextsFromConfigObject(this.oRepresentation);var p=this._getCornerTextsFromConfigObject(this.oParentStep);var d=jQuery.extend({},p,r);return d;},_setDefaultRepresentationType:function(){var d;if(this.getRepresentationTypes()[0].metadata){d=this.getRepresentationTypes()[0].id;}this.oRepresentation.setRepresentationType(d);this.oRepresentation.setAlternateRepresentationType(sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION);var r=this.getText(this.oRepresentation.getRepresentationType());var s=this._getChartPictureDataset().sSelectedChartPicture;var S=this.oConfigurationEditor.getCategoriesForStep(this.oParentStep.getId());if(S.length===1){this.oViewData.updateSelectedNode({id:this.oRepresentation.getId(),icon:s});}else{var R=[];var a=jQuery.extend(true,{},this.mParam);var o={id:this.oRepresentation.getId(),aStepCategories:S,stepContext:a};this.oViewData.updateTree();}},_setDefaultProperties:function(){var f,F;this.aSelectProperties.forEach(function(s){if(!f){if(s.sAggregationRole==="dimension"){f=s.sName;}}if(!F){if(s.sAggregationRole==="measure"){F=s.sName;}}});if(f){this.oRepresentation.addDimension(f);this.oRepresentation.setDimensionKind(f,sap.apf.core.constants.representationMetadata.kind.XAXIS);}if(F){this.oRepresentation.addMeasure(F);this.oRepresentation.setMeasureKind(F,sap.apf.core.constants.representationMetadata.kind.YAXIS);}},_updateAndSetDatasetsByChartType:function(c){this._updatePropertyDatasetByChartType(c);this.mModel.oPropertyModel.updateBindings();this._setPropertiesFromCurrentDataset();this._updateSortDatasetByChartType(c);this.mModel.oSortModel.updateBindings();this._setSortFieldsFromCurrentDataset();this._updatePictureDataset(c);this.mModel.oChartPictureModel.updateBindings();},_updatePropertyDatasetByChartType:function(c){var s=this;var d={aPropertyRows:[]};var r=this._getRepresentationMetadata()[c];var a=["dimensions","measures"];a.forEach(function(A){if(r.hasOwnProperty(A)){var S=r[A].supportedKinds;var b;S.forEach(function(o){var p={sAggregationRole:A.slice(0,-1),sKind:o.kind,nMin:o.min,nMax:o.max,aAllProperties:s.aSelectProperties.filter(function(P){return(P.sAggregationRole===(A.slice(0,-1)));})};if(!parseInt(o.min,10)){p.aAllProperties.unshift({sName:s.getText("none"),sAggregationRole:A.slice(0,-1)});}p.aAllProperties.forEach(function(e){b=e.sName;if(b){var t=A.slice(0,-1);var f=[t.charAt(0).toUpperCase(),t.substring(1)].join("");var l=["get",f,"TextLabelKey"].join("");var L=s.oRepresentation[l](b);var g=L&&s.oTextPool.get(L);var h=g&&g.TextElementDescription;if(h){e.sLabel=h;}else{if(b!==s.getText("none")){var D=s.oEntityMetadata.getPropertyMetadata(b).label;if(D){e.sLabel=D;}}}}});d.aPropertyRows.push(p);});}});var R={aPropertyRows:[]};d.aPropertyRows.forEach(function(D){var e=false;s.mDataset.oPropertyDataset.aPropertyRows.forEach(function(E){var h=E.sAggregationRole===D.sAggregationRole;var H=E.sKind===D.sKind;var b=E.nMin===D.nMin;var f=E.nMax===D.nMax;if(h&&H&&b&&f){e=true;var C=jQuery.extend(E,D);R.aPropertyRows.push(C);}});if(!e){R.aPropertyRows.push(D);}});this.mDataset.oPropertyDataset.aPropertyRows=R.aPropertyRows;},_updateSortDatasetByChartType:function(c){var r=this._getRepresentationMetadata()[c];if(r.sortable!==undefined&&!r.sortable){var a=this.aSelectProperties.slice();a.unshift({sName:this.getText("none")});this.mDataset.oSortDataset.aSortRows=[{aAllProperties:a,sDirection:this.getText("ascending")}];this.byId("idSortLayout").setVisible(false);this.byId("idSorting").setVisible(false);}else{this.byId("idSortLayout").setVisible(true);this.byId("idSorting").setVisible(true);this.mModel.oSortModel.updateBindings();var s=this.byId("idSortLayout");jQuery.sap.delayedCall(10,s,s.rerender);}},_setPropertiesFromCurrentDataset:function(){var s=this;var d=this.oRepresentation.getDimensions();d.forEach(function(D){s.oRepresentation.removeDimension(D);});var m=this.oRepresentation.getMeasures();m.forEach(function(M){s.oRepresentation.removeMeasure(M);});this.mDataset.oPropertyDataset.aPropertyRows.forEach(function(p){var S=p.sSelectedProperty||(p.aAllProperties.length&&p.aAllProperties[0].sName);if(S&&S!==s.getText("none")){var a=p.sAggregationRole;var A=[a.charAt(0).toUpperCase(),a.substring(1)].join("");var D=s.oEntityMetadata.getPropertyMetadata(S).label;var l=p.sLabel;var L;if(l&&l!==D){var t=sap.apf.modeler.ui.utils.TranslationFormatMap.REPRESENTATION_LABEL;L=s.oTextPool.setText(l,t);}var b=["add",A].join("");var c=["set",A,"Kind"].join("");var e=["set",A,"TextLabelKey"].join("");s.oRepresentation[b](S);s.oRepresentation[c](S,p.sKind);s.oRepresentation[e](S,L);}else{p.sLabel="";p.sSelectedProperty=s.getText("none");}});},_setSortFieldsFromCurrentDataset:function(){var s=this;this.oRepresentation.getOrderbySpecifications().forEach(function(o){s.oRepresentation.removeOrderbySpec(o.property);});this.mDataset.oSortDataset.aSortRows.forEach(function(S){var a=S.sSortProperty||(S.aAllProperties.length&&S.aAllProperties[0].sName);if(a&&a!==s.getText("none")){var A=!S.sDirection||(S.sDirection===s.getText("ascending"));s.oRepresentation.addOrderbySpec(a,A);}});},_getRepresentationMetadata:function(){var r={};this.getRepresentationTypes().forEach(function(a){if(a.metadata){r[a.id]=a.metadata;}});return r;}});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.step.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.step.controller');
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.controller("sap.apf.modeler.ui.controller.step",{onInit:function(){this.getView().addStyleClass("sapUiSizeCompact");this.oViewData=this.getView().getViewData();this.getText=this.oViewData.getText;this.params=this.oViewData.oParams;this.oConfigurationHandler=this.oViewData.oConfigurationHandler;this.oConfigurationEditor=this.oViewData.oConfigurationEditor;this.oTextPool=this.oConfigurationHandler.getTextPool();this.getNavigationTargetName=this.oViewData.getNavigationTargetName;var s=this;if(!this.oConfigurationEditor){this.oConfigurationHandler.loadConfiguration(this.params.arguments.configId,function(c){s.oConfigurationEditor=c;});}this.oTextPool=this.oConfigurationHandler.getTextPool();this._addConfigStyleClass();this._setDisplayText();this.setDetailData();var m=[];m.push(this.byId("idstepTitle"));m.push(this.byId("idSourceSelect"));m.push(this.byId("idSelectPropCombo"));m.push(this.byId("idCategorySelect"));m.push(this.byId("idFilterMapEntitySelect"));m.push(this.byId("idFilterMapTargetFilterCombo"));this._setMandatoryFields(m);if(this.step.getFilterMappingService()===undefined||this.step.getFilterMappingService()===""){this._removeMandatoryFromFilterMap();}},_setDisplayText:function(){this.byId("idStepBasicData").setTitle(this.getText("stepBasicData"));this.byId("idStepTitleLabel").setText(this.getText("stepTitle"));this.byId("idStepTitleLabel").setRequired(true);this.byId("idstepTitle").setPlaceholder(this.getText("newStep"));this.byId("idStepLongTitleLabel").setText(this.getText("stepLongTitle"));this.byId("idstepLongTitle").setPlaceholder(this.getText("stepLongTitle"));this.byId("idCategoryTitleLabel").setText(this.getText("categoryAssignments"));this.byId("idCategoryTitleLabel").setRequired(true);this.byId("idGlobalLabel").setText(this.getText("globalNavTargets"));this.byId("idStepSpecificLabel").setText(this.getText("stepSpecificNavTargets"));this.byId("idSourceSelectLabel").setText(this.getText("source"));this.byId("idSourceSelectLabel").setRequired(true);this.byId("idEntitySelectLabel").setText(this.getText("entity"));this.byId("idEntitySelectLabel").setRequired(true);this.byId("idSelectPropComboLabel").setText(this.getText("selectProperties"));this.byId("idSelectPropComboLabel").setRequired(true);this.byId("idReqFilterSelectLabel").setText(this.getText("requiredFilters"));this.byId("idDataRequest").setTitle(this.getText("dataRequest"));this.byId("idNavigationTarget").setTitle(this.getText("navigationTargetAssignment"));this.byId("idCornerTextLabel").setTitle(this.getText("cornerTextLabel"));this.byId("idLeftTop").setPlaceholder(this.getText("leftTop"));this.byId("idRightTop").setPlaceholder(this.getText("rightTop"));this.byId("idLeftBottom").setPlaceholder(this.getText("leftBottom"));this.byId("idRightBottom").setPlaceholder(this.getText("rightBottom"));},_addAutoCompleteFeatureOnInputs:function(){if(this.oConfigurationHandler){var t=new sap.apf.modeler.ui.utils.TextPoolHelper(this.oTextPool);var s=this.byId("idstepTitle");var T=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_TITLE;var d={oTranslationFormat:T,type:"text"};t.setAutoCompleteOn(s,d);var S=this.byId("idstepLongTitle");var o=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_LONG_TITLE;var D={oTranslationFormat:o,type:"text"};t.setAutoCompleteOn(S,D);var a=this.byId("idLeftTop");var b=this.byId("idRightTop");var c=this.byId("idLeftBottom");var e=this.byId("idRightBottom");var f=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_CORNER_TEXT;var g={oTranslationFormat:f,type:"text"};t.setAutoCompleteOn(a,g);t.setAutoCompleteOn(b,g);t.setAutoCompleteOn(c,g);t.setAutoCompleteOn(e,g);var h={oConfigurationEditor:this.oConfigurationEditor,type:"service"};var i=this.byId("idSourceSelect");t.setAutoCompleteOn(i,h);var j=this.byId("idFilterMapSourceSelect");t.setAutoCompleteOn(j,h);}},_addConfigStyleClass:function(){this.byId("idChartIcon").addStyleClass("stepChartIcon");this.byId("idRightTop").addStyleClass("stepRightCornerText");this.byId("idRightBottom").addStyleClass("stepRightCornerText");this.byId("idLeftTop").addStyleClass("stepLeftCornerText");this.byId("idLeftBottom").addStyleClass("stepLeftCornerText");},_prepareStepSpecificList:function(){var s=this;var m=[];var a=this.oConfigurationEditor.getNavigationTargets();var S=this.step.getNavigationTargets();var A=a.filter(function(n){return n.isStepSpecific();});if(A.length!==0){this.byId("idStepSpecificCombo").setBusy(true);}A.forEach(function(o){var n={};n.navTargetKey=o.getId();s.getNavigationTargetName(o.getId()).then(function(v){n.navTargetName=v;m.push(n);if(m.length===A.length){var b=new sap.ui.model.json.JSONModel();var c={stepSpecific:m};b.setData(c);s.byId("idStepSpecificCombo").setModel(b);s.byId("idStepSpecificCombo").setSelectedKeys(S);s.byId("idStepSpecificCombo").setBusy(false);}});});},_prepareGlobalList:function(){var s=this;var m=[];var a=this.oConfigurationEditor.getNavigationTargets();var g=a.filter(function(n){return n.isGlobal();});if(g.length!==0){this.byId("idGlobalCombo").setBusy(true);}g=g.map(function(G){return G.getId();});g.forEach(function(G){var o={};o.navTargetKey=G;s.getNavigationTargetName(G).then(function(v){o.navTargetName=v;m.push(o);if(m.length===g.length){var b=new sap.ui.model.json.JSONModel();var c={global:m};b.setData(c);s.byId("idGlobalCombo").setModel(b);s.byId("idGlobalCombo").setSelectedKeys(g);s.byId("idGlobalCombo").setBusy(false);}});});},setDetailData:function(){var s=this;var C=[];this.oTextPool=this.oConfigurationHandler.getTextPool();var a=this.oConfigurationEditor.getCategories();a.forEach(function(L){var N={};N.CategoryId=L.getId();N.CategoryTitle=s.oTextPool.get(L.labelKey)?s.oTextPool.get(L.labelKey).TextElementDescription:L.labelKey;C.push(N);});var d={Categories:C};var m=new sap.ui.model.json.JSONModel();m.setData(d);this.byId("idCategorySelect").setModel(m);var p={propertyKey:this.getText("none"),propertyName:this.getText("none")};var D={Properties:[p]};var M=new sap.ui.model.json.JSONModel();M.setSizeLimit(500);M.setData(D);this.byId("idReqFilterSelect").setModel(M);var S=[];var o=this.byId("idFilterMapTargetFilterCombo")?this.byId("idFilterMapTargetFilterCombo").getSelectedKeys():[];o.forEach(function(L){var p={};p.propertyKey=L;p.propertyName=L;S.push(p);});var b=new sap.ui.model.json.JSONModel();b.setSizeLimit(500);b.setData(S);this.byId("idFilterMapTargetFilterCombo").setModel(b);if(this.params&&this.params.arguments&&this.params.arguments.stepId){this.step=this.oConfigurationEditor.getStep(this.params.arguments.stepId);}if(this.step){var n=this.getText("none");var c=[n];if(this.step.getTitleId&&this.step.getTitleId()!==undefined&&this.step.getTitleId()!==null&&s.oTextPool.get(this.step.getTitleId())){this.byId("idstepTitle").setValue(s.oTextPool.get(this.step.getTitleId()).TextElementDescription);}else{this.byId("idstepTitle").setValue(this.params.arguments.stepId);}if(this.step.getLongTitleId&&this.step.getLongTitleId()!==undefined&&this.step.getLongTitleId()!==null&&s.oTextPool.get(this.step.getLongTitleId())){this.byId("idstepLongTitle").setValue(s.oTextPool.get(this.step.getLongTitleId()).TextElementDescription);}else{this.byId("idstepLongTitle").setValue("");}if(this.step.getService&&this.step.getService()!==undefined&&this.step.getService()!==null){this.byId("idSourceSelect").setValue(this.step.getService());var e=this.step.getService();var A=[];var f=[];A=this.oConfigurationEditor.getAllEntitySetsOfService(e);A.forEach(function(L){var N={};N.entityKey=L;N.entityName=L;f.push(N);});var g={Entities:f};var h=new sap.ui.model.json.JSONModel();h.setSizeLimit(500);h.setData(g);this.byId("idEntitySelect").setModel(h);}if(this.step.getEntitySet&&this.step.getEntitySet()!==undefined&&this.step.getEntitySet()!==null){this.byId("idEntitySelect").setSelectedKey(this.step.getEntitySet());var E=this.step.getEntitySet();var i=this.step.getService();var P=[],j=[];if(i&&i!==null&&i!==""){P=this.oConfigurationEditor.getAllPropertiesOfEntitySet(i,E);P.forEach(function(L){var p={};p.propertyKey=L;p.propertyName=L;j.push(p);});var k={Properties:j};var l=new sap.ui.model.json.JSONModel();l.setSizeLimit(500);l.setData(k);this.byId("idSelectPropCombo").setModel(l);}}if(this.step.getSelectProperties&&this.step.getSelectProperties()!==undefined&&this.step.getSelectProperties().length!==0){this.byId("idSelectPropCombo").setSelectedKeys(this.step.getSelectProperties());P=c.concat(this.step.getSelectProperties());j=[];P.forEach(function(L){var p={};p.propertyKey=L;p.propertyName=L;j.push(p);});D={Properties:j};M=new sap.ui.model.json.JSONModel();M.setSizeLimit(500);M.setData(D);this.byId("idReqFilterSelect").setModel(M);}if(this.step.getFilterProperties&&this.step.getFilterProperties()!==undefined&&this.step.getFilterProperties().length!==0){this.byId("idReqFilterSelect").setSelectedKey(this.step.getFilterProperties()[0]);this._showFilterMappingField();}else{this.byId("idReqFilterSelect").setSelectedKey(this.getText("none"));this._hideAndResetFilterMapField();}if(this.step.getFilterMappingService&&this.step.getFilterMappingService()!==undefined&&this.step.getFilterMappingService().length!==0){this.byId("idFilterMapSourceSelect").setValue(this.step.getFilterMappingService());var F=this.step.getFilterMappingService();var q=[];var r=[];var R=this.step.getFilterProperties();q=this.oConfigurationEditor.getAllEntitySetsOfServiceWithGivenProperties(F,R);q.forEach(function(L){var N={};N.entityKey=L;N.entityName=L;r.push(N);});var t={Entities:r};var u=new sap.ui.model.json.JSONModel();u.setSizeLimit(500);u.setData(t);this.byId("idFilterMapEntitySelect").setModel(u);this._addMandatoryfromFilterMap();}else{this._removeMandatoryFromFilterMap();this._resetFilterMappingFields();}if(this.step.getFilterMappingEntitySet&&this.step.getFilterMappingEntitySet()!==undefined&&this.step.getFilterMappingEntitySet().length!==0){this.byId("idFilterMapEntitySelect").setSelectedKey(this.step.getFilterMappingEntitySet());var v=this.step.getFilterMappingEntitySet();var w=this.step.getFilterMappingService();var x=[],y=[];if(w&&w!==null&&w!==""){x=this.oConfigurationEditor.getAllPropertiesOfEntitySet(w,v);x.forEach(function(L){var p={};p.propertyKey=L;p.propertyName=L;y.push(p);});var z={Properties:y};var B=new sap.ui.model.json.JSONModel();B.setSizeLimit(500);B.setData(z);this.byId("idFilterMapTargetFilterCombo").setModel(B);}}if(this.step.getFilterMappingTargetProperties&&this.step.getFilterMappingTargetProperties()!==undefined&&this.step.getFilterMappingTargetProperties().length!==0){this.byId("idFilterMapTargetFilterCombo").setSelectedKeys(this.step.getFilterMappingTargetProperties());}if(this.step.getFilterMappingKeepSource&&this.step.getFilterMappingKeepSource()!==undefined){this.byId("idFilterKeepSourceCheckBox").setSelected(this.step.getFilterMappingKeepSource());}var G=s.oConfigurationEditor.getCategoriesForStep(this.step.getId());if(G&&G.length!==0){this.byId("idCategorySelect").setSelectedKeys(G);}if(this.step.getLeftLowerCornerTextKey()&&s.oTextPool.get(this.step.getLeftLowerCornerTextKey())){this.byId("idLeftBottom").setValue(s.oTextPool.get(this.step.getLeftLowerCornerTextKey()).TextElementDescription);}else{this.byId("idLeftBottom").setValue(this.step.getLeftLowerCornerTextKey());}if(this.step.getLeftUpperCornerTextKey()&&s.oTextPool.get(this.step.getLeftUpperCornerTextKey())){this.byId("idLeftTop").setValue(s.oTextPool.get(this.step.getLeftUpperCornerTextKey()).TextElementDescription);}else{this.byId("idLeftTop").setValue(this.step.getLeftUpperCornerTextKey());}if(this.step.getRightUpperCornerTextKey()&&s.oTextPool.get(this.step.getRightUpperCornerTextKey())){this.byId("idRightTop").setValue(s.oTextPool.get(this.step.getRightUpperCornerTextKey()).TextElementDescription);}else{this.byId("idRightTop").setValue(this.step.getRightUpperCornerTextKey());}if(this.step.getRightLowerCornerTextKey()&&s.oTextPool.get(this.step.getRightLowerCornerTextKey())){this.byId("idRightBottom").setValue(s.oTextPool.get(this.step.getRightLowerCornerTextKey()).TextElementDescription);}else{this.byId("idRightBottom").setValue(this.step.getRightLowerCornerTextKey());}}else{var H=this.params.arguments.categoryId;var I=s.oConfigurationEditor.createStep(H);this.step=s.oConfigurationEditor.getStep(I);var J=[H];this.byId("idCategorySelect").setSelectedKeys(J);var K={id:I,icon:"sap-icon://BusinessSuiteInAppSymbols/icon-phase"};this.oViewData.updateSelectedNode(K);}this._addAutoCompleteFeatureOnInputs();this._prepareGlobalList();this._prepareStepSpecificList();},handleChangeDetailValueForTree:function(e){this.oConfigurationEditor.setIsUnsaved();var s=this;var S=this.oConfigurationEditor.getCategoriesForStep(this.step.getId());var t=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_TITLE;var a=this.byId("idstepTitle").getValue().trim();var b=s.oTextPool.setText(a,t);if(a!==""&&a!==null){this.step.setTitleId(b);}var c={};c.name=a;c.id=this.step.getId();if(a!==""&&a!==null){if(S.length>1){this.oViewData.updateTree();}else{this.oViewData.updateSelectedNode(c);}var T=this.getText("step")+": "+a;this.oViewData.updateTitleAndBreadCrumb(T);}},handleChangeForLongTitle:function(){this.oConfigurationEditor.setIsUnsaved();var s=this.byId("idstepLongTitle").getValue().trim();var t=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_LONG_TITLE;var S=this.oTextPool.setText(s,t);this.step.setLongTitleId(S);},handleChangeForStepSpecific:function(){var s=this;this.oConfigurationEditor.setIsUnsaved();var a=this.byId("idStepSpecificCombo").getSelectedKeys();var p=this.step.getNavigationTargets();p.forEach(function(n){if(a.indexOf(n)===-1){s.step.removeNavigationTarget(n);}});a.forEach(function(n){if(p.indexOf(n)===-1){s.step.addNavigationTarget(n);}});},handleChangeForService:function(e){this.oConfigurationEditor.setIsUnsaved();var s,a=[],A=[],p=[],S=[],r;var b=this.byId("idReqFilterSelect").getSelectedKey();if(b!==this.getText("none")){r=[b];}else{r=this.step.getFilterProperties();}var c=e?e.getParameter("id"):"";var i=c.search("FilterMap")!==-1?true:false;var d;if(i){s=this.byId("idFilterMapSourceSelect").getValue().trim();d=this.oConfigurationEditor.registerService(s);if(d){this._addMandatoryfromFilterMap();a=this.oConfigurationEditor.getAllEntitySetsOfServiceWithGivenProperties(s,r);}else{this._removeMandatoryFromFilterMap();}}else{if(b===this.getText("none")||b===""){this._hideAndResetFilterMapField();}else{this._removeMandatoryFromFilterMap();this._resetFilterMappingFields();}s=this.byId("idSourceSelect").getValue().trim();d=this.oConfigurationEditor.registerService(s);a=this.oConfigurationEditor.getAllEntitySetsOfService(s);}a.forEach(function(q){var t={};t.entityKey=q;t.entityName=q;A.push(t);});var E={Entities:A};var o=new sap.ui.model.json.JSONModel();o.setSizeLimit(500);o.setData(E);var f;if(a.length>=1){if(i){if(this.step.getFilterMappingEntitySet()){f=this.step.getFilterMappingEntitySet();p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(s,f);}else{p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(s,a[0]);}this.step.setFilterMappingEntitySet(a[0]);this.byId("idFilterMapEntitySelect").setSelectedKey(a[0]);}else{if(this.step.getEntitySet()){f=this.step.getEntitySet();p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(s,f);}else{p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(s,a[0]);}this.step.setEntitySet(a[0]);this.byId("idEntitySelect").setSelectedKey(a[0]);}p.forEach(function(q){var P={};P.propertyKey=q;P.propertyName=q;S.push(P);});}var g={Properties:S};var h=new sap.ui.model.json.JSONModel();h.setSizeLimit(500);h.setData(g);var j=[],k=[];var l=this.byId("idSelectPropCombo").getSelectedKeys();l.forEach(function(q){var P={};P.propertyKey=q;P.propertyName=q;j.push(P);});var n={propertyKey:this.getText("none"),propertyName:this.getText("none")};var N=[n];N=N.concat(j);var R=new sap.ui.model.json.JSONModel();R.setSizeLimit(500);var D={Properties:N};R.setData(D);var m=this.byId("idFilterMapTargetFilterCombo")?this.byId("idFilterMapTargetFilterCombo").getSelectedKeys():[];m.forEach(function(q){var P={};P.propertyKey=q;P.propertyName=q;k.push(P);});if(i){this.byId("idFilterMapEntitySelect").setModel(o);this.byId("idFilterMapTargetFilterCombo").setModel(h);}else{this.byId("idEntitySelect").setModel(o);this.byId("idSelectPropCombo").setModel(h);this.byId("idReqFilterSelect").setModel(R);}this._checkValidationStateForService("source",c);},_addMandatoryfromFilterMap:function(){this.byId("idFilterMapEntitySelect").isMandatory=true;this.byId("idFilterMapTargetFilterCombo").isMandatory=true;this.byId("idFilterMapEntityLabel").setText(this.getText("entity"));this.byId("idFilterMapEntityLabel").setRequired(true);this.byId("idFilterMapTargetFilterLabel").setText(this.getText("filterMapTarget"));this.byId("idFilterMapTargetFilterLabel").setRequired(true);this.byId("idFilterMapKeepSourceLabel").setText(this.getText("filterMapKeepSource"));this.byId("idFilterMapKeepSourceLabel").setRequired(true);},_removeMandatoryFromFilterMap:function(){this.byId("idFilterMapEntitySelect").isMandatory=false;this.byId("idFilterMapTargetFilterCombo").isMandatory=false;this.byId("idFilterMapEntityLabel").setText(this.getText("entity"));this.byId("idFilterMapEntityLabel").setRequired(false);this.byId("idFilterMapTargetFilterLabel").setText(this.getText("filterMapTarget"));this.byId("idFilterMapTargetFilterLabel").setRequired(false);this.byId("idFilterMapKeepSourceLabel").setText(this.getText("filterMapKeepSource"));this.byId("idFilterMapKeepSourceLabel").setRequired(false);},_resetFilterMappingFields:function(){var s=this;this.step.setFilterMappingService("");this.step.setFilterMappingEntitySet(undefined);this.step.setFilterMappingKeepSource(undefined);var o=this.step.getFilterMappingTargetProperties();o.forEach(function(p){s.step.removeFilterMappingTargetProperty(p);});var e=new sap.ui.model.json.JSONModel();var E={NoData:[]};e.setData(E);this.byId("idFilterMapSourceSelect").setValue("");this.byId("idFilterMapEntitySelect").setModel(e);this.byId("idFilterMapEntitySelect").setSelectedKey();this.byId("idFilterMapTargetFilterCombo").setModel(e);var S=this.byId("idFilterMapTargetFilterCombo").getSelectedKeys();this.byId("idFilterMapTargetFilterCombo").removeSelectedKeys(S);},handleChangeForEntity:function(e){this.oConfigurationEditor.setIsUnsaved();var E,s,p=[],P=[];var a=e.getParameter("id");var i=a.search("FilterMap")!==-1?true:false;if(i){E=this.byId("idFilterMapEntitySelect").getSelectedKey();s=this.byId("idFilterMapSourceSelect").getValue().trim();p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(s,E);}else{E=this.byId("idEntitySelect").getSelectedKey();s=this.byId("idSourceSelect").getValue().trim();p=this.oConfigurationEditor.getAllPropertiesOfEntitySet(s,E);}p.forEach(function(c){var f={};f.propertyKey=c;f.propertyName=c;P.push(f);});var S={Properties:P};var o=new sap.ui.model.json.JSONModel();o.setSizeLimit(500);o.setData(S);var n={propertyKey:this.getText("none"),propertyName:this.getText("none")};var r=[n];r=r.concat(P);var R=new sap.ui.model.json.JSONModel();R.setSizeLimit(500);var d={Properties:r};R.setData(d);var t=new sap.ui.model.json.JSONModel();t.setSizeLimit(500);t.setData(P);if(i){this.byId("idFilterMapTargetFilterCombo").setModel(o);}else{this.byId("idSelectPropCombo").setModel(o);this.byId("idReqFilterSelect").setModel(R);}this._checkValidationStateForService("entitySet",a);var b=this.byId("idReqFilterSelect").getSelectedKey();if(b===this.getText("none")){this._hideAndResetFilterMapField();}},handleChangeForSelectProperty:function(e){var s=this;this.oConfigurationEditor.setIsUnsaved();var S,a=[];var b=e.getParameter("id");S=this.byId("idSelectPropCombo").getSelectedKeys();S.forEach(function(p){s.step.addSelectProperty(p);var P={};P.propertyKey=p;P.propertyName=p;a.push(P);});var n={propertyKey:this.getText("none"),propertyName:this.getText("none")};var r=[n];r=r.concat(a);var R=new sap.ui.model.json.JSONModel();R.setSizeLimit(500);var d={Properties:r};R.setData(d);var t=new sap.ui.model.json.JSONModel();t.setSizeLimit(500);t.setData(a);this.byId("idReqFilterSelect").setModel(R);this._checkValidationStateForService("selectProperties",b);var c=this.byId("idReqFilterSelect").getSelectedKey();if(c===this.getText("none")){this._hideAndResetFilterMapField();}},handleChangeForRequiredFilter:function(e){var s=this;var a=e.getParameter("id");this.oConfigurationEditor.setIsUnsaved();var o=this.step.getFilterProperties();o.forEach(function(p){s.step.removeFilterProperty(p);});var r=this.byId("idReqFilterSelect").getSelectedKey();if(r!==this.getText("none")){this.step.addFilterProperty(r);this._showFilterMappingField();}else{this._hideAndResetFilterMapField();}this._checkValidationStateForService("requiredFilter",a);},_showFilterMappingField:function(){this.byId("idFilterMapping").setVisible(true);this.byId("idFilterMapSourceLabel").setVisible(true);this.byId("idFilterMapSourceSelect").setVisible(true);this.byId("idFilterMapEntityLabel").setVisible(true);this.byId("idFilterMapEntitySelect").setVisible(true);this.byId("idFilterMapTargetFilterLabel").setVisible(true);this.byId("idFilterMapTargetFilterCombo").setVisible(true);this.byId("idFilterMapKeepSourceLabel").setVisible(true);this.byId("idFilterKeepSourceCheckBox").setVisible(true);this.byId("idFilterMapping").setTitle(this.getText("filterMap"));this.byId("idFilterMapSourceLabel").setText(this.getText("source"));this.byId("idFilterMapSourceLabel").setRequired(false);this.byId("idFilterMapEntityLabel").setText(this.getText("entity"));this.byId("idFilterMapEntityLabel").setRequired(false);this.byId("idFilterMapTargetFilterLabel").setText(this.getText("filterMapTarget"));this.byId("idFilterMapTargetFilterLabel").setRequired(false);this.byId("idFilterMapKeepSourceLabel").setText(this.getText("filterMapKeepSource"));this.byId("idFilterMapKeepSourceLabel").setRequired(false);},_hideAndResetFilterMapField:function(){this.byId("idFilterMapping").setVisible(false);this.byId("idFilterMapSourceLabel").setVisible(false);this.byId("idFilterMapSourceSelect").setVisible(false);this.byId("idFilterMapEntityLabel").setVisible(false);this.byId("idFilterMapEntitySelect").setVisible(false);this.byId("idFilterMapTargetFilterLabel").setVisible(false);this.byId("idFilterMapTargetFilterCombo").setVisible(false);this.byId("idFilterMapKeepSourceLabel").setVisible(false);this.byId("idFilterKeepSourceCheckBox").setVisible(false);this._removeMandatoryFromFilterMap();this._resetFilterMappingFields();},handleChangeForTargetFilter:function(e){var s=this;var a=e.getParameter("id");this.oConfigurationEditor.setIsUnsaved();var t=this.byId("idFilterMapTargetFilterCombo").getSelectedKeys();if(t.length>0){var o=this.step.getFilterMappingTargetProperties();o.forEach(function(p){s.step.removeFilterMappingTargetProperty(p);});t.forEach(function(p){s.step.addFilterMappingTargetProperty(p);});}this._checkValidationStateForService("targetProperties",a);},handleFilterMapKeepSource:function(){var i=this.byId("idFilterKeepSourceCheckBox").getSelected();this.oConfigurationEditor.setIsUnsaved();this.step.setFilterMappingKeepSource(i);},_checkValidationStateForService:function(p,s){var a=this;var v={source:undefined,entitySet:undefined,selectProperty:undefined,requiredFilter:undefined,targetFilter:undefined};var S,r,A=[],b=[];var i=s.search("FilterMap")!==-1?true:false;S=i?this.byId("idFilterMapSourceSelect").getValue().trim():this.byId("idSourceSelect").getValue().trim();var c=this.oConfigurationEditor.registerService(S);if(c){v.source=S;var d=this.byId("idReqFilterSelect").getSelectedKey();if(d!==this.getText("none")){r=[d];}else{r=this.step.getFilterProperties();}A=i?this.oConfigurationEditor.getAllEntitySetsOfServiceWithGivenProperties(S,r):this.oConfigurationEditor.getAllEntitySetsOfService(S);var e;if(p==="entitySet"||p==="selectProperties"||p==="targetProperties"||p==="requiredFilter"){e=i?this.byId("idFilterMapEntitySelect").getSelectedKey():this.byId("idEntitySelect").getSelectedKey();}else{e=i?this.step.getFilterMappingEntitySet():this.step.getEntitySet();}if(e){A.forEach(function(u){if(e===u){v.entitySet=e;if(p==="source"){if(i){a.byId("idFilterMapEntitySelect").setSelectedKey(e);}else{a.byId("idEntitySelect").setSelectedKey(e);}}}});var f,C=[];if(p==="selectProperties"){f=this.byId("idSelectPropCombo").getSelectedKeys();}else{f=this.step.getSelectProperties();}var P=this.oConfigurationEditor.getAllPropertiesOfEntitySet(S,e);var g=[];P.forEach(function(u){var w={};w.propertyKey=u;w.propertyName=u;g.push(w);});var D={Properties:g};var m=new sap.ui.model.json.JSONModel();m.setSizeLimit(500);m.setData(D);this.byId("idSelectPropCombo").setModel(m);this.byId("idFilterMapTargetFilterCombo").setModel(m);P.forEach(function(u){f.forEach(function(w){if(w===u){C.push(w);}});});var h=[];var o=[{propertyKey:this.getText("none"),propertyName:this.getText("none")}];if(this.step.getFilterMappingTargetProperties().length===0){this.byId("idFilterMapTargetFilterCombo").setSelectedKeys([]);}if(C.length>0){v.selectProperty=C;if(p!=="selectProperties"){this.byId("idSelectPropCombo").setSelectedKeys(C);}C.forEach(function(u){var w={};w.propertyKey=u;w.propertyName=u;h.push(w);});}else{var j;if(!i){j=this.byId("idSelectPropCombo").getSelectedKeys();this.byId("idSelectPropCombo").removeSelectedKeys(j);this.byId("idReqFilterSelect").setSelectedKey(this.getText("none"));}}o=o.concat(h);var R={Properties:o};var k=new sap.ui.model.json.JSONModel();k.setData(R);var t=[],l=[];if(p==="targetProperties"){t=this.byId("idFilterMapTargetFilterCombo").getSelectedKeys();}else{t=this.step.getFilterMappingTargetProperties();}if(t.length>0){v.targetFilter=t;this.byId("idFilterMapTargetFilterCombo").setSelectedKeys(t);}if(p==="requiredFilter"){l.push(this.byId("idReqFilterSelect").getSelectedKey());}else{l=this.step.getFilterProperties();}var n=[];l.forEach(function(u){if(u!==a.getText("none")){h.forEach(function(w){if(w.propertyKey===u){n.push(u);}});}});if(n.length!==0){v.requiredFilter=n;}else{if(!i){this.byId("idReqFilterSelect").setSelectedKey(this.getText("none"));}}var T={Properties:h};var q=new sap.ui.model.json.JSONModel();q.setSizeLimit(500);q.setData(T);if(!i){this.byId("idReqFilterSelect").setModel(k);}}if(i){this._validateStepServiceForFilterMapping(v);}else{this._validateStepServiceForDataSource(v);}}else{if(i){this._resetFilterMappingFields();}else{this._resetStepRequestProperties();}}},_resetStepRequestProperties:function(){var s=this;this.step.setEntitySet(undefined);var o=this.step.getSelectProperties();o.forEach(function(p){s.step.removeSelectProperty(p);});var O=this.step.getFilterProperties();O.forEach(function(p){s.step.removeFilterProperty(p);});this.byId("idEntitySelect").setSelectedKey();this.byId("idReqFilterSelect").setSelectedKey();},_validateStepServiceForDataSource:function(v){var s=this;if(v.selectProperty&&v.entitySet&&v.source){this.step.setService(v.source);this.step.setEntitySet(v.entitySet);var o=this.step.getSelectProperties();o.forEach(function(p){s.step.removeSelectProperty(p);});v.selectProperty.forEach(function(p){s.step.addSelectProperty(p);});var O=this.step.getFilterProperties();O.forEach(function(p){s.step.removeFilterProperty(p);});if(v.requiredFilter){v.requiredFilter.forEach(function(p){s.step.addFilterProperty(p);});}}},_validateStepServiceForFilterMapping:function(v){var s=this;if(v.entitySet&&v.source&&v.targetFilter){this.step.setFilterMappingService(v.source);this.step.setFilterMappingEntitySet(v.entitySet);var o=this.step.getFilterMappingTargetProperties();o.forEach(function(p){s.step.removeFilterMappingTargetProperty(p);});v.targetFilter.forEach(function(p){s.step.addFilterMappingTargetProperty(p);});}},handleChangeForCategory:function(){this.oConfigurationEditor.setIsUnsaved();var s=this;var a=s.step.getId();var c=this.params.arguments.categoryId;var p=this.oConfigurationEditor.getCategoriesForStep(this.step.getId());var S=this.byId("idCategorySelect").getSelectedKeys();var b=S.indexOf(c);var d=[];var u=[];var i,j;for(i=0;i<p.length;i++){var m=false;for(j=0;j<S.length;j++){if(p[i]===S[j]){m=true;break;}}if(!m){u.push(p[i]);}}if(S.length!==0){S.forEach(function(e){s.oConfigurationEditor.addCategoryStepAssignment(e,a);var o={oldContext:{name:s.params.name,arguments:{configId:s.params.arguments.configId,categoryId:c,stepId:a}},newContext:{arguments:{configId:s.params.arguments.configId,categoryId:e}}};if(e!==c){d.push(o);}});p.forEach(function(C){if(S.indexOf(C)===-1){s.oConfigurationEditor.removeCategoryStepAssignment(C,s.step.getId());}});if(u.length!==0){var n=jQuery.extend(true,{},s.params);u.forEach(function(e){var o={oldContext:{name:s.params.name,arguments:{configId:s.params.arguments.configId,categoryId:c,stepId:a}},newContext:{arguments:{configId:s.params.arguments.configId,categoryId:e}},removeStep:true};if(b===-1&&e===c){var f={arguments:{appId:s.params.arguments.appId,configId:s.params.arguments.configId,categoryId:S[0],stepId:a}};o.categoryChangeContext=f;o.changeCategory=true;}d.push(o);});}}if(d.length!==0){this.oViewData.updateConfigTree(d);}},handleChangeForLeftTop:function(){this.oConfigurationEditor.setIsUnsaved();var s=this.byId("idLeftTop").getValue().trim();var t=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_CORNER_TEXT;var S=this.oTextPool.setText(s,t);this.step.setLeftUpperCornerTextKey(S);},handleChangeForRightTop:function(){this.oConfigurationEditor.setIsUnsaved();var s=this.byId("idRightTop").getValue().trim();var t=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_CORNER_TEXT;var S=this.oTextPool.setText(s,t);this.step.setRightUpperCornerTextKey(S);},handleChangeForLeftBottom:function(){this.oConfigurationEditor.setIsUnsaved();var s=this.byId("idLeftBottom").getValue().trim();var t=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_CORNER_TEXT;var S=this.oTextPool.setText(s,t);this.step.setLeftLowerCornerTextKey(S);},handleChangeForRightBottom:function(){this.oConfigurationEditor.setIsUnsaved();var s=this.byId("idRightBottom").getValue().trim();var t=sap.apf.modeler.ui.utils.TranslationFormatMap.STEP_CORNER_TEXT;var S=this.oTextPool.setText(s,t);this.step.setRightLowerCornerTextKey(S);},_setMandatoryFields:function(f){this.mandatoryFields=this.mandatoryFields||[];for(var i=0;i<f.length;i++){f[i].isMandatory=true;this.mandatoryFields.push(f[i]);}},_getMandatoryFields:function(){return this.mandatoryFields;},_setValidationState:function(){var m=this._getMandatoryFields();for(var i=0;i<m.length;i++){if(m[i].isMandatory===true){if(typeof m[i].getSelectedKeys==="function"){this.isValidState=(m[i].getSelectedKeys().length>=1)?true:false;}else if(typeof m[i].getValue==="function"){this.isValidState=(m[i].getValue().trim()!=="")?true:false;}else{this.isValidState=(m[i].getSelectedKey().length>=1)?true:false;}if(this.isValidState===false){break;}}}},getValidationState:function(){this._setValidationState();var i=(this.isValidState!==undefined)?this.isValidState:true;return i;}});};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.utils.APFTree')){
/*!
* SAP APF Analysis Path Framework
*
* (c) Copyright 2012-2014 SAP SE. All rights reserved
*/
jQuery.sap.declare('sap.apf.modeler.ui.utils.APFTree');sap.ui.getCore().loadLibrary("sap.ui.commons");sap.ui.commons.Tree.extend("sap.apf.modeler.ui.utils.APFTree",{metadata:{events:{},properties:{translationFunction:{},defaultRepresentationType:{}}},renderer:function(c,r){sap.ui.commons.TreeRenderer.render(c,r);},setTranslationFunction:function(t){this.fnTranslationFunction=t;},setDefaultRepresentationType:function(d){this.defaultRepresentationType=d;},getAPFTreeNodeContext:function(n){if(n){var N=n?n.getBindingContext():undefined;var o=N.getObject()?N.getObject().type:undefined;var O;if(N.getObject()&&N.getObject().id){O=N.getObject().id;}else if(N.getObject()&&N.getObject().AnalyticalConfiguration){O=N.getObject().AnalyticalConfiguration;}return{oNode:n,nodeContext:N.sPath,nodeObjectType:o,nodeTitle:n.getText(),nodeAPFId:O};}return null;},getParentNodeContext:function(s){var m=this.getModel();if(s!==null){var c=s.nodeContext.split('/')[2];var a=m.getData().aConfigDetails[c]?m.getData().aConfigDetails[c].AnalyticalConfiguration:undefined;var r,S;var b=s.nodeContext.split('/')[6];var f=s.nodeContext.split('/')[6];var n=s.nodeContext.split('/')[6];var d=s.nodeContext.split('/')[8];var o={};if(s!==null){switch(s.nodeObjectType){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:o.facetFilterId=m.getData().aConfigDetails[c].configData[0].filters[f].id;o.configurationId=a;o.configurationName=m.getData().aConfigDetails[c].name;o.facetFilterName=m.getData().aConfigDetails[c].configData[0].filters[f].name;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:o.categoryId=m.getData().aConfigDetails[c].configData[1].categories[b].id;o.configurationId=a;o.configurationName=m.getData().aConfigDetails[c].name;o.categoryName=m.getData().aConfigDetails[c].configData[1].categories[b].name;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:S=s.oNode;o.configurationId=a;o.categoryId=m.getData().aConfigDetails[c].configData[1].categories[b].id;o.stepId=m.getData().aConfigDetails[c].configData[1].categories[b].steps[d].id;o.configurationName=m.getData().aConfigDetails[c].name;o.categoryName=m.getData().aConfigDetails[c].configData[1].categories[b].name;o.stepName=m.getData().aConfigDetails[c].configData[1].categories[b].steps[d].name;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:r=s.oNode;o.configurationId=a;o.categoryId=m.getData().aConfigDetails[c].configData[1].categories[b].id;o.stepId=m.getData().aConfigDetails[c].configData[1].categories[b].steps[d].id;o.representationId=r.getBindingContext().getObject().id;o.configurationName=m.getData().aConfigDetails[c].name;o.categoryName=m.getData().aConfigDetails[c].configData[1].categories[b].name;o.stepName=m.getData().aConfigDetails[c].configData[1].categories[b].steps[d].name;o.representationName=r.getBindingContext().getObject().name;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION:o.configurationId=s.oNode.getBindingContext().getObject().AnalyticalConfiguration;o.configurationName=s.oNode.getBindingContext().getObject().name;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:o.navTargetId=m.getData().aConfigDetails[c].configData[2].navTargets[n].id;o.configurationId=a;o.configurationName=m.getData().aConfigDetails[c].name;o.navTargetName=m.getData().aConfigDetails[c].configData[2].navTargets[n].name;break;default:break;}}return o;}},isConfigurationSwitched:function(p,c){var i=false;var P=this.getParentNodeContext(this.getAPFTreeNodeContext(p));var C=this.getParentNodeContext(this.getAPFTreeNodeContext(c));if(P&&!jQuery.isEmptyObject(P)&&(P.configurationId!==C.configurationId)){i=true;}return i;},removeSelectionOnTree:function(s){var S=this.getSelection();if(s){s.getBindingContext().getObject().isSelected=false;s.setIsSelected(false);}else if(S){S.getBindingContext().getObject().isSelected=false;S.setIsSelected(false);}this.getModel().updateBindings();},setSelectionOnTree:function(b){this.selectedNode=this.getNodeByContext(b);var s=this.getSelection();if(s!==this.selectedNode){if(s&&s.getBindingContext().getObject()){s.getBindingContext().getObject().isSelected=false;s.setIsSelected(false);}this.selectedNode.setIsSelected(true);}},_scrollTreeToNewNode:function(n){if(n&&n.$().length!==0){jQuery(n.$())[0].scrollIntoView();}},setSelectedNode:function(n){this.setSelection(this.getNodeByContext(n.getBindingContext().sPath));this._scrollTreeToNewNode(n);},_getObjectNodesArray:function(o,c,a,s){var O;switch(o){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION:O=this.getNodes();break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:O=this.getNodes()[c].getNodes()[0].getNodes();break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:O=this.getNodes()[c].getNodes()[1].getNodes();break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:O=this.getNodes()[c].getNodes()[1].getNodes()[a].getNodes();break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:O=this.getNodes()[c].getNodes()[1].getNodes()[a].getNodes()[s].getNodes();break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:O=this.getNodes()[c].getNodes()[2].getNodes();break;default:break;}return O;},addNodeInTree:function(o,p){var m=this.getModel();var M;var s=this.getAPFTreeNodeContext(this.getSelection());var c=s?s.nodeContext.split('/')[2]:undefined;var a=s?s.nodeContext.split('/')[6]:undefined;var b=s?s.nodeContext.split('/')[8]:undefined;M=["_add",o].join("");this[M](c,a,b,p);var O=this._getObjectNodesArray(o,c,a,b);var n=O[O.length-1];if(o!==sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION){if(n.getParent()){n.getParent().setExpanded(true);}}this.setSelectedNode(n);},_addconfiguration:function(){var s=this;this.configNewIndex=this.configNewIndex||1;var m=this.getModel();var i;i="I"+this.configNewIndex;this.configNewIndex++;var a=[],f=[],c=[],n=[];a.push({filters:f,name:s.fnTranslationFunction("facetFilters"),isSelected:false,expanded:false,selectable:false});a.push({categories:c,name:s.fnTranslationFunction("categories"),isSelected:false,expanded:false,selectable:false});a.push({navTargets:n,name:s.fnTranslationFunction("navigationTargets"),isSelected:false,expanded:false,selectable:false});var C={};C.configData=a;var b=this.fnTranslationFunction("newConfiguration");var d={name:"< "+b+" >",type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION,AnalyticalConfiguration:"newConfig"+i,configData:a,bIsLoaded:true,isSelected:false,expanded:false,selectable:true};m.getData().aConfigDetails.push(d);m.updateBindings();},_addfacetFilter:function(c){var m=this.getModel();var n=this.fnTranslationFunction("newFacetFilter");var i=m.getData().aConfigDetails[c].configData[0].filters.length;var a={name:"< "+n+" >",type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER,id:"newFilter"+i,isSelected:false,selectable:true};m.getData().aConfigDetails[c].expanded=true;m.getData().aConfigDetails[c].configData[0].expanded=true;m.getData().aConfigDetails[c].configData[0].filters.push(a);m.updateBindings();},_addnavigationTarget:function(c){var m=this.getModel();var n=this.fnTranslationFunction("newNavigationTarget");var i=m.getData().aConfigDetails[c].configData[2].navTargets.length;var a={name:"< "+n+" >",type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET,id:"newNavTarget"+i,isSelected:false,selectable:true};m.getData().aConfigDetails[c].expanded=true;m.getData().aConfigDetails[c].configData[2].expanded=true;m.getData().aConfigDetails[c].configData[2].navTargets.push(a);m.updateBindings();},_addcategory:function(c){var m=this.getModel();var n=this.fnTranslationFunction("newCategory");var i=m.getData().aConfigDetails[c].configData[1].categories.length;var a={name:"< "+n+" >",type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY,id:"newCategory"+i,isSelected:false,expanded:false,selectable:true};m.getData().aConfigDetails[c].expanded=true;m.getData().aConfigDetails[c].configData[1].expanded=true;m.getData().aConfigDetails[c].configData[1].categories.push(a);m.updateBindings();},_addstep:function(c,a,s,p){var m=this.getModel();var n;if(m.getData().aConfigDetails[c].configData[1].categories[a].steps===undefined){m.getData().aConfigDetails[c].configData[1].categories[a].steps=[];}if(!p){var b=m.getData().aConfigDetails[c].configData[1].categories[a].steps.length;var d=this.fnTranslationFunction("newStep");n={name:"< "+d+" >",type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP,id:"newStep"+b,isSelected:false,expanded:false,selectable:true};m.getData().aConfigDetails[c].expanded=true;m.getData().aConfigDetails[c].configData[1].expanded=true;m.getData().aConfigDetails[c].configData[1].categories[a].expanded=true;m.getData().aConfigDetails[c].configData[1].categories[a].steps.push(n);}else{var e,i,j;for(i=0;i<p.noOfSteps;i++){e={name:p.aExistingStepsToBeAdded[i].step.name,type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP,id:p.aExistingStepsToBeAdded[i].step.id,isSelected:false,expanded:false,selectable:true};m.getData().aConfigDetails[c].configData[1].categories[a].steps.push(e);if(p.aExistingStepsToBeAdded[i].noOfReps!==0){s=m.getData().aConfigDetails[c].configData[1].categories[a].steps.length-1;for(j=0;j<p.aExistingStepsToBeAdded[i].noOfReps;j++){var r={id:p.aExistingStepsToBeAdded[i].representations[j].id,name:p.aExistingStepsToBeAdded[i].representations[j].name,icon:p.aExistingStepsToBeAdded[i].representations[j].icon};this._addrepresentation(c,a,s,r);}}}}m.updateBindings();},_addrepresentation:function(c,a,s,p){var m=this.getModel();var b=this;var d;if(p===undefined){var e=this.getAPFTreeNodeContext(this.getSelection());if(e.nodeObjectType===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION){d=this.getParentNodeContext(e,m).stepId;}else if(e.nodeObjectType===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP){d=e.nodeAPFId;}var S=[];m.getData().aConfigDetails[c].configData[1].categories.forEach(function(f,g){if(m.getData().aConfigDetails[c].configData[1].categories[g].steps){m.getData().aConfigDetails[c].configData[1].categories[g].steps.forEach(function(h,i){var j={};if(h.id===d){j.stepIndex=i;j.categoryIndex=g;S.push(j);}});}});S.forEach(function(f){if(m.getData().aConfigDetails[c].configData[1].categories[f.categoryIndex].steps[f.stepIndex].representations===undefined){m.getData().aConfigDetails[c].configData[1].categories[f.categoryIndex].steps[f.stepIndex].representations=[];}var i=m.getData().aConfigDetails[c].configData[1].categories[f.categoryIndex].steps[f.stepIndex].representations.length;var n={name:b.fnTranslationFunction(b.defaultRepresentationType),type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION,id:"newRepresentation"+i,isSelected:false,selectable:true};m.getData().aConfigDetails[c].expanded=true;m.getData().aConfigDetails[c].configData[1].expanded=true;m.getData().aConfigDetails[c].configData[1].categories[f.categoryIndex].expanded=true;m.getData().aConfigDetails[c].configData[1].categories[f.categoryIndex].steps[f.stepIndex].expanded=true;m.getData().aConfigDetails[c].configData[1].categories[f.categoryIndex].steps[f.stepIndex].representations.push(n);});}else{if(m.getData().aConfigDetails[c].configData[1].categories[a].steps[s].representations===undefined){m.getData().aConfigDetails[c].configData[1].categories[a].steps[s].representations=[];}var r={name:p.name,type:sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION,id:p.id,isSelected:false,selectable:true,icon:p.icon};m.getData().aConfigDetails[c].configData[1].categories[a].steps[s].representations.push(r);}m.updateBindings();}});};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.BaseUI5ChartRepresentation')){jQuery.sap.declare("sap.apf.ui.representations.BaseUI5ChartRepresentation");sap.apf.ui.representations.BaseUI5ChartRepresentation=function(a,p){this.oMessageObject="";this.legendBoolean=true;this.aDataResponse=undefined;this.dataset={};this.oModel=new sap.ui.model.json.JSONModel();this.bDataHasBeenSelected=false;this.parameter=p;this.orderby=p.orderby;this.dimension=p.dimensions;this.measure=p.measures;this.alternateRepresentation=p.alternateRepresentationType;this.requiredFilters=p.requiredFilters;this.UI5ChartHelper=new sap.apf.ui.representations.utils.UI5ChartHelper(a,this.parameter);this.chartInstance={};this.chartParam="";this.thumbnailChartParam="";this.disableSelectEvent=false;this.oApi=a;this.showXaxisLabel=true;this.axisType=sap.apf.ui.utils.CONSTANTS.axisTypes.AXIS;};sap.apf.ui.representations.BaseUI5ChartRepresentation.prototype={getParameter:function(){return this.parameter;},setData:function(d,m){this.bIsGroupTypeChart=this.getIsGroupTypeChart();this.oDataSetHelper=this.getDataSetHelper();this.formatter=new sap.apf.ui.utils.formatter({getEventCallback:this.oApi.getEventCallback.bind(this.oApi),getTextNotHtmlEncoded:this.oApi.getTextNotHtmlEncoded},m,d);this.UI5ChartHelper.init(d,m,this.bIsGroupTypeChart,this.oDataSetHelper,this.formatter);this.aDataResponse=d||[];this.metadata=m;if(!this.metadata){this.oMessageObject=this.oApi.createMessageObject({code:"6004",aParameters:[this.oApi.getTextNotHtmlEncoded("step")]});this.oApi.putMessage(this.oMessageObject);}},attachSelectionAndFormatValue:function(s){var a=this;if(!s){this.oMessageObject=this.oApi.createMessageObject({code:"6002",aParameters:["title",this.oApi.getTextNotHtmlEncoded("step")]});this.oApi.putMessage(this.oMessageObject);}if(this.dimension.length===0){this.oMessageObject=this.oApi.createMessageObject({code:"6002",aParameters:["dimensions",s]});this.oApi.putMessage(this.oMessageObject);}if(this.measure.length===0){this.oMessageObject=this.oApi.createMessageObject({code:"6002",aParameters:["measures",s]});this.oApi.putMessage(this.oMessageObject);}if(!this.aDataResponse||this.aDataResponse.length===0){this.oMessageObject=this.oApi.createMessageObject({code:"6000",aParameters:[s]});this.oApi.putMessage(this.oMessageObject);}this.fnHandleSelection=this.handleSelection.bind(a);this.chart.attachSelectData(this.fnHandleSelection);this.fnHandleDeselection=this.handleDeselection.bind(a);this.chart.attachDeselectData(this.fnHandleDeselection);},getFormatStringForMeasure:function(m){var f=this.formatter.getFormatString(m);return f;},getIsAllMeasureSameUnit:function(){var a=true;var s=this;var f=this.metadata.getPropertyMetadata(this.measure[0].fieldName).unit?this.metadata.getPropertyMetadata(this.metadata.getPropertyMetadata(this.measure[0].fieldName).unit).semantics:undefined;var m;this.measure.forEach(function(b,i){m=s.metadata.getPropertyMetadata(s.measure[i].fieldName).unit?s.metadata.getPropertyMetadata(s.metadata.getPropertyMetadata(b.fieldName).unit).semantics:undefined;if(a&&f!==undefined&&m&&(f!==m)){a=false;}});return a;},createThumbnailLayout:function(){this.thumbnailLayout=new sap.ui.layout.HorizontalLayout().addStyleClass('thumbnailLayout');if(this.aDataResponse!==undefined&&this.aDataResponse.length!==0){this.thumbnailChart.setModel(this.oModel);this.thumbnailLayout.removeAllContent();this.thumbnailLayout.addContent(this.thumbnailChart);}else{var n=new sap.m.Text({text:this.oApi.getTextNotHtmlEncoded("noDataText")}).addStyleClass('noDataText');this.thumbnailLayout.removeAllContent();this.thumbnailLayout.addContent(n);}},getAlternateRepresentation:function(){return this.alternateRepresentation;},getMetaData:function(){return this.metadata;},getData:function(){return this.aDataResponse;},getRequestOptions:function(){if(this.orderby&&this.orderby.length){var o=this.orderby.map(function(O){return{property:O.property,descending:!O.ascending};});return{orderby:o};}else{return{};}},createDataset:function(){this.dataset=this.UI5ChartHelper.getDataset();this.oModel=this.UI5ChartHelper.getModel();},drawSelectionOnMainChart:function(){var s=this.UI5ChartHelper.getSelectionFromFilter(this.filter);if(s.length>0){this.disableSelectEvent=true;this.setSelectionOnMainChart(s);}},drawSelectionOnThumbnailChart:function(){var s=this.UI5ChartHelper.getSelectionFromFilter(this.filter);if(s.length>0){this.clearSelectionFromThumbnailChart();this.setSelectionOnThumbnailChart(s);}},handleSelection:function(e){if(!this.disableSelectEvent){var s=this.getSelectionFromChart();var c=this.UI5ChartHelper.getHighlightPointsFromSelectionEvent(s);this.setSelectionOnThumbnailChart(c);this.setSelectionOnMainChart(c);this.bDataHasBeenSelected=true;this.oApi.selectionChanged();}else{this.disableSelectEvent=false;}},handleDeselection:function(e){if(!this.disableSelectEvent){this.disableSelectEvent=true;var s=this.getSelectionFromChart();var n=this.UI5ChartHelper.getHighlightPointsFromDeselectionEvent(s);this.removeAllSelection();this.setSelectionOnThumbnailChart(n);this.setSelectionOnMainChart(n);if(!n.length){this.disableSelectEvent=false;}this.bDataHasBeenSelected=true;this.oApi.selectionChanged();}else{this.disableSelectEvent=false;}},getSelections:function(){return this.UI5ChartHelper.getFilters();},getSelectionCount:function(){return this.UI5ChartHelper.getFilterCount();},hasSelection:function(){return this.bDataHasBeenSelected;},removeAllSelection:function(){this.clearSelectionFromThumbnailChart();this.clearSelectionFromMainChart();},getFilterMethodType:function(){return sap.apf.core.constants.filterMethodTypes.filter;},getFilter:function(){this.filter=this.UI5ChartHelper.getFilterFromSelection();return this.filter;},setFilter:function(f){this.filter=f;this.bDataHasBeenSelected=false;},adoptSelection:function(s){if(s&&s.getFilter){this.UI5ChartHelper.filterValues=s.getFilter().getInternalFilter().getFilterTerms().map(function(t){return[t.getValue()];});}},serialize:function(){return{oFilter:this.UI5ChartHelper.filterValues,bIsAlternateView:this.bIsAlternateView};},deserialize:function(s){this.UI5ChartHelper.filterValues=s.oFilter;this.bIsAlternateView=s.bIsAlternateView;},getPrintContent:function(s){var c,v=this.chartType,a={};var o=this.getMainContent(s);if(o.setVizProperties){a=o.getVizProperties();c=o.clone();c.setVizType(v);c.setVizProperties(a);}else{a=jQuery.extend(true,{},this.chartParam);delete a.dataset;c=new sap.viz.ui5[v](a);}c.setWidth("1000px");c.setHeight("600px");this.createDataset();c.setDataset(this.dataset);c.setModel(this.oModel);return{oChartForPrinting:c,aSelectionOnChart:this.aStoredSelection};},destroy:function(){this.dataset=null;this.oModel.destroy();this.oDataSetHelper=null;if(this.formatter){this.formatter.destroy();this.formatter=null;}this.UI5ChartHelper.destroy();this.UI5ChartHelper=null;if(this.chart){this.chart.detachSelectData(this.fnHandleSelection);this.fnHandleSelection=null;this.chart.detachDeselectData(this.fnHandleDeselection);this.fnHandleDeselection=null;this.chart.destroy();this.chart=null;}if(this.thumbnailChart){this.thumbnailChart.destroy();this.thumbnailChart=null;}if(this.thumbnailLayout){this.thumbnailLayout.removeAllContent();}}};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.BaseVizChartRepresentation')){jQuery.sap.declare("sap.apf.ui.representations.BaseVizChartRepresentation");(function(){'use strict';sap.apf.ui.representations.BaseVizChartRepresentation=function(a,p){sap.apf.ui.representations.BaseUI5ChartRepresentation.apply(this,[a,p]);};sap.apf.ui.representations.BaseVizChartRepresentation.prototype=Object.create(sap.apf.ui.representations.BaseUI5ChartRepresentation.prototype);sap.apf.ui.representations.BaseVizChartRepresentation.prototype.constructor=sap.apf.ui.representations.BaseVizChartRepresentation;sap.apf.ui.representations.BaseVizChartRepresentation.prototype.destroy=function(){if(this.chart){if(this.chart.getTitle&&this.chart.getTitle()){this.chart.destroyTitle();}if(this.chart.getXAxis&&this.chart.getXAxis()){this.chart.destroyXAxis();}if(this.chart.getYAxis&&this.chart.getYAxis()){this.chart.destroyYAxis();}if(this.chart.getLegend&&this.chart.getLegend()){this.chart.destroyLegend();}if(this.chart.getPlotArea&&this.chart.getPlotArea()){this.chart.destroyPlotArea();}this.chart.detachInitialized(this.fnDrawSelectionOnMainChart);this.fnDrawSelectionOnMainChart=null;}if(this.thumbnailChart){if(this.thumbnailChart.getTitle&&this.thumbnailChart.getTitle()){this.thumbnailChart.destroyTitle();}if(this.thumbnailChart.getXAxis&&this.thumbnailChart.getXAxis()){this.thumbnailChart.destroyXAxis();}if(this.thumbnailChart.getYAxis&&this.thumbnailChart.getYAxis()){this.thumbnailChart.destroyYAxis();}if(this.thumbnailChart.getLegend&&this.thumbnailChart.getLegend()){this.thumbnailChart.destroyLegend();}if(this.thumbnailChart.getToolTip&&this.thumbnailChart.getToolTip()){this.thumbnailChart.destroyToolTip();}if(this.thumbnailChart.getInteraction&&this.thumbnailChart.getInteraction()){this.thumbnailChart.destroyInteraction();}if(this.thumbnailChart.getBackground&&this.thumbnailChart.getBackground()){this.thumbnailChart.destroyBackground();}if(this.thumbnailChart.getGeneral&&this.thumbnailChart.getGeneral()){this.thumbnailChart.destroyGeneral();}if(this.thumbnailChart.getPlotArea&&this.thumbnailChart.getPlotArea()){this.thumbnailChart.destroyPlotArea();}this.thumbnailChart.detachInitialized(this.fnDrawSelectionOnThumbnailChart);this.fnDrawSelectionOnThumbnailChart=null;}sap.apf.ui.representations.BaseUI5ChartRepresentation.prototype.destroy.call(this);};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getMeasures=function(){return this.measure;};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getMainContent=function(s,w,h){var a=this;var b=this;var c=h||600;c=c+"px";var d=w||1000;d=d+"px";this.title=s;if(!this.chartType){this.chartType=this.getChartTypeFromRepresentationType(this.type);}this.createDataset();if(!this.chart){this.chartParam={width:d,height:c,title:{visible:true,text:this.title},xAxis:{title:{visible:true},label:{visible:this.showXaxisLabel}},yAxis:{title:{visible:true}},legend:{visible:this.legendBoolean,title:{visible:this.legendBoolean}},plotArea:{animation:{dataLoading:false,dataUpdating:false}},dataset:this.dataset};this.chart=new sap.viz.ui5[this.chartType](this.chartParam);this.validateSelectionModes();if(this.metadata){var t=[];this.measure.forEach(function(m){var f=b.getFormatStringForMeasure(m);t.push([f]);a.setFormatStringOnChart(f);});this.setFormatString("tooltip",t);if(this.handleCustomFormattingOnChart){this.handleCustomFormattingOnChart();}}this.fnDrawSelectionOnMainChart=this.drawSelectionOnMainChart.bind(a);this.chart.attachInitialized(this.fnDrawSelectionOnMainChart);b.attachSelectionAndFormatValue.call(this,s);}else{if(w){this.chart.setWidth(d);}if(h){this.chart.setHeight(c);}this.chart.destroyDataset();this.chart.setDataset(this.dataset);}this.chart.setModel(this.oModel);return this.chart;};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.validateSelectionModes=function(){var s=new sap.viz.ui5.types.controller.Interaction_selectability();var i=new sap.viz.ui5.types.controller.Interaction();i.setSelectability(s);this.chart.setInteraction(i);if(this.parameter.requiredFilters===undefined||this.parameter.requiredFilters.length===0){s.setMode("none");}else{s.setMode("multiple");if(this.parameter.dimensions.length>1){if(this.parameter.requiredFilters[0]===this.parameter.dimensions[1].fieldName){s.setAxisLabelSelection(false);}else if(this.parameter.requiredFilters[0]===this.parameter.dimensions[0].fieldName){s.setLegendSelection(false);}}}};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getThumbnailContent=function(){var s=this;var a=this;var h=sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.HEIGHT;var w=sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.WIDTH;if(!this.chartType){this.chartType=this.getChartTypeFromRepresentationType(this.type);}this.createDataset();if(!this.thumbnailChart){this.thumbnailChartParam={width:w,height:h,title:{visible:false},xAxis:{visible:false,title:{visible:false}},yAxis:{visible:false,title:{visible:false}},legend:{visible:false,title:{visible:false}},sizeLegend:{visible:false,title:{visible:false}},toolTip:{visible:false},interaction:{selectability:{axisLabelSelection:false,legendSelection:false,plotLassoSelection:false,plotStdSelection:false},enableHover:false},background:{visible:false},general:{layout:{padding:0}},plotArea:{animation:{dataLoading:false,dataUpdating:false},markerSize:4,marker:{visible:true,size:4}},dataset:this.dataset};this.thumbnailChart=new sap.viz.ui5[this.chartType](this.thumbnailChartParam);this.fnDrawSelectionOnThumbnailChart=this.drawSelectionOnThumbnailChart.bind(s);this.thumbnailChart.attachInitialized(this.fnDrawSelectionOnThumbnailChart);}else{this.thumbnailChart.destroyDataset();this.thumbnailChart.setDataset(this.dataset);}a.createThumbnailLayout.call(this);return this.thumbnailLayout;};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.setSelectionOnMainChart=function(s){this.chart.selection(s);};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.setSelectionOnThumbnailChart=function(s){this.aStoredSelection=s;this.clearSelectionFromThumbnailChart();this.thumbnailChart.selection(s);};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.clearSelectionFromMainChart=function(){this.chart.selection([],{clearSelection:true});};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.clearSelectionFromThumbnailChart=function(){this.thumbnailChart.selection([],{clearSelection:true});};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getSelectionFromChart=function(){var s=this.chart.selection();return s;};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.setFormatStringOnChart=function(f){var s=this;var a=s.getIsAllMeasureSameUnit();if(this.chart.getYAxis!==undefined&&f!==""&&a){this.setFormatString("yAxis",f);}};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.setFormatString=function(c,f){var C;switch(c){case"xAxis":C=this.chart.getYAxis().getLabel();break;case"yAxis":C=this.chart.getXAxis().getLabel();break;case"tooltip":C=this.chart.getToolTip();break;case"sizeLegend":C=this.chart.getSizeLegend().getLabel();break;default:break;}C.setFormatString(f);};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getFormatString=function(m){var f=this.getFormatStringForMeasures(m);return f.labelFormatString;};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getChartTypeFromRepresentationType=function(r){var R=sap.apf.ui.utils.CONSTANTS.representationTypes;var v=sap.apf.ui.utils.CONSTANTS.vizChartTypes;var V;switch(r){case R.COLUMN_CHART:V=v.COLUMN;break;case R.LINE_CHART:V=v.LINE;break;case R.PIE_CHART:V=v.PIE;break;case R.STACKED_COLUMN_CHART:V=v.STACKED_COLUMN;break;case R.PERCENTAGE_STACKED_COLUMN_CHART:V=v.PERCENTAGE_STACKED_COLUMN;break;case R.SCATTERPLOT_CHART:V=v.SCATTERPLOT;break;case R.BUBBLE_CHART:V=v.BUBBLE;break;default:this.oMessageObject=this.oApi.createMessageObject({code:"6000",aParameters:[r]});this.oApi.putMessage(this.oMessageObject);break;}return V;};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getIsGroupTypeChart=function(){var i;if(this.axisType===sap.apf.ui.utils.CONSTANTS.axisTypes.AXIS){i=false;}else{i=true;}return i;};sap.apf.ui.representations.BaseVizChartRepresentation.prototype.getDataSetHelper=function(){var i=this.getIsGroupTypeChart();var d=new sap.apf.ui.representations.utils.VizDatasetHelper(i);return d;};}());};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.BaseVizFrameChartRepresentation')){jQuery.sap.declare("sap.apf.ui.representations.BaseVizFrameChartRepresentation");(function(){'use strict';sap.apf.ui.representations.BaseVizFrameChartRepresentation=function(a,p){sap.apf.ui.representations.BaseUI5ChartRepresentation.apply(this,[a,p]);};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype=Object.create(sap.apf.ui.representations.BaseUI5ChartRepresentation.prototype);sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.constructor=sap.apf.ui.representations.BaseVizFrameChartRepresentation;sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.destroy=function(){if(this.chart){this.chart.destroyDataset();this.chart.destroyFeeds();this.chart.detachRenderComplete(this.fnDrawSelectionOnMainChart);this.fnDrawSelectionOnMainChart=null;}if(this.thumbnailChart){this.thumbnailChart.destroyDataset();this.thumbnailChart.destroyFeeds();this.thumbnailChart.detachRenderComplete(this.fnDrawSelectionOnThumbnailChart);this.fnDrawSelectionOnThumbnailChart=null;}sap.apf.ui.representations.BaseUI5ChartRepresentation.prototype.destroy.call(this);};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.getMeasures=function(){return this.measure;};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.getMainContent=function(s,w,h){var a=this;var b=this;var c=h||600;c=c+"px";var d=w||1000;d=d+"px";this.title=s;if(!this.chartType){this.chartType=this.getChartTypeFromRepresentationType(this.type);}this.createDataset();if(!this.chart){this.chart=new sap.viz.ui5.controls.VizFrame({vizType:this.chartType,dataset:this.dataset,width:d,height:c,uiConfig:{applicationSet:"fiori"}});this.chart.setVizProperties({title:{visible:true,text:this.title},categoryAxis:{title:{visible:true},label:{visible:true}},valueAxis:{title:{visible:true},label:{visible:true}},legend:{visible:this.legendBoolean,title:{visible:this.legendBoolean},isScrollable:true},sizeLegend:{visible:true},valueAxis2:{visible:true,title:{visible:true},label:{visible:true}},plotArea:{animation:{dataLoading:false,dataUpdating:false},isFixedDataPointSize:false},tooltip:{visible:true,label:{visible:true}},interaction:{behaviorType:null}});this.validateSelectionModes();this.fnDrawSelectionOnMainChart=this.drawSelectionOnMainChart.bind(a);this.chart.attachRenderComplete(this.fnDrawSelectionOnMainChart);if(this.metadata){var m={};var f;this.measure.forEach(function(e){var F=b.getFormatStringForMeasure(e);f=F;m.measure=e;m.formatString=F;a.setFormatStringOnChart(m);});this.setFormatString("tooltip",f);if(this.handleCustomFormattingOnChart){this.handleCustomFormattingOnChart();}}b.attachSelectionAndFormatValue.call(this,s);}else{if(w){this.chart.setWidth(d);}if(h){this.chart.setHeight(c);}this.chart.destroyDataset();this.chart.removeAllFeeds();this.chart.destroyFeeds();this.chart.vizUpdate({'data':this.dataset});}this._createAndAddFeedItemBasedOnId(this.chart);this.chart.setModel(this.oModel);return this.chart;};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.setFormatStringOnChart=function(m){var f=m.formatString;var c=m.measure.axisfeedItemId;this.setFormatString(c,f);};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.setFormatString=function(c,f){var s=this;var i=s.getIsAllMeasureSameUnit();switch(c){case sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS:if(i){this.chart.setVizProperties({valueAxis:{label:{formatString:f}}});}break;case sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS2:if(i){this.chart.setVizProperties({valueAxis2:{label:{formatString:f}}});}break;case sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS:this.chart.setVizProperties({categoryAxis:{label:{formatString:f}}});break;case sap.apf.core.constants.vizFrame.feedItemTypes.BUBBLEWIDTH:this.chart.setVizProperties({sizeLegend:{formatString:f}});break;case"tooltip":this.chart.setVizProperties({tooltip:{formatString:f}});break;default:break;}};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype._createAndAddFeedItemBasedOnId=function(c){var s=this;var f=s.UI5ChartHelper.datasetObj;var a=this._createFeedItemGroup(f.measures);this._addFeedItemsToChart(c,a,"Measure");var b=this._createFeedItemGroup(f.dimensions);this._addFeedItemsToChart(c,b,"Dimension");};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype._createFeedItemGroup=function(d){var s={};d.forEach(function(a){var f=s[a.axisfeedItemId];if(f){var F=f.some(function(D){return D.name===a.name;});if(!F){f.push(a);}}else{s[a.axisfeedItemId]=[a];}});return s;};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype._addFeedItemsToChart=function(c,g,f){for(var k in g){var F={};var a=[];var i=0;for(i in g[k]){a.push(g[k][i].name);F.feedItemId=g[k][0].axisfeedItemId;}F.value=a;var b=new sap.viz.ui5.controls.common.feeds.FeedItem({uid:F.feedItemId,type:f,values:F.value});c.addFeed(b);}};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.validateSelectionModes=function(){if(this.parameter.requiredFilters===undefined||this.parameter.requiredFilters.length===0){this.chart.setVizProperties({interaction:{selectability:{mode:'none'},behaviorType:null}});}else{this.chart.setVizProperties({interaction:{selectability:{mode:'multiple'},behaviorType:null}});if(this.parameter.dimensions.length>1){if(this.parameter.requiredFilters[0]===this.parameter.dimensions[1].fieldName){this.chart.setVizProperties({interaction:{selectability:{axisLabelSelection:false}}});}else if(this.parameter.requiredFilters[0]===this.parameter.dimensions[0].fieldName){this.chart.setVizProperties({interaction:{selectability:{legendSelection:false}}});}}}};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.getThumbnailContent=function(){var s=this;var a=this;var h=sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.HEIGHT;var w=sap.apf.ui.utils.CONSTANTS.thumbnailDimensions.WIDTH;if(!this.chartType){this.chartType=this.getChartTypeFromRepresentationType(this.type);}this.createDataset();if(!this.thumbnailChart){this.thumbnailChart=new sap.viz.ui5.controls.VizFrame({vizType:this.chartType,width:w,height:h,dataset:this.dataset});this.thumbnailChart.setVizProperties({title:{visible:false},categoryAxis:{visible:false,title:{visible:false}},valueAxis:{visible:false,title:{visible:false}},valueAxis2:{visible:false,title:{visible:false}},legend:{visible:false,title:{visible:false}},sizeLegend:{visible:false},tooltip:{visible:false},interaction:{selectability:{axisLabelSelection:false,legendSelection:false,plotLassoSelection:false,plotStdSelection:false},enableHover:false},background:{visible:false},general:{layout:{padding:0}},plotArea:{markerSize:4,marker:{visible:true,size:4},animation:{dataLoading:false,dataUpdating:false},gridline:{visible:false},dataLabel:{visible:false},lineStyle:{rules:[{properties:{width:1}}]}}});this.fnDrawSelectionOnThumbnailChart=this.drawSelectionOnThumbnailChart.bind(s);this.thumbnailChart.attachRenderComplete(this.fnDrawSelectionOnThumbnailChart);}else{this.thumbnailChart.destroyDataset();this.thumbnailChart.removeAllFeeds();this.thumbnailChart.destroyFeeds();this.thumbnailChart.vizUpdate({'data':this.dataset});}this._createAndAddFeedItemBasedOnId(this.thumbnailChart);a.createThumbnailLayout.call(this);return this.thumbnailLayout;};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.setSelectionOnMainChart=function(s){this.chart.vizSelection(s);};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.setSelectionOnThumbnailChart=function(s){this.aStoredSelection=s;this.clearSelectionFromThumbnailChart();this.thumbnailChart.vizSelection(s);};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.clearSelectionFromMainChart=function(){this.chart.vizSelection([],{clearSelection:true});};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.clearSelectionFromThumbnailChart=function(){this.thumbnailChart.vizSelection([],{clearSelection:true});};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.getSelectionFromChart=function(){var s=this.chart.vizSelection();return s;};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.getChartTypeFromRepresentationType=function(r){var R=sap.apf.ui.utils.CONSTANTS.representationTypes;var v=sap.apf.ui.utils.CONSTANTS.vizFrameChartTypes;var V;switch(r){case R.COLUMN_CHART:V=v.COLUMN;break;case R.LINE_CHART:V=v.LINE;break;case R.PIE_CHART:V=v.PIE;break;case R.STACKED_COLUMN_CHART:V=v.STACKED_COLUMN;break;case R.PERCENTAGE_STACKED_COLUMN_CHART:V=v.PERCENTAGE_STACKED_COLUMN;break;case R.SCATTERPLOT_CHART:V=v.SCATTERPLOT;break;case R.BUBBLE_CHART:V=v.BUBBLE;break;case R.BAR_CHART:V=v.BAR;break;case R.STACKED_BAR_CHART:V=v.STACKED_BAR;break;case R.PERCENTAGE_STACKED_BAR_CHART:V=v.PERCENTAGE_STACKED_BAR;break;default:this.oMessageObject=this.oApi.createMessageObject({code:"6000",aParameters:[r]});this.oApi.putMessage(this.oMessageObject);break;}return V;};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.getIsGroupTypeChart=function(){return this.bIsGroupTypeChart?this.bIsGroupTypeChart:false;};sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype.getDataSetHelper=function(){var i=this.getIsGroupTypeChart();var d=new sap.apf.ui.representations.utils.vizFrameDatasetHelper(i);return d;};}());};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.barChart')){jQuery.sap.declare("sap.apf.ui.representations.barChart");sap.apf.ui.representations.barChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.BAR_CHART;this._createDefaultFeedItemId();};sap.apf.ui.representations.barChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.barChart.prototype.constructor=sap.apf.ui.representations.barChart;sap.apf.ui.representations.barChart.prototype._createDefaultFeedItemId=function(){this.parameter.measures.forEach(function(m){if(m.kind===undefined){m.axisfeedItemId=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.axisfeedItemId=i===0?sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS:sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;}});};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.bubbleChart')){jQuery.sap.declare("sap.apf.ui.representations.bubbleChart");sap.apf.ui.representations.bubbleChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.BUBBLE_CHART;this.bIsGroupTypeChart=true;this._createDefaultFeedItemId();};sap.apf.ui.representations.bubbleChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.bubbleChart.prototype.constructor=sap.apf.ui.representations.bubbleChart;sap.apf.ui.representations.bubbleChart.prototype._createDefaultFeedItemId=function(){this.parameter.measures.forEach(function(m,i){if(m.kind===undefined){if(i<2){if(i===0){m.axisfeedItemId=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;}else{m.axisfeedItemId=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS2;}}else if(i===2){m.axisfeedItemId=sap.apf.core.constants.vizFrame.feedItemTypes.BUBBLEWIDTH;}else{m.axisfeedItemId=sap.apf.core.constants.vizFrame.feedItemTypes.BUBBLEHEIGTH;}}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.axisfeedItemId=i===0?sap.apf.core.constants.vizFrame.feedItemTypes.COLOR:sap.apf.core.constants.vizFrame.feedItemTypes.SHAPE;}});};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.columnChart')){jQuery.sap.declare("sap.apf.ui.representations.columnChart");sap.apf.ui.representations.columnChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.COLUMN_CHART;this._createDefaultFeedItemId();};sap.apf.ui.representations.columnChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.columnChart.prototype.constructor=sap.apf.ui.representations.columnChart;sap.apf.ui.representations.columnChart.prototype._createDefaultFeedItemId=function(){this.parameter.measures.forEach(function(m){if(m.kind===undefined){m.axisfeedItemId=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.axisfeedItemId=i===0?sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS:sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;}});};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.lineChart')){jQuery.sap.declare("sap.apf.ui.representations.lineChart");sap.apf.ui.representations.lineChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.LINE_CHART;this._createDefaultFeedItemId();};sap.apf.ui.representations.lineChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.lineChart.prototype.constructor=sap.apf.ui.representations.lineChart;sap.apf.ui.representations.lineChart.prototype._createDefaultFeedItemId=function(){this.parameter.measures.forEach(function(m){if(m.kind===undefined){m.axisfeedItemId=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.axisfeedItemId=i===0?sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS:sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;}});};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.percentageStackedBarChart')){jQuery.sap.declare("sap.apf.ui.representations.percentageStackedBarChart");sap.apf.ui.representations.percentageStackedBarChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.PERCENTAGE_STACKED_BAR_CHART;this._createDefaultFeedItemId();};sap.apf.ui.representations.percentageStackedBarChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.percentageStackedBarChart.prototype.constructor=sap.apf.ui.representations.percentageStackedBarChart;sap.apf.ui.representations.percentageStackedBarChart.prototype._createDefaultFeedItemId=function(){this.parameter.measures.forEach(function(m){if(m.kind===undefined){m.axisfeedItemId=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.axisfeedItemId=i===0?sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS:sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;}});};sap.apf.ui.representations.percentageStackedBarChart.prototype.setFormatString=function(){return;};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.percentageStackedColumnChart')){jQuery.sap.declare("sap.apf.ui.representations.percentageStackedColumnChart");sap.apf.ui.representations.percentageStackedColumnChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.PERCENTAGE_STACKED_COLUMN_CHART;this._createDefaultFeedItemId();};sap.apf.ui.representations.percentageStackedColumnChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.percentageStackedColumnChart.prototype.constructor=sap.apf.ui.representations.percentageStackedColumnChart;sap.apf.ui.representations.percentageStackedColumnChart.prototype._createDefaultFeedItemId=function(){this.parameter.measures.forEach(function(m){if(m.kind===undefined){m.axisfeedItemId=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.axisfeedItemId=i===0?sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS:sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;}});};sap.apf.ui.representations.percentageStackedColumnChart.prototype.setFormatString=function(){return;};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.pieChart')){jQuery.sap.declare("sap.apf.ui.representations.pieChart");sap.apf.ui.representations.pieChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.PIE_CHART;this._createDefaultFeedItemId();};sap.apf.ui.representations.pieChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.pieChart.prototype.constructor=sap.apf.ui.representations.pieChart;sap.apf.ui.representations.pieChart.prototype._createDefaultFeedItemId=function(){this.parameter.measures.forEach(function(m){if(m.kind===undefined){m.axisfeedItemId=sap.apf.core.constants.vizFrame.feedItemTypes.SIZE;}});this.parameter.dimensions.forEach(function(d){if(d.kind===undefined){d.axisfeedItemId=sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;}});};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.scatterPlotChart')){jQuery.sap.declare("sap.apf.ui.representations.scatterPlotChart");sap.apf.ui.representations.scatterPlotChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.SCATTERPLOT_CHART;this.bIsGroupTypeChart=true;this._createDefaultFeedItemId();};sap.apf.ui.representations.scatterPlotChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.scatterPlotChart.prototype.constructor=sap.apf.ui.representations.scatterPlotChart;sap.apf.ui.representations.scatterPlotChart.prototype._createDefaultFeedItemId=function(){this.parameter.measures.forEach(function(m,i){if(m.kind===undefined){m.axisfeedItemId=i===0?sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS:sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS2;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.axisfeedItemId=i===0?sap.apf.core.constants.vizFrame.feedItemTypes.COLOR:sap.apf.core.constants.vizFrame.feedItemTypes.SHAPE;}});};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.stackedBarChart')){jQuery.sap.declare("sap.apf.ui.representations.stackedBarChart");sap.apf.ui.representations.stackedBarChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.STACKED_BAR_CHART;this._createDefaultFeedItemId();};sap.apf.ui.representations.stackedBarChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.stackedBarChart.prototype.constructor=sap.apf.ui.representations.stackedBarChart;sap.apf.ui.representations.stackedBarChart.prototype._createDefaultFeedItemId=function(){this.parameter.measures.forEach(function(m){if(m.kind===undefined){m.axisfeedItemId=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.axisfeedItemId=i===0?sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS:sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;}});};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.stackedColumnChart')){jQuery.sap.declare("sap.apf.ui.representations.stackedColumnChart");sap.apf.ui.representations.stackedColumnChart=function(a,p){sap.apf.ui.representations.BaseVizFrameChartRepresentation.apply(this,[a,p]);this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.STACKED_COLUMN_CHART;this._createDefaultFeedItemId();};sap.apf.ui.representations.stackedColumnChart.prototype=Object.create(sap.apf.ui.representations.BaseVizFrameChartRepresentation.prototype);sap.apf.ui.representations.stackedColumnChart.prototype.constructor=sap.apf.ui.representations.stackedColumnChart;sap.apf.ui.representations.stackedColumnChart.prototype._createDefaultFeedItemId=function(){this.parameter.measures.forEach(function(m){if(m.kind===undefined){m.axisfeedItemId=sap.apf.core.constants.vizFrame.feedItemTypes.VALUEAXIS;}});this.parameter.dimensions.forEach(function(d,i){if(d.kind===undefined){d.axisfeedItemId=i===0?sap.apf.core.constants.vizFrame.feedItemTypes.CATEGORYAXIS:sap.apf.core.constants.vizFrame.feedItemTypes.COLOR;}});};};if(!jQuery.sap.isDeclared('sap.apf.ui.representations.table')){jQuery.sap.declare("sap.apf.ui.representations.table");sap.apf.ui.representations.table=function(a,p){var s=this;this.parameter=p;this.type=sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION;this.fields=p.dimensions.concat(p.measures);this.columns={name:[],value:[],width:[]};jQuery.sap.require({modName:"sap.ui.thirdparty.d3"});this.aDataResponse=[];this.alternateRepresentation=p.defaultListConfigurationTypeID;this.filter=a.createFilter();var b=0;var t=100;var c;var d;var f=false;var g=0;var h=0;var r=[];this.printMode=false;this.oModel=new sap.ui.model.json.JSONModel();this.oModel.setSizeLimit(10000);this.isAlternateRepresentation=p.isAlternateRepresentation;this.getParameter=function(){return this.parameter;};this.setData=function(D,m){if(h===0){if(f){D.map(function(o){s.aDataResponse.push(o);});h++;}else{b=0;s.aDataResponse=[];D.map(function(o){s.aDataResponse.push(o);});}}r=D;this.metadata=m;f=false;this.formatter=new sap.apf.ui.utils.formatter({getEventCallback:a.getEventCallback.bind(a),getTextNotHtmlEncoded:a.getTextNotHtmlEncoded},m,D);};this.getAlternateRepresentation=function(){return this.alternateRepresentation;};this.getMetaData=function(){return this.metadata;};this.getData=function(){return this.aDataResponse;};this.getRequestOptions=function(){if(!f){t=100;b=0;h=0;}var e={paging:{top:t,skip:b,inlineCount:true}};var o;if(c!==undefined){o=[{property:c,descending:d}];e.orderby=o;}else{if(this.getParameter().orderby&&this.getParameter().orderby.length){var O=this.getParameter().orderby.map(function(i){return{property:i.property,descending:!i.ascending};});e.orderby=O;}}return e;};this.createDataset=function(){if(s.getData().length!==0){for(var i=0;i<s.fields.length;i++){s.columns.value[i]=s.fields[i].fieldName;var n="";var u="";if(s.getMetaData()!==undefined&&s.getMetaData().getPropertyMetadata(s.fields[i].fieldName).unit!==undefined){var U=s.getMetaData().getPropertyMetadata(s.fields[i].fieldName).unit;u=s.getData()[0][U];n=s.fields[i].fieldDesc===undefined||!a.getTextNotHtmlEncoded(s.fields[i].fieldDesc).length?s.getMetaData().getPropertyMetadata(s.fields[i].fieldName).label+" ("+u+")":a.getTextNotHtmlEncoded(s.fields[i].fieldDesc)+" ("+u+")";s.columns.name[i]=n;}else{s.columns.name[i]=this.fields[i].fieldDesc===undefined||!a.getTextNotHtmlEncoded(s.fields[i].fieldDesc).length?s.getMetaData().getPropertyMetadata(s.fields[i].fieldName).label:a.getTextNotHtmlEncoded(s.fields[i].fieldDesc);}if(s.parameter.width!==undefined){s.columns.width[i]=s.parameter.width[s.columns.value[i]];}}}};this.drawSelection=function(e){var R=s.getFilter().getInternalFilter().getProperties()[0],F=s.getFilter().getInternalFilter().getFilterTermsForProperty(R),i=F.map(function(j){return j.getValue();}),l=this.getItems(),S=l.filter(function(j){var k=j.getBindingContext().getProperty(R);return i.indexOf(k)!==-1;});S.forEach(function(j){j.addStyleClass('sapMLIBSelected');});};this.getMainContent=function(S,e,w){s.createDataset();var m;if(!S){m=a.createMessageObject({code:"6002",aParameters:["title",a.getTextNotHtmlEncoded("step")]});a.putMessage(m);}if(this.fields.length===0){m=a.createMessageObject({code:"6002",aParameters:["dimensions",S]});a.putMessage(m);}if(!this.aDataResponse||this.aDataResponse.length===0){m=a.createMessageObject({code:"6000",aParameters:[S]});a.putMessage(m);}var j=e||600;j=j+"px";var k=w||1000;k=k+"px";s.title=S;var o=s.aDataResponse;s.oModel.setData({tableData:o});var l=[];var i;var C=function(F){return function(G){if(s.metadata===undefined){return G;}else{var H=s.formatter.getFormattedValue(s.columns.value[F],G);if(H!==undefined){return H;}else{return G;}}};};for(i=0;i<s.columns.name.length;i++){s.cellValues=new sap.m.Text().bindText(s.columns.value[i],C(i),sap.ui.model.BindingMode.OneWay);l.push(s.cellValues);}var n=[];var q=[];var W;var u;var v;for(i=0;i<s.columns.name.length;i++){W=false;if(s.columns.width!==undefined&&s.columns.width instanceof Array&&s.columns.width.length!==0){W=true;}u=d3.scale.linear().domain([0,8]).range([0,72]);v=W?s.columns.width[i]:(u(s.columns.name[i].length))+"px";s.columnName=new sap.m.Column({width:v,header:new sap.m.Text({text:s.columns.name[i]})});n.push(s.columnName);s.columnName1=new sap.m.Column({width:v});q.push(s.columnName1);}var T=new sap.m.Table({headerText:s.title,showNoData:false,columns:n}).addStyleClass("tableWithHeaders");this.oTableWithoutHeaders=new sap.m.Table({columns:q,items:{path:"/tableData",template:new sap.m.ColumnListItem({cells:l})}});T.setModel(s.oModel);this.oTableWithoutHeaders.setModel(s.oModel);this.oTableWithoutHeaders.attachUpdateFinished(this.drawSelection.bind(this.oTableWithoutHeaders));var x=function(F){var G=F.getParameters();s.oTableWithoutHeaders.setBusy(true);h=0;c=G.sortItem.getKey();d=G.sortDescending;t=100;b=0;var y=[];if(G.sortItem){if(s.isAlternateRepresentation){var z=s.oTableWithoutHeaders.getBinding("items");y.push(new sap.ui.model.Sorter(c,d));z.sort(y);s.oTableWithoutHeaders.setBusy(false);return;}a.updatePath(function(H,J){if(H===a.getActiveStep()){s.oModel.setData({tableData:s.aDataResponse});s.oTableWithoutHeaders.rerender();s.oTableWithoutHeaders.setBusy(false);}});}};this.viewSettingsDialog=new sap.m.ViewSettingsDialog({confirm:x});for(i=0;i<T.getColumns().length;i++){var I=new sap.m.ViewSettingsItem({text:s.columns.name[i],key:s.columns.value[i]});this.viewSettingsDialog.addSortItem(I);}if(c===undefined&&d===undefined){if(this.getParameter().orderby&&this.getParameter().orderby.length){for(i=0;i<this.viewSettingsDialog.getSortItems().length;i++){if(this.getParameter().orderby[0].property===this.viewSettingsDialog.getSortItems()[i].getKey()){this.viewSettingsDialog.setSelectedSortItem(this.viewSettingsDialog.getSortItems()[i]);this.viewSettingsDialog.setSortDescending(!this.getParameter().orderby[0].ascending);}}}else{this.viewSettingsDialog.setSelectedSortItem(this.viewSettingsDialog.getSortItems()[0]);this.viewSettingsDialog.setSortDescending(false);}}else{for(i=0;i<this.viewSettingsDialog.getSortItems().length;i++){if(c===this.viewSettingsDialog.getSortItems()[i].getKey()){this.viewSettingsDialog.setSelectedSortItem(this.viewSettingsDialog.getSortItems()[i]);}}this.viewSettingsDialog.setSortDescending(d);var y=[];if(this.isAlternateRepresentation){var z=s.oTableWithoutHeaders.getBinding("items");y.push(new sap.ui.model.Sorter(c,d));z.sort(y);}}if(s.metadata!==undefined){for(i=0;i<s.columns.name.length;i++){var M=s.metadata.getPropertyMetadata(s.columns.value[i]);if(M.unit){var A=s.oTableWithoutHeaders.getColumns()[i];A.setHAlign(sap.ui.core.TextAlign.Right);}}}var B=new sap.m.ScrollContainer({content:s.oTableWithoutHeaders,height:"480px",horizontal:false,vertical:true}).addStyleClass("tableWithoutHeaders");var D=new sap.m.Link({text:"More"}).addStyleClass("loadMoreLink");var E=new sap.m.ScrollContainer({content:[T,B],width:k,horizontal:true,vertical:false}).addStyleClass("scrollContainer");s.oModel.setSizeLimit(10000);T.addEventDelegate({onAfterRendering:function(){jQuery(".scrollContainer > div:first-child").css({"display":"table","width":"inherit"});var F;if(s.offsetTop===undefined){s.offsetTop=jQuery(".tableWithoutHeaders").offset().top;}if(jQuery(".tableWithoutHeaders").offset().top!==s.offsetTop){F=((window.innerHeight-jQuery('.tableWithoutHeaders').offset().top))+"px";}else{F=((window.innerHeight-jQuery('.tableWithoutHeaders').offset().top)-(jQuery(".applicationFooter").height())-20)+"px";}document.querySelector('.tableWithoutHeaders').style.cssText+="height : "+F;var L=sap.ui.getCore().getRenderManager().getHTML(D);sap.ui.Device.orientation.attachHandler(function(){E.rerender();});var G=a.getActiveStep();if(G.getSelectedRepresentation().bIsAlternateView===undefined||G.getSelectedRepresentation().bIsAlternateView===false){if(sap.ui.Device.browser.mobile){if(r.length>0){jQuery(jQuery(".tableWithoutHeaders > div:first-child")).append(L);}D.attachPress(function(){if(!jQuery(".openToggleImage").length&&(r.length>0)){if(g===0){H();h=0;g++;jQuery(".loadMoreLink").remove();jQuery(jQuery(".tableWithoutHeaders > div:first-child")).append(L);}}else{jQuery(".loadMoreLink").remove();}});}else{jQuery('.tableWithoutHeaders').on("scroll",function(){var s=jQuery(this);var J=s.prop("scrollTop");var K=s.prop("scrollHeight");var N=s.prop("offsetHeight");var O=K-N-5;if((O<=J)&&!jQuery(".openToggleImage").length&&(r.length>0)){if(g===0){H();h=0;g++;}}});}}var H=function(){s.oTableWithoutHeaders.setBusy(true);sap.ui.getCore().applyChanges();var J=s.oModel.getData();b+=o.length;t=10;f=true;a.updatePath(function(K,N){if(K===a.getActiveStep()){s.oModel.setData(J);s.oTableWithoutHeaders.rerender();s.oTableWithoutHeaders.setBusy(false);g=0;}});};}});return new sap.ui.layout.VerticalLayout({content:[E]});};this.getThumbnailContent=function(){if(this.aDataResponse!==undefined&&this.aDataResponse.length!==0){var i=new sap.ui.core.Icon({src:"sap-icon://table-chart",size:"70px"}).addStyleClass('thumbnailTableImage');return i;}else{var n=new sap.m.Text({text:a.getTextNotHtmlEncoded("noDataText")}).addStyleClass('noDataText');return new sap.ui.layout.VerticalLayout({content:n});}};this.serialize=function(){return{oFilter:this.getFilter().serialize()};};this.deserialize=function(S){var e=a.createFilter();this.setFilter(e.deserialize(S.oFilter));};this.getFilterMethodType=function(){return sap.apf.core.constants.filterMethodTypes.filter;};this.getSelectionCount=function(){var R=s.getFilter().getInternalFilter().getProperties()[0],F=s.getFilter().getInternalFilter().getFilterTermsForProperty(R);return F.length;};this.getFilter=function(){return this.filter;};this.setFilter=function(F){this.filter=F;};this.adoptSelection=function(S){if(S&&S.getFilter){this.setFilter(S.getFilter());}};this.removeAllSelection=function(){this.setFilter(a.createFilter());a.selectionChanged();s.oTableWithoutHeaders.getItems().forEach(function(i){i.removeStyleClass('sapMLIBSelected');});};this.getPrintContent=function(S){this.createDataset();var o=this.aDataResponse;this.oModel.setData({tableData:o});var i;var e=[];for(i=0;i<s.columns.name.length;i++){s.columnName=new sap.m.Column({width:"75px",header:new sap.m.Label({text:s.columns.name[i]})});e.push(s.columnName);}var j=[];var C=function(l){return function(n){if(s.metadata===undefined){return n;}else{var m=s.metadata.getPropertyMetadata(s.columns.value[l]);if(m.dataType.type==="Edm.DateTime"){if(n===null){return"-";}var q=new Date(parseInt(n.slice(6,n.length-2),10));q=q.toLocaleDateString();if(q==="Invalid Date"){return"-";}return q;}if(m.unit){if(n===null){return"-";}var u=s.metadata.getPropertyMetadata(m.unit);if(u.semantics==="currency-code"){var v=s.aDataResponse[0][m.scale];n=parseFloat(n,10).toFixed(v).toString();var w=n.split(".");var x=parseFloat(w[0]).toLocaleString();var y=0.1;y=y.toLocaleString();if(x.split(y.substring(1,2)).length>1){x=x.split(y.substring(1,2))[0];}x=x.concat(y.substring(1,2),w[1]);return x;}}else{return n;}}};};for(i=0;i<s.columns.name.length;i++){s.cellValues=new sap.m.Text().bindText(s.columns.value[i],C(i),sap.ui.model.BindingMode.OneWay);j.push(s.cellValues);}var T=new sap.m.Table({headerText:S,headerDesign:sap.m.ListHeaderDesign.Standard,columns:e,items:{path:"/tableData",template:new sap.m.ColumnListItem({cells:j})}}).addStyleClass("printTable");if(s.metadata!==undefined){for(i=0;i<s.columns.name.length;i++){var m=s.metadata.getPropertyMetadata(s.columns.value[i]);if(m.unit){var k=T.getColumns()[i];k.setHAlign(sap.ui.core.TextAlign.Right);}}}T.setModel(s.oModel);T.attachUpdateFinished(this.drawSelection.bind(T));return new sap.ui.layout.VerticalLayout({content:[T]});};};};if(!jQuery.sap.isDeclared('sap.apf.ui.reuse.controller.stepGallery.controller')){jQuery.sap.declare('sap.apf.ui.reuse.controller.stepGallery.controller');
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.controller("sap.apf.ui.reuse.controller.stepGallery",{getGalleryElementsData:function(){var s=this;var g=[];var c=this.oCoreApi.getCategories();var l=this.oCoreApi.getTextNotHtmlEncoded("label");var a=this.oCoreApi.getTextNotHtmlEncoded("steps");var b=this.oCoreApi.getTextNotHtmlEncoded("category");var m;if(c.length===0){m=this.oCoreApi.createMessageObject({code:"6001",aParameters:["Categories"]});this.oCoreApi.putMessage(m);}var i;for(i=0;i<c.length;i++){var G={};var C=c[i];var d;if(!C.label){m=this.oCoreApi.createMessageObject({code:"6002",aParameters:[l,b+": "+d]});this.oCoreApi.putMessage(m);}else{d=this.oCoreApi.getTextNotHtmlEncoded(C.label);G.title=this.oCoreApi.getTextNotHtmlEncoded(C.label);}G.id=C.id;G.stepTemplates=[];C.stepTemplates.forEach(function(o){var e={};if(!o.title){m=s.oCoreApi.createMessageObject({code:"6003",aParameters:["Title"]});s.oCoreApi.putMessage(m);}else{e.title=s.oCoreApi.getTextNotHtmlEncoded(o.title);}e.id=o.id;e.representationtypes=o.getRepresentationInfo();e.representationtypes.forEach(function(r){r.title=s.oCoreApi.getTextNotHtmlEncoded(r.label);if(r.parameter&&r.parameter.orderby){var f=new sap.apf.ui.utils.Helper(s.oCoreApi).getRepresentationSortInfo(r);r.sortDescription=f;}});e.defaultRepresentationType=e.representationtypes[0];G.stepTemplates.push(e);});g.push(G);}var S=this.oCoreApi.getStepTemplates();if(S.length===0){m=this.oCoreApi.createMessageObject({code:"6002",aParameters:[a,b]});this.oCoreApi.putMessage(m);}var j={GalleryElements:g};return j;},onInit:function(){this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;var g=this.getGalleryElementsData().GalleryElements;var m=new sap.ui.model.json.JSONModel({"GalleryElements":g});this.getView().setModel(m);},getStepDetails:function(c,s){var g=this.getGalleryElementsData().GalleryElements;var a=g[c].stepTemplates[s];return a;},openHierarchicalSelectDialog:function(){if(this.oHierchicalSelectDialog){this.oHierchicalSelectDialog.destroy();}this.oHierchicalSelectDialog=new sap.ui.jsfragment("sap.apf.ui.reuse.fragment.stepGallery",this);this.oHierchicalSelectDialog.setModel(this.getView().getModel());this.oHierchicalSelectDialog.open();},onStepPress:function(i,r){this.oHierchicalSelectDialog.close();this.oUiApi.getLayoutView().setBusy(true);this.oCoreApi.createStep(i,this.oUiApi.getAnalysisPath().getController().callBackForUpdatePathAndSetLastStepAsActive.bind(this.oUiApi.getAnalysisPath().getController()),r);this.oUiApi.getLayoutView().setBusy(true);this.oUiApi.getAnalysisPath().getController().refresh(-1);}});};if(!jQuery.sap.isDeclared('sap.apf.ui.reuse.controller.stepToolbar.controller')){jQuery.sap.declare('sap.apf.ui.reuse.controller.stepToolbar.controller');sap.ui.controller("sap.apf.ui.reuse.controller.stepToolbar",{chartIconInserted:false,alternateRepresentationIcon:false,alternateRepresentationBool:false,selectedRepresentation:null,alternateRepresentationBtn:{},selectedNumber:null,selectedNumberLink:null,isSwitchRepresentation:false,viewSettingsIcon:null,onInit:function(){this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;},drawAlternateRepresentation:function(){var t=this;this.alternateRepresentationBtn=new sap.m.Button({icon:this.oCoreApi.getActiveStep().getSelectedRepresentation().getAlternateRepresentation().picture,tooltip:this.oCoreApi.getTextNotHtmlEncoded("TableRepresentation"),press:function(){var s=t.oCoreApi.getActiveStep();var c=s.getSelectedRepresentation();var a=t.oCoreApi.getSteps().indexOf(s);t.selectedRepresentation="table";c.bIsAlternateView=true;if(c.toggleInstance===undefined){c.toggleInstance=t.oUiApi.getStepContainer().getController().createAlternateRepresentation(a);}else{var d=c.getData(),m=c.getMetaData();if(d!==undefined&&m!==undefined){c.toggleInstance.setData(d,m);}c.toggleInstance.adoptSelection(c);}t.oUiApi.getAnalysisPath().getController().refresh(-1);t.oUiApi.getStepContainer().getController().drawStepContent();t.oUiApi.getAnalysisPath().getCarousel().getStepView(a).getController().drawThumbnailContent(true);}}).addStyleClass("alternateButton");this.insertViewSettingsIcon();this.getView().chartToolbar.getToolBar().insertContentRight(this.alternateRepresentationBtn);},insertViewSettingsIcon:function(){var t=this;this.sortButton=new sap.m.Button({icon:"sap-icon://drop-down-list",tooltip:this.oCoreApi.getTextNotHtmlEncoded("view-Settings"),press:function(){if(t.oCoreApi.getActiveStep().getSelectedRepresentation().type!==sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){t.oCoreApi.getActiveStep().getSelectedRepresentation().toggleInstance.viewSettingsDialog.open();}else{t.oCoreApi.getActiveStep().getSelectedRepresentation().viewSettingsDialog.open();}}}).addStyleClass("sortButton");this.getView().chartToolbar.getToolBar().insertContentRight(this.sortButton);},showSelectionCount:function(){var a=this.oCoreApi.getActiveStep();var s=a.getSelectedRepresentation();var b;if(typeof s.getSelections==="function"){b=s.getSelections().length;}else if(typeof s.getSelectionCount==="function"){b=s.getSelectionCount();}else{b=0;}var r=s.getParameter().requiredFilters!==undefined&&s.getParameter().requiredFilters.length!==0;var m=s.getMetaData!==undefined&&s.getMetaData()!==undefined&&s.getMetaData().hasOwnProperty("getPropertyMetadata");var c=r&&m?s.getMetaData().getPropertyMetadata(s.getParameter().requiredFilters[0]).label:null;if(c===null||b===0){jQuery(".showSelection").hide();jQuery(".resetSelection").hide();}else if(b>0){this.selectedNumber.setText("("+this.oCoreApi.getTextNotHtmlEncoded("selected-objects",[c]));this.selectedNumberLink.setText(b);this.selectedNumberEndText.setText(')');jQuery(".showSelection").show();jQuery(".resetSelection").show();}},insertContentLeft:function(){var t=this;this.currentStepText=new sap.m.Label({wrapping:true,text:this.oCoreApi.getTextNotHtmlEncoded("currentStep")}).addStyleClass("currentStep");this.selectedNumber=new sap.m.Label({wrapping:true}).addStyleClass("showSelection");this.selectedNumberEndText=new sap.m.Label({wrapping:true}).addStyleClass("showSelection");this.selectedNumberEndText.addStyleClass("selectedNumberEndText");this.selectedNumberLink=new sap.m.Link({press:function(){if(t.selectionDisplayDialog){t.selectionDisplayDialog.destroy();}t.selectionDisplayDialog=new sap.ui.jsfragment("sap.apf.ui.reuse.fragment.selectionDisplay",t);t.selectionDisplayDialog.open();}}).addStyleClass("showSelection");this.selectedNumberLink.addStyleClass("selectedNumberLink");this.resetSelection=new sap.m.Link({text:this.oCoreApi.getTextNotHtmlEncoded("resetSelection")}).attachPress(function(){jQuery(".showSelection").hide();jQuery(".resetSelection").hide();if(t.oCoreApi.getActiveStep().getSelectedRepresentation().bIsAlternateView){t.oCoreApi.getActiveStep().getSelectedRepresentation().toggleInstance.removeAllSelection();}t.oCoreApi.getActiveStep().getSelectedRepresentation().removeAllSelection();}).addStyleClass("resetSelection");this.getView().chartToolbar.getToolBar().insertContentRight(this.resetSelection);this.getView().chartToolbar.getToolBar().insertContentLeft(this.selectedNumberEndText);this.getView().chartToolbar.getToolBar().insertContentLeft(this.selectedNumberLink);this.getView().chartToolbar.getToolBar().insertContentLeft(this.selectedNumber);this.getView().chartToolbar.getToolBar().insertContentLeft(this.currentStepText);},drawSingleRepresentation:function(){var t=this;var a=this.oCoreApi.getActiveStep();a.selectedRepresentaionType=a.getSelectedRepresentationInfo();if(a.selectedRepresentaionType.parameter&&a.selectedRepresentaionType.parameter.orderby){var r=new sap.apf.ui.utils.Helper(t.oCoreApi).getRepresentationSortInfo(a.selectedRepresentaionType);a.selectedRepresentaionType.sortDescription=r;}var s=new sap.m.Button({icon:a.selectedRepresentaionType.picture,tooltip:this.oCoreApi.getTextNotHtmlEncoded(a.selectedRepresentaionType.label)+"\n"+((a.selectedRepresentaionType.sortDescription!==undefined)?this.oCoreApi.getTextNotHtmlEncoded("sortBy")+": "+a.selectedRepresentaionType.sortDescription:""),press:function(){var S=t.oCoreApi.getActiveStep();var c=S.getSelectedRepresentation();c.bIsAlternateView=false;t.oUiApi.getStepContainer().getController().drawStepContent();var b=t.oCoreApi.getSteps().indexOf(S);t.oUiApi.getAnalysisPath().getCarousel().getStepView(b).getController().drawThumbnailContent(true);}});this.getView().chartToolbar.getToolBar().insertContentRight(s,0);this.insertContentLeft();},drawMultipleRepresentation:function(){var t=this;var a=this.oCoreApi.getActiveStep();a.representationtypes=a.getRepresentationInfo();a.representationtypes.forEach(function(R){if(R.parameter&&R.parameter.orderby){var r=new sap.apf.ui.utils.Helper(t.oCoreApi).getRepresentationSortInfo(R);R.sortDescription=r;}});a.selectedRepresentaionType=a.getSelectedRepresentationInfo();if(a.selectedRepresentaionType.parameter&&a.selectedRepresentaionType.parameter.orderby){var r=new sap.apf.ui.utils.Helper(this.oCoreApi).getRepresentationSortInfo(a.selectedRepresentaionType);a.selectedRepresentaionType.sortDescription=r;}var b=a.representationtypes.length;var s;var d=function(e){var a=t.oCoreApi.getSteps()[e.nActiveStepIndex];a.getSelectedRepresentation().bIsAlternateView=false;a.setSelectedRepresentation(e.oRepresentationType.representationId);t.oUiApi.getAnalysisPath().getController().refresh(e.nActiveStepIndex);t.oCoreApi.updatePath(t.oUiApi.getAnalysisPath().getController().callBackForUpdatePath.bind(t.oUiApi.getAnalysisPath().getController()));};this.openList=function(e){var f=e.getParameter("listItem").getCustomData()[0].getValue();d(f);s.setIcon(f.icon);s.setTooltip(t.oCoreApi.getTextNotHtmlEncoded(f.oRepresentationType.label)+"\n"+(f.oRepresentationType.sortDescription!==undefined?t.oCoreApi.getTextNotHtmlEncoded("sortBy")+": "+f.oRepresentationType.sortDescription:""));};var A=new sap.m.List({mode:sap.m.ListMode.SingleSelectMaster,showSeparators:sap.m.ListSeparators.None,includeItemInSelection:true,select:jQuery.proxy(function(e){this.openList(e);},this)});for(var j=0;j<b;j++){A.addItem(new sap.m.StandardListItem({description:a.representationtypes[j].sortDescription&&this.oCoreApi.getTextNotHtmlEncoded("sortBy")+": "+a.representationtypes[j].sortDescription,icon:a.representationtypes[j].picture,title:t.oCoreApi.getTextNotHtmlEncoded(a.representationtypes[j].label),customData:[new sap.ui.core.CustomData({key:'data',value:{oRepresentationType:a.representationtypes[j],nActiveStepIndex:t.oCoreApi.getSteps().indexOf(t.oCoreApi.getActiveStep()),icon:a.representationtypes[j].picture}})]}));}var S=new sap.m.Popover({placement:sap.m.PlacementType.Bottom,showHeader:false,content:[A]}).addStyleClass("sapCaUiChartToolBarShowAllChartListPopover");function p(e){var f=e.getSource().getCustomData()[0].getValue();d(f);}for(var k=0;k<b;k++){var c=new sap.m.Button({tooltip:t.oCoreApi.getTextNotHtmlEncoded(a.representationtypes[k].label)+"\n"+((a.representationtypes[k].sortDescription!==undefined)?this.oCoreApi.getTextNotHtmlEncoded("sortBy")+": "+a.representationtypes[k].sortDescription:""),icon:a.representationtypes[k].picture,customData:[new sap.ui.core.CustomData({key:'data',value:{oRepresentationType:a.representationtypes[k],nActiveStepIndex:t.oCoreApi.getSteps().indexOf(t.oCoreApi.getActiveStep()),icon:a.representationtypes[k].picture}})],press:p});c.addStyleClass("iconLeft");this.getView().chartToolbar.getToolBar().insertContentRight(c);}s=new sap.m.Button({icon:a.selectedRepresentaionType.picture,tooltip:this.oCoreApi.getTextNotHtmlEncoded(a.selectedRepresentaionType.label)+"\n"+((a.selectedRepresentaionType.sortDescription!==undefined)?this.oCoreApi.getTextNotHtmlEncoded("sortBy")+": "+a.selectedRepresentaionType.sortDescription:""),press:function(){S.openBy(this);}}).addStyleClass("iconList");this.getView().chartToolbar.getToolBar().insertContentRight(s,0);this.insertContentLeft();},drawToolBar:function(){var t=this;this.showAndHideIcons=function(){var t=this;t.isSwitchRepresentation=false;if(t.getView().chartToolbar.getFullScreen()===true){jQuery(".iconList").hide();jQuery(".iconLeft").show();}else{jQuery(".iconList").show();jQuery(".iconLeft").hide();}if((t.oCoreApi.getActiveStep().getSelectedRepresentation().bIsAlternateView&&t.oCoreApi.getActiveStep().getSelectedRepresentation().getAlternateRepresentation().id===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION)||t.oCoreApi.getActiveStep().getSelectedRepresentation().type===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){jQuery(".sortButton").show();}else{jQuery(".sortButton").hide();}if(t.oCoreApi.getSteps().length>=1){t.showSelectionCount();}var a=t.getView().chartToolbar.getId();if(t.oCoreApi.getActiveStep().getSelectedRepresentation().getAlternateRepresentation()!==undefined){if((!t.oCoreApi.getActiveStep().getSelectedRepresentation().bIsAlternateView&&t.oCoreApi.getActiveStep().getSelectedRepresentation().getAlternateRepresentation().id!==sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION)||t.oCoreApi.getActiveStep().getSelectedRepresentation().type!==sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){if((window.innerWidth===jQuery("#"+a+" > div:first-child > div:nth-child(2)").width())){jQuery(t.getView().chartToolbar._oShowLegendButton.getDomRef()).show();}}}};this.renderIcons=function(){var t=this;var a=t.oCoreApi.getActiveStep();if(a!==undefined){t.getView().chartToolbar._oFullScreenButton.setTooltip(t.oCoreApi.getTextNotHtmlEncoded("toggle-fullscreen"));t.getView().chartToolbar._oFullScreenExitButton.setTooltip(t.oCoreApi.getTextNotHtmlEncoded("toggle-fullscreen"));if(t.alternateRepresentationIcon===false&&t.oCoreApi.getActiveStep().getSelectedRepresentation().type!==sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){t.drawAlternateRepresentation();t.alternateRepresentationIcon=true;}if(t.oCoreApi.getActiveStep().getSelectedRepresentation().type===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION){if(t.viewSettingsIcon===false){t.insertViewSettingsIcon();}t.viewSettingsIcon=true;}if(t.oCoreApi.getActiveStep().getRepresentationInfo().length>1){if(t.chartIconInserted===false){t.drawMultipleRepresentation();}t.chartIconInserted=true;}else if(t.oCoreApi.getActiveStep().getSelectedRepresentation().type!==sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION&&t.oCoreApi.getActiveStep().getRepresentationInfo().length===1){if(t.chartIconInserted===false){t.drawSingleRepresentation();}t.chartIconInserted=true;}if((t.oCoreApi.getActiveStep().getSelectedRepresentation().bIsAlternateView&&t.oCoreApi.getActiveStep().getSelectedRepresentation().getAlternateRepresentation().id===sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION)||t.oCoreApi.getActiveStep().getSelectedRepresentation().type===(sap.apf.ui.utils.CONSTANTS.representationTypes.TABLE_REPRESENTATION||sap.apf.ui.utils.CONSTANTS.representationTypes.GEO_MAP)){t.getView().chartToolbar._oShowLegendButton.setVisible(false);}else{t.getView().chartToolbar._oShowLegendButton.setVisible(true);t.getView().chartToolbar._oShowLegendButton.setTooltip(t.oCoreApi.getTextNotHtmlEncoded("legend"));}if(t.isSwitchRepresentation===true){t.getView().chartToolbar.setShowLegend(true);}}};this.getView().chartToolbar.addEventDelegate({onAfterRendering:function(){if(t.oCoreApi.getSteps().length>0){t.showAndHideIcons();}var s=t.oCoreApi.getActiveStep();if(s){var c=s.getSelectedRepresentation();var f;var a=s.getSelectedRepresentation().chart||{};if(c.bIsLegendVisible===true||c.bIsLegendVisible===undefined){if(a.setVizProperties){a.setVizProperties({legend:{visible:true},sizeLegend:{visible:true}});}else{if(a.setLegend!==undefined){a.setLegend(new sap.viz.ui5.types.legend.Common({visible:true,title:new sap.viz.ui5.types.legend.Common_title({visible:true})}));}if(a.setSizeLegend!==undefined){f=a.getSizeLegend().getFormatString();a.setSizeLegend(new sap.viz.ui5.types.legend.Common({visible:true,title:new sap.viz.ui5.types.legend.Common_title({visible:true})}));if(f!==null){a.getSizeLegend().setFormatString(f);}}}}else{if(a.setVizProperties){a.setVizProperties({legend:{visible:false},sizeLegend:{visible:false}});}else{if(a.setLegend!==undefined){a.setLegend(new sap.viz.ui5.types.legend.Common({visible:false,title:new sap.viz.ui5.types.legend.Common_title({visible:false})}));}if(a.setSizeLegend!==undefined){f=a.getSizeLegend().getFormatString();a.setSizeLegend(new sap.viz.ui5.types.legend.Common({visible:false,title:new sap.viz.ui5.types.legend.Common_title({visible:false})}));if(f!==null){a.getSizeLegend().setFormatString(f);}}}}}},onBeforeRendering:function(){if(t.oCoreApi.getSteps().length>0){t.renderIcons();}}});},drawRepresentation:function(c){var t=this;this.isSwitchRepresentation=true;this.getView().chartToolbar.getToolBar().removeAllContentLeft();this.getView().chartToolbar.getToolBar().removeAllContentRight();this.chartIconInserted=false;this.alternateRepresentationIcon=false;this.viewSettingsIcon=false;this.getView().chartToolbar.removeAllCharts();this.getView().chartToolbar.insertChart(c);if(this.getView().chartToolbar.getFullScreen()===true){this.getView().chartToolbar.rerender();}this.drawToolBar();this.getView().chartToolbar.onAfterRendering=function(){var l=this._oShowLegendButton.getDomRef();var e=sap.ui.Device.browser.mobile?"tap":"click";$(l).on(e,function(){var s=t.oCoreApi.getActiveStep();var a=s.getSelectedRepresentation();if(a.bIsLegendVisible===true||a.bIsLegendVisible===undefined){a.bIsLegendVisible=false;}else{a.bIsLegendVisible=true;}});};}});};if(!jQuery.sap.isDeclared('sap.apf.ui.utils.facetFilterValueFormatter')){jQuery.sap.declare('sap.apf.ui.utils.facetFilterValueFormatter');sap.apf.ui.utils.FacetFilterValueFormatter=function(){"use strict";this.getFormattedFFData=function(f){var F,t,s;var p=f.oPropertyMetadata;var S=f.sSelectProperty;var a=f.aFilterValues;var o=new sap.apf.ui.utils.formatter({getEventCallback:f.oUiApi.getEventCallback.bind(f.oUiApi),getTextNotHtmlEncoded:f.oCoreApi.getTextNotHtmlEncoded},p,a);var T=p.text;a.forEach(function(b){F=o.getFormattedValue(S,b[S]);t=F;if(T){s=o.getFormattedValue(T,b[T]);if(s){t=F+" - "+s;}}b.formattedValue=t;});return a;};};};if(!jQuery.sap.isDeclared('sap.apf.core.utils.filter')){jQuery.sap.declare('sap.apf.core.utils.filter');(function(){'use strict';sap.apf.core.utils.Filter=function(m,a,b,c,d){var e="%20and%20";var f="%20or%20";this.type="internalFilter";var l;if(a&&(a instanceof sap.apf.core.utils.FilterTerm||a instanceof sap.apf.core.utils.Filter)){l=a;}else if(a!==undefined&&b!==undefined&&c!==undefined){l=new sap.apf.core.utils.FilterTerm(m,a,b,c,d);}else if(a!==undefined||b!==undefined||c!==undefined){m.check(false,"wrong arguments in construction of sap.apf.core.utils.Filter");}var r=[];var g;this.getProperties=function(){var i;var p=[];var P=[];var j="";if(l===undefined){return p;}if(l instanceof sap.apf.core.utils.FilterTerm){j=l.getProperty();p.push(j);}else if(l instanceof sap.apf.core.utils.Filter){p=l.getProperties();}for(i=0;i<r.length;i++){if(r[i]instanceof sap.apf.core.utils.FilterTerm){p.push(r[i].getProperty());}else{P=r[i].getProperties();p=p.concat(P);}}return sap.apf.utils.eliminateDuplicatesInArray(m,p);};this.copy=function(){var F;var i;if(l===undefined){return new sap.apf.core.utils.Filter(m);}F=new sap.apf.core.utils.Filter(m,l);if(g===undefined){return F;}for(i=0;i<r.length;i++){if(g===sap.apf.core.constants.BooleFilterOperators.AND){F.addAnd(r[i].copy());}else{F.addOr(r[i].copy());}}return F;};this.isEmpty=function(){if(l===undefined){return true;}if(l instanceof sap.apf.core.utils.FilterTerm){return false;}if(!l.isEmpty()){return false;}if(r.length===0){return true;}var i;for(i=0;i<r.length;++i){if(!r[i].isEmpty()){return false;}}return true;};this.isOr=function(){if(g===sap.apf.core.constants.BooleFilterOperators.OR){return true;}else if(g===sap.apf.core.constants.BooleFilterOperators.AND){return false;}if(l){if(l instanceof sap.apf.core.utils.Filter){return l.isOr();}}return false;};this.isEqual=function(F){if(this===F){return true;}if(F===undefined){return false;}return this.getHash()===F.getHash();};this.getHash=function(L){var n=L||1;var j=0;if(r.length===0){j=n;}else{j=n+1;}if(l===undefined){return 0;}var H=l.getHash(j);var i;if(g===undefined){return H;}if(g===sap.apf.core.constants.BooleFilterOperators.AND){H=H+Math.pow(2,n);}else if(g===sap.apf.core.constants.BooleFilterOperators.OR){H=H+Math.pow(3,n);}for(i=0;i<r.length;i++){H=H+r[i].getHash(j);}return H;};this.filterArray=function(D){var F=[];var i;var j=0;var k=D.length;if(k===0){return F;}var p;var C=false;var n=this.getProperties();var o=[];for(p in D[0]){if(jQuery.inArray(p,n)>-1){o.push(p);}}if(o.length===0){return D;}for(i=0;i<k;i++){C=true;for(j=0;j<o.length;++j){p=o[j];if(this.isConsistentWithFilter(p,D[i][p])===false){C=false;break;}}if(C){F.push(D[i]);}}return F;};this.getFilterTermsForProperty=function(p){var t=[];var i;if(l===undefined){return t;}if(l instanceof sap.apf.core.utils.Filter){t=l.getFilterTermsForProperty(p);}else if(p===l.getProperty()){t.push(l);}for(i=0;i<r.length;i++){if(r[i]instanceof sap.apf.core.utils.FilterTerm){if(p===r[i].getProperty()){t.push(r[i]);}}else{t=t.concat(r[i].getFilterTermsForProperty(p));}}return t;};this.getFilterTerms=function(){var t=[];var i;if(l===undefined){return t;}if(l instanceof sap.apf.core.utils.Filter){t=l.getFilterTerms();}else{t.push(l);}for(i=0;i<r.length;i++){if(r[i]instanceof sap.apf.core.utils.FilterTerm){t.push(r[i]);}else{t=t.concat(r[i].getFilterTerms());}}return t;};function h(i,p){if(i instanceof sap.apf.core.utils.FilterTerm){return i.getProperty()===p;}return i.getProperties().indexOf(p)>=0;}this.isConsistentWithFilter=function(p,v){var i;var j=false;if(l===undefined){return true;}if(g===undefined){return l.isConsistentWithFilter(p,v);}if(g===sap.apf.core.constants.BooleFilterOperators.AND){if(!l.isConsistentWithFilter(p,v)){return false;}for(i=0;i<r.length;i++){if(!r[i].isConsistentWithFilter(p,v)){return false;}}return true;}if(g===sap.apf.core.constants.BooleFilterOperators.OR){if(h(l,p)){j=true;if(l.isConsistentWithFilter(p,v)){return true;}}for(i=0;i<r.length;i++){if(h(r[i],p)){j=true;if(r[i].isConsistentWithFilter(p,v)){return true;}}}return!j;}};this.removeTermsByProperty=function(p){var i,R,o;if(l===undefined){return this.copy();}R=l.removeTermsByProperty(p);if(R instanceof sap.apf.core.utils.FilterTerm){R=new sap.apf.core.utils.Filter(m,R.getProperty(),R.getOp(),R.getValue(),R.getHighValue());}if(g===undefined){return R;}for(i=0;i<r.length;i++){o=r[i].removeTermsByProperty(p);if(R===undefined){if(o instanceof sap.apf.core.utils.FilterTerm){R=new sap.apf.core.utils.Filter(m,o);}else{R=o;}}else if(o!==undefined){if(g===sap.apf.core.constants.BooleFilterOperators.AND){R.addAnd(o);}else{R.addOr(o);}}}if(R){return new sap.apf.core.utils.Filter(m,R);}};this.removeTerms=function(p,o,v){var i;if(l===undefined){return this.copy();}var F=l.removeTerms(p,o,v);var j;if(F instanceof sap.apf.core.utils.FilterTerm){F=new sap.apf.core.utils.Filter(m,F.getProperty(),F.getOp(),F.getValue(),F.getHighValue());}if(g===undefined){return F;}for(i=0;i<r.length;i++){j=r[i].removeTerms(p,o,v);if(F===undefined){if(j instanceof sap.apf.core.utils.FilterTerm){F=new sap.apf.core.utils.Filter(m,j);}else{F=j;}}else if(j!==undefined){if(g===sap.apf.core.constants.BooleFilterOperators.AND){F.addAnd(j);}else{F.addOr(j);}}}return F;};this.addOr=function(a,b,c,d){var F;if(a instanceof sap.apf.core.utils.Filter||a instanceof sap.apf.core.utils.FilterTerm){F=a;}else if(a!==undefined&&b!==undefined&&c!==undefined){F=new sap.apf.core.utils.FilterTerm(m,a,b,c,d);}else{m.check(false,"sap.apf.core.utils.Filter.addOr: wrong arguments in construction of  Filter");}if(l===undefined){l=F;return this;}if(g===undefined){g=sap.apf.core.constants.BooleFilterOperators.OR;}r.push(F);m.check(g===sap.apf.core.constants.BooleFilterOperators.OR,"sap.apf.core.utils.Filter - addOr wrong operation");return this;};this.addAnd=function(a,b,c,d){var F;if(a instanceof sap.apf.core.utils.Filter||a instanceof sap.apf.core.utils.FilterTerm){F=a;}else if(a!==undefined&&b!==undefined&&c!==undefined){F=new sap.apf.core.utils.FilterTerm(m,a,b,c,d);}else{m.check(false,"sap.apf.core.utils.Filter.addAnd: wrong arguments in construction of  Filter");}if(l===undefined){l=F;return this;}if(g===undefined){g=sap.apf.core.constants.BooleFilterOperators.AND;}m.check(g===sap.apf.core.constants.BooleFilterOperators.AND,"sap.apf.core.utils.Filter - addAnd wrong operation");r.push(F);return this;};this.toUrlParam=function(j){var A=false;var p=[];var E="";if(j!==undefined&&j.asFilterArray===true){A=true;}if(l===undefined){if(A===true){return[];}return"";}if(A===true){p=l.toUrlParam(j);}else{E=l.toUrlParam(j);}var i=0;var k=r.length;var C="";if(k===0){if(A===true){return p;}return E;}if(g===sap.apf.core.constants.BooleFilterOperators.AND){C=e;}else{C=f;}var R="";if(A===true){for(i=0;i<k;i++){p=p.concat(r[i].toUrlParam(j));}return p;}for(i=0;i<k;i++){R=r[i].toUrlParam(j);if(E===""){E=R;}else if(R!==""){E=E+C+R;}}return'('+E+')';};this.mapToSapUI5FilterExpression=function(){var i,j,F=[];if(l===undefined){return{};}if(r.length===0){return l.mapToSapUI5FilterExpression();}F.push(l.mapToSapUI5FilterExpression());for(i=0;i<r.length;i++){F.push(r[i].mapToSapUI5FilterExpression());}j={filters:F,and:g===sap.apf.core.constants.BooleFilterOperators.AND};return j;};this.overwriteWith=function(F){var p=F.getProperties();var R;if(p.length!==0){R=this.removeTermsByProperty(p);if(R===undefined){return F.copy();}R.addAnd(F);return R;}return this.copy();};this.reduceToProperty=function(){var p=[];var P;switch(arguments.length){case 1:P=arguments[0];if(P instanceof Array){p=P;}else{p.push(P);}break;default:p=Array.prototype.slice.call(arguments,0);}var F=s(this.getProperties(),p);return this.copy().removeTermsByProperty(F)||new sap.apf.core.utils.Filter(m);function s(S,j){var i;var k=[];var n={};var o=S?S.length:0;var q=j?j.length:0;for(i=0;i<q;i++){n[j[i]]=undefined;}for(i=0;i<o;i++){if(!(S[i]in n)){k.push(S[i]);}}return k;}};this.isFilterTerm=function(){if(r.length>0){return false;}if(!l){return false;}if(l instanceof sap.apf.core.utils.FilterTerm){return true;}return l.isFilterTerm();};this.traverse=function(v){if(!l){return v.processEmptyFilter();}if(l&&r.length===0){if(l instanceof sap.apf.core.utils.FilterTerm){return v.processTerm(l);}return l.traverse(v);}if(g===sap.apf.core.constants.BooleFilterOperators.AND){return v.processAnd(l,r,this);}if(g===sap.apf.core.constants.BooleFilterOperators.OR){return v.processOr(l,r,this);}m.check(false,'undefined case in traverse()');return false;};this.isDisjunctionOverEqualities=function(){var i=true;if(g===sap.apf.core.constants.BooleFilterOperators.AND){return false;}if(this.getProperties().length>1){return false;}if(l instanceof sap.apf.core.utils.Filter){if(l.getFilterTerms().length>1){return false;}}this.getFilterTerms().forEach(function(j){if(j.getOp()!==sap.apf.core.constants.FilterOperators.EQ){i=false;}});r.forEach(function(j){if(j instanceof sap.apf.core.utils.Filter){if(j.getFilterTerms().length>1){i=false;}}});return i;};};sap.apf.core.utils.Filter.createFromArray=function(m,p,d,I){var l=p.length;var i;var n;var j;var f;var F;var o;m.check(p instanceof Array&&p.length>0,"sap.apf.core.utils.Filter.createFromArray incorrect argument aProperties");m.check(d instanceof Array,"sap.apf.core.utils.Filter.createFromArray incorrect argument aData");if(I.length>0){for(i=0;i<I.length;++i){F=undefined;n=I[i];if(!d[n]){continue;}for(j=0;j<l;j++){o=new sap.apf.core.utils.Filter(m,p[j],sap.apf.core.constants.FilterOperators.EQ,d[n][p[j]]);if(F===undefined){F=new sap.apf.core.utils.Filter(m,o);}else{F.addAnd(o);}}if(f===undefined){f=new sap.apf.core.utils.Filter(m,F);}else{f.addOr(F);}}return f;}return new sap.apf.core.utils.Filter(m);};sap.apf.core.utils.Filter.createEmptyFilter=function(m,p){m.check(jQuery.isArray(p)&&p.length>0,"sap.apf.core.utils.Filter.createEmptyFilter - array with property names expected");return new sap.apf.core.utils.Filter(m,p[0],sap.apf.core.constants.FilterOperators.EQ,'').addAnd(p[0],sap.apf.core.constants.FilterOperators.NE,'');};sap.apf.core.utils.Filter.transformUI5FilterToInternal=function(m,u){return t(u,u.and);function t(u,a){var r=new sap.apf.core.utils.Filter(m);var s;if(u.filters){u.filters.forEach(function(f){if(f.filters){s=t(f,f.and);if(a){r.addAnd(s);}else{r.addOr(s);}}else if(f.path){if(a){r.addAnd(f.path,f.operator,f.value1,f.value2);}else{r.addOr(f.path,f.operator,f.value1,f.value2);}}});}else{r=new sap.apf.core.utils.Filter(m,u.path,u.operator,u.value1,u.value2);}return r;}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.utils.filterSimplify')){
/*
 * Created by d025375 on 24.05.2015.
 * Copyright(c) 2015 SAP SE
 */
jQuery.sap.declare('sap.apf.core.utils.filterSimplify');(function(){'use strict';sap.apf.core.utils.CollectPropertiesAndValuesVisitor=function(){var t=this;var p=[];var v=[];var a=true;var b=true;var n=0;var c=0;var d=0;var e=0;function f(g){var i,l=p.length;for(i=0;i<l;i++){if(p[i]===g){return;}}p.push(g);}this.getProperties=function(){return p.slice(0);};this.getValues=function(){return v.slice(0);};this.isWellFormed=function(){return a&&b&&p.length<=1;};this.isEmptyFilter=function(){return n===0&&c===0&&d>0&&e===0;};this.processEmptyFilter=function(){d++;};this.processAnd=function(g,F){n++;b=false;this.process(g);this.processAndArray(F);};this.processAndArray=function(F){F.forEach(function(g){t.process(g);});};this.processOr=function(g,F){c++;this.process(g);this.processOrArray(F);};this.processOrArray=function(F){F.forEach(function(g){t.process(g);});};this.processTerm=function(g){e++;var h=g.getProperty();f(h);switch(g.getOp()){case sap.apf.core.constants.FilterOperators.EQ:v.push(g.getValue());return;default:a=false;return;}};this.process=function(g){if(g instanceof sap.apf.core.utils.FilterTerm){this.processTerm(g);}else{g.traverse(this);}};};sap.apf.core.utils.CollectChildrenOfAndNodeVisitor=function(){this.processEmptyFilter=function(){return null;};this.processTerm=function(t){return[t];};this.processAnd=function(f,F){var r=[];r.push(f);F.forEach(function(a){r.push(a);});return r;};this.processOr=function(){return null;};this.process=function(f){if(f instanceof sap.apf.core.utils.FilterTerm){this.processTerm(f);}else{return f.traverse(this);}};};sap.apf.core.utils.FilterReduction=function(){var t=this;this.transformFilter=function(f){var T=[];var p;var c;if(f){f.forEach(function(a){if(a instanceof sap.apf.core.utils.FilterTerm){T.push({property:a.getProperty(),values:[a.getValue()]});}else if(a instanceof sap.apf.core.utils.Filter){p=a.getProperties();c=new sap.apf.core.utils.CollectPropertiesAndValuesVisitor();c.process(a);T.push({property:p[0],values:c.getValues()});}});}return T;};this.intersection=function(a,b){var r={};var l=a.values;var c=b.values;var d=[];var e={};var i,f=l.length;var j,g=c.length;for(i=0;i<f;i++){e[l[i]]=l[i];}for(j=0;j<g;j++){if(e[c[j]]!==undefined&&d.indexOf(c[j])<0){d.push(c[j]);}}r.property=a.property;r.values=d;return r;};function F(m){this.reducers=[];this.disjunctions=[];this.processTerm=function(a){var w=new sap.apf.core.utils.Filter(m,a);if(a.getOp()===sap.apf.core.constants.FilterOperators.EQ){this.disjunctions.push(w);}else{this.reducers.push(w);}};this.processOr=function(l,f,o){var i=new sap.apf.core.utils.CollectPropertiesAndValuesVisitor();i.process(o);if(i.isWellFormed()){this.disjunctions.push(o);}else{this.reducers.push(o);}};this.processAnd=function(l,f,a){var s=t.filterSeparation(a,m);this.disjunctions=this.disjunctions.concat(s.disjunctions);this.reducers=this.reducers.concat(s.reducers);};this.processEmptyFilter=function(){};this.process=function(a){a.traverse(this);};}this.filterSeparation=function(f,m){var c=new sap.apf.core.utils.CollectChildrenOfAndNodeVisitor();var a=c.process(f);var v;if(!a){return{reducers:[],disjunctions:[]};}v=new F(m);a.forEach(function(e){e.traverse(v);});return{reducers:v.reducers,disjunctions:v.disjunctions};};this.simplifyTransforms=function(T){var s=[];var r;var p=[];var l=T.length;var n;T.forEach(function(a,i){var j;n=a.property;if(p.indexOf(n)===-1){p.push(n);r=a;for(j=i+1;j<l;++j){if(n===T[j].property){r=t.intersection(r,T[j]);}}s.push(r);}});return s;};this.applyStartFilter=function(s,T){var r=[];var p=s.getProperties();T.forEach(function(a){var R=[];var j;var l=a.values.length;var v;if(p.indexOf(a.property)>-1){for(j=0;j<l;j++){v=a.values[j];if(s.isConsistentWithFilter(a.property,v)){R.push(v);}}r.push({property:a.property,values:R});}else{r.push(a);}});return r;};this.simplifyInStartFilter=function(s,T){var r=s;T.forEach(function(a){if(r){r=r.removeTermsByProperty(a.property);}});return r;};this.containsContradiction=function(m,T){var i=false;T.forEach(function(a){if(a.values.length===0){i=true;}});if(i){return i;}return i;};this.rebuildDisjunction=function(m,a){var r=new sap.apf.core.utils.Filter(m);var p=a.property;var v=a.values;v.forEach(function(b){var f=new sap.apf.core.utils.FilterTerm(m,p,sap.apf.core.constants.FilterOperators.EQ,b);r.addOr(f);});return r;};this.filterReduction=function(m,f){var c=this;function a(R){var g=[];R.forEach(function(h){g.push(t.rebuildDisjunction(m,h));});return g;}function b(g,h){h.forEach(function(i){g.addAnd(i);});}function d(g,h){var i;var R=h;var j=[];var k;for(i=0;i<g.length;++i){R=c.applyStartFilter(g[i],h);if(c.containsContradiction(m,R)){return{contradiction:f};}k=c.simplifyInStartFilter(g[i],h);if(k){j.push(k);}}return{reducedTransforms:R,simplifiedReducers:j};}var s;var D;var T;var S;var r;var e;if(f.isFilterTerm()||f.isOr()||f.isEmpty()){return f;}s=this.filterSeparation(f,m);D=s.disjunctions;T=this.transformFilter(D);S=this.simplifyTransforms(T);if(this.containsContradiction(m,S)){return f;}e=d(s.reducers,S);if(e.contradiction){return e.contradiction;}r=new sap.apf.core.utils.Filter(m);b(r,e.simplifiedReducers);b(r,a(e.reducedTransforms));return r;};};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.textPool')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.modeler.core.textPool");jQuery.sap.require('sap.ui.core.format.DateFormat');(function(){'use strict';sap.apf.modeler.core.TextPool=function(a,b,e){var m=a.instance.messageHandler;var p=a.instance.persistenceProxy;var H=a.constructor.hashtable;var h=new H(m);var k=new H(m);var g=new H(m);var c=0;var d={TextElement:sap.apf.core.constants.textKeyForInitialText,Language:sap.apf.core.constants.developmentLanguage,TextElementType:"XFLD",TextElementDescription:"",MaximumLength:10,Application:b,TranslationHint:""};function f(t,j){var n=h.getKeys();var i,o=n.length;var q=j.MaximumLength||10;var r=j.TranslationHint||"";var s;for(i=0;i<o;i++){s=h.getItem(n[i]);if((s.TextElementDescription===t)&&(s.MaximumLength===q)&&(s.TranslationHint===r)){return n[i];}}return undefined;}this.removeTexts=function(t,n,o){var q=[];var i,r;function s(u){var j;if(!u){for(j=0;j<r;j++){h.removeItem(t[j]);}}o(u);}r=t.length;if(r===0){o(undefined);return;}for(i=0;i<r;i++){if(t[i]===sap.apf.core.constants.textKeyForInitialText){continue;}q.push({method:"DELETE",entitySetName:"texts",inputParameters:[{name:'TextElement',value:t[i]},{name:'Language',value:sap.apf.core.constants.developmentLanguage}]});}p.doChangeOperationsInBatch(q,s,n);};this.isInitialTextKey=function(t){return(t===sap.apf.core.constants.textKeyForInitialText);};this.addTextsAndSave=function(t,j,n){function o(x,y){return(x.TextElement===y.TextElement&&x.TextElementDescription===y.TextElementDescription&&x.MaximumLength===y.MaximumLength&&x.Language===y.Language&&x.TranslationHint===y.TranslationHint);}var i;var q=t.length;var r;var s=[];var u=[];var v=[];var w;for(i=0;i<q;i++){if(t[i]===sap.apf.core.constants.textKeyForInitialText){continue;}r=h.getItem(t[i].TextElement);if(r){if(!o(r,t[i])){s.push(t[i]);h.setItem(t[i].TextElement,t[i]);}}else{u.push(t[i]);h.setItem(t[i].TextElement,t[i]);}}q=s.length;for(i=0;i<q;i++){w=[{name:'TextElement',value:s[i].TextElement},{name:'Language',value:s[i].Language}];s[i].MaximumLength=parseInt(s[i].MaximumLength,10);v.push({method:"PUT",entitySetName:"texts",data:s[i],inputParameters:w});}q=u.length;for(i=0;i<q;i++){u[i].MaximumLength=parseInt(u[i].MaximumLength,10);v.push({method:"POST",entitySetName:"texts",data:u[i]});}if(v.length>0){p.doChangeOperationsInBatch(v,j,n);}else{j(undefined);}};this.exportTexts=function(){var t=sap.apf.utils.renderHeaderOfTextPropertyFile(b,m);return t+sap.apf.utils.renderTextEntries(h,m);};this.get=function(i){var j,n;if(i===sap.apf.core.constants.textKeyForInitialText){return d;}if(h.hasItem(i)){return h.getItem(i);}if(k.hasItem(i)){j=k.getItem(i);if(j.TextElementDescription){return j;}return h.getItem(j);}n=jQuery.extend({},true,d);n.TextElement=i;n.TextElementDescription=i;return n;};this.getPersistentKey=function(i){return i;};this.setText=function(t,i){var j;var u=function(o,q,r){if(r){m.putMessage(r);}if(o){h.setItem(o.TextElement,o);j=o.TextElement;}};var n={TextElement:"",Language:sap.apf.core.constants.developmentLanguage,TextElementType:i.TextElementType,TextElementDescription:t,MaximumLength:i.MaximumLength||10,Application:b,TranslationHint:i.TranslationHint||""};if(!t){return sap.apf.core.constants.textKeyForInitialText;}j=f(t,i);if(j){return j;}c++;p.create('texts',n,u,false);return j;};this.getTextKeys=function(t){var j=h.getKeys();var i,n,o=j.length;var q=[];for(i=0;i<o;i++){n=h.getItem(j[i]);if(t&&n.TextElementType!==t){continue;}if(g.hasItem(j[i])){q.push(g.getItem(j[i]));}else{q.push(j[i]);}}return q;};this.getTextsByTypeAndLength=function(t,j){var n=h.getKeys();var i,o,q=n.length;var r=[];for(i=0;i<q;i++){o=h.getItem(n[i]);if(o.TextElementType===t&&o.MaximumLength===j){if(g.hasItem(n[i])){r.push({TextElement:g.getItem(n[i]),TextElementDescription:o.TextElementDescription});}else{r.push({TextElement:n[i],TextElementDescription:o.TextElementDescription});}}}return r;};function l(){var i,j;j=e.length;for(i=0;i<j;i++){if(e[i].TextElement){h.setItem(e[i].TextElement,e[i]);}}}l();};}());};if(!jQuery.sap.isDeclared('sap.apf.modeler.ui.controller.configurationList.controller')){jQuery.sap.declare('sap.apf.modeler.ui.controller.configurationList.controller');sap.ui.controller("sap.apf.modeler.ui.controller.configurationList",{onInit:function(){var c=this.getOwnerComponent();if(c!==undefined){this.oCoreApi=c.oCoreApi;this._setDisplayText();}this._instantiateToolbarView();this._instantiateAPFTree();this._instantiateTitleAndBreadCrumbView();this._addConfigStyleClass();this.oModel=new sap.ui.model.json.JSONModel({aConfigDetails:[]});this.getView().setModel(this.oModel);this.bProgramaticSelection=false;sap.apf.modeler.ui.utils.APFRouter.patternMatch(this);},_instantiateToolbarView:function(){var t=new sap.ui.view({viewName:"sap.apf.modeler.ui.view.toolbar",type:"XML",viewData:{oConfigListInstance:this}});this.toolbarController=t.getController();this.byId("idConfigMasterData").insertItem(t,0);},_instantiateAPFTree:function(){this.oTreeInstance=this.byId("idConfigTree");this.oTreeInstance.setTranslationFunction(this.oCoreApi.getText);var d;if(this.oCoreApi.getRepresentationTypes()[0].metadata){d=this.oCoreApi.getRepresentationTypes()[0].id;}this.oTreeInstance.setDefaultRepresentationType(d);},_instantiateTitleAndBreadCrumbView:function(){this.oTitleBreadCrumbView=new sap.ui.view({viewName:"sap.apf.modeler.ui.view.titleBreadCrumb",type:"XML",viewData:{getText:this.oCoreApi.getText}});this.oTitleBreadCrumbController=this.oTitleBreadCrumbView.getController();this.byId("idConfigDetail").insertItem(this.oTitleBreadCrumbView,0);this.oBreadCrumb=this.oTitleBreadCrumbView.byId("IdBreadCrumb");},setConfigListMasterTitle:function(t){this.byId("idConfigTitleMaster").setText(this.oCoreApi.getText("configurationObjectTitle")+" : "+t);},onAfterRendering:function(){var s=this;this.oTreeInstance.onAfterRendering=function(){s._setHeightForTree();};},_setHeightForTree:function(){var v=this;var t=this.oTreeInstance;var w=jQuery(v.byId("idConfigMasterData").getDomRef()).width();var h=jQuery(window).height();var a=100;var b=jQuery(v.byId("idConfigMasterData").getItems()[0].getDomRef()).height();var c=jQuery(v.byId("configPage").getDomRef()).find("header").height();var f=jQuery(v.byId("configPage").getDomRef()).find("footer").height();var o;if(b>0){o=a+b+c+f;}else{o=205;}t.setHeight(h-o+"px");t.setWidth(w+"px");sap.apf.modeler.ui.utils.helper.onResize(function(){w=jQuery(v.byId("idConfigMasterData").getDomRef()).width();h=jQuery(v.byId("configPage").getDomRef()).height();t.setHeight(h-o+"px");t.setWidth(w+"px");});},_setDisplayText:function(){this.byId("configPage").setTitle(this.oCoreApi.getText("configModelerTitle"));this.byId("idSavebutton").setText(this.oCoreApi.getText("save"));this.byId("idCancelbutton").setText(this.oCoreApi.getText("cancel"));this.byId("idExportbutton").setText(this.oCoreApi.getText("export"));},_addConfigStyleClass:function(){this.getView().addStyleClass("sapUiSizeCompact");this.byId("idConfigTree").addStyleClass("configTree");this.byId("idConfigTitleMaster").addStyleClass("configTitle");this.byId("idConfigMasterData").addStyleClass("configMasterData");this.byId("idConfigDetailData").addStyleClass("configDetailData");},_setSubViewContainerHeight:function(s){var S=this;var a=s.getContent()[0].getItems()[0];var h=jQuery(window).height();var t=jQuery(this.byId("idConfigTitleMaster").getDomRef()).outerHeight()+jQuery(this.byId("idConfigTitleMaster").getDomRef()).offset().top+25;var b=jQuery(this.byId("idConfigMasterData").getItems()[0].getDomRef()).height();var c=jQuery(this.byId("configPage").getDomRef()).find("header").height();var f=jQuery(this.byId("configPage").getDomRef()).find("footer").height();var o,d;if(b>0){o=t+b+c+f;}else{o=265;}var e=h-o+"px";a.setHeight(e);var g=jQuery(this.byId("idConfigDetailData").getDomRef()).width();if(g>0){d=jQuery(this.byId("idConfigMasterData").getDomRef()).offset().left;}else{g=1015;d=15;}var i=g-d;var j=i+"px";a.setWidth(j);sap.apf.modeler.ui.utils.helper.onResize(function(){h=jQuery(S.byId("configPage").getDomRef()).height();e=h-o+"px";a.setHeight(e);g=jQuery(S.byId("idConfigDetailData").getDomRef()).width();i=g-d;j=i+"px";a.setWidth(j);});},_setSubView:function(s){this.oSubView=s;},_getSubView:function(){return this.oSubView;},updateSubView:function(p){var s=this;var P=this._getSubView();var d=this.byId("idConfigDetailData");var v=this.getSPathFromURL(p);if(P){P.destroy();}var S=new sap.ui.view({viewName:"sap.apf.modeler.ui.view."+v.objectType,type:"XML",viewData:{oParams:p,updateConfigTree:s.updateConfigTree.bind(s),updateSelectedNode:s.updateSelectedNode.bind(s),updateTitleAndBreadCrumb:s.updateTitleAndBreadCrumb.bind(s),updateTree:s.updateTree.bind(s),oConfigurationHandler:s.configurationHandler,oApplicationHandler:s.applicationHandler,oConfigurationEditor:s.configEditor,getText:s.oCoreApi.getText,getEntityTypeMetadata:s.oCoreApi.getEntityTypeMetadata,getRepresentationTypes:s.oCoreApi.getRepresentationTypes,oFooter:s.byId("idFooterBarMain"),createMessageObject:s.oCoreApi.createMessageObject,putMessage:s.oCoreApi.putMessage,getAllAvailableSemanticObjects:s.oCoreApi.getAllAvailableSemanticObjects,getSemanticActions:s.oCoreApi.getSemanticActions,getNavigationTargetName:s._getNavigationTargetName.bind(s),setNavigationTargetName:s._setNavigationTargetName.bind(s)}});if(p.name!=="applicationList"){d.removeAllContent();S.placeAt(d);this._setSubViewContainerHeight(S);this._setSubView(S);}},clearTitleAndBreadCrumb:function(){this.oTitleBreadCrumbView.byId("IdFormTitle").setText("");this.oTitleBreadCrumbView.byId("IdBreadCrumb").removeAllContent();},_createLinkForBreadCrumb:function(n,p){var s=this;var l=new sap.m.Link({text:n,press:function(){s._navigateToNode(p);}});return l;},_createTextForBreadCrumb:function(v){var l=new sap.m.Label();l.addStyleClass("dialogText");l.setText(v);return l;},_createIconForBreadCrumb:function(){var b=new sap.ui.core.Icon({src:"sap-icon://open-command-field"});b.addStyleClass("breadCrumbIcon");return b;},_navigateToNode:function(p){var n=this.oTreeInstance.getNodeByContext(p);this.oTreeInstance.setSelection(n);},_getAllPossibleNodes:function(p){var n=[];if(p.configurationId){n.push({id:p.configurationId,name:p.configurationName,oParams:{arguments:{configId:p.configurationId}}});}if(p.facetFilterId){n.push({id:p.facetFilterId,name:p.facetFilterName,oParams:{arguments:{configId:p.configurationId,facetFilterId:p.facetFilterId}}});}if(p.categoryId){n.push({id:p.categoryId,name:p.categoryName,oParams:{arguments:{configId:p.configurationId,categoryId:p.categoryId}}});}if(p.stepId){n.push({id:p.stepId,name:p.stepName,oParams:{arguments:{configId:p.configurationId,categoryId:p.categoryId,stepId:p.stepId}}});}if(p.representationId){n.push({id:p.representationId,name:p.representationName,oParams:{arguments:{configId:p.configurationId,categoryId:p.categoryId,stepId:p.stepId,representationId:p.representationId}}});}if(p.navTargetId){n.push({id:p.navTargetId,name:p.navTargetName,oParams:{arguments:{configId:p.configurationId,navTargetId:p.navTargetId}}});}return n;},_breadCrumbCreation:function(s,t){for(var i=0;i<s.length;i++){var p=this.getSPathFromURL(s[i].oParams).sPath;var l;if(i===1){l=this._createTextForBreadCrumb(t);this.oBreadCrumb.addContent(l);var I=this._createIconForBreadCrumb();this.oBreadCrumb.addContent(I);}if(i!==s.length-1){var L=this._createLinkForBreadCrumb(s[i].name,p);this.oBreadCrumb.addContent(L);var o=this._createIconForBreadCrumb();this.oBreadCrumb.addContent(o);}else{l=this._createTextForBreadCrumb(s[i].name);this.oBreadCrumb.addContent(l);}}},updateTitleAndBreadCrumb:function(t){var f;var s=this.oTreeInstance.getSelection();var S=s?this.oTreeInstance.getAPFTreeNodeContext(s):undefined;var n=S?S.nodeObjectType:undefined;var p=S?this.oTreeInstance.getParentNodeContext(S):undefined;if(t){f=t;}else{if(n){var a=s.getText();f=this.oCoreApi.getText(n)+": "+a;}}if(p){if(this.oBreadCrumb){this.oBreadCrumb.removeAllContent();}var o=this._getAllPossibleNodes(p);var T;switch(n){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION:this._breadCrumbCreation(o);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:T=this.oCoreApi.getText("facetFilter");this._breadCrumbCreation(o,T);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:T=this.oCoreApi.getText("category");this._breadCrumbCreation(o,T);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:T=this.oCoreApi.getText("category");this._breadCrumbCreation(o,T);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:T=this.oCoreApi.getText("category");this._breadCrumbCreation(o,T);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:T=this.oCoreApi.getText("navigationTarget");this._breadCrumbCreation(o,T);break;default:break;}}this.oTitleBreadCrumbController.setTitleAndBreadCrumb(f);},setSelectionOnTree:function(b){this.toolbarController.enableCopyDeleteButton();this._enableExportButton();this.oTreeInstance.setSelectionOnTree(b);},removeSelectionOnTree:function(){this.oTreeInstance.removeSelectionOnTree(this.selectedNode);},updateConfigTree:function(o){var a,n,O,i,b,c,d,e,f;var s=this;o.forEach(function(S){var h;a=s.getSPathFromURL(S.oldContext).sPath;O=a.split("/");i=O[2];b=O[6];d=O[8];e=jQuery.extend(true,{},s.oModel.getData().aConfigDetails[i].configData[1].categories[b].steps[d]);f=e.id;e.isSelected=false;n=s.getSPathFromURL(S.newContext).sPath;c=n.split("/")[6];if(S.removeStep===undefined){if(s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps){s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps.forEach(function(p){if(p.id===f){h=true;}});if(h===undefined){s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps.push(e);}}else{s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps=[];s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps.push(e);}}else if(S.removeStep===true){if(s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps){s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps.forEach(function(p,q){if(p.id===f){var r=s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps;r.splice(q,1);s.oModel.getData().aConfigDetails[i].configData[1].categories[c].steps=r;}});if(S.changeCategory===true){var j=s.getSPathFromURL(S.categoryChangeContext).sPath;var k=j.split("/");i=k[2];var l=k[6];var m=k[8];s.oModel.getData().aConfigDetails[i].configData[1].categories[l].steps[m].isSelected=true;s.oModel.getData().aConfigDetails[i].configData[1].categories[l].expanded=true;}}}});this.oModel.updateBindings();var g=o.length;if(o[g-1].changeCategory){sap.ui.core.UIComponent.getRouterFor(this).navTo(o[g-1].oldContext.name,o[g-1].categoryChangeContext.arguments,true);}this.configEditor.setIsUnsaved();},updateSelectedNode:function(p,c){if(p){if(this.oTreeInstance.getSelection()){this.selectedNode=this.oTreeInstance.getSelection();}if(this.selectedNode){if(p.name&&this.selectedNode.getBindingContext()&&this.selectedNode.getBindingContext().getObject()){this.selectedNode.getBindingContext().getObject().name=p.name;this.selectedNode.getBindingContext().getObject().isSelected=true;if(this.selectedNode.getBindingContext().getObject().type===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION||this.selectedNode.getBindingContext().getObject().type===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET){this.selectedNode.getBindingContext().getObject().icon=p.icon;}this.oModel.updateBindings();}if(p.id&&this.selectedNode.getBindingContext().getObject().id){this.selectedNode.getBindingContext().getObject().id=p.id;if(p.icon){this.selectedNode.getBindingContext().getObject().icon=p.icon;}}else if(p.id&&this.selectedNode.getBindingContext().getObject().AnalyticalConfiguration){this.selectedNode.getBindingContext().getObject().AnalyticalConfiguration=p.id;this.selectedNode.getBindingContext().getObject().expanded=true;}}if((this.selectedNode.getBindingContext().getObject().type===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION)&&c){sap.ui.core.UIComponent.getRouterFor(this).navTo(this.selectedNode.getBindingContext().getObject().type,c,true);}}},createConfigList:function(){var s=this;this.modelUpdateDeferred={};this.configList=this.configurationHandler.getList();this.configList.forEach(function(c,i){var C={};C.AnalyticalConfiguration=c.AnalyticalConfiguration;C.name=c.AnalyticalConfigurationName;C.Application=c.Application;C.type=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION;C.bIsLoaded=false;C.bToggleState=false;C.isSelected=false;C.expanded=false;C.selectable=true;C.hasExpander=true;s.oModel.getData().aConfigDetails.push(C);s.modelUpdateDeferred[i]=new jQuery.Deferred();});this.oModel.updateBindings();},showNoConfigSelectedText:function(){this.byId("idConfigDetailData").removeAllContent();this.clearTitleAndBreadCrumb();var n=new sap.m.Label().addStyleClass("noConfigSelected");n.setText(this.oCoreApi.getText("noConfigSelected"));n.placeAt(this.byId("idConfigDetailData"));this.toolbarController.disableCopyDeleteButton();this.disableExportButton();},updateConfigListView:function(){this.selectedNode=this.oTreeInstance.getSelection();if(this.selectedNode===null){if(this.configList.length>1){this.showNoConfigSelectedText();}else{this.oModel.getData().aConfigDetails[0].isSelected=true;this.oModel.getData().aConfigDetails[0].expanded=true;this.configId=this.oModel.getData().aConfigDetails[0].AnalyticalConfiguration;this.oModel.updateBindings();var c={appId:this.appId,configId:this.oModel.getData().aConfigDetails[0].AnalyticalConfiguration};this.selectedNode=this.oTreeInstance.getNodes()[0];this.toolbarController.enableCopyDeleteButton();this._enableExportButton();sap.ui.core.UIComponent.getRouterFor(this).navTo(this.oModel.getData().aConfigDetails[0].type,c,true);}}},_getNodeData:function(p,t){var c=this.oModel.getData().aConfigDetails;var n={};var g=function(h){var j={};var k=h||this.configId;for(var i=0;i<c.length;i++){if(c[i].AnalyticalConfiguration===k){j.index=i;j.data=c[i];j.id=c[i].AnalyticalConfiguration;break;}}return j;};var a=function(h){var k=g.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]).index;var l={};for(var i=0;i<c[k].configData.length;i++){if(c[k].configData[i].filters instanceof Array){l.indexConfigData=i;for(var j=0;j<c[k].configData[i].filters.length;j++){if(c[k].configData[i].filters[j].id===h){l.index=j;l.data=c[k].configData[i].filters[j];l.id=c[k].configData[i].filters[j].id;l.ffExpansion=c[k].configData[i].expanded;}}}}return l;};var b=function(h){var k=g.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]).index;var l={};for(var i=0;i<c[k].configData.length;i++){if(c[k].configData[i].categories instanceof Array){l.indexConfigData=i;for(var j=0;j<c[k].configData[i].categories.length;j++){if(c[k].configData[i].categories[j].id===h){l.index=j;l.data=c[k].configData[i].categories[j];l.id=c[k].configData[i].categories[j].id;l.categoryExpansion=c[k].configData[i].expanded;}}}}return l;};var d=function(h){var j=g.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]).index;var k=b.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]).indexConfigData;var l=b.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]).index;var m={};for(var i=0;i<c[j].configData[k].categories[l].steps.length;i++){if(c[j].configData[k].categories[l].steps[i].id===h){m.index=i;m.data=c[j].configData[k].categories[l].steps[i];m.id=c[j].configData[k].categories[l].steps[i].id;}}return m;};var e=function(h){var j=g.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]).index;var k=b.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]).indexConfigData;var l=b.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]).index;var m=d.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP]).index;var o={};for(var i=0;i<c[j].configData[k].categories[l].steps[m].representations.length;i++){if(c[j].configData[k].categories[l].steps[m].representations[i].id===h){o.index=i;o.data=c[j].configData[k].categories[l].steps[m].representations[i];o.id=c[j].configData[k].categories[l].steps[m].representations[i].id;}}return o;};var f=function(h){var k=g.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]).index;var l={};for(var i=0;i<c[k].configData.length;i++){if(c[k].configData[i].navTargets instanceof Array){l.indexConfigData=i;for(var j=0;j<c[k].configData[i].navTargets.length;j++){if(c[k].configData[i].navTargets[j].id===h){l.index=j;l.data=c[k].configData[i].navTargets[j];l.id=c[k].configData[i].navTargets[j].id;l.nTExpansion=c[k].configData[i].expanded;}}}}return l;};switch(t){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION:n=g.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:n=a.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER]);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:n=b.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:n=d.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP]);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:n=e.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION]);break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:n=f.call(this,p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET]);break;default:break;}return n;},_retainNodeState:function(p,t){var c=this._getNodeData(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION).index;if(!this.oModel.getData().aConfigDetails[c].bIsLoaded){return{};}var n=this._getNodeData(p,t);if(!n.data){return{};}return{expanded:n.data.expanded,isSelected:n.data.isSelected};},updateTree:function(){var s=this;var c=[],f=[],n=[],C=[],a=[],b=[];this.oTextPool=this.configurationHandler.getTextPool();var p={};p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION]=this.configId;var d=s._getNodeData(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION).index;var e=this.configId;var F=false;var g=false;var h=false;c=this.configEditor.getCategories();f=this.configEditor.getFacetFilters();n=this.configEditor.getNavigationTargets();var r=this.oCoreApi.getRepresentationTypes();var R={};r.forEach(function(o){var i=o.id;R[i]=o.picture;});c.forEach(function(i){p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]=i.getId();var o=i;var j=o.getId();b=[];s.configEditor.getCategoryStepAssignments(j).forEach(function(S){var v=s.configEditor.getStep(S);p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY]=j;p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP]=v.getId();var w=s._retainNodeState(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP);var x=v.getRepresentations();var y=x.map(function(z){p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION]=z.getId();var A=s._retainNodeState(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION);return{id:z.getId(),name:s.oCoreApi.getText(z.getRepresentationType()),type:"representation",isSelected:A.isSelected||false,expanded:A.expanded||false,selectable:true,icon:R[z.getRepresentationType()]};});b.push({id:v.getId(),name:s.oTextPool.get(v.getTitleId())?s.oTextPool.get(v.getTitleId()).TextElementDescription:v.getTitleId(),type:"step",representations:y,isSelected:w.isSelected||false,expanded:w.expanded||false,selectable:true,icon:"sap-icon://BusinessSuiteInAppSymbols/icon-phase"});});var q=s._retainNodeState(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY);if(s.oModel.getData().aConfigDetails[d].bIsLoaded){var t=s._getNodeData(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY);if(t.categoryExpansion){h=true;}}C.push({id:i.getId(),name:s.oTextPool.get(i.labelKey)?s.oTextPool.get(i.labelKey).TextElementDescription:i.labelKey,type:"category",steps:b,isSelected:q.isSelected||false,expanded:q.expanded||false,selectable:true,icon:"sap-icon://open-folder"});});var k=[];f.forEach(function(o){p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER]=o.getId();var i=s._retainNodeState(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER);if(s.oModel.getData().aConfigDetails[d].bIsLoaded){var j=s._getNodeData(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER);if(j.ffExpansion){F=true;}}k.push({id:o.getId(),name:s.oTextPool.get(o.getLabelKey())?s.oTextPool.get(o.getLabelKey()).TextElementDescription:o.getLabelKey(),type:"facetFilter",isSelected:i.isSelected||false,expanded:i.expanded||false,selectable:true,icon:"sap-icon://filter"});});a.push({filters:k,name:s.oCoreApi.getText("facetFilters"),expanded:F,selectable:false});a.push({categories:C,name:s.oCoreApi.getText("categories"),expanded:h,selectable:false});var N=[];var l=function(S,o){p[sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET]=o.getId();var j=s._retainNodeState(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET);if(s.oModel.getData().aConfigDetails[d].bIsLoaded){var q=s._getNodeData(p,sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET);if(q.nTExpansion){g=true;}}var i,t;for(i=0;i<S.length;i++){if(S[i].id===o.getAction()){t=S[i].text;break;}}N.push({id:o.getId(),name:t||o.getSemanticObject(),type:"navigationTarget",isSelected:j.isSelected||false,expanded:j.expanded||false,selectable:true,icon:o.isStepSpecific()?"sap-icon://pushpin-off":"sap-icon://BusinessSuiteInAppSymbols/icon-where-used"});};var m=function(){var o=n.map(function(q){return q.getId();});var t=[];for(var i=0;i<o.length;i++){for(var j=0;j<N.length;j++){if(o[i]===N[j].id){t[i]=N[j];break;}}}N=t;};var u=function(){var o={};o.configData=a;s.oModel.getData().aConfigDetails[d].bIsLoaded=true;var t=s.oModel.getData().aConfigDetails[d];jQuery.extend(t,o);s.oModel.getData().aConfigDetails[d]=t;s.oModel.getData().aConfigDetails[d].name=s.configurationHandler.getConfiguration(e).AnalyticalConfigurationName;for(var i=0;i<s.oModel.getData().aConfigDetails.length;i++){if(s.modelUpdateDeferred[i]&&s.modelUpdateDeferred[i].state()==="pending"&&n.length===0){s.modelUpdateDeferred[i].resolve(s.oModel.getData());}}if(t.configData[2].navTargets.length>0){s._setNavigationTargetName({configIndexInTree:d});s.modelUpdateDeferred[d].resolve(s.oModel.getData());}s.oModel.updateBindings();};n.forEach(function(o){var P=s.oCoreApi.getSemanticActions(o.getSemanticObject());P.then(function(S){l(S.semanticActions,o);if(N.length===n.length){m();if(a[2]){a.splice(2,2);a.push({navTargets:N,name:s.oCoreApi.getText("navigationTargets"),expanded:g,selectable:false});u();var i=sap.apf.modeler.ui.utils.APFRouter.params;if(i.name==="navigationTarget"){sap.apf.modeler.ui.utils.APFRouter.setCurrentSelectionState(i,s);}}}});});a.push({navTargets:N,name:s.oCoreApi.getText("navigationTargets"),expanded:g,selectable:false});u();},_checkIfKeyExists:function(k,c){var i;if(this.navTargetTextsTable[c]){this.navTargetTextsTable[c].texts.forEach(function(n,a){if(n.key===k){i=a;}});}return i;},_getNavigationTargetName:function(k){var s=this;var v;var n=new jQuery.Deferred();var c=s.getSPathForConfig(s.configId).split('/')[2];if(this.modelUpdateDeferred[c]===undefined){this.modelUpdateDeferred[c]=new jQuery.Deferred();this.modelUpdateDeferred[c].resolve(this.oModel.getData());}jQuery.when(this.modelUpdateDeferred[c]).done(function(m){var i=s._checkIfKeyExists(k,c);if(i!==undefined){v=s.navTargetTextsTable[c].texts[i].value;n.resolve(v);}});return n.promise();},_setNavigationTargetName:function(p){var c=p.configIndexInTree!==undefined?p.configIndexInTree:this.getSPathForConfig(this.configId).split('/')[2];if(jQuery.isEmptyObject(this.navTargetTextsTable)){this.navTargetTextsTable={};}if(!this.navTargetTextsTable[c]){this.navTargetTextsTable[c]={texts:[]};}if(p.key&&p.value){var i=this._checkIfKeyExists(p.key,c);if(i===undefined){var n={};n.key=p.key;n.value=p.value;this.navTargetTextsTable[c].texts.push(n);}else{this.navTargetTextsTable[c].texts[i].value=p.value;}}else{var a=this.oModel.getData().aConfigDetails[c].configData[2].navTargets;for(var b=0;b<a.length;b++){var d={};d.key=a[b].id;d.value=a[b].name;this.navTargetTextsTable[p.configIndexInTree].texts.push(d);}}},_handleToggleTreeNode:function(e){var s=this;var c=e.getSource();c.setExpanded(!c.getExpanded());var p=c.getBindingContext().sPath;var a=c.getBindingContext().getObject().type;if(a===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION){var b=p.split('/')[2];if(s.oModel.getData().aConfigDetails[b].bIsLoaded===true){this.oModel.updateBindings();}else{this.configurationHandler.loadConfiguration(this.oModel.getData().aConfigDetails[b].AnalyticalConfiguration,function(d){s.configEditor=d;s.configId=s.oModel.getData().aConfigDetails[b].AnalyticalConfiguration;s.updateTree();});}}},getSPathForConfig:function(c){var p;this.oModel.getData().aConfigDetails.forEach(function(a,i){if(a.AnalyticalConfiguration===c){p="/aConfigDetails/"+i;}});return p;},getSPathFromURL:function(p){var v={sPath:undefined,objectType:undefined};var s=this;this.oModel.getData().aConfigDetails.forEach(function(c,i){if(c.AnalyticalConfiguration===p.arguments.configId){v.sPath="/aConfigDetails/"+i;v.objectType=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION;s.oModel.getData().aConfigDetails[i].expanded=true;if(p.arguments.categoryId!==undefined){s.oModel.getData().aConfigDetails[i].configData[1].categories.forEach(function(a,b){if(a.id===p.arguments.categoryId){v.sPath=v.sPath.concat("/configData/1/categories/"+b);v.objectType=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY;s.oModel.getData().aConfigDetails[i].configData[1].expanded=true;if(p.arguments.stepId!==undefined){s.oModel.getData().aConfigDetails[i].configData[1].categories[b].steps.forEach(function(d,e){if(d.id===p.arguments.stepId){v.sPath=v.sPath.concat("/steps/"+e);v.objectType=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP;s.oModel.getData().aConfigDetails[i].configData[1].categories[b].expanded=true;if(p.arguments.representationId!==undefined){s.oModel.getData().aConfigDetails[i].configData[1].categories[b].steps[e].representations.forEach(function(r,f){if(r.id===p.arguments.representationId){s.oModel.getData().aConfigDetails[i].configData[1].categories[b].steps[e].expanded=true;v.sPath=v.sPath.concat("/representations/"+f);v.objectType=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION;}});}}});}}});}if(p.arguments.facetFilterId!==undefined){s.oModel.getData().aConfigDetails[i].configData[0].filters.forEach(function(f,a){if(f.id===p.arguments.facetFilterId){v.sPath=v.sPath.concat("/configData/0/filters/"+a);v.objectType=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER;s.oModel.getData().aConfigDetails[i].configData[0].expanded=true;}});}if(p.arguments.navTargetId!==undefined){s.oModel.getData().aConfigDetails[i].configData[2].navTargets.forEach(function(n,a){if(n.id===p.arguments.navTargetId){v.sPath=v.sPath.concat("/configData/2/navTargets/"+a);v.objectType=sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET;s.oModel.getData().aConfigDetails[i].configData[2].expanded=true;}});}}});return v;},_navHandleExpandDelete:function(n,p,a){var s=this;var c=this.oModel.getData().aConfigDetails;var I=a||this.oTreeInstance.isConfigurationSwitched(this.oPreviousSelectedNode,this.selectedNode);var g=function(j){var r;for(var i=0;i<c.length;i++){if(c[i].AnalyticalConfiguration===j){r=i;break;}}return r;};var b=function(r){var h=g.call(this,p.configId);var t,u;for(var i=0;i<c[h].configData.length;i++){if(c[h].configData[i].filters instanceof Array){t=i;for(var j=0;j<c[h].configData[i].filters.length;j++){if(c[h].configData[i].filters[j].id===r){u=j;break;}else{u=j;}}}}return{indexConfig:t,indexFilter:u};};var d=function(r){var h=g.call(this,p.configId);var t,u;for(var i=0;i<c[h].configData.length;i++){if(c[h].configData[i].navTargets instanceof Array){t=i;for(var j=0;j<c[h].configData[i].navTargets.length;j++){if(c[h].configData[i].navTargets[j].id===r){u=j;break;}else{u=j;}}}}return{indexConfig:t,indexNavTarget:u};};var e=function(r){var h=g.call(this,p.configId);var t,u;for(var i=0;i<c[h].configData.length;i++){if(c[h].configData[i].categories instanceof Array){t=i;for(var j=0;j<c[h].configData[i].categories.length;j++){if(c[h].configData[i].categories[j].id===r){u=j;break;}else{u=j;}}}}return{indexConfig:t,indexCategory:u};};var f=function(j){var h=g.call(this,p.configId);var k=e.call(this,p.categoryId).indexConfig;var m=e.call(this,p.categoryId).indexCategory;var r;for(var i=0;i<c[h].configData[k].categories[m].steps.length;i++){if(c[h].configData[k].categories[m].steps[i].id===j){r=i;break;}else{r=i;}}return r;};if(p.configId.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===0&&I){this.configurationHandler.removeConfiguration(p.configId,function(i){var C=s.oModel.getData().aConfigDetails;var h=g.call(s,p.configId);s._deleteConfigNavTargetTexts(h,C.length);C.splice(h,1);s.oModel.getData().aConfigDetails=C;});}else{var h,k,l,m,o,q;switch(n.nodeObjectType){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION:h=g.call(this,p.configId);this.oModel.getData().aConfigDetails[h].isSelected=true;this.oModel.getData().aConfigDetails[h].expanded=true;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:h=g.call(this,p.configId);k=b.call(this,p.facetFilterId).indexConfig;l=b.call(this,p.facetFilterId).indexFilter;this.oModel.getData().aConfigDetails[h].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].filters[l].expanded=true;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:h=g.call(this,p.configId);k=e.call(this,p.categoryId).indexConfig;m=e.call(this,p.categoryId).indexCategory;this.oModel.getData().aConfigDetails[h].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].expanded=true;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:h=g.call(this,p.configId);k=e.call(this,p.categoryId).indexConfig;m=e.call(this,p.categoryId).indexCategory;o=f.call(this,p.stepId);this.oModel.getData().aConfigDetails[h].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].categories[m].expanded=true;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:h=g.call(this,p.configId);k=e.call(this,p.categoryId).indexConfig;m=e.call(this,p.categoryId).indexCategory;o=f.call(this,p.stepId);this.oModel.getData().aConfigDetails[h].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].categories[m].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].categories[m].steps[o].expanded=true;break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:h=g.call(this,p.configId);k=d.call(this,p.navTargetId).indexConfig;q=d.call(this,p.navTargetId).indexNavTarget;this.oModel.getData().aConfigDetails[h].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].expanded=true;this.oModel.getData().aConfigDetails[h].configData[k].navTargets[q].expanded=true;break;default:break;}}this.oModel.updateBindings();},_isNewSubView:function(p){var i=false;if(p.arguments.configId.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===0){i=true;}else{if(p.name===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION){i=(this.configurationHandler.getConfiguration(p.arguments.configId)!==undefined)?false:true;}else if(p.name===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY){i=(this.configEditor.getCategory(p.arguments.categoryId)!==undefined)?false:true;}else if(p.name===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER){i=(this.configEditor.getFacetFilter(p.arguments.facetFilterId)!==undefined)?false:true;}else if(p.name===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP){i=(this.configEditor.getStep(p.arguments.stepId)!==undefined)?false:true;}else if(p.name===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION){i=(this.configEditor.getRepresentation(p.arguments.representationId)!==undefined)?false:true;}else if(p.name===sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET){i=(this.configEditor.getNavigationTarget(p.arguments.navTargetId)!==undefined)?false:true;}}return i;},_getCurrentConfigurationNode:function(){var p=this.oTreeInstance.getNodes();var c=this.configId;for(var i=0;i<p.length;i++){if(c===p[i].getBindingContext().getObject().AnalyticalConfiguration){return p[i];}}return undefined;},_navMandatoryResetState:function(c,a){var s=c;s.bIsSaved=s.configEditor?s.configEditor.isSaved():undefined;var b=(typeof s.byId("idConfigDetailData").getContent()[0].getController==="function")?s.byId("idConfigDetailData").getContent()[0].getController():undefined;var i=this._isNewSubView(b.oViewData.oParams);if(!i){s.updateTree();var d=s.selectedNode.getBindingContext().getObject();if(d){d.isSelected=true;b.oConfigurationEditor=s.configEditor;b.setDetailData.call(b);s.updateTitleAndBreadCrumb();}else{s.oTreeInstance.setSelection(s._getCurrentConfigurationNode());}if(typeof a==="function"){a();}}else{s.handleConfirmDeletion();}return{bIsSaved:s.bIsSaved,isNewView:i};},_navSaveState:function(s){s();},_navConfigResetState:function(c,a){var s=c;var b=(typeof s.byId("idConfigDetailData").getContent()[0].getController==="function")?s.byId("idConfigDetailData").getContent()[0].getController():undefined;var i=this._isNewSubView(b.oViewData.oParams);if(!i){s.configurationHandler.loadConfiguration(s.configId,function(d){var b=(typeof s.byId("idConfigDetailData").getContent()[0].getController==="function")?s.byId("idConfigDetailData").getContent()[0].getController():undefined;s.configEditor=d;s.updateTree();var e=s.selectedNode.getBindingContext().getObject();if(e){e.isSelected=true;b.oConfigurationEditor=s.configEditor;b.setDetailData.call(b);s.updateTitleAndBreadCrumb();}else{s.oTreeInstance.setSelection(s._getCurrentConfigurationNode());}if(typeof a==="function"){a();}});}else{s.handleConfirmDeletion();}},getRouteContext:function(n){var s=this;if(!n){this.oSelectedNodeDetails=this.oTreeInstance.getAPFTreeNodeContext(this.oTreeInstance.getSelection());this.oParentNodeDetails=this.oTreeInstance.getParentNodeContext(this.oSelectedNodeDetails);n=this.oParentNodeDetails;}var r={appId:s.appId,configId:n.configurationId,categoryId:n.categoryId,facetFilterId:n.facetFilterId,stepId:n.stepId,representationId:n.representationId,navTargetId:n.navTargetId};return r;},_onTreeNodeSelection:function(e){this.selectedNode=e.getParameter("node");var s=this;if(!this.bProgramaticSelection){this.oPreviousSelectedNode=this.oTreeInstance.getSelection();this.bIsDifferntConfig=this.oTreeInstance.isConfigurationSwitched(this.oPreviousSelectedNode,this.selectedNode);this.oSelectedNodeDetails=this.oTreeInstance.getAPFTreeNodeContext(this.selectedNode);this.oParentNodeDetails=this.oTreeInstance.getParentNodeContext(this.oSelectedNodeDetails);this.toolbarController.enableCopyDeleteButton();this._enableExportButton();var a;if(this.byId("idConfigDetailData").getContent().length>=1){a=(typeof this.byId("idConfigDetailData").getContent()[0].getController==="function")?this.byId("idConfigDetailData").getContent()[0].getController():undefined;}var c=this.selectedNode?this.selectedNode.getId():null;var p=this.oPreviousSelectedNode?this.oPreviousSelectedNode.getId():null;var r=function(){var f=s.oPreviousSelectedNode.getBindingContext().getObject();var g=s.selectedNode.getBindingContext().getObject();f.isSelected=true;g.isSelected=false;s.oModel.updateBindings();};if(c!==p||this.bNavDeletionMode){var n=sap.apf.modeler.ui.utils.navigationHandler.getInstance();var i;if(a!==undefined){i=typeof a.getValidationState==="function"?a.getValidationState.call(a):true;}else{i=true;}this.bIsSaved=this.configEditor?this.configEditor.isSaved():undefined;var o;var b=false;var d=this.configurationHandler.getList();if(!i&&(d.length>0)){n.throwMandatoryPopup(s,{yes:function(){var f=s.getRouteContext(s.oParentNodeDetails);var a=(typeof s.byId("idConfigDetailData").getContent()[0].getController==="function")?s.byId("idConfigDetailData").getContent()[0].getController():undefined;var g=s._isNewSubView(a.oViewData.oParams);if(!g){var y=function(k){if(typeof k==="function"){k();}this.updateTree();var l=this.selectedNode.getBindingContext().getObject();this.navigateToDifferntView(this.oParentNodeDetails,this.oSelectedNodeDetails);l.isSelected=true;this.oModel.updateBindings();};if(!s.bIsSaved&&s.bIsDifferntConfig){o(false,function(){y.call(s);});}else{y.call(s);}}else{if(!s.bIsSaved&&s.bIsDifferntConfig){o(false,function(){var h=s.selectedNode.getBindingContext().sPath;var j=s.oPreviousSelectedNode;s.handleConfirmDeletion(j,h);});}else{var h=s.selectedNode.getBindingContext().sPath;var j=s.oPreviousSelectedNode;s.handleConfirmDeletion(j,h);}}s._navHandleExpandDelete.call(s,s.oSelectedNodeDetails,f);},no:function(){r();}});b=true;}o=function(f){n.throwLossOfDataPopup(s,{yes:function(g){if(typeof f==="function"){f(function(){g(function(){if(s.oPreviousSelectedNode){var B=s.oPreviousSelectedNode.getBindingContext().sPath;var C=B.split("/");var h=C[2];}s.oModel.getData().aConfigDetails[h].AnalyticalConfiguration=s.configId;});});}else{g(function(){if(s.oPreviousSelectedNode){var B=s.oPreviousSelectedNode.getBindingContext().sPath;var C=B.split("/");var h=C[2];}s.oModel.getData().aConfigDetails[h].AnalyticalConfiguration=s.configId;var j=s.selectedNode.getBindingContext().getObject();s.navigateToDifferntView(s.oParentNodeDetails,s.oSelectedNodeDetails);j.isSelected=true;s.oModel.updateBindings();});}},no:function(){var g=s.getRouteContext(s.oParentNodeDetails);s.configurationHandler.loadConfiguration(s.configId,function(h){s.configEditor=h;if(s.configId.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===0){s._navHandleExpandDelete.call(s,{},{configId:s.configId},g);}else{s.updateTree();}s.navigateToDifferntView(s.oParentNodeDetails,s.oSelectedNodeDetails);s._navHandleExpandDelete.call(s,s.oSelectedNodeDetails,g);});},cancel:function(){r();}});};if(!s.bIsSaved&&s.bIsDifferntConfig&&i){o();b=true;}if(!b){if(this.oPreviousSelectedNode&&this.oPreviousSelectedNode.getId()!==this.selectedNode.getId()){var P=this.oPreviousSelectedNode.getBindingContext().getObject();if(P){this.oPreviousSelectedNode.getBindingContext().getObject().isSelected=false;this.oPreviousSelectedNode.setIsSelected(false);}}else{this.selectedNode.getBindingContext().getObject().isSelected=true;}this.navigateToDifferntView(this.oParentNodeDetails,this.oSelectedNodeDetails,this.bIsSaved,this.bIsDifferntConfig);}}}this.bProgramaticSelection=false;this.bNavDeletionMode=false;},navigateToDifferntView:function(p,s,i,I){var c={appId:this.appId,configId:p.configurationId,categoryId:p.categoryId,facetFilterId:p.facetFilterId,stepId:p.stepId,representationId:p.representationId,navTargetId:p.navTargetId};if((!jQuery.isEmptyObject(c)&&(i===undefined||i))||(!I)){sap.ui.core.UIComponent.getRouterFor(this).navTo(s.nodeObjectType,c,true);}},_deleteConfigNavTargetTexts:function(a,n){var s=this;var b;for(var i=a;i<n-1;i++){this.modelUpdateDeferred[i]=this.modelUpdateDeferred[i+1];}delete this.modelUpdateDeferred[n-1];if(this.navTargetTextsTable){if(this.navTargetTextsTable[a]){delete this.navTargetTextsTable[a];}if(a!==(n-1)){Object.keys(this.navTargetTextsTable).forEach(function(k){k=parseInt(k,10);if(k>a){s.navTargetTextsTable[k-1]=s.navTargetTextsTable[k];b=k;}});if(b!==undefined){delete this.navTargetTextsTable[b];}}}},handleConfirmDeletion:function(s,a){var b=((s===undefined)||(typeof s.preventDefault==="function"))?this.oTreeInstance.getAPFTreeNodeContext(this.oTreeInstance.getSelection()):this.oTreeInstance.getAPFTreeNodeContext(s);var c=this;this.selectedNode=this.oTreeInstance.getSelection();var n,N,o,d,i,e,f,g,h;d=b.nodeContext;o=d.split("/");i=o[2];switch(b.nodeObjectType){case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.FACETFILTER:this.configEditor.removeFacetFilter(b.nodeAPFId);e=o[6];var F=this.oModel.getData().aConfigDetails[i].configData[0].filters;F.splice(e,1);this.oModel.getData().aConfigDetails[i].configData[0].filters=F;N=o.slice(0,3);n=N.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CATEGORY:this.configEditor.removeCategory(b.nodeAPFId);f=o[6];var C=this.oModel.getData().aConfigDetails[i].configData[1].categories;C.splice(f,1);this.oModel.getData().aConfigDetails[i].configData[1].categories=C;N=o.slice(0,3);n=N.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.NAVIGATIONTARGET:this.configEditor.removeNavigationTarget(b.nodeAPFId);g=o[6];var j=this.oModel.getData().aConfigDetails[i].configData[2].navTargets;j.splice(g,1);this.oModel.getData().aConfigDetails[i].configData[2].navTargets=j;N=o.slice(0,3);n=N.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.STEP:var S=this.configEditor.getCategoriesForStep(b.nodeAPFId);var k=b.nodeContext.split("/");i=k[2];S.forEach(function(w){c.configEditor.removeCategoryStepAssignment(w,b.nodeAPFId);c.oModel.getData().aConfigDetails[i].configData[1].categories.forEach(function(x,y){if(x.id===w){c.oModel.getData().aConfigDetails[i].configData[1].categories[y].steps.forEach(function(z,A){if(z.id===b.nodeAPFId){var B=c.oModel.getData().aConfigDetails[i].configData[1].categories[y].steps;B.splice(A,1);c.oModel.getData().aConfigDetails[i].configData[1].categories[y].steps=B;}});}});});N=o.slice(0,7);n=N.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.REPRESENTATION:f=o[6];h=o[8];var p=this.oModel.getData().aConfigDetails[i].configData[1].categories[f].steps[h].id;var P=this.configEditor.getStep(p);var l=this.configEditor.getCategoriesForStep(p);P.removeRepresentation(b.nodeAPFId);l.forEach(function(w){c.oModel.getData().aConfigDetails[i].configData[1].categories.forEach(function(x,y){if(x.id===w){c.oModel.getData().aConfigDetails[i].configData[1].categories[y].steps.forEach(function(z,A){if(z.id===p){c.oModel.getData().aConfigDetails[i].configData[1].categories[y].steps[A].representations.forEach(function(B,D){if(B.id===b.nodeAPFId){var R=c.oModel.getData().aConfigDetails[i].configData[1].categories[y].steps[A].representations;R.splice(D,1);c.oModel.getData().aConfigDetails[i].configData[1].categories[y].steps[A].representations=R;}});}});}});});N=o.slice(0,9);n=N.join("/");break;case sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION:var m=false;if(b.nodeAPFId.indexOf("newConfig")===0){m=true;}if(!m){this.configurationHandler.removeConfiguration(b.nodeAPFId,function(w){var q;var r=c.oModel.getData().aConfigDetails;c._deleteConfigNavTargetTexts(parseInt(i,10),r.length);var u=(c.configurationHandler.getList().length>0)?true:false;r.splice(i,1);c.oModel.getData().aConfigDetails=r;c.oModel.updateBindings();if(a){var t={appId:c.appId,configId:c.selectedNode.getBindingContext().getObject().AnalyticalConfiguration};sap.ui.core.UIComponent.getRouterFor(c).navTo(c.selectedNode.getBindingContext().getObject().type,t,true);}else{c.clearTitleAndBreadCrumb();c.byId("idConfigDetailData").removeAllContent();if(u){q=new sap.m.Label().addStyleClass("noConfigSelected");q.setText(c.oCoreApi.getText("noConfigSelected"));q.placeAt(c.byId("idConfigDetailData"));c.toolbarController.disableCopyDeleteButton();c.disableExportButton();}else{q=new sap.m.Label().addStyleClass("addNewConfig");q.setText(c.oCoreApi.getText("addNewConfig"));q.placeAt(c.byId("idConfigDetailData"));c.toolbarController.disableCopyDeleteButton();c.disableExportButton();}}});}else{var q;var r=c.oModel.getData().aConfigDetails;r.splice(i,1);c.oModel.getData().aConfigDetails=r;c.oModel.updateBindings();if(a){var t={appId:c.appId,configId:c.selectedNode.getBindingContext().getObject().AnalyticalConfiguration};sap.ui.core.UIComponent.getRouterFor(c).navTo(c.selectedNode.getBindingContext().getObject().type,t,true);}else{c.clearTitleAndBreadCrumb();c.byId("idConfigDetailData").removeAllContent();var u=(this.configurationHandler.getList().length>0)?true:false;if(u){q=new sap.m.Label().addStyleClass("noConfigSelected");q.setText(c.oCoreApi.getText("noConfigSelected"));q.placeAt(c.byId("idConfigDetailData"));c.toolbarController.disableCopyDeleteButton();c.disableExportButton();}else{q=new sap.m.Label().addStyleClass("addNewConfig");q.setText(c.oCoreApi.getText("addNewConfig"));q.placeAt(c.byId("idConfigDetailData"));c.toolbarController.disableCopyDeleteButton();c.disableExportButton();}}}break;default:break;}if(a){this.bNavDeletionMode=true;}if(b.nodeObjectType!==sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.CONFIGURATION){this.configEditor.setIsUnsaved();this.clearTitleAndBreadCrumb();this.byId("idConfigDetailData").removeAllContent();n=a||n;this.oModel.updateBindings();this.selectedNode=this.oTreeInstance.getNodeByContext(n);this.bProgramaticSelection=false;this.oTreeInstance.setSelection(this.selectedNode);if(a){this.selectedNode.getBindingContext().getObject().isSelected=true;this.oModel.updateBindings();}}var v=(this.toolbarController.confirmationDialog===undefined)?false:this.toolbarController.confirmationDialog.isOpen;if(v&&!a){this.toolbarController.confirmationDialog.close();}},handleNavBack:function(){var s;var a=this;if(this.byId("idConfigDetailData").getContent().length>=1){s=(typeof this.byId("idConfigDetailData").getContent()[0].getController==="function")?this.byId("idConfigDetailData").getContent()[0].getController():undefined;}var n=sap.apf.modeler.ui.utils.navigationHandler.getInstance();var i;if(s!==undefined){i=typeof s.getValidationState==="function"?s.getValidationState.call(s):true;}else{i=true;}this.bIsSaved=this.configEditor?this.configEditor.isSaved():undefined;var c=(a.configurationHandler.getList().length>0)?true:false;var b=false;var d=function(e){if(this.selectedNode){this.selectedNode=null;}this.oModel=new sap.ui.model.json.JSONModel({aConfigDetails:[]});this.getView().setModel(this.oModel);this.navTargetTextsTable={};window.history.go(-1);};if(c){if(!i){n.throwMandatoryPopup(a,{yes:function(){var e=a._navMandatoryResetState(a);var f=a.configurationHandler.getList();if(e.bIsSaved===false&&f.length>0){n.throwLossOfDataPopup(a,{yes:function(g){g();d.call(a);},no:function(){var r=a.getRouteContext(a.oParentNodeDetails);a.configurationHandler.resetConfiguration(a.configId);if(a.configId.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===0){a._navHandleExpandDelete.call(a,{},{configId:a.configId},r);}d.call(a);}});}else{d.call(a);}}});b=true;}var S=(a.bIsSaved===undefined)?true:a.bIsSaved;if(!S&&i){n.throwLossOfDataPopup(a,{yes:function(e){e();d.call(a);},no:function(){var r=a.getRouteContext(a.oParentNodeDetails);a.configurationHandler.resetConfiguration(a.configId);if(a.configId.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===0){a._navHandleExpandDelete.call(a,{},{configId:a.configId},r);}d.call(a);}});b=true;}}if(!b){d.call(a);}},handleSavePress:function(){var s;var a=this;this.selectedNode=this.oTreeInstance.getSelection();if(this.selectedNode){var b=this.selectedNode.getBindingContext().sPath;var c=b.split("/");var i=c[2];}if(this.byId("idConfigDetailData").getContent().length>=1){s=(typeof this.byId("idConfigDetailData").getContent()[0].getController==="function")?this.byId("idConfigDetailData").getContent()[0].getController():undefined;}var d=function(){var a=this;a.configEditor.save(function(g,m,h){if(h===undefined){a.oModel.getData().aConfigDetails[i].AnalyticalConfiguration=g;a.oModel.updateBindings();a.oSelectedNodeDetails=a.oTreeInstance.getAPFTreeNodeContext(a.selectedNode);a.oParentNodeDetails=a.oTreeInstance.getParentNodeContext(a.oSelectedNodeDetails);a.navigateToDifferntView(a.oParentNodeDetails,a.oSelectedNodeDetails,true,false);var j=a.oCoreApi.getText("successOnSave");sap.m.MessageToast.show(j,{width:"20em"});}else{var M=a.oCoreApi.createMessageObject({code:"12000"});M.setPrevious(h);a.oCoreApi.putMessage(M);var k=a.oCoreApi.getText("errorOnSave");sap.m.MessageToast.show(k,{width:"20em"});}});};var n=sap.apf.modeler.ui.utils.navigationHandler.getInstance();var e;if(s!==undefined){e=typeof s.getValidationState==="function"?s.getValidationState.call(s):true;}else{e=true;}this.bIsSaved=this.configEditor?this.configEditor.isSaved():undefined;var f=false;if(!e){n.throwMandatoryPopup(a,{yes:function(){a._navMandatoryResetState(a);d.call(a);}});f=true;}if(!f){d.call(this);this.toolbarController.closeDialog();}},_handleExportButtonPress:function(){var s;var a=this;if(this.byId("idConfigDetailData").getContent().length>=1){s=(typeof this.byId("idConfigDetailData").getContent()[0].getController==="function")?this.byId("idConfigDetailData").getContent()[0].getController():undefined;}var n=sap.apf.modeler.ui.utils.navigationHandler.getInstance();var i;if(s!==undefined){i=typeof s.getValidationState==="function"?s.getValidationState.call(s):true;}else{i=true;}this.bIsSaved=this.configEditor?this.configEditor.isSaved():undefined;var b=false;var e=function(){if(!this.exportConfigurationDialog){this.exportConfigurationDialog=sap.ui.xmlfragment("idExportConfigurationFragment","sap.apf.modeler.ui.fragment.exportConfiguration",this);this.getView().addDependent(this.exportConfigurationDialog);this._setExportConfigDialogText();this._addStyleClassForExportDialog();}jQuery.sap.syncStyleClass("sapUiSizeCompact",this.getView(),this.exportConfigurationDialog);this.exportConfigurationDialog.open();};var d=function(){var c=new sap.m.Label().addStyleClass("noConfigSelected");c.setText(a.oCoreApi.getText("noConfigSelected"));c.placeAt(a.byId("idConfigDetailData"));a.toolbarController.disableCopyDeleteButton();a.disableExportButton();};var o;if(!i){n.throwMandatoryPopup(a,{yes:function(){var c=a._navMandatoryResetState(a);var f=(a.configurationHandler.getList().length>0)?true:false;if(f){if(!c.bIsSaved){o(a);}else{if(a.oParentNodeDetails.configurationId.indexOf("newConfig")!==0){e.call(a);}}}else{d();}}});b=true;}o=function(c){n.throwLossOfDataPopup(c,{yes:function(f){a._navSaveState(function(){f(function(g){if(a.selectedNode){var B=a.selectedNode.getBindingContext().sPath;var C=B.split("/");var h=C[2];}a.oModel.getData().aConfigDetails[h].AnalyticalConfiguration=a.configId;a.oModel.updateBindings();e.call(a);});});},no:function(){var r=a.getRouteContext(a.oParentNodeDetails);if(a.configId.indexOf(sap.apf.modeler.ui.utils.CONSTANTS.configurationObjectTypes.ISNEWCONFIG)===0){a._navHandleExpandDelete.call(a,{},{configId:a.configId},r);a.clearTitleAndBreadCrumb();a.byId("idConfigDetailData").removeAllContent();var f=(a.configurationHandler.getList().length>0)?true:false;if(!f){d();}}else{a._navConfigResetState(a,function(){a._navHandleExpandDelete.call(a,a.oSelectedNodeDetails,r);e.call(a);});}}});};if(!a.bIsSaved&&i){o(a);b=true;}if(!b){e.call(a);}},_enableExportButton:function(){if(!this.byId("idExportbutton").getEnabled()){this.byId("idExportbutton").setEnabled(true);}},disableExportButton:function(){if(this.byId("idExportbutton").getEnabled()){this.byId("idExportbutton").setEnabled(false);}},_setExportConfigDialogText:function(){sap.ui.core.Fragment.byId("idExportConfigurationFragment","idExportConfigDialog").setTitle(this.oCoreApi.getText("exportConfig"));sap.ui.core.Fragment.byId("idExportConfigurationFragment","idOpenConfig").setText(this.oCoreApi.getText("openConfig"));sap.ui.core.Fragment.byId("idExportConfigurationFragment","idOpenTextProperty").setText(this.oCoreApi.getText("openTextProperty"));sap.ui.core.Fragment.byId("idExportConfigurationFragment","idCloseButton").setText(this.oCoreApi.getText("close"));},_addStyleClassForExportDialog:function(){sap.ui.core.Fragment.byId("idExportConfigurationFragment","idOpenConfig").addStyleClass("configLink");sap.ui.core.Fragment.byId("idExportConfigurationFragment","idOpenTextProperty").addStyleClass("textPropertyLink");},_handleCloseOfExportDialog:function(){if(this.exportConfigurationDialog.isOpen()){this.exportConfigurationDialog.close();}},_handleOpenConfigLinkPress:function(){var s=this;this.configurationHandler.exportConfiguration(this.configId,function(c){s._openFile(c);});},_handleOpenTextsLinkPress:function(){var s=this;this.configurationHandler.exportConfiguration(this.configId,function(c){var e=s.configurationHandler.exportTexts();s._openFile(e);});},_openFile:function(f){var e=encodeURIComponent(f);var n;n=window.open("about:blank","","_blank");n.document.write("<textarea rows='50' cols='160'readonly>"+decodeURIComponent(e)+"</textarea>");}});};if(!jQuery.sap.isDeclared('sap.apf.ui.instance')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.apf.ui.instance");sap.apf.ui.Instance=function(i){'use strict';i.uiApi=this;var c=i.oCoreApi;var s=i.oStartFilterHandler;var a;var b;var m;var f;var d=c.getUriGenerator().getApfLocation();this.oEventCallbacks={};jQuery.sap.includeStyleSheet(d+"resources/css/apfUi.css","apfCss");jQuery.sap.includeStyleSheet(d+"resources/css/apfPrint.css","printCss");jQuery("#printCss").attr("media","print");this.getAnalysisPath=function(){if(b===undefined){b=sap.ui.view({viewName:"sap.apf.ui.reuse.view.analysisPath",type:sap.ui.core.mvc.ViewType.JS,viewData:i});}return b;};this.getNotificationBar=function(){if(m===undefined){m=sap.ui.view({viewName:"sap.apf.ui.reuse.view.messageHandler",type:sap.ui.core.mvc.ViewType.JS,viewData:i});}return m;};this.getStepContainer=function(){if(a===undefined){a=sap.ui.view({viewName:"sap.apf.ui.reuse.view.stepContainer",type:sap.ui.core.mvc.ViewType.JS,viewData:i});}return a;};this.selectionChanged=function(r){if(r){this.getAnalysisPath().getController().refresh(0);}else{var n=c.getSteps().indexOf(c.getActiveStep());this.getAnalysisPath().getController().refresh(n+1);}c.updatePath(this.getAnalysisPath().getController().callBackForUpdatePath.bind(this.getAnalysisPath().getController()));};var e;var g=new sap.m.App().addStyleClass("sapApf");var I=false;this.createApplicationLayout=function(){if(!I){g.addPage(this.getLayoutView());I=true;}return g;};this.getLayoutView=function(){if(e===undefined){e=sap.ui.view({viewName:"sap.apf.ui.reuse.view.layout",type:sap.ui.core.mvc.ViewType.XML,viewData:i});}return e;};this.addDetailFooterContent=function(C){this.getLayoutView().getController().addDetailFooterContentLeft(C);};this.addMasterFooterContentRight=function(C){this.getLayoutView().getController().addMasterFooterContentRight(C);};this.setEventCallback=function(E,C){this.oEventCallbacks[E]=C;};this.getEventCallback=function(E){return this.oEventCallbacks[E];};this.drawFacetFilter=function(C){if(C&&C.length){f=sap.ui.view({viewName:"sap.apf.ui.reuse.view.facetFilter",type:sap.ui.core.mvc.ViewType.JS,viewData:{oCoreApi:c,oUiApi:this,aConfiguredFilters:C,oStartFilterHandler:s}});var h=this.getLayoutView().byId("subHeader");h.addItem(f.byId("idAPFFacetFilter"));}};this.contextChanged=function(r){if(f){f.getController().populateAndSelectFFListValues();}var C=this.getEventCallback(sap.apf.core.constants.eventTypes.contextChanged);if(typeof C==="function"){var S;if(!r){S=i.oFilterIdHandler.serialize();}C(S);}};this.getFacetFilterForPrint=function(){if(f){return f.byId("idAPFFacetFilter");}};this.handleStartup=function(h){var t=this;var p=jQuery.Deferred();h.done(function(j){var k=s.getStartFilters();t.contextChanged();k.done(function(C){t.drawFacetFilter(C);if(j.navigationMode==="backward"){t.getAnalysisPath().getController().bIsBackNavigation=true;c.updatePath(t.getAnalysisPath().getController().callBackForUpdatePath.bind(t.getAnalysisPath().getController()));}if(j.navigationMode==="forward"){if(c.getStartParameterFacade().getSteps()){var l=c.getStartParameterFacade().getSteps()[0].stepId;var r=c.getStartParameterFacade().getSteps()[0].representationId;var n=t.getAnalysisPath().getController().callBackForUpdatePathAndSetLastStepAsActive.bind(t.getAnalysisPath().getController());c.createFirstStep(l,r,n);}}p.resolve();});});return p.promise();};this.destroy=function(){f=undefined;this.getAnalysisPath().getToolbar().getController().oPrintHelper=undefined;this.getAnalysisPath().getCarousel().dndBox=undefined;};};};if(!jQuery.sap.isDeclared('sap.apf.ui.utils.facetFilterListHandler')){jQuery.sap.declare('sap.apf.ui.utils.facetFilterListHandler');sap.apf.ui.utils.FacetFilterListHandler=function(c,u,C,f){"use strict";function _(){var m=c.createMessageObject({code:"6010",aParameters:[c.getTextNotHtmlEncoded(C.getLabel())]});c.putMessage(m);}this.getFacetFilterListData=function(){var s,F,a,m,b;var o=jQuery.Deferred();var d=C.getValues();d.then(function(e){if(e===null||e.length===0){_();o.reject([]);}else{s=C.getAliasNameIfExistsElsePropertyName()||C.getPropertyName();C.getMetadata().then(function(p){F={oCoreApi:c,oUiApi:u,aFilterValues:e,oPropertyMetadata:p,sSelectProperty:s};a=new sap.apf.ui.utils.FacetFilterValueFormatter();b=a.getFormattedFFData(F);m=f.getFFListDataFromFilterValues(b,s);o.resolve(m);});}},function(e){_();o.reject([]);});return o.promise();};this.getSelectedFFValues=function(){var F=jQuery.Deferred();var a=C.getSelectedValues();a.then(function(s){F.resolve(s);},function(e){_();F.resolve([]);});return F.promise();};this.setSelectedFFValues=function(F){C.setSelectedValues(F);};};};if(!jQuery.sap.isDeclared('sap.apf.utils.externalContext')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2015 SAP AG. All rights reserved
 */
jQuery.sap.declare('sap.apf.utils.externalContext');sap.apf.utils.ExternalContext=function(i){'use strict';var d=jQuery.Deferred();var s=i.instance.startParameter.getEvaluationId();var x=i.instance.startParameter.getXappStateId();var m=i.instance.messageHandler;var r;var c;var a;this.getCombinedContext=function(){if(s){c=i.functions.getConfigurationProperties();a=c&&c.smartBusiness&&c.smartBusiness.runtime;if(a&&a.service){r=a.service+"/EVALUATIONS('"+s+"')/FILTERS?$format=json";jQuery.ajax({url:r,success:function(b){var p;var m=i.instance.messageHandler;var o;var e=new sap.apf.core.utils.Filter(m);var f=[];var t={};b.d.results.forEach(g);for(p in t){if(t.hasOwnProperty(p)){o=new sap.apf.core.utils.Filter(m);t[p].forEach(h);f.push(o);}}f.forEach(j);d.resolve(e);function g(k){if(!t[k.NAME]){t[k.NAME]=[];}t[k.NAME].push(new sap.apf.core.utils.Filter(m,k.NAME,k.OPERATOR,k.VALUE_1,k.VALUE_2));}function h(k){o.addOr(k);}function j(k){e.addAnd(k);}},error:function(j,t,e){}});}}else if(x){sap.ushell.Container.getService("CrossApplicationNavigation").getAppState(i.instance.component,x).done(function(b){var e=b.getData();if(e&&e.sapApfCumulativeFilter){d.resolve(sap.apf.core.utils.Filter.transformUI5FilterToInternal(m,e.sapApfCumulativeFilter));}else{d.resolve(new sap.apf.core.utils.Filter(m));}});}else{d.resolve(new sap.apf.core.utils.Filter(m));}return d.promise();};};};if(!jQuery.sap.isDeclared('sap.apf.utils.filter')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
(function(){'use strict';jQuery.sap.declare('sap.apf.utils.filter');sap.apf.utils.Filter=function(m){var t;var a=this;var b=function(){t=new sap.apf.utils.FilterAnd(m,sap.apf.utils.Filter.topAndId);};this.getById=function(i){if(t){if(i===sap.apf.utils.Filter.topAndId){return t;}return t.getById(i);}return undefined;};this.type="filter";this.getExpressions=function(){if(t){return t.getExpressions();}return[];};this.getInternalFilter=function(){return t.getInternalFilter();};this.getTopAnd=function(){return t;};this.updateExpression=function(i,e){m.check(i===e.id,"sId differs from oExpression.id");var E=this.getById(i);E.update(e);};this.updateValue=function(i,v,h){m.check(i!==undefined,"Filter updateValue: parameter id required");m.check(v!==undefined,"Filter updateValue: parameter value is required");var e=this.getById(i);m.check(e!==undefined,"Filter updateValue: id for expression not valid");e.updateValue(v,h);};this.serialize=function(){function c(C,T){var s={id:T.getId(),type:T.type,expressions:[],terms:[]};C.forEach(function(d,i){if(d instanceof Array){if(T.type==="filterAnd"){s.terms.push(c(d,T.getAndTerms()[i]));}else if(T.type==="filterOr"){s.terms.push(c(d,T.getOrTerms()[i]));}}else{s.expressions.push(d);}});return s;}return c(this.getTopAnd().getExpression(),this.getTopAnd());};this.deserialize=function(s){t=undefined;b();function c(s,T){if(s.type==="filterAnd"&&s.id!==sap.apf.utils.Filter.topAndId){T=T.addAnd(s.id);}else if(s.type==="filterOr"&&s.id!==sap.apf.utils.Filter.topAndId){T=T.addOr(s.id);}s.expressions.forEach(function(e){T.addExpression(e);});s.terms.forEach(function(d){c(d,T);});}c(s,this.getTopAnd());return this;};this.addAnd=function(i){jQuery.sap.log.error("Method 'addAnd' is deprecated since 1.23.0","Will be discarded with 1.26.0.");};this.intersectWith=function(c){var i=0;var f=[];var F;var r=new sap.apf.utils.Filter(m);var R=a.serialize();s(R);switch(arguments.length){case 1:F=arguments[0];if(F instanceof Array){f=F;}else{f.push(F);}break;default:f=Array.prototype.slice.call(arguments,0);}f.forEach(function(o){m.check((o instanceof sap.apf.utils.Filter),"Parameter value is not of type sap.apf.utils.Filter");var I=o.serialize();s(I);Array.prototype.push.apply(R.expressions,I.expressions);Array.prototype.push.apply(R.terms,I.terms);});r.deserialize(R);return r;function s(S){if(S.id!==sap.apf.utils.Filter.topAndId){S.id='#'+i++ +'#';}S.terms.forEach(s);}};b();return this;};function g(p,f){var r=[];if(f.filters){f.filters.forEach(function(a){r=r.concat(g(p,a));});return r;}else if(f.path){if(f.path===p){return[f];}else{return[];}}}sap.apf.utils.Filter.createFilterFromSapUi5FilterJSON=function(m,s){var r=new sap.apf.utils.Filter(m);function a(f,l,b){var c;l++;if(b.filters){if(b.and){if(l!==1){c=f.addAnd();}else{c=f;}}else{c=f.addOr();}b.filters.forEach(function(e){a(c,l,e);});}else{if(b.operator){f.addExpression({name:b.path,operator:b.operator,value:b.value1,high:b.value2});}}}a(r.getTopAnd(),0,s);return r;};sap.apf.utils.Filter.getOperators=function(){return sap.apf.core.constants.FilterOperators;};sap.apf.utils.Filter.prototype.getOperators=sap.apf.utils.Filter.getOperators;sap.apf.utils.Filter.topAndId='filterTopAnd';sap.apf.utils.FilterAnd=function(m,I){var a=I;var A=[];var t=this;this.type="filterAnd";this.getById=function(I){if(I===a){return this;}var T;var i;for(i=0;i<A.length;i++){T=A[i].getById(I);if(T!==undefined){return T;}}return undefined;};this.getExpressions=function(){var e=[];var T;var i;for(i=0;i<A.length;i++){T=A[i].getExpression();if(T instanceof Array&&T.length===0){continue;}if(T instanceof Array){e.push(T);}else{e.push([T]);}}return e;};this.getExpression=function(){var e=[];var T;var i;for(i=0;i<A.length;i++){T=A[i].getExpression();if(T instanceof Array&&T.length===0){continue;}e.push(T);}return e;};this.getCompoundExpressions=function(){jQuery.sap.log.error("Method 'getExpressions' is deprecated since 1.23.0","Will be discarded with 1.26.0.");};this.getId=function(){return I;};this.getInternalFilter=function(){var f=new sap.apf.core.utils.Filter(m);var l=A.length;var i;for(i=0;i<l;i++){f.addAnd(A[i].getInternalFilter());}return f;};this.addAndTerm=function(T){jQuery.sap.log.error("Method 'addAndTerm' is deprecated since 1.23.0","Will be discarded with 1.26.0.");};this.getAndTerms=function(){return A;};this.addOr=function(I){m.check((I===undefined||this.getById(I)===undefined),"Filter includes duplicated identifiers (IDs)");var o=new sap.apf.utils.FilterOr(m,I,t);A.push(o);return o;};this.addExpression=function(e){if(e.operator.length==2){e.operator=e.operator.toUpperCase();}m.check((e.id===undefined||this.getById(e.id)===undefined),"Filter includes duplicated identifiers (IDs)");m.check((e.operator!==undefined),"sap.apf.utils.Filter oExpression.operator undefined");m.check((jQuery.inArray(e.operator,sap.apf.core.constants.aSelectOpt)>-1),"sap.apf.core.utils.Filter oExpression.operator "+e.operator+" not supported");A.push(new sap.apf.utils.FilterExpression(m,e));return this;};};sap.apf.utils.FilterOr=function(m,I,a){var b=I;var o=[];var A=a;this.type="filterOr";this.getById=function(I){if(I===b){return this;}var t;for(var i=0;i<o.length;i++){t=o[i].getById(I);if(t!==undefined){return t;}}return undefined;};this.getExpression=function(){var e=[];var t;for(var i=0;i<o.length;i++){t=o[i].getExpression();if(t instanceof Array&&t.length===0){continue;}e.push(t);}return e;};this.getId=function(){return I;};this.getInternalFilter=function(){var f=new sap.apf.core.utils.Filter(m);for(var i=0;i<o.length;i++){f.addOr(o[i].getInternalFilter());}return f;};this.getAndObject=function(){return A;};this.addOrTerm=function(t){jQuery.sap.log.error("Method 'addOr' is deprecated since 1.23.0","Will be discarded with 1.26.0.");};this.getOrTerms=function(){return o;};this.addExpression=function(e){if(e.operator.length==2){e.operator=e.operator.toUpperCase();}m.check((e.id===undefined||this.getAndObject().getById(e.id)===undefined),"Filter includes duplicated identifiers (IDs)");m.check((e.operator!==undefined),"sap.apf.utils.Filter oExpression.operator undefined");m.check((jQuery.inArray(e.operator,sap.apf.core.constants.aSelectOpt)>-1),"sap.apf.core.utils.Filter oExpression.operator "+e.operator+" not supported");o.push(new sap.apf.utils.FilterExpression(m,e));return this;};this.addAnd=function(I){m.check((I===undefined||this.getById(I)===undefined),"Filter includes duplicated identifiers (IDs)");var c=new sap.apf.utils.FilterAnd(m,I);o.push(c);return c;};};sap.apf.utils.FilterExpression=function(m,e){c(e.high,e.operator);var i=e.id;var n=e.name;var o=e.operator;var v=e.value;var h=e.high;this.getById=function(a){if(i===a){return this;}return undefined;};this.getExpression=function(){if(!o||o!==sap.apf.core.constants.FilterOperators.BT){return{name:n,operator:o,value:v};}return{name:n,operator:o,value:v,high:h};};this.getInternalFilter=function(){return new sap.apf.core.utils.Filter(m,n,o,v,h);};this.update=function(e){c(e.high,e.operator);n=e.name;o=e.operator;v=e.value;h=e.high;};this.updateValue=function(a,b){v=a;if(b!==undefined){h=b;}c(h,o);};function c(a,b){if(!b){return;}if(b===sap.apf.core.constants.FilterOperators.BT&&(a===null||a===undefined)){m.check(false,"sap.apf.utils.FilterExpression: High value needed for 'between' selection");}else if(b!==sap.apf.core.constants.FilterOperators.BT&&(a!==null&&a!==undefined)){m.check(false,"sap.apf.utils.FilterExpression: High value only needed for 'between' selection");}}};}());};if(!jQuery.sap.isDeclared('sap.apf.utils.startFilterHandler')){jQuery.sap.declare('sap.apf.utils.startFilterHandler');sap.apf.utils.StartFilterHandler=function(a){'use strict';var s=[{isLevel:true}];var S=(a&&a.constructor&&a.constructor.StartFilter)||sap.apf.utils.StartFilter;var r={};var b={};var m=a.instance.messageHandler;var d=jQuery.Deferred();var c=false;this.getStartFilters=function(){if(!c){c=true;a.functions.getCombinedContext().done(function(l){var n=a.functions.getFacetFilterConfigurations();var o=l.getProperties();var p=o.length;var q=null;n.forEach(function(t){for(var i=0;i<p;i++){if(t.property===o[i]){q=o[i];break;}}if(q){s.push(new S(a,t,e(l,q)));o.splice(o.indexOf(q),1);q=null;}else{s.push(new S(a,t));}});o.forEach(function(i){s.unshift(new S(a,{property:i,invisible:true,multiSelection:true},e(l,i)));});k();d.resolve(f());});}return d.promise();};this.setRestrictionByProperty=function(i){var l=i.getInternalFilter();var n=g(l);var p=l.getProperties()[0];var o=true;h().forEach(function(q){if(q.getPropertyName()===p){q.setSelectedValues(n);o=false;}});if(o){s.unshift(new S(a,{multiSelection:true,property:p,invisible:true},n));}k();r[p]=i;if(!b[p]){b[p]=i.serialize();}};this.getRestrictionByProperty=function(p){if(r[p]){return r[p];}return new sap.apf.utils.Filter(m);};this.getCumulativeFilter=function(){var i=jQuery.Deferred();var l=new sap.apf.core.utils.Filter(m);var n;var o;d.done(function(){o=h().length;if(o==0){i.resolve(new sap.apf.core.utils.Filter(m));}h().forEach(function(q){q.getSelectedValues().done(function(v){n=new sap.apf.core.utils.Filter(m);if(v&&v.type==='internalFilter'){n=v;}if(jQuery.isArray(v)){v.forEach(function(t){n.addOr(new sap.apf.core.utils.Filter(m,q.getPropertyName(),'eq',t));});}l.addAnd(n);p();});});});return i.promise();function p(){o--;if(o==0){i.resolve(l);}}};this.serialize=function(){var i=jQuery.Deferred();var n;var l;var o={};o.startFilters=[];o.restrictionsSetByApplication={};for(l in r){o.restrictionsSetByApplication[l]=r[l].serialize();}n=h().length;if(h().length>0){h().forEach(function(p){p.serialize().done(function(q){o.startFilters.push(q);n--;if(n==0){i.resolve(o);}});});}else{i.resolve(o);}return i.promise();};this.deserialize=function(l){var s=h();var n;var o;r={};l.startFilters.forEach(function(p){for(var i=0,q=s.length;i<q;i++){if(p.propertyName===s[i].getPropertyName()){s[i].deserialize(p);}}});for(n in l.restrictionsSetByApplication){o=new sap.apf.utils.Filter(m);o.deserialize(l.restrictionsSetByApplication[n]);r[n]=o;}};this.resetAll=function(){var i;h().forEach(function(l){l.reset();});r={};for(i in b){r[i]=new sap.apf.utils.Filter(m).deserialize(b[i]);}};this.resetVisibleStartFilters=function(){f().forEach(function(i){i.reset();});};function g(i){var l=[];i.getFilterTerms().forEach(function(t){l.push(t.getValue());});return l;}function e(l,p){var n=[];var t=l.getFilterTermsForProperty(p);var o=l.reduceToProperty(p);if(o.toUrlParam().indexOf('%20and%20')>-1){return o;}for(var i=0,q=t.length;i<q;i++){if(t[i].getOp()!=='EQ'){return o;}n.push(t[i].getValue());}return n;}function f(){var v=[];h().forEach(function(i){if(i.isVisible()){v.push(i);}});return v;}function h(){var i=[];s.forEach(function(l){if(!l.isLevel){i.push(l);}});return i;}function j(){var l=[];for(var i=0,n=s.length;i<n;i++){if(!s[i].isLevel){l.push(s[i]);}else{break;}}return l;}function k(){l(i(j()));function i(n){var o=new sap.apf.core.utils.Filter(m);n.forEach(function(p){var q=new sap.apf.core.utils.Filter(m);p.getSelectedValues().done(function(v){if(v.type==='internalFilter'){q.addOr(v);}else{v.forEach(function(t){q.addOr(p.getPropertyName(),'eq',t);});}});o.addAnd(q);});return o;}function l(n){var o=false;s.forEach(function(p){if(p.isLevel){o=true;return;}if(o){p.setRestriction(n);}});}}};};if(!jQuery.sap.isDeclared('sap.apf.core.binding')){jQuery.sap.declare("sap.apf.core.binding");sap.apf.core.Binding=function(I,b,f,r){var t=this;this.type="binding";var n=0;var R=[];var a=[];var c=[];var C;var s;this.oTitle=b.oTitle;this.oLongTitle=b.oLongTitle;var d=b.requiredFilters;this.destroy=function(){R.forEach(function(o){if(o&&o.destroy){o.destroy();}});R=[];a=[];c=[];C=undefined;s=undefined;};this.getFilter=function(){var S=this.getSelectedRepresentation();var m=sap.apf.core.constants.filterMethodTypes;var i=[];if(S.getFilterMethodType()===m.filter){var F=S.getFilter().getInternalFilter();if(s){return s.getInternalFilter().overwriteWith(F);}else{return F;}}if(S.getSelectionAsArray){i=S.getSelectionAsArray();}else{return new sap.apf.core.utils.Filter(I.messageHandler);}if(i===undefined){return sap.apf.core.utils.Filter.createEmptyFilter(I.messageHandler,d);}if(i.length===c.length||i.length===0){return new sap.apf.core.utils.Filter(I.messageHandler);}return sap.apf.core.utils.Filter.createFromArray(I.messageHandler,d,c,i);};this.getRequestOptions=function(){if(jQuery.isFunction(this.getSelectedRepresentation().getRequestOptions)){return this.getSelectedRepresentation().getRequestOptions();}return{};};function e(o){return o.getFilterMethodType()===sap.apf.core.constants.filterMethodTypes.startFilter;}this.setFilter=function(F){var o=this.getSelectedRepresentation();s=F;if(e(o)){o.setFilter(s);}};this.setData=function(D){I.messageHandler.check(D!==undefined,"aDataResponse is undefined (binding function setData)");c=D.data;C=D.metadata;this.getSelectedRepresentation().setData(D.data,D.metadata);};this.getRepresentationInfo=function(){var k=jQuery.extend(true,[],a);for(var i=0;i<k.length;i++){delete k[i].id;delete k[i].type;delete k[i].constructor;}return k;};this.getSelectedRepresentationInfo=function(){I.messageHandler.check(n>=0&&n<a.length,"index in array boundaries");var o=jQuery.extend(true,{},a[n]);delete o.id;delete o.type;delete o.constructor;return o;};this.getSelectedRepresentation=function(){I.messageHandler.check(n>=0&&n<R.length,"selectedRepresentation in array boundaries");return R[n];};this.setSelectedRepresentation=function(r){I.messageHandler.check(typeof r==="string","setSelectedRepresentation() - sRepresentationId missing");var t=this;var o=this.getSelectedRepresentation();var S=k(r,b.representations);var N=l(S);n=S.index;if(c!==undefined&&C!==undefined){N.setData(c,C);}if(N.adoptSelection){N.adoptSelection(o);}function k(r,m){for(var i=0;i<m.length;i++){if(r===m[i].id){return{config:m[i],constructor:f.getConfigurationById(m[i].representationTypeId).constructor,index:i};}}I.messageHandler.check(false,"Representation config not found");}function l(i){var m;if(R[i.index]===undefined){if(i.config.parameter&&i.config.parameter.alternateRepresentationTypeId){i.config.parameter.alternateRepresentationType=f.getConfigurationById(i.config.parameter.alternateRepresentationTypeId);}i.config.parameter.requiredFilters=b.requiredFilters;m=t.convertSortToOrderBy(i.config.parameter);R[i.index]=I.coreApi.createRepresentation(i.constructor,m);return R[i.index];}else{return R[i.index];}}};this.serialize=function(){return{selectedRepresentation:t.getSelectedRepresentation().serialize(),selectedRepresentationId:t.getSelectedRepresentationInfo().representationId};};this.deserialize=function(S){t.setSelectedRepresentation(S.selectedRepresentationId);t.getSelectedRepresentation().deserialize(S.selectedRepresentation);return t;};this.convertSortToOrderBy=function(p){var i;if(p.sort&&!p.orderby){i=jQuery.extend(true,{},p);if(p.alternateRepresentationType){i.alternateRepresentationType=p.alternateRepresentationType;}i.orderby=[{property:p.sort.sortField,ascending:!p.sort.descending}];delete i.sort;return i;}i=p;return i;};R[0]=undefined;var g,h=false;for(g in b.representations){var j=b.representations[g].representationTypeId;a[g]=jQuery.extend(true,{},f.getConfigurationById(j));a[g].representationId=b.representations[g].id;if(r===a[g].representationId){h=true;}a[g].representationLabel=b.representations[g].label;a[g].thumbnail=b.representations[g].thumbnail;a[g].parameter=jQuery.extend(true,{},b.representations[g].parameter);}if(h){this.setSelectedRepresentation(r);}else if(a.length>0){this.setSelectedRepresentation(a[0].representationId);}if(!h&&r){I.messageHandler.putMessage(I.messageHandler.createMessageObject({code:'5037',aParameters:[r]}));}};};if(!jQuery.sap.isDeclared('sap.apf.core.request')){jQuery.sap.declare('sap.apf.core.request');jQuery.sap.require('sap.ui.thirdparty.datajs');(function(){'use strict';sap.apf.core.Request=function(I,c){var m=I.messageHandler;var C=I.coreApi;var s=c.service;var a=c.selectProperties;var u=C.getUriGenerator();var M;if(s===undefined){M=m.createMessageObject({code:'5015',aParameters:[c.id]});m.putMessage(M);}var o=C.getMetadata(s);var U=o.getUriComponents(c.entityType);var e,b;if(U){e=U.entitySet;b=U.navigationProperty;}m.check(e!==undefined,'Invalid request configuration: An entityset does not exist under the service '+c.entityType);m.check(b!==undefined,'Invalid request configuration: A usable navigation does not exist for the service '+c.entityType);this.type=c.type;this.sendGetInBatch=function(F,h,R){var i;var p=r(F);var j;var k;g(F);if(F&&F.getProperties){j=F.reduceToProperty(o.getFilterableProperties(e));i=(I.manifests&&I.manifests.manifest)||{};if(C.getStartParameterFacade().isFilterReductionActive()||(i["sap.apf"]&&i["sap.apf"].activateFilterReduction)){k=new sap.apf.core.utils.FilterReduction();j=k.filterReduction(m,j);}}d(R);var P=R&&R.paging;var S=R&&R.orderby;var l=u.buildUri(m,e,a,j,p,S,P,undefined,f,b);var n={method:'POST',headers:{'x-csrf-token':C.getXsrfToken(s)},requestUri:u.getAbsolutePath(s)+'$batch',data:{__batchRequests:[{requestUri:l,method:'GET',headers:{'Accept-Language':sap.ui.getCore().getConfiguration().getLanguage(),'x-csrf-token':C.getXsrfToken(s)}}]}};var q=function(t,v){var w={};var x='';if(t&&t.__batchResponses&&t.__batchResponses[0].data){w.data=t.__batchResponses[0].data.results;w.metadata=C.getEntityTypeMetadata(c.service,c.entityType);if(t.__batchResponses[0].data.__count){w.count=parseInt(t.__batchResponses[0].data.__count,10);}}else if(t&&t.__batchResponses[0]&&t.__batchResponses[0].response&&t.__batchResponses[0].message){x=v.requestUri;var y=t.__batchResponses[0].message;var z=t.__batchResponses[0].response.body;var H=t.__batchResponses[0].response.statusCode;w=m.createMessageObject({code:'5001',aParameters:[H,y,z,x]});}else{x=v.requestUri||l;w=m.createMessageObject({code:'5001',aParameters:['unknown','unknown error','unknown error',x]});}h(w,false);};var E=function(t){var v='unknown error';var w='unknown error';var x=l;if(t.message!==undefined){v=t.message;}var H='unknown';if(t.response&&t.response.statusCode){H=t.response.statusCode;w=t.response.statusText||'';x=t.response.requestUri||l;}if(t.messageObject&&t.messageObject.type==='messageObject'){h(t.messageObject);}else{h(m.createMessageObject({code:'5001',aParameters:[H,v,w,x]}));}};C.odataRequest(n,q,E,OData.batchHandler);};function f(p,v){var h="'";var E=o.getPropertyMetadata(e,p);if(E&&E.dataType){return sap.apf.utils.formatValue(v,E.dataType.type);}if(typeof v==='number'){return v;}return h+sap.apf.utils.escapeOdata(v)+h;}function d(R){var p,i;if(!R){return;}p=Object.getOwnPropertyNames(R);for(i=0;i<p.length;i++){if(p[i]!=='orderby'&&p[i]!=='paging'){m.putMessage(m.createMessageObject({code:'5032',aParameters:[e,p[i]]}));}}}function g(F){var h=o.getFilterableProperties(e);var R='';var E=o.getEntityTypeAnnotations(e);var i;if(E.requiresFilter!==undefined&&E.requiresFilter==='true'){if(E.requiredProperties!==undefined){R=E.requiredProperties;}}if(R===''){return;}if(jQuery.inArray(R,h)===-1){i=m.createMessageObject({code:'5006',aParameters:[e,R]});m.putMessage(i);}var p=F.getProperties();if(jQuery.inArray(R,p)===-1){i=m.createMessageObject({code:'5005',aParameters:[e,R]});m.putMessage(i);}}function r(F){var p={};var P;var n;var t;var i;var h;P=o.getParameterEntitySetKeyProperties(e);if(P!==undefined){n=P.length;}else{n=0;}if(n>0){for(i=0;i<n;i++){if(F&&F instanceof sap.apf.core.utils.Filter){t=F.getFilterTermsForProperty(P[i].name);h=t[t.length-1];}if(h instanceof sap.apf.core.utils.FilterTerm){j(i,h.getValue());}else if(P[i].defaultValue){j(i,P[i].defaultValue);}else{m.putMessage(m.createMessageObject({code:'5016',aParameters:[P[i].name]}));}}}return p;function j(k,v){var l;if(P[k].dataType.type==='Edm.String'){p[P[k].name]=(jQuery.sap.encodeURL("'"+sap.apf.utils.escapeOdata(v)+"'"));}else if(P[k].dataType.type){l=sap.apf.utils.formatValue(v,P[k].dataType.type);if(typeof l==='string'){p[P[k].name]=jQuery.sap.encodeURL(l);}else{p[P[k].name]=l;}}else if(typeof v==='string'){p[P[k].name]=jQuery.sap.encodeURL(sap.apf.utils.escapeOdata(v));}else{p[P[k].name]=v;}}}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.resourcePathHandler')){(function(){'use strict';jQuery.sap.declare("sap.apf.core.resourcePathHandler");sap.apf.core.ResourcePathHandler=function(i){var t=this;var c=i.coreApi;var m=i.messageHandler;var h=new sap.apf.utils.Hashtable(m);var C;var p;var s=null;var a="";var b=false;var I=false;var P=sap.apf.core.OdataProxy;o();this.getApplicationConfigurationURL=function(){return a;};this.loadConfigFromFilePath=function(F){if(b){return;}if(c.getStartParameterFacade().getAnalyticalConfigurationId()){I=true;}var U=F;a=F;jQuery.ajax({url:U,dataType:"json",success:r,error:function(J,S,E){var M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorLoadingRessource,rawText:"Error "+E+" when loading the configuration of the resource location: "+U});m.putMessage(M);},async:false});f();if(I){l();}else{e();}b=true;function r(D,S,J){var M=sap.apf.core.utils.checkForTimeout(J);if(M){m.putMessage(m.createMessageObject({code:sap.apf.core.constants.message.code.errorStartUp,rawText:"Timeout when loading application configuration from "+F+"."}));}if(!D||!D.applicationConfiguration){m.putMessage(m.createMessageObject({code:sap.apf.core.constants.message.code.errorStartUp,rawText:"The application configuration from "+F+" has no valid format."}));return;}if(D.applicationConfiguration.textResourceLocations===undefined){m.putMessage(m.createMessageObject({code:sap.apf.core.constants.message.code.errorStartUp,rawText:"The textResourceLocations is missing in the application configuration from "+F+"."}));return;}q(D);}};function u(){var r=(i.manifests&&i.manifests.manifest)||{};return((r["sap.apf"]&&r["sap.apf"].activateLrep)||c.getStartParameterFacade().isLrepActive());};function l(){var r=c.getStartParameterFacade().getAnalyticalConfigurationId();var v=r.applicationId;var w=r.configurationId;if(u()&&!v){m.putMessage(m.createMessageObject({code:"5022"}))}var x=new P({serviceRoot:p.path.service,entityTypes:{configuration:sap.apf.core.constants.entitySets.configuration,texts:sap.apf.core.constants.entitySets.texts}},{instance:{coreApi:c,messageHandler:m}});x.readEntity("configuration",function(y,z,A){if(A){m.putMessage(m.createMessageObject({code:"5022",aParameters:[w]}));}else{var B=JSON.parse(y.SerializedAnalyticalConfiguration);c.loadAnalyticalConfiguration(JSON.parse(y.SerializedAnalyticalConfiguration));v=v||y.Application;d(v,x);if(B.applicationTitle){C.appName=B.applicationTitle.key;C.appTitle=B.applicationTitle.key;}}},[{name:"AnalyticalConfiguration",value:w}],undefined,false,v);}function d(r,v){var w=new sap.apf.core.utils.Filter(m,'Application','eq',r);var x=new sap.apf.core.utils.Filter(m,'Language','eq',sap.apf.core.constants.developmentLanguage);x.addAnd(w);var y=["TextElement","TextElementDescription"];v.readCollection('texts',function(z,A,B){if(B){m.putMessage(m.createMessageObject({code:"5023",aParameters:[sap.apf.utils.uriParameter.getConfigurationId()]}));}else{c.loadTextElements(z);}},undefined,y,x,false);}function e(){var U=t.getResourceLocation(sap.apf.core.constants.resourceLocation.analyticalConfigurationLocation);var M;if(U!==""){jQuery.ajax({url:U,dataType:"json",success:function(D,S,J){if(D){c.loadAnalyticalConfiguration(D);if(D.applicationTitle){C.appName=D.applicationTitle.key;C.appTitle=D.applicationTitle.key;}}else{M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorLoadingAnalyticalConfig,rawText:"No data received when loading analytical configuration file"+U});m.putMessage(M);}},error:function(J,S,E){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorLoadingAnalyticalConfig,rawText:"Error "+E+" when loading analytical configuration file"+U});m.putMessage(M);},async:false});}else{M=m.createMessageObject({code:sap.apf.core.constants.message.code.missingAnalyticalConfig,rawText:"No analytical configuration defined in the application configuration"});m.putMessage(M);}}function f(){c.loadMessageConfiguration(sap.apf.core.messageDefinition,true);g(sap.apf.core.constants.resourceLocation.applicationMessageDefinitionLocation,false);}function g(r,R){var U=t.getResourceLocation(r);if(U!==""){jQuery.ajax({url:U,dataType:"json",success:v,error:function(J,S,E){var M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorLoadingAnalyticalConfig,rawText:"Error "+E+" when loading message configuration file"+U});m.putMessage(M);},async:false});}function v(D,S,J){var M;var w=sap.apf.core.utils.checkForTimeout(J);if(!w){if(D.messageConfiguration){c.loadMessageConfiguration(D.messageConfiguration.definitions,R);}}else{M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorLoadingAnalyticalConfig,rawText:"Timeout error when loading message configuration file"+U});m.putMessage(M);}}}function j(r){var M;if(!r||!r.path){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorInAnalyticalConfig,rawText:"persistence path configuration is missing in the application configuration"});m.putMessage(M);}if(!r.path.service){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorInAnalyticalConfig,rawText:"service in persistence path configuration is missing"});m.putMessage(M);}if(!r.logicalSystem){M=m.createMessageObject({code:sap.apf.core.constants.message.code.warningAnalyticalConfig,rawText:"logical system configuration is missing in the application configuration"});m.putMessage(M);}else if(!r.logicalSystem.service&&r.logicalSystem.service!==null){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorInAnalyticalConfig,rawText:"service is missing in logical system configuration  in the application configuration"});m.putMessage(M);}if(r.analyticalConfiguration){if(!r.analyticalConfiguration.service){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorInAnalyticalConfig,rawText:"service or entity set are missing in analytical configuration in the application configuration"});m.putMessage(M);}}}function k(r){var M;if(r.evaluations&&!r.evaluations.service){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorInAnalyticalConfig,rawText:"service in Smart Business service root configuration is missing"});m.putMessage(M);}if(r.evaluations&&(!r.evaluations.type||r.evaluations.type!=="smartBusinessRequest")){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorInAnalyticalConfig,rawText:"type in Smart Business configuration is not smartBusinessRequest"});m.putMessage(M);}if(r.evaluations&&!r.evaluations.entityType){M=m.createMessageObject({code:sap.apf.core.constants.message.code.errorInAnalyticalConfig,rawText:"entityType in Smart Business service root configuration is missing"});m.putMessage(M);}}this.getResourceLocation=function(r){return h.getItem(r);};this.getPersistenceConfiguration=function(){m.check(b,"RessourcePathHandler: configuration must be loaded before access to ressources");return p;};this.getConfigurationProperties=function(){return C;};function n(){var r=sap.apf.core.utils.uriGenerator;var v,w,x;var y=i.manifests.manifest;var z=i.manifests.baseManifest;if(b){return;}if(c.getStartParameterFacade().getAnalyticalConfigurationId()){I=true;}var A=r.getBaseURLOfComponent(i.manifests.baseManifest.name);var B=r.getBaseURLOfComponent(i.manifests.manifest.name);a=y["sap.app"].id;if(y["sap.app"].dataSources&&y["sap.app"].dataSources.PathPersistenceServiceRoot){x=y["sap.app"].dataSources.PathPersistenceServiceRoot.uri;}var D=z["sap.app"].i18n;D=r.addRelativeToAbsoluteURL(A,D);var E=y["sap.app"].i18n;E=r.addRelativeToAbsoluteURL(B,E);var F=y["sap.app"].title;F=F.replace(/[{}]/g,"");var G="";if(y["sap.app"].dataSources&&y["sap.app"].dataSources.AnalyticalConfigurationLocation){G=y["sap.app"].dataSources.AnalyticalConfigurationLocation.uri;G=r.addRelativeToAbsoluteURL(B,G);}var H={"appName":F,"appTitle":F,"analyticalConfigurationLocation":G,"textResourceLocations":{"apfUiTextBundle":D,"applicationUiTextBundle":E},"persistence":{"path":{"service":x}}};if(y["sap.apf"]&&y["sap.apf"].appSpecificParameters){for(v in y["sap.apf"].appSpecificParameters){H[v]=y["sap.apf"].appSpecificParameters[v];}}if(u()){P=sap.apf.core.LayeredRepositoryProxy;}if(y["sap.app"].dataSources&&y["sap.app"].dataSources.SmartBusiness){w=y["sap.app"].dataSources.SmartBusiness.uri;H.smartBusiness={runtime:{service:w}};}if(y["sap.app"].dataSources&&y["sap.app"].dataSources.LogicalSystem){H.persistence.logicalSystem={service:y["sap.app"].dataSources.LogicalSystem.uri};}q({applicationConfiguration:H});f();if(I){l();}else{e();}b=true;}function o(){var A=c.getUriGenerator().getApfLocation();h.setItem(sap.apf.core.constants.resourceLocation.apfUiTextBundle,A+"resources/i18n/apfUi.properties");h.setItem(sap.apf.core.constants.resourceLocation.applicationMessageDefinitionLocation,"");h.setItem(sap.apf.core.constants.resourceLocation.applicationMessageTextBundle,"");h.setItem(sap.apf.core.constants.resourceLocation.applicationUiTextBundle,"");h.setItem(sap.apf.core.constants.resourceLocation.analyticalConfigurationLocation,"");}function q(r){function v(A){C=jQuery.extend(true,{},A);delete C.type;delete C.analyticalConfigurationLocation;delete C.applicationMessageDefinitionLocation;delete C.textResourceLocations;delete C.persistence;}var A=r.applicationConfiguration;v(A);var T=r.applicationConfiguration.textResourceLocations;p=r.applicationConfiguration.persistence;j(p);if(!p.path.entitySet){p.path.entitySet=sap.apf.core.constants.entitySets.analysisPath;}if(r.applicationConfiguration.smartBusiness){s=r.applicationConfiguration.smartBusiness;k(s);}var M;var U;var w;for(w in sap.apf.core.constants.resourceLocation){if(!sap.apf.core.constants.resourceLocation.hasOwnProperty(w)){continue;}if(A[w]!==undefined){U=A[w];}else{if(T[w]!==undefined){U=T[w];}else{continue;}}if(sap.apf.core.utils.fileExists(U)){h.setItem(w,U);}else{if(!I){M=m.createMessageObject({code:sap.apf.core.constants.message.code.wrongRessourcePath,rawText:"The path "+U+" for resource location "+w+"is not valid."});m.putMessage(M);}}}}if(i.manifests&&i.manifests.manifest){n();}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.sessionHandler')){jQuery.sap.declare("sap.apf.core.sessionHandler");sap.apf.core.SessionHandler=function(i){var t=this;var x="";var s="";var h=new sap.apf.utils.Hashtable(i.messageHandler);var n=0;var l="";var c=i.coreApi;var m=i.messageHandler;var C=new sap.apf.utils.Filter(m);var S="";this.type="sessionHandler";this.ajax=function(d){sap.apf.core.ajax(d);};this.odata=function(r,O,e){c.odataRequest(r,O,e);};this.getXsrfToken=function(d){s=d;if(h.hasItem(s)){return h.getItem(s);}else{t.fetchXcsrfToken();h.setItem(s,x);return x;}};this.getLogicalSystem=function(){return l;};this.setContext=function(f){C=f;var T=C.getInternalFilter().getFilterTermsForProperty('SAPClient');if(T&&T.length===1){b();}c.updatePath(function(){},true);};this.getContext=function(){return C;};this.fetchXcsrfToken=function(){t.ajax({url:c.getUriGenerator().getAbsolutePath(s),type:"GET",beforeSend:function(d){d.setRequestHeader("x-csrf-token","Fetch");},success:a,error:o,async:false});n=n+1;};var o=function(j,d,e){if((x.length===0||x==="unsafe")&&n<2){setTimeout(t.fetchXcsrfToken,500+Math.random()*1500);}else{m.check(false,"No XSRF Token available!",5101);}};var a=function(d,e,X){x=X.getResponseHeader("x-csrf-token");if(x===null){x="";}else if((x.length===0||x==="unsafe")&&n<2){setTimeout(t.fetchXcsrfToken,500+Math.random()*1500);}};var g=function(){var T=C.getInternalFilter().getFilterTermsForProperty('SAPClient');if(T===undefined||T.length!==1){m.putMessage(m.createMessageObject({code:"5025"}));}return T[0].getValue();};var b=function(){var d=c.getPersistenceConfiguration().logicalSystem;if(!d){l=f;return;}var e=d.service;var E=d.entityType;var f=g();if(e===null){l=f;return;}if(E===undefined){E=sap.apf.core.constants.entitySets.logicalSystem;}if(S===f){return;}S=f;var F=new sap.apf.core.utils.Filter(m,"SAPClient",'eq',S);var u=c.getUriGenerator().getAbsolutePath(e);u=u+c.getUriGenerator().buildUri(m,E,['LogicalSystem'],F,undefined,undefined,undefined,undefined,undefined,'Results');var r={requestUri:u,method:"GET",headers:{"x-csrf-token":x},async:false};var O=function(D){if(D&&D.results&&D.results instanceof Array&&D.results.length===1&&D.results[0].LogicalSystem){l=D.results[0].LogicalSystem;}else{m.putMessage(m.createMessageObject({code:"5026",aParameters:[S]}));}};var j=function(k){var M=m.createMessageObject({code:"5026",aParameters:[S]});if(k.messageObject!==undefined&&k.messageObject.type==="messageObject"){M.setPrevious(k.messageObject);}m.putMessage(M);};t.odata(r,O,j);};};};if(!jQuery.sap.isDeclared('sap.apf.core.step')){jQuery.sap.declare("sap.apf.core.step");(function(){'use strict';sap.apf.core.Step=function(m,s,f,r){m.check(s!==undefined,"Step: step configuration is missing");m.check(s.binding!==undefined,"No binding assigned to step "+s.id+" in analytical configuration",sap.apf.core.constants.message.code.errorCheckConfiguration);var t=this;var b,R,c,C;var a=jQuery.extend(true,{},s);delete a.id;delete a.picture;delete a.hoverPicture;delete a.title;delete a.longTitle;delete a.type;delete a.thumbnail;delete a.categories;this.type=s.type;this.title=jQuery.extend(true,{},s.title);this.longTitle=undefined;if(s.longTitle){this.longTitle=jQuery.extend(true,{},s.longTitle);}this.thumbnail=jQuery.extend(true,{},s.thumbnail);this.categories=s.categories;this.destroy=function(){if(b){b.destroy();}R=undefined;c=undefined;C=undefined;b=undefined;t=undefined;};this.getAdditionalConfigurationProperties=function(){return a;};this.update=function(F,g){var o=b.getRequestOptions();var h=!F.isEqual(c);var j=!d(C,o);if(R&&(h||j)){R.sendGetInBatch(F,g,o);}else{g({},true);}};this.determineFilter=function(o,g){if(e()&&this.getFilter().toUrlParam()){var h=f.getConfigurationById(s.filterMapping.requestForMappedFilter);h.selectProperties=s.filterMapping.target;var M=f.createRequest(h);var j=o.addAnd(this.getFilter());sap.apf.utils.executeFilterMapping(j,M,s.filterMapping.target,l,m);}else{g(this.getFilter());}function l(k,n){if(!n){if(s.filterMapping.keepSource==='true'){var k=t.getFilter().addAnd(k);}g(k);}}};this.setFilter=function(F){return b.setFilter(F);};this.getFilter=function(){return b.getFilter();};this.setData=function(D,F){c=F.copy();C=jQuery.extend({},b.getRequestOptions());b.setData(D);};this.getRepresentationInfo=function(){return b.getRepresentationInfo();};this.getSelectedRepresentationInfo=function(){return b.getSelectedRepresentationInfo();};this.getSelectedRepresentation=function(){return b.getSelectedRepresentation();};this.setSelectedRepresentation=function(r){b.setSelectedRepresentation(r);};this.serialize=function(){return{stepId:s.id,binding:b.serialize()};};this.deserialize=function(S){b.deserialize(S.binding);m.check(s.id,S.stepId,"sap.apf.core.step.deserialize inconsistent serialization data - id "+S.stepId);return this;};this.getAssignedNavigationTargets=function(){return s.navigationTargets;};i();function i(){b=f.createBinding(s.binding,undefined,undefined,r);delete a.binding;if(s.request!==undefined&&s.request!==""){R=f.createRequest(s.request);delete a.request;}}function d(o,O){var n=0;var g=0;var p;for(p in o){n++;}for(p in O){g++;}if(n!==g){return false;}for(p in o){if(!o.hasOwnProperty(p)){continue;}if(typeof o[p]==='object'){if(!d(o[p],O[p])){return false;}}else{if(o[p]!==O[p]){return false;}}}return true;}function e(){if(s.filterMapping){if(s.filterMapping.requestForMappedFilter&&s.filterMapping.target instanceof Array&&s.filterMapping.keepSource){return true;}else{m.putMessage(m.createMessageObject({code:"5104"}));return false;}}else{return false;}}};}());};if(!jQuery.sap.isDeclared('sap.apf.ui.reuse.controller.facetFilter.controller')){jQuery.sap.declare('sap.apf.ui.reuse.controller.facetFilter.controller');
/*!
* SAP APF Analysis Path Framework
* 
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
*/
(function(){'use strict';var c={};var f={};var s;var F=new sap.apf.ui.utils.FacetFilterListConverter();function _(C){var g;var h=C.getView().byId("idAPFFacetFilter").getLists();h.forEach(function(o){g=o.getId();f[g].getSelectedFFValues().then(e.bind(null,o));});}function a(o,g){var h=o.getId();var i=o.getModel();i.setSizeLimit(g.length);if(!o.getMultiSelect()){o.setGrowingThreshold(g.length);}i.setData(g);i.updateBindings();f[h].getSelectedFFValues().then(e.bind(null,o));}function b(o){var C=this;C.getView().byId("idAPFFacetFilter").removeList(o);}function d(g,o){var i;g.forEach(function(h){h.selected=false;});if(g.length!==o.length){o.forEach(function(h){for(i=0;i<g.length;i++){if(h===g[i].key){g[i].selected=true;break;}}});}return g;}function e(o,S){var g=o.getId();var h=o.getModel();var i=h.getData();c[g]=S;i=d(i,S);h.setData(i);h.updateBindings();}sap.ui.controller("sap.apf.ui.reuse.controller.facetFilter",{onInit:function(){var C=this,g;s=false;var v=C.getView().getViewData();v.aConfiguredFilters.forEach(function(o,n){g=C.getView().byId("idAPFFacetFilter").getLists()[n].getId();f[g]=new sap.apf.ui.utils.FacetFilterListHandler(v.oCoreApi,v.oUiApi,o,F);});C.populateAndSelectFFListValues();},populateAndSelectFFListValues:function(){var C=this,g;var h=C.getView().byId("idAPFFacetFilter").getLists();h.forEach(function(o){g=o.getId();f[g].getFacetFilterListData().then(a.bind(null,o),b.bind(C,o));});},onListClose:function(E){var C=this;var o=E.getSource();var i=E.getParameter('allSelected');var S=[],g,h,j,k,l,m;if(i){g=o.getItems();if(!jQuery.isEmptyObject(g)){S=g.map(function(D){return D.getKey();});}}else{g=o.getSelectedItems();S=g.map(function(I){return I.getKey();});}h=o.getId();j=c[h];if(S.length!==0&&j!==undefined){k=JSON.stringify(S.sort());l=JSON.stringify(j.sort());m=(k===l);if(!m){c[h]=S;s=true;f[h].setSelectedFFValues(S);C.getView().getViewData().oUiApi.selectionChanged(true);}}},onResetPress:function(){var C=this;if(s){C.getView().getViewData().oStartFilterHandler.resetVisibleStartFilters();_(C);C.getView().getViewData().oUiApi.selectionChanged(true);s=false;}}});}());};if(!jQuery.sap.isDeclared('sap.apf.core.configurationFactory')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
(function(){'use strict';jQuery.sap.declare("sap.apf.core.configurationFactory");sap.apf.core.ConfigurationFactory=function(i){var t=this;var a=new sap.apf.utils.Hashtable(i.messageHandler);var s=function(I){i.messageHandler.check(I!==undefined&&I.hasOwnProperty("id")!==false,"oItem is undefined or property 'id' is missing",sap.apf.core.constants.message.code.errorCheckConfiguration);if(!a){a=new sap.apf.utils.Hashtable(i.messageHandler);}var v=a.setItem(I.id,I);i.messageHandler.check((v===undefined),"Configuration includes duplicated identifiers (IDs)",sap.apf.core.constants.message.code.errorCheckConfigurationWarning);};var g=function(v){var R=[];if(a.getNumberOfItems()!==0){a.each(function(w,x){if(x.type===v){R.push(x);}});return R;}i.messageHandler.putMessage(i.messageHandler.createMessageObject({code:"5020"}));return R;};function l(v){if(v.type===undefined){v.type="step";}s(v);}function b(v){i.messageHandler.check(v!==undefined&&v instanceof Array!==false,"aSteps is missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);v.forEach(function(w){l(w);});}function c(R){if(R.type===undefined){R.type="request";}if(R.entitySet){R.entityType=R.entitySet;delete R.entitySet;}s(R);}function d(v){if(v.type===undefined){v.type="navigationTarget";}s(v);}function e(R){i.messageHandler.check(R!==undefined&&R instanceof Array!==false,"aRequests is missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);R.forEach(function(v){c(v);});}function f(B){function v(){var w=new sap.apf.utils.Hashtable(i.messageHandler);B.representations.forEach(function(x){if(!(x.id&&typeof x.id==="string")){i.messageHandler.putMessage(i.messageHandler.createMessageObject({code:"5028",aParameters:[B.id]}));}if(w.setItem(x.id,x.id)){i.messageHandler.putMessage(i.messageHandler.createMessageObject({code:"5029",aParameters:[B.id]}));}});}if(B.type===undefined){B.type="binding";}i.messageHandler.check(B.id!==undefined,"binding has no id");i.messageHandler.check(B.representations!==undefined&&B.representations instanceof Array!==false,"representations for binding "+B.id+" not defined",sap.apf.core.constants.message.code.errorCheckConfiguration);v();s(B);}function h(B){i.messageHandler.check(B!==undefined&&B instanceof Array!==false,"aBindings is missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);B.forEach(function(v){f(v);});}function j(v){i.messageHandler.check(v!==undefined&&v instanceof Array!==false,"navigationTarget is missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);v.forEach(function(w){d(w);});}function k(v){if(v.type===undefined){v.type="category";}s(v);}function m(v){i.messageHandler.check(v!==undefined&&v instanceof Array!==false,"aCategories is missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);v.forEach(function(w){var x=w.steps;i.messageHandler.check(x!==undefined&&x instanceof Array!==false,"steps for category "+w.id+" are missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);x.forEach(function(y){i.messageHandler.check(y.type&&y.type==="step"&&y.id,"step with wrong format assigned to category '"+w.id+"'");i.messageHandler.check(t.existsConfiguration(y.id),"step with id '"+y.id+"' which is assigned to category '"+w.id+"' does not exist");});k(w);});}function n(v){var w=false;var R=sap.apf.core.representationTypes();R.forEach(function(x){if(v===x.id){w=true;}});return w;}function o(R){var v;if(R.type===undefined){R.type="representationType";}if(!n(R.id)){v=sap.apf.utils.extractFunctionFromModulePathString(R.constructor);if(!jQuery.isFunction(v)){i.messageHandler.putMessage(i.messageHandler.createMessageObject({code:'5030',parameters:[R.id]}));}}s(R);}function p(R){i.messageHandler.check(R!==undefined&&R instanceof Array!==false,"aRepresentationInfo is missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);R.forEach(function(v){o(v);});}function q(F){if(F.type===undefined){F.type="facetFilter";}t.addObject(F);}function r(F){i.messageHandler.check(F!==undefined&&F instanceof Array!==false,"Facet filter configuration is missing or not an Array",sap.apf.core.constants.message.code.errorCheckConfiguration);F.forEach(function(v){q.call(t,v);});}var u=function(R){p(R);};function S(v,F){function w(v,z){var A=z.getConfigurationById(v.binding).representations;if(A){return A;}i.messageHandler.check(false,'Binding of step with ID "'+v.id+'" does not contain any representations.',sap.apf.core.constants.message.code.errorCheckConfigurationWarning);}function x(v,z){var A;var B=[];if(v.binding){A=w(v,z);A.forEach(function(D){var E=jQuery.extend(true,{},z.getConfigurationById(D.representationTypeId));E.representationId=D.id;E.representationLabel=D.label;E.parameter=jQuery.extend(true,{},D.parameter);B.push(E);});return B;}i.messageHandler.check(false,'Step with ID "'+v.id+'" does not contain any binding references.',sap.apf.core.constants.message.code.errorCheckConfigurationWarning);}var y=jQuery.extend(true,{},v);var R=x(v,F);delete y.request;delete y.binding;delete y.thumbnail;delete y.longTitle;y.type="stepTemplate";y.getRepresentationInfo=function(){var z=jQuery.extend(true,[],R);z.forEach(function(A){delete A.id;delete A.type;delete A.constructor;});return z;};return y;}var C=function(v,w){var t=this;this.type=v.type;this.id=v.id;this.label=v.label;this.stepTemplates=[];v.steps.forEach(function(x){var y=w.getConfigurationById(x.id);t.stepTemplates.push(new S(y,w));});return this;};var T=function(v,F){this.type="thumbnail";if(v===undefined){return this;}this.leftUpper=F.createLabel(v.leftUpper);this.rightUpper=F.createLabel(v.rightUpper);this.leftLower=F.createLabel(v.leftLower);this.rightLower=F.createLabel(v.rightLower);this.altTitle=F.createLabel(v.altTitle);return this;};this.createThumbnail=function(v){return new T(v,this);};function L(v){this.type="label";this.kind=v.kind;if(this.kind==="text"){this.file=v.file;this.key=v.key;}else if(this.kind==="property"){this.property=v.property;}else if(this.kind==="sapLabel"){this.labelOf=v.labelOf;}}this.createLabel=function(v){return new L(v,this);};this.loadConfig=function(v){a=new sap.apf.utils.Hashtable(i.messageHandler);if(v.applicationTitle){a.setItem('applicationTitle',v.applicationTitle);}var w={constructor:{hashtable:sap.apf.utils.Hashtable},instance:{messageHandler:i.messageHandler}};sap.apf.utils.migrateConfigToCategoryStepAssignment(v,w);var R=sap.apf.core.representationTypes();u(R);b(v.steps);m(v.categories);e(v.requests);h(v.bindings);if(v.representationTypes){p(v.representationTypes);}if(v.facetFilters){r.call(this,v.facetFilters);}if(v.navigationTargets){j(v.navigationTargets);}};this.addObject=function(v){if(!sap.apf.core.constants.configurationObjectTypes.hasOwnProperty(v.type)){i.messageHandler.putMessage(i.messageHandler.createMessageObject({code:"5033",aParams:[v.type]}));}if(!(v.property)){i.messageHandler.putMessage(i.messageHandler.createMessageObject({code:"5034"}));}a.setItem(v.id,v);};this.getConfigurationById=function(I){return a.getItem(I);};this.existsConfiguration=function(I){return a.hasItem(I);};this.getServiceDocuments=function(){var R=g("request");var v=[];R.forEach(function(w){v.push(w.service);});return sap.apf.utils.eliminateDuplicatesInArray(i.messageHandler,v);};this.getNavigationTargets=function(){var v=g("navigationTarget");return jQuery.extend(true,[],v);};this.getStepTemplates=function(){var I=g("step");var v=[];I.forEach(function(w,x){v[x]=new S(w,t);});return v;};this.getFacetFilterConfigurations=function(){var v=g("facetFilter");var w;v=jQuery.extend(true,[],v);v.forEach(function(x){if(x.preselectionFunction){w=sap.apf.utils.extractFunctionFromModulePathString(x.preselectionFunction);if(!jQuery.isFunction(w)){i.messageHandler.putMessage(i.messageHandler.createMessageObject({code:'5035',parameters:[x.id]}));x.preselectionFunction=undefined;}else{x.preselectionFunction=w;}}});return v;};this.getCategories=function(){var I=g("category");var v=[];I.forEach(function(w,x){v[x]=new C(w,t);});return v;};this.createStep=function(v,R){var w=this.getConfigurationById(v);i.messageHandler.check((w!==undefined&&w.type==="step"),"Error - referenced object is undefined or has not type step",sap.apf.core.constants.message.code.errorCheckConfiguration);i.messageHandler.check(sap.apf.core.Step!==undefined,"Step must be defined ",sap.apf.core.constants.message.code.errorCheckConfiguration);i.messageHandler.check(typeof sap.apf.core.Step==="function","Step must be Ctor function");return new sap.apf.core.Step(i.messageHandler,w,this,R);};this.createBinding=function(B,v,w,R){var x=this.getConfigurationById(B);i.messageHandler.check((x!==undefined&&x.type==="binding"),"Error - oBindingConfig is undefined or has not type binding",sap.apf.core.constants.message.code.errorCheckConfiguration);x.oTitle=v;x.oLongTitle=w;return new sap.apf.core.Binding(i,x,this,R);};this.createRequest=function(v){if(v.entitySet){v.entityType=v.entitySet;delete v.entitySet;}var M;var R;function w(){var x=new Date();return Math.random()*x.getTime();}if(typeof v==="string"){R=t.getConfigurationById(v);if(!(R!==undefined&&R.type==="request")){M=i.messageHandler.createMessageObject({code:"5004",aParameters:[v]});i.messageHandler.putMessage(M);return undefined;}}else{R=v;i.messageHandler.check(R.type&&R.type==="request"&&R.service&&R.entityType,'Wrong request configuration when creating a new request');if(!R.id){R.id=w();s(R);}}return new sap.apf.core.Request(i,R);};if(i.constructor.registryProbe){this.getRegistry=function(){return new i.constructor.registryProbe(a);};}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.readRequest')){jQuery.sap.declare("sap.apf.core.readRequest");sap.apf.core.ReadRequest=function(i,r,s,e){var c=i.coreApi;var m=i.messageHandler;this.type="readRequest";this.send=function(f,C,R){var a;var b=function(o,n){var M;var E;var d=[];if(o&&o.type&&o.type==="messageObject"){m.putMessage(o);M=o;}else{d=o.data;E=o.metadata;}C(d,E,M);};if(f){a=f.getInternalFilter();}else{a=new sap.apf.core.utils.Filter(m);}r.sendGetInBatch(a,b,R);};this.getMetadata=function(){return c.getEntityTypeMetadata(s,e);};this.getMetadataFacade=function(){return c.getMetadataFacade(s);};};};if(!jQuery.sap.isDeclared('sap.apf.core.readRequestByRequiredFilter')){jQuery.sap.declare("sap.apf.core.readRequestByRequiredFilter");sap.apf.core.ReadRequestByRequiredFilter=function(i,r,s,e){var c=i.coreApi;var m=i.messageHandler;var M;this.type="readRequestByRequiredFilter";this.send=function(f,C,R){var o;var a=function(g,n){var h;var E;var D=[];if(g&&g.type&&g.type==="messageObject"){m.putMessage(g);h=g;}else{D=g.data;E=g.metadata;}C(D,E,h);};if(!M){M=c.getMetadata(s);}var p=M.getParameterEntitySetKeyProperties(e);var b="";var E=M.getEntityTypeAnnotations(e);if(E.requiresFilter!==undefined&&E.requiresFilter==="true"){if(E.requiredProperties!==undefined){b=E.requiredProperties;}}var d=b.split(',');p.forEach(function(g){d.push(g.name);});var P=c.getContext().getInternalFilter().reduceToProperty(d);if(f){o=f.getInternalFilter();o.addAnd(P);}else{o=P;}r.sendGetInBatch(o,a,R);};this.getMetadataFacade=function(){return c.getMetadataFacade(s);};};};if(!jQuery.sap.isDeclared('sap.apf.modeler.core.instance')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.modeler.core.instance");(function(){'use strict';jQuery.sap.require('sap.ui.thirdparty.datajs');sap.apf.modeler.core.Instance=function(p,a){var t=this;var A,C,b,c,d,S,F,N,R,E,H,e,M,f,g,h,j,L,k,l,m,s,n,o,q,r,u,v,O,w,x,y,z,B,D,G;A=(a&&a.constructor&&a.constructor.applicationHandler)||sap.apf.modeler.core.ApplicationHandler;C=(a&&a.constructor&&a.constructor.configurationHandler)||sap.apf.modeler.core.ConfigurationHandler;b=(a&&a.constructor&&a.constructor.configurationEditor)||sap.apf.modeler.core.ConfigurationEditor;c=(a&&a.constructor&&a.constructor.configurationObjects)||sap.apf.modeler.core.ConfigurationObjects;d=(a&&a.constructor&&a.constructor.configurationFactory)||sap.apf.core.ConfigurationFactory;E=(a&&a.constructor&&a.constructor.elementContainer)||sap.apf.modeler.core.ElementContainer;S=(a&&a.constructor&&a.constructor.step)||sap.apf.modeler.core.Step;F=(a&&a.constructor&&a.constructor.facetFilter)||sap.apf.modeler.core.FacetFilter;N=(a&&a.constructor&&a.constructor.navigationTarget)||sap.apf.modeler.core.NavigationTarget;R=(a&&a.constructor&&a.constructor.representation)||sap.apf.modeler.core.Representation;H=(a&&a.constructor&&a.constructor.hashtable)||sap.apf.utils.Hashtable;e=(a&&a.constructor&&a.constructor.registryProbe)||sap.apf.modeler.core.RegistryWrapper;L=(a&&a.constructor&&a.constructor.LazyLoader)||sap.apf.modeler.core.LazyLoader;M=(a&&a.constructor&&a.constructor.metadata)||sap.apf.core.Metadata;f=(a&&a.constructor&&a.constructor.entityTypeMetadata)||sap.apf.core.EntityTypeMetadata;g=(a&&a.constructor&&a.constructor.metadataFacade)||sap.apf.core.MetadataFacade;h=(a&&a.constructor&&a.constructor.metadataProperty)||sap.apf.core.MetadataProperty;j=(a&&a.constructor&&a.constructor.metadataFactory)||sap.apf.core.MetadataFactory;k=(a&&a.constructor&&a.constructor.startParameter)||sap.apf.utils.StartParameter;if(a&&a.constructor&&a.constructor.textHandler){l=new a.constructor.textHandler();}else{l=new sap.apf.modeler.core.TextHandler();}if(a&&a.constructor&&a.constructor.messageHandler){m=new a.constructor.messageHandler(true);}else{m=new sap.apf.core.MessageHandler(true);}m.setTextResourceHandler(l);m.loadConfig(sap.apf.core.messageDefinition);m.loadConfig(sap.apf.modeler.core.messageDefinition);m.activateOnErrorHandling(true);n=new k(a&&a.instances&&a.instances.component);this.getStartParameterFacade=function(){return n;};r={instance:{messageHandler:m,coreApi:t}};if(a&&a.constructor&&a.constructor.persistenceProxy){o=new a.constructor.persistenceProxy(p,r);}else{o=new sap.apf.core.OdataProxy(p,r);}if(a&&a.constructor&&a.constructor.sessionHandler){s=new a.constructors.sessionHandler(r.instance);}else{s=new sap.apf.core.SessionHandler(r.instance);}u={entityTypeMetadata:sap.apf.core.EntityTypeMetadata,hashtable:H,metadata:sap.apf.core.Metadata,metadataFacade:sap.apf.core.MetadataFacade,metadataProperty:sap.apf.core.MetadataProperty,messageHandler:m,coreApi:t,datajs:OData,configurationFactory:{getServiceDocuments:function(){return[p.serviceRoot];}},deactivateFatalError:true};q=new sap.apf.core.MetadataFactory(u);v={constructor:{hashtable:H},instance:{messageHandler:m}};O=(a&&a.functions&&a.functions.odataRequestWrapper)||sap.apf.core.odataRequestWrapper;w=(a&&a.functions&&a.functions.ajax)||sap.apf.core.ajax;this.ajax=function(i){return w(i);};this.odataRequest=function(i,I,J,K){O(m,i,I,J,K);};this.checkForTimeout=function(i){var I=sap.apf.core.utils.checkForTimeout(i);if(I){m.putMessage(I);}return I;};this.getEntityTypeMetadata=function(i,I){return q.getEntityTypeMetadata(i,I);};this.getXsrfToken=function(i){return s.getXsrfToken(i);};this.getUriGenerator=function(){return sap.apf.core.utils.uriGenerator;};this.getText=function(i,P){return l.getText(i,P);};this.putMessage=function(i){return m.putMessage(i);};this.check=function(i,I,J){return m.check(i,I,J);};this.createMessageObject=function(i){return m.createMessageObject(i);};this.setCallbackForMessageHandling=function(i){m.setMessageCallback(i);};this.importTexts=function(I,J){var K;var i;var P;var Q;var T;function U(W,X,K){var Y;var Z;if(K){J(K);}else{Y={instance:{messageHandler:m,persistenceProxy:o},constructor:{hashtable:H}};Z=new sap.apf.modeler.core.TextPool(Y,T,W);Z.addTextsAndSave(Q.TextElements,J,T);}}function V(W,X){if(X){J(X);return;}var K;var Y=W.getApplication(T);if(!Y){K=m.createMessageObject({code:11021});J(K);return;}if(B&&B.getId()===T){B.getInstance().getTextPool().addTextsAndSave(Q.TextElements,J,T);}else{var Z=new sap.apf.core.utils.Filter(m,'Application','eq',T);var $=new sap.apf.core.utils.Filter(m,'Language','eq',sap.apf.core.constants.developmentLanguage);$.addAnd(Z);o.readCollection("texts",U,undefined,undefined,$,true);}}Q=sap.apf.utils.parseTextPropertyFile(I,{instance:{messageHandler:m}});if(Q.Messages.length>0){K=m.createMessageObject({code:11020});P=Q.Messages.length;for(i=0;i<P-1;i++){Q.Messages[i+1].setPrevious(Q.Messages[i]);}K.setPrevious(Q.Messages[P-1]);J(K);}else{T=Q.Application;this.getApplicationHandler(V);}};this.importConfiguration=function(i,I,J){var K=JSON.parse(i);var P=K.configHeader;var Q;if(!T(K,J)){return;}this.getApplicationHandler(U);function T(K,J){var Y=[],T=true,Z;if(!sap.apf.utils.isValidGuid(K.configHeader.Application)){Y.push(m.createMessageObject({code:11037,aParameters:[K.configHeader.Application]}));T=false;}if(!sap.apf.utils.isValidGuid(K.configHeader.AnalyticalConfiguration)){Y.push(m.createMessageObject({code:11038,aParameters:[K.configHeader.AnalyticalConfiguration]}));T=false;}Z=sap.apf.modeler.core.ConfigurationObjects.getTextKeysFromConfiguration(K);Z.forEach(function($){var _=new H(m);if(!_.hasItem($)){_.setItem($,$);if(!sap.apf.utils.isValidGuid($)){Y.push(m.createMessageObject({code:11039,aParameters:[$]}));T=false;}}});if(T){return T;}Y.forEach(function($,_,Y){if(_){$.setPrevious(Y[_-1]);}});J(i,undefined,Y[Y.length-1]);return T;}function U(Y,Z){if(Z){J(undefined,undefined,Z);return;}var $=false;var _=Y.getList();Q=P.Application;_.forEach(function(b1){if(b1.Application===P.Application){$=true;}});if($){t.getConfigurationHandler(P.Application,W);}else{var a1={ApplicationName:P.ApplicationName,SemanticObject:P.SemanticObject};Y.setAndSave(a1,V,P.Application,true);}}function V(Y,Z,$){if($){J(undefined,undefined,$);return;}t.getConfigurationHandler(P.Application,W);}function W(Y,Z){if(Z){J(undefined,undefined,Z);return;}var $=jQuery.extend({},K,true);delete $.configHeader;var _=false;var a1=Y.getList();a1.forEach(function(e1){if(e1.AnalyticalConfiguration===P.AnalyticalConfiguration){_=true;}});if(_){I(c1,d1);}else{Y.setConfiguration({AnalyticalConfigurationName:P.AnalyticalConfigurationName},P.AnalyticalConfiguration);var b1={id:P.AnalyticalConfiguration,creationDate:P.CreationUTCDateTime,lastChangeDate:P.LastChangeUTCDateTime,content:$};Y.loadConfiguration(b1,X);}function c1(){Y.setConfiguration({AnalyticalConfigurationName:P.AnalyticalConfigurationName},P.AnalyticalConfiguration);var b1={updateExisting:true,id:P.AnalyticalConfiguration,creationDate:P.CreationUTCDateTime,lastChangeDate:P.LastChangeUTCDateTime,content:$};Y.loadConfiguration(b1,X);}function d1(){var e1=Y.setConfiguration({AnalyticalConfigurationName:P.AnalyticalConfigurationName});var i={id:e1,content:$};Y.loadConfiguration(i,X);}}function X(Y,Z){if(Z){J(undefined,undefined,Z);return;}Y.save(J);}};this.getApplicationHandler=function(i){var x;if(!z){x=(a&&a.functions&&a.functions.loadApplicationHandler)||I;z=new L(v,x);}z.asyncGetInstance("ApplicationHandlerId",i);function I(J,K){new A({instance:{messageHandler:m,persistenceProxy:o},constructor:{hashtable:H},functions:{resetConfigurationHandler:Q}},P);function P(T,U){K(J,T,U);}function Q(T){if(B&&B.getId()===T){B.getInstance().removeAllConfigurations();B.reset();}}}};this.getConfigurationHandler=function(i,I){if(!B){y=(a&&a.functions&&a.functions.loadConfigurationHandler)||J;B=new L(v,y);}B.asyncGetInstance(i,I);function J(i,K,P){var Q=new sap.apf.core.utils.Filter(m,'Application','eq',i);var T=new sap.apf.core.utils.Filter(m,'Language','eq',sap.apf.core.constants.developmentLanguage);T.addAnd(Q);var U=[];var V=["AnalyticalConfiguration","AnalyticalConfigurationName","Application","CreatedByUser","CreationUTCDateTime","LastChangeUTCDateTime","LastChangedByUser"];U.push({entitySetName:"configuration",filter:Q,selectList:V});U.push({entitySetName:'texts',filter:T});o.readCollectionsInBatch(U,W,true);function W(X,Y){var Z,$;var _;var a1;var b1=P;if(Y){K(i,undefined,Y);}else{_=X[0];a1=X[1];$={instance:{messageHandler:m,persistenceProxy:o},constructor:{hashtable:H}};Z=new sap.apf.modeler.core.TextPool($,i,a1);if(!b1){b1=new C({instance:{messageHandler:m,persistenceProxy:o,datajs:OData,coreApi:t,metadataFactory:q},constructor:{configurationEditor:b,configurationFactory:d,configurationObjects:c,elementContainer:E,entityTypeMetadata:f,facetFilter:F,navigationTarget:N,hashtable:H,representation:R,registryProbe:e,step:S,lazyLoader:L},functions:{getApplication:z.getInstance().getApplication}});}b1.setApplicationIdAndContext(i,_,Z);K(i,b1,Y);}}}};this.getUnusedTextKeys=function(i,I){var J={instance:{messageHandler:m,persistenceProxy:o},constructor:{hashtable:H}};var K=new c(J);var P=null,Q=null,T=null;K.getTextKeysFromAllConfigurations(i,function(V,W){if(Q){return;}P=V;Q=W;if(W||T){U();}});this.getConfigurationHandler(i,function(V,W){if(Q){return;}T=V;Q=W;if(W||P){U();}});function U(){var V=[];if(Q){I(undefined,Q);return;}T.getTextPool().getTextKeys().forEach(function(W){if(!P.hasItem(W)){V.push(W);}});I(V,undefined);}};this.resetConfigurationHandler=function(){if(B){B.reset();}};this.getRepresentationTypes=function(){var i=sap.apf.core.representationTypes();var I=[];jQuery.extend(true,I,i);return I;};this.getAllAvailableSemanticObjects=function(i){function I(P,Q){G=P.results;i(P.results,undefined);}function J(P){var Q;if(P.messageObject){Q=P.messageObject;}else{Q=m.createMessageObject({code:"11041"});}i([],Q);}if(G){i(G,undefined);return;}var K={requestUri:"/sap/opu/odata/UI2/INTEROP/SemanticObjects?$format=json&$select=id,text",method:"GET",headers:{"x-csrf-token":s.getXsrfToken("/sap/opu/odata/UI2/INTEROP/SemanticObjects")}};t.odataRequest(K,I,J);};this.getSemanticActions=function(I){var J;var K=jQuery.Deferred();if(!D){D=new H(m);}J=D.getItem(I);if(J){K.resolve(J);return K.promise();}t.getAllAvailableSemanticObjects(P);return K.promise();function P(Q,T){if(T){K.reject(T);return;}var U=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation");var V;var i;if(!U){K.reject(m.createMessageObject({code:"5038"}));return;}for(i=0;i<Q.length;i++){if(Q[i].id===I){V=Q[i];break;}}U.getSemanticObjectLinks(I,undefined,true,a.instances.component,undefined).done(function(W){var X=[];W.forEach(function(Y){var Z=Y.intent.split("-");var $=Z[1].split("?");var $=$[0].split("~");X.push({id:$[0],text:Y.text});});D.setItem(I,{semanticObject:V,semanticActions:X});K.resolve({semanticObject:V,semanticActions:X});}).fail(function(){K.reject(m.createMessageObject({code:"11042"}));});}};if(a&&a.probe){new a.probe({constructor:{applicationHandler:A,configurationHandler:C,configurationEditor:b,configurationObjects:c,configurationFactory:d,metadataFactory:j,metadata:M,entityTypeMetadata:f,metadataFacade:g,metadataProperty:h,step:S,facetFilter:F,navigationTarget:N,representation:R,elementContainer:E,hashtable:H,lazyLoader:L,registryProbe:e},textHandler:l,messageHandler:m,sessionHandler:s,persistenceProxy:o,metadataFactory:q,injectForFollowUp:r,injectMetadataFactory:u,fnOdataRequestWrapper:O,ajax:w,odataRequestWrapper:O});}};}());};if(!jQuery.sap.isDeclared('sap.apf.core.instance')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.declare("sap.apf.core.instance");sap.apf.core.Instance=function(a){'use strict';var t=this;var m=a.messageHandler;var s=a.startParameter;var r;var I={messageHandler:m,coreApi:t};var R;var M;var T;var c;var p;var S;var P;this.destroy=function(){p.destroy();};this.ajax=function(b){return sap.apf.core.ajax(b);};this.odataRequest=function(b,f,e,B){sap.apf.core.odataRequestWrapper(m,b,f,e,B);};this.getStartParameterFacade=function(){return s;};this.getMessageHandler=function(){return m;};this.putMessage=function(b){return m.putMessage(b);};this.check=function(e,b,C){return m.check(e,b,C);};this.createMessageObject=function(C){return m.createMessageObject(C);};this.activateOnErrorHandling=function(O){m.activateOnErrorHandling(O);};this.setCallbackForMessageHandling=function(C){m.setMessageCallback(C);};this.setApplicationCallbackForMessageHandling=function(C){m.setApplicationMessageCallback(C);};this.getLogMessages=function(){return m.getLogMessages();};this.checkForTimeout=function(b){var d=sap.apf.core.utils.checkForTimeout(b);if(d){m.putMessage(d);}return d;};this.getUriGenerator=function(){return sap.apf.core.utils.uriGenerator;};this.getMetadata=function(A){return M.getMetadata(A);};this.getMetadataFacade=function(){return M.getMetadataFacade();};this.getEntityTypeMetadata=function(A,e){return M.getEntityTypeMetadata(A,e);};this.loadApplicationConfig=function(f){R.loadConfigFromFilePath(f);};this.loadTextElements=function(b){T.loadTextElements(b);};this.getApplicationConfigProperties=function(){return R.getConfigurationProperties();};this.getResourceLocation=function(b){return R.getResourceLocation(b);};this.getPersistenceConfiguration=function(){return R.getPersistenceConfiguration();};this.getApplicationConfigurationURL=function(){return R.getApplicationConfigurationURL();};this.getCategories=function(){return c.getCategories();};this.existsConfiguration=function(i){return c.existsConfiguration(i);};this.getStepTemplates=function(){return c.getStepTemplates();};this.getFacetFilterConfigurations=function(){return c.getFacetFilterConfigurations();};this.getNavigationTargets=function(){return c.getNavigationTargets();};this.createStep=function(b,f,d){var e;m.check(b!==undefined&&typeof b==="string"&&b.length!==0,"sStepID is  unknown or undefined");e=c.createStep(b,d);p.addStep(e,f);return e;};this.getSteps=function(){return p.getSteps();};this.moveStepToPosition=function(b,n,f){p.moveStepToPosition(b,n,f);};this.updatePath=function(f,C){p.update(f,C);};this.removeStep=function(b,f){p.removeStep(b,f);};this.resetPath=function(b){if(b){r=p.serialize();}if(p){p.destroy();}p=new sap.apf.core.Path(I);};this.restoreOriginalPath=function(){if(r){p.destroy();p=new sap.apf.core.Path(I);p.deserialize(r);}};this.stepIsActive=function(b){return p.stepIsActive(b);};this.serializePath=function(){return p.serialize();};this.deserializePath=function(b){p.deserialize(b);};this.getTextNotHtmlEncoded=function(l,b){return T.getTextNotHtmlEncoded(l,b);};this.getTextHtmlEncoded=function(l,b){return T.getTextHtmlEncoded(l,b);};this.isInitialTextKey=function(b){return(b===sap.apf.core.constants.textKeyForInitialText);};this.getMessageText=function(C,b){return T.getMessageText(C,b);};this.getXsrfToken=function(b){return S.getXsrfToken(b);};this.setContext=function(C){S.setContext(C);};this.getContext=function(){return S.getContext();};this.getCumulativeFilter=function(){return a.getCumulativeFilter();};this.getLogicalSystem=function(){return S.getLogicalSystem();};this.createReadRequest=function(b){var d=c.createRequest(b);var e;if(typeof b==='string'){e=c.getConfigurationById(b);}else{e=b;}return new sap.apf.core.ReadRequest(I,d,e.service,e.entityType);};this.createReadRequestByRequiredFilter=function(b){var d=c.createRequest(b);var e;if(typeof b==='string'){e=c.getConfigurationById(b);}else{e=b;}return new sap.apf.core.ReadRequestByRequiredFilter(I,d,e.service,e.entityType);};this.loadMessageConfiguration=function(b,d){m.loadConfig(b,d);};this.loadAnalyticalConfiguration=function(C){c.loadConfig(C);};this.savePath=function(b,d,e,f){var g;var n;var C;var E;if(typeof b==='string'&&typeof d==='string'&&typeof e==='function'){g=b;n=d;C=e;E=f;P.modifyPath(g,n,C,E);}else if(typeof b==='string'&&typeof d==='function'){n=b;C=d;E=e;P.createPath(n,C,E);}else{m.putMessage(sap.apf.core.createMessageObject({code:"5027",aParameters:[b,d,e]}));}};this.readPaths=function(C){P.readPaths(C);};this.openPath=function(b,C,n){function l(d,e,f){if(!f&&r){r=undefined;}C(d,e,f);}return P.openPath(b,l,n);};this.deletePath=function(b,C){P.deletePath(b,C);};this.createFilter=function(b){return new sap.apf.utils.Filter(m,b);};this.getActiveStep=function(){return p.getActiveSteps()[0];};this.getCumulativeFilterUpToActiveStep=function(){return p.getCumulativeFilterUpToActiveStep();};this.setActiveStep=function(b){p.makeStepActive(b);var A=p.getActiveSteps();var i;for(i=0;i<A.length;++i){p.makeStepInactive(A[i]);}return p.makeStepActive(b);};this.createFirstStep=function(b,d,e){var i=false;var f;f=t.getStepTemplates();f.forEach(function(g){i=g.id===b?true:i;});if(!i){m.putMessage(m.createMessageObject({code:'5036',aParameters:[b]}));}else{t.createStep(b,e,d);}};this.getFunctionCreateRequest=function(){return c.createRequest;};T=new sap.apf.core.TextResourceHandler(I);m.setTextResourceHandler(T);if(a.manifests){I.manifests=a.manifests;}c=new sap.apf.core.ConfigurationFactory(I);var o={entityTypeMetadata:sap.apf.core.EntityTypeMetadata,hashtable:sap.apf.utils.Hashtable,metadata:sap.apf.core.Metadata,metadataFacade:sap.apf.core.MetadataFacade,metadataProperty:sap.apf.core.MetadataProperty,messageHandler:I.messageHandler,coreApi:t,datajs:OData,configurationFactory:c};M=new sap.apf.core.MetadataFactory(o);p=new sap.apf.core.Path(I);S=new sap.apf.core.SessionHandler(I);P=new sap.apf.core.Persistence(I);R=new sap.apf.core.ResourcePathHandler(I);};};if(!jQuery.sap.isDeclared('sap.apf.modeler.Component')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
(function(){'use strict';jQuery.sap.declare("sap.apf.modeler.Component");jQuery.sap.require('sap.ui.core.UIComponent');jQuery.sap.require('sap.m.routing.RouteMatchedHandler');sap.ui.core.UIComponent.extend("sap.apf.modeler.Component",{oCoreApi:null,metadata:{manifest:"json"},init:function(){var p;var u=false;var s;if(this.initHasAlreadyBeenCalled){return;}this.initHasAlreadyBeenCalled=true;var m=jQuery.extend({},true,this.getMetadata().getManifest());if(m["sap.apf"]&&m["sap.apf"].activateLrep){u=m["sap.apf"].activateLrep;}if(jQuery.sap.getUriParameters().get('sap-apf-activate-lrep')){u=true;}else{s=this.getComponentData&&this.getComponentData()&&this.getComponentData().startupParameters;if(s&&s['sap-apf-activate-lrep']){u=s['sap-apf-activate-lrep'][0];}}if(m["sap.app"].dataSources&&m["sap.app"].dataSources.AnalyticalConfigurationServiceRoot){p=m["sap.app"].dataSources.AnalyticalConfigurationServiceRoot.uri;}else{p=sap.apf.core.constants.modelerPersistenceServiceRoot;}var a={serviceRoot:p,useLayeredRepositoryForAnalyticalConfiguration:u};var i={instances:{component:this}};if(u){i.constructor={persistenceProxy:sap.apf.core.LayeredRepositoryProxy}}this.oCoreApi=new sap.apf.modeler.core.Instance(a,i);var b=this.oCoreApi.getUriGenerator().getApfLocation();jQuery.sap.includeStyleSheet(b+"modeler/resources/css/configModeler.css","configModelerCss");sap.ui.core.UIComponent.prototype.init.apply(this,arguments);var r=this.getRouter();this.oRouteHandler=new sap.m.routing.RouteMatchedHandler(r);r.initialize();},createContent:function(){if(a===undefined){var a=sap.ui.view({viewName:"sap.apf.modeler.ui.view.applicationList",type:"XML",viewData:this.oCoreApi});}var b=this.oCoreApi.getUriGenerator().getApfLocation();return a;}});}());};if(!jQuery.sap.isDeclared('sap.apf.api')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
(function(){'use strict';jQuery.sap.declare('sap.apf.api');sap.apf.Api=function(c,i,m){var M;var C;var s;var n;var S;var e;var f;var a;var b;var d;this.type='api';this.constants={};this.constants.eventTypes=sap.apf.core.constants.eventTypes;s=new sap.apf.utils.StartParameter(c,m);M=new sap.apf.core.MessageHandler();M.activateOnErrorHandling(true);C=new sap.apf.core.Instance({startParameter:s,messageHandler:M,manifests:m,getCumulativeFilter:function(){return S.getCumulativeFilter();}});this.destroy=function(){if(u&&u.destroy){u.destroy();}if(C){C.destroy();}u=undefined;M.activateOnErrorHandling(false);M=undefined;C=undefined;s=undefined;n=undefined;};this.activateOnErrorHandling=function(h){return C.activateOnErrorHandling(h);};this.getStartParameterFacade=function(){return C.getStartParameterFacade();};this.setCallbackForMessageHandling=function(h){return C.setCallbackForMessageHandling(h);};this.setApplicationCallbackForMessageHandling=function(h){return C.setApplicationCallbackForMessageHandling(h);};this.getLogMessages=function(){return C.getLogMessages();};this.createStep=function(h,j,r){return C.createStep(h,j,r);};this.getActiveStep=function(){return C.getActiveStep();};this.getCategories=function(){return C.getCategories();};this.getSteps=function(){return C.getSteps();};this.getStepTemplates=function(){return C.getStepTemplates();};this.getFacetFilterConfigurations=function(){return C.getFacetFilterConfigurations();};this.getApplicationConfigProperties=function(){return C.getApplicationConfigProperties();};this.moveStepToPosition=function(h,j,k){return C.moveStepToPosition(h,j,k);};this.removeStep=function(h,j){return C.removeStep(h,j);};this.resetPath=function(){return C.resetPath();};this.setActiveStep=function(h){return C.setActiveStep(h);};this.stepIsActive=function(h){return C.stepIsActive(h);};this.updatePath=function(h){return C.updatePath(h);};this.getApfLocation=function(){return C.getUriGenerator().getApfLocation();};this.readPaths=function(h){return C.readPaths(h);};this.savePath=function(p,N,h){C.savePath(p,N,h);};this.openPath=function(p,h,j){return C.openPath(p,h,j);};this.deletePath=function(p,h){return C.deletePath(p,h);};this.addFacetFilter=function(h){u.getLayoutView().getController().addFacetFilter(h);};this.getEventCallback=function(E){return u.getEventCallback(E);};this.putMessage=function(h){return C.putMessage(h);};this.createMessageObject=function(h){return C.createMessageObject(h);};this.getTextHtmlEncoded=function(l,p){return C.getTextHtmlEncoded(l,p);};this.getTextNotHtmlEncoded=function(l,p){return C.getTextNotHtmlEncoded(l,p);};if(!m){this.loadApplicationConfig=function(F){C.loadApplicationConfig(F);};}else{this.loadApplicationConfig=function(F){};}this.createFilter=function(){return C.createFilter();};this.addPathFilter=function(h){return f.add(h);};this.updatePathFilter=function(h,j){f.update(h,j);};this.getPathFilter=function(h){return f.get(h);};this.createReadRequest=function(r){return C.createReadRequest(r);};this.createReadRequestByRequiredFilter=function(r){return C.createReadRequestByRequiredFilter(r);};b={instance:{startParameter:s,component:c,messageHandler:M},functions:{getConfigurationProperties:C.getApplicationConfigProperties}};e=new sap.apf.utils.ExternalContext(b);a={functions:{getFacetFilterConfigurations:this.getFacetFilterConfigurations,getCombinedContext:e.getCombinedContext,createRequest:C.getFunctionCreateRequest()},instance:{messageHandler:M},constructor:{StartFilter:sap.apf.utils.StartFilter}};S=new sap.apf.utils.StartFilterHandler(a);d={functions:{setRestrictionByProperty:S.setRestrictionByProperty,getRestrictionByProperty:S.getRestrictionByProperty},instance:{messageHandler:M}};f=new sap.apf.utils.FilterIdHandler(d);var g={functions:{getCumulativeFilterUpToActiveStep:C.getCumulativeFilterUpToActiveStep,getNavigationTargets:C.getNavigationTargets,getActiveStep:C.getActiveStep,serializePath:C.serializePath,serializeFilterIds:f.serialize,deserializePath:C.deserializePath,deserializeFilterIds:f.deserialize,createRequest:C.getFunctionCreateRequest(),getXappStateId:C.getStartParameterFacade().getXappStateId},instances:{messageHandler:M,component:c,startFilterHandler:S}};n=new sap.apf.utils.NavigationHandler(g);var o=new sap.apf.utils.SerializationMediator({coreApi:C,filterIdHandler:f,startFilterHandler:S});var u=new sap.apf.ui.Instance({oCoreApi:C,oFilterIdHandler:f,oSerializationMediator:o,oNavigationHandler:n,oComponent:c,oStartParameter:s,oStartFilterHandler:S});C.createRepresentation=function(r,h){var j=new sap.apf.ui.representations.RepresentationInterfaceProxy(C,u);var R=sap.apf.utils.extractFunctionFromModulePathString(r);return new R(j,h);};this.selectionChanged=function(r){u.selectionChanged(r);};this.createApplicationLayout=function(){return u.createApplicationLayout();};this.startApf=function(){var t=this;if(this.fnBeforeApfStartupCallback&&typeof this.fnBeforeApfStartupCallback==="function"){this.fnBeforeApfStartupCallback.apply(c,[this]);}var A=this.createApplicationLayout();var h=n.checkMode();var p=u.handleStartup(h);p.done(function(){if(t.fnAfterApfStartupCallback&&typeof t.fnAfterApfStartupCallback==="function"){t.fnAfterApfStartupCallback.apply(c,[t]);}});return A;};this.addMasterFooterContent=function(h){return u.addMasterFooterContentRight(h);};this.setEventCallback=function(E,h){switch(E){case sap.apf.core.constants.eventTypes.contextChanged:u.setEventCallback(E,h);return true;case sap.apf.core.constants.eventTypes.printTriggered:u.setEventCallback(E,h);return true;case sap.apf.core.constants.eventTypes.format:u.setEventCallback(E,h);return true;default:return false;}};this.setCallbackBeforeApfStartup=function(h){this.fnBeforeApfStartupCallback=h;};this.setCallbackAfterApfStartup=function(h){this.fnAfterApfStartupCallback=h;};if(i){if(i.probe){new i.probe({coreApi:C,component:c,uiApi:u,serializationMediator:o,navigationHandler:n,startParameter:s,injectedFunctionsNavigationHandler:g.functions,startFilterHandler:S});}}};}());};if(!jQuery.sap.isDeclared('sap.apf.base.Component')){
/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2015 SAP SE. All rights reserved
 */
(function(){'use strict';jQuery.sap.declare("sap.apf.base.Component");jQuery.sap.require('sap.ui.core.UIComponent');sap.ui.core.UIComponent.extend("sap.apf.base.Component",{metadata:{"manifest":"json","publicMethods":["getApi"]},oApi:null,init:function(){if(!this.oApi){var b=sap.apf.base.Component.prototype.getMetadata().getManifest();var m=jQuery.extend({},true,this.getMetadata().getManifest());this.oApi=new sap.apf.Api(this,undefined,{manifest:m,baseManifest:b});}else{return;}sap.ui.core.UIComponent.prototype.init.apply(this,arguments);},createContent:function(){sap.ui.core.UIComponent.prototype.createContent.apply(this,arguments);return this.oApi.startApf();},exit:function(){this.oApi.destroy();},getApi:function(){return this.oApi;}});}());};if(!jQuery.sap.isDeclared('sap.apf.Component')){
/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
(function(){'use strict';jQuery.sap.declare("sap.apf.Component");jQuery.sap.require('sap.ui.core.UIComponent');sap.ui.core.UIComponent.extend("sap.apf.Component",{oApi:null,metadata:{"config":{"fullWidth":true},"name":"CoreComponent","version":"0.0.1","publicMethods":["getApi"],"dependencies":{"libs":["sap.m","sap.ui.layout","sap.ca.ui","sap.viz"]}},init:function(){if(!this.oApi){this.oApi=new sap.apf.Api(this);}var a=this.oApi.getStartParameterFacade().getApplicationConfigurationPath();if(a){this.oApi.loadApplicationConfig(a);}sap.ui.core.UIComponent.prototype.init.apply(this,arguments);},createContent:function(){sap.ui.core.UIComponent.prototype.createContent.apply(this,arguments);return this.oApi.startApf();},exit:function(){this.oApi.destroy();},getApi:function(){return this.oApi;}});}());};
