(function(){"use strict";jQuery.sap.require("sap.ui.model.odata.AnnotationHelper");jQuery.sap.require("sap.ui.comp.smartfield.SmartField");jQuery.sap.declare("sap.suite.ui.generic.template.js.AnnotationHelper");sap.suite.ui.generic.template.js.AnnotationHelper={formatWithExpandSimple:function(i,d){var e=[],E;var m=i.getModel();var M=/^(\/dataServices\/schema\/\d+\/entityType\/\d+)(?:\/|$)/.exec(i.getPath());if(M&&M.length&&M[0]){var o=m.getProperty(M[0]);var n=m.getODataEntityContainer().namespace;var a=m.getODataEntityType(n+'.'+o.name);if(d&&d.Path){E=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,a,d.Path);if(E){e.push(E);}}else if(d&&d.Apply&&d.Apply.Name==="odata.concat"){d.Apply.Parameters.forEach(function(P){if(P.Type==="Path"){E=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,a,P.Value);if(E){if(e.indexOf(E)===-1){e.push(E);}}}});}if(e.length>0){var p=i.getSetting("preprocessorsData");if(p){var r=p.rootContextExpand||[];for(var j=0;j<e.length;j++){if(r.indexOf(e[j])===-1){r.push(e[j]);}}p.rootContextExpand=r;}}}return sap.ui.model.odata.AnnotationHelper.format(i,d);},formatWithExpand:function(i,d,e){sap.suite.ui.generic.template.js.AnnotationHelper.getNavigationPathWithExpand(i,d,e);i=i.getInterface(0);return sap.ui.model.odata.AnnotationHelper.format(i,d);},_getNavigationPrefix:function(m,e,p){var E="";var P=p.split("/");if(P.length>1){for(var i=0;i<(P.length-1);i++){var a=m.getODataAssociationEnd(e,P[i]);if(a){e=m.getODataEntityType(a.type);if(E){E=E+"/";}E=E+P[i];}else{return E;}}}return E;},getNavigationPathWithExpand:function(I,c,E){I=I.getInterface(0);var d=[],a=[],f,F=[];var m=I.getModel();var o=m.getODataEntitySet(E.name||'');var r=sap.ui.model.odata.AnnotationHelper.resolvePath(m.getContext(I.getPath()));var n=sap.ui.model.odata.AnnotationHelper.getNavigationPath(I,c);var N=n.replace("{","").replace("}","");if(N){var b=m.getODataEntityType(o.entityType);var A=m.getODataAssociationSetEnd(b,N);if(A&&A.entitySet){o=m.getODataEntitySet(A.entitySet);}}else{var b=m.getODataEntityType(E.entityType);}if(r){F=m.getObject(r);}F=F.Data||F;var g=function(P,k){var s=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,b,P);if(s){if(a.indexOf(s)===-1){a.push(s);}}if(k){try{d=sap.ui.comp.smartfield.SmartField.getSupportedAnnotationPaths(m,o,P,true)||[];}catch(e){d=[];}for(var i=0;i<d.length;i++){if(a.indexOf(d[i])===-1){a.push(d[i]);}}}};var h=function(P){if(P.Type==="LabeledElement"){g(P.Value.Path);}else if(P.Type==="Path"){g(P.Value);}};for(var i=0;i<F.length;i++){f=F[i];if(f.Value&&f.Value.Path){g(f.Value.Path,true);}if(f.Value&&f.Value.Apply&&f.Value.Apply.Name==="odata.concat"){f.Value.Apply.Parameters.forEach(h);}if(f.Action&&f.Action.Path){g(f.Action.Path);}if(f.Target&&f.Target.Path){g(f.Target.Path);}if(f.SemanticObject&&f.SemanticObject.Path){g(f.SemanticObject.Path);}if(f.Url&&f.Url.Path){g(f.Url.Path);}if(f.Url&&f.Url.Apply&&f.Url.Apply.Parameters){f.Url.Apply.Parameters.forEach(h);}if(f.UrlContentType&&f.UrlContentType.Path){g(f.UrlContentType.Path);}}if(F.name){g(F.name,true);}if(a.length>0){if(N===""){var p=I.getSetting("preprocessorsData");if(p){var R=p.rootContextExpand||[];for(var j=0;j<a.length;j++){if(R.indexOf(a[j])===-1){R.push(a[j]);}}p.rootContextExpand=R;}}else{n="{ path : '"+N+"', parameters : { expand : '"+a.join(',')+"'} }";}}return n;},isSelf:function(p){if(p===undefined||(p&&p.indexOf('@')===0&&p.indexOf('/')===-1)){return true;}return false;},number:function(v){if(!v){return NaN;}else if(v.Decimal){return+v.Decimal;}else if(v.Path){return'{'+v.Path+'}';}else{return NaN;}},formatColor:(function(){function f(v){if(!v){return NaN;}else if(v.Decimal){return v.Decimal;}else if(v.EnumMember){return'\''+v.EnumMember+'\'';}else if(v.Path){return'${'+v.Path+'}';}else{return NaN;}}function a(d){var c=d.Criticality;return'{= '+f(c)+' === \'UI.CriticalityType/Negative\' ? \'Error\' : '+f(c)+'=== \'UI.CriticalityType/Critical\' ? \'Critical\' : \'Good\'}';}function b(d){var v=f(d.Value);var c=d.CriticalityCalculation;return'{= ('+v+' < '+f(c.DeviationRangeLowValue)+' || '+v+' > '+f(c.DeviationRangeHighValue)+') ? \'Error\' : ('+v+' < '+f(c.ToleranceRangeLowValue)+' || '+v+' > '+f(c.ToleranceRangeHighValue)+') ? \'Critical\' : \'Good\'}';}return function(d){if(d.Criticality){return a(d);}else if(d.CriticalityCalculation){return b(d);}};})(),createP13N:function(c,C,d){var p="",a=[];if(d.Value.Path){p='\\{"columnKey":"'+d.Value.Path+'", "leadingProperty":"'+d.Value.Path;}else if(d.Value.Apply&&d.Value.Apply.Name==="odata.concat"){d.Value.Apply.Parameters.forEach(function(P){if(P.Type==="Path"){if(!p){p='\\{"columnKey":"'+P.Value+'", "leadingProperty":"'+P.Value;}else{a.push(P.Value);}}});}var m=this.getModel("meta");if(m){var e=m.getODataEntityType(c.entityType);if(e){var n=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,e,d.Value.Path);if(n){n=n+"/";}}}if(C["com.sap.vocabularies.Common.v1.Text"]){a.push(n+C["com.sap.vocabularies.Common.v1.Text"].Path);}if(C["Org.OData.Measures.V1.ISOCurrency"]){a.push(n+C["Org.OData.Measures.V1.ISOCurrency"].Path);}if(C["Org.OData.Measures.V1.Unit"]){a.push(n+C["Org.OData.Measures.V1.Unit"].Path);}if((d["RecordType"]==="com.sap.vocabularies.UI.v1.DataFieldWithUrl")&&d.Url&&d.Url.Apply&&d.Url.Apply.Parameters){d.Url.Apply.Parameters.forEach(function(P){if(P.Type==="LabeledElement"){a.push(n+P.Value.Path);}});}if(a.length>0){var A="";a.forEach(function(P){if(A){A=A+",";}A=A+P;});p+='", "additionalProperty":"'+A;}var N=false;if(c["Org.OData.Capabilities.V1.SortRestrictions"]&&c["Org.OData.Capabilities.V1.SortRestrictions"].NonSortableProperties){var b=c["Org.OData.Capabilities.V1.SortRestrictions"].NonSortableProperties;for(var i=b.length-1;i>=0;i--){if(b[i].PropertyPath===d.Value.Path){N=true;break;}}}if(!N){p+='", "sortProperty":"'+C.name;}var f=false;if(c["Org.OData.Capabilities.V1.FilterRestrictions"]){if(c["Org.OData.Capabilities.V1.FilterRestrictions"].Filterable!=='false'){if(c["Org.OData.Capabilities.V1.FilterRestrictions"].NonFilterableProperties){var g=c["Org.OData.Capabilities.V1.FilterRestrictions"].NonFilterableProperties;for(var j=g.length-1;j>=0;j--){if(g[j].PropertyPath===d.Value.Path){f=true;break;}}}}else{f=true;}}if(!f){p+='", "filterProperty":"'+C.name;}return p+'" \\}';},getEntitySetOfPath:function(c){var C="",r=c.getObject(),a=null,n=null,A=null,e=null,m=c.getModel(),E=null,s=[],b=null,d=null;var M=/^(\/dataServices\/schema\/\d+\/entityType\/\d+)(?:\/|$)/.exec(c.getPath());if(M){if(r.hasOwnProperty("AnnotationPath")){a=r.AnnotationPath;if(a.indexOf('/')>-1){n=a.split("/")[0];e=c.getObject(M[1]);A=m.getODataAssociationEnd(e,n);s=c.getObject('/dataServices/schema');jQuery.each(s,function(f,S){d=S.entityContainer;jQuery.each(d,function(i,o){jQuery.each(o.associationSet,function(i,g){jQuery.each(g.end,function(i,h){if(h.role===A.role){E=h.entitySet;b=f;return false;}});if(E){return false;}});if(E){return false;}});if(E){return false;}});if(E){jQuery.each(d,function(i,o){jQuery.each(o.entitySet,function(j,f){if(f.name===E){C='/dataServices/schema/'+b+'/entityContainer/'+i+'/entitySet/'+j;return false;}});if(C){return false;}});}}}}return C?C:undefined;},hasActions:function(P){for(var i=0;i<P.length;i++){if(P[i].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||P[i].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){return true;}}},getSortOrder:function(P){var s='';for(var i=0;i<P.length;i++){if(!s){s=P[i].Property.PropertyPath;}else{s=s+', '+P[i].Property.PropertyPath;}if(P[i].Descending){s=s+' '+P[i].Descending.Bool;}}return s;},replaceSpecialCharsInId:function(i){if(i.indexOf(" ")>=0){jQuery.sap.log.error("Annotation Helper: Spaces are not allowed in ID parts. Please check the annotations, probably something is wrong there.");}return i.replace("@","").replace("/","::").replace("#","::");},getStableIdPartFromDataField:function(d){var p="",I="";if(d.RecordType&&d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"){return sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Action.String);}else if(d.RecordType&&d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){if(d.SemanticObject.String){I=sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.SemanticObject.String);}else if(d.SemanticObject.Path){I=sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.SemanticObject.Path);}if(d.Action&&d.Action.String){I=I+"::"+sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Action.String);}else if(d.Action&&d.Action.Path){I=I+"::"+sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Action.Path);}return I;}else if(d.Value&&d.Value.Path){return sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Value.Path);}else if(d.Value&&d.Value.Apply&&d.Value.Apply.Name==="odata.concat"){for(var i=0;i<d.Value.Apply.Parameters.length;i++){if(d.Value.Apply.Parameters[i].Type==="Path"){if(p){p=p+"::";}p=p+sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Value.Apply.Parameters[i].Value);}}return p;}else{jQuery.sap.log.error("Annotation Helper: Unable to create a stable ID. Please check the annotations.");}},getStableIdPartFromDataPoint:function(d){var p="";if(d.Value&&d.Value.Path){return sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Value.Path);}else if(d.Value&&d.Value.Apply&&d.Value.Apply.Name==="odata.concat"){for(var i=0;i<d.Value.Apply.Parameters.length;i++){if(d.Value.Apply.Parameters[i].Type==="Path"){if(p){p=p+"::";}p=p+sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Value.Apply.Parameters[i].Value);}}return p;}else{jQuery.sap.log.error("Annotation Helper: Unable to create stable ID derived from annotations.");}},getStableIdPartFromFacet:function(f){if(f.RecordType&&f.RecordType==="com.sap.vocabularies.UI.v1.CollectionFacet"){if(f.ID&&f.ID.String){return f.ID.String;}else{jQuery.sap.log.error("Annotation Helper: Unable to create a stable ID. You have to set an ID at all collection facets.");return Math.floor((Math.random()*99999)+1).toString();}}else if(f.RecordType&&f.RecordType==="com.sap.vocabularies.UI.v1.ReferenceFacet"){return sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(f.Target.AnnotationPath);}else{jQuery.sap.log.error("Annotation Helper: Unable to create a stable ID. Please check the facet annotations.");return Math.floor((Math.random()*99999)+1).toString();}},extensionPointBeforeFacetExists:function(e,f,m){var E="BeforeFacet|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);if(m['sap.suite.ui.generic.template.ObjectPage.view.Details'][E]){return"true";}else{return"";}},extensionPointAfterFacetExists:function(e,f,m){var E="AfterFacet|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);if(m['sap.suite.ui.generic.template.ObjectPage.view.Details'][E]){return"true";}else{return"";}},getExtensionPointBeforeFacetTitle:function(e,f,m){var E="BeforeFacet|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);var o=m['sap.suite.ui.generic.template.ObjectPage.view.Details'][E];if(o&&o['sap.ui.generic.app']&&o['sap.ui.generic.app'].title){return o['sap.ui.generic.app'].title;}},getExtensionPointAfterFacetTitle:function(e,f,m){var E="AfterFacet|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);var o=m['sap.suite.ui.generic.template.ObjectPage.view.Details'][E];if(o&&o['sap.ui.generic.app']&&o['sap.ui.generic.app'].title){return o['sap.ui.generic.app'].title;}},getRepeatIndex:function(v){if(v&&v.getPath()){return parseInt(v.getPath().substring(v.getPath().lastIndexOf("/")+1),10)+1;}else{jQuery.sap.log.error("Annotation Helper: Unable to get index.");}},getColumnListItemType:function(l,s){var t="Inactive";if(l.name&&s&&s.length>0){s.forEach(function(S){if(l.name===S.entitySet){t="Navigation";}});}return t;},getEntityTypesForFormPersonalization:function(i,f,e){i=i.getInterface(0);var E=[];var m=i.getModel();var o=m.getODataEntitySet(e.name||'');var F=[];if(f.RecordType==="com.sap.vocabularies.UI.v1.CollectionFacet"&&f.Facets){F=f.Facets;}else if(f.RecordType==="com.sap.vocabularies.UI.v1.ReferenceFacet"){F.push(f);}F.forEach(function(f){var n;if(f.Target&&f.Target.AnnotationPath&&f.Target.AnnotationPath.indexOf("/")>0){n=f.Target.AnnotationPath.split("/")[0];var a=m.getODataEntityType(o.entityType);var A=m.getODataAssociationSetEnd(a,n);if(A&&A.entitySet){o=m.getODataEntitySet(A.entitySet);if(E.indexOf(o.entityType.split(".")[1])===-1){E.push(o.entityType.split(".")[1]);}}}else{if(E.indexOf(e.entityType.split(".")[1])===-1){E.push(e.entityType.split(".")[1]);}}});return E.join(", ");}};sap.suite.ui.generic.template.js.AnnotationHelper.getRepeatIndex.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.formatWithExpand.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.formatWithExpandSimple.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getNavigationPathWithExpand.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getEntityTypesForFormPersonalization.requiresIContext=true;})();
