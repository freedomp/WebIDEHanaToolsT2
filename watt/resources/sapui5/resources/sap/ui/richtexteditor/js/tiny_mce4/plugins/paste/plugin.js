(function(a,u){"use strict";var m={};function r(e,g){var h,j=[];for(var i=0;i<e.length;++i){h=m[e[i]]||c(e[i]);if(!h){throw'module definition dependecy not found: '+e[i];}j.push(h);}g.apply(null,j);}function d(i,e,g){if(typeof i!=='string'){throw'invalid module definition, module id must be defined and be a string';}if(e===u){throw'invalid module definition, dependencies must be specified';}if(g===u){throw'invalid module definition, definition function must be specified';}r(e,function(){m[i]=g.apply(null,arguments);});}function b(i){return!!m[i];}function c(i){var t=a;var e=i.split(/[.\/]/);for(var g=0;g<e.length;++g){if(!t[e[g]]){return;}t=t[e[g]];}return t;}function f(e){var i,t,g,h,p;for(i=0;i<e.length;i++){t=a;g=e[i];h=g.split(/[.\/]/);for(var j=0;j<h.length-1;++j){if(t[h[j]]===u){t[h[j]]={};}t=t[h[j]];}t[h[h.length-1]]=m[g];}if(a.AMDLC_TESTS){p=a.privateModules||{};for(g in m){p[g]=m[g];}for(i=0;i<e.length;i++){delete p[e[i]];}a.privateModules=p;}}d("tinymce/pasteplugin/Utils",["tinymce/util/Tools","tinymce/html/DomParser","tinymce/html/Schema"],function(T,D,S){function e(g,h){T.each(h,function(v){if(v.constructor==RegExp){g=g.replace(v,'');}else{g=g.replace(v[0],v[1]);}});return g;}function i(h){var s=new S(),g=new D({},s),j='';var k=s.getShortEndedElements();var l=T.makeMap('script noscript style textarea video audio iframe object',' ');var n=s.getBlockElements();function w(o){var p=o.name,q=o;if(p==='br'){j+='\n';return;}if(k[p]){j+=' ';}if(l[p]){j+=' ';return;}if(o.type==3){j+=o.value;}if(!o.shortEnded){if((o=o.firstChild)){do{w(o);}while((o=o.next));}}if(n[p]&&q.next){j+='\n';if(p=='p'){j+='\n';}}}h=e(h,[/<!\[[^\]]+\]>/g]);w(g.parse(h));return j;}function t(h){function g(j,s,k){if(!s&&!k){return' ';}return'\u00a0';}h=e(h,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/g,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,g],/<br>$/i]);return h;}return{filter:e,innerText:i,trimHtml:t};});d("tinymce/pasteplugin/Clipboard",["tinymce/Env","tinymce/dom/RangeUtils","tinymce/util/VK","tinymce/pasteplugin/Utils"],function(E,R,V,U){return function(g){var s=this,p,l,k=0,h=false;var j='%MCEPASTEBIN%',n;var o='data:text/mce-internal,';function q(e){var i,J=g.dom;i=g.fire('BeforePastePreProcess',{content:e});i=g.fire('PastePreProcess',i);e=i.content;if(!i.isDefaultPrevented()){if(g.hasEventListeners('PastePostProcess')&&!i.isDefaultPrevented()){var K=J.add(g.getBody(),'div',{style:'display:none'},e);i=g.fire('PastePostProcess',{node:K});J.remove(K);e=i.node.innerHTML;}if(!i.isDefaultPrevented()){g.insertContent(e,{merge:g.settings.paste_merge_formats!==false,data:{paste:true}});}}}function t(e){e=g.dom.encode(e).replace(/\r\n/g,'\n');var i=g.dom.getParent(g.selection.getStart(),g.dom.isBlock);var J=g.settings.forced_root_block;var K;if(J){K=g.dom.createHTML(J,g.settings.forced_root_block_attrs);K=K.substr(0,K.length-3)+'>';}if((i&&/^(PRE|DIV)$/.test(i.nodeName))||!J){e=U.filter(e,[[/\n/g,"<br>"]]);}else{e=U.filter(e,[[/\n\n/g,"</p>"+K],[/^(.*<\/p>)(<p>)$/,K+'$1'],[/\n/g,"<br />"]]);if(e.indexOf('<p>')!=-1){e=K+e;}}q(e);}function v(){var i=g.dom,J=g.getBody();var K=g.dom.getViewPort(g.getWin()),L=K.y,M=20;var N;l=g.selection.getRng();if(g.inline){N=g.selection.getScrollContainer();if(N&&N.scrollTop>0){L=N.scrollTop;}}function O(e){var S,T,W,Q=e.startContainer;S=e.getClientRects();if(S.length){return S[0];}if(!e.collapsed||Q.nodeType!=1){return;}W=Q.childNodes[l.startOffset];while(W&&W.nodeType==3&&!W.data.length){W=W.nextSibling;}if(!W){return;}if(W.tagName=='BR'){T=i.doc.createTextNode('\uFEFF');W.parentNode.insertBefore(T,W);e=i.createRng();e.setStartBefore(T);e.setEndAfter(T);S=e.getClientRects();i.remove(T);}if(S.length){return S[0];}}if(l.getClientRects){var P=O(l);if(P){M=L+(P.top-i.getPos(J).y);}else{M=L;var Q=l.startContainer;if(Q){if(Q.nodeType==3&&Q.parentNode!=J){Q=Q.parentNode;}if(Q.nodeType==1){M=i.getPos(Q,N||J).y;}}}}p=i.add(g.getBody(),'div',{id:"mcepastebin",contentEditable:true,"data-mce-bogus":"all",style:'position: absolute; top: '+M+'px;'+'width: 10px; height: 10px; overflow: hidden; opacity: 0'},j);if(E.ie||E.gecko){i.setStyle(p,'left',i.getStyle(J,'direction',true)=='rtl'?0xFFFF:-0xFFFF);}i.bind(p,'beforedeactivate focusin focusout',function(e){e.stopPropagation();});p.focus();g.selection.select(p,true);}function w(){if(p){var e;while((e=g.dom.get('mcepastebin'))){g.dom.remove(e);g.dom.unbind(e);}if(l){g.selection.setRng(l);}}p=l=null;}function x(){var e='',J,i,K,L;J=g.dom.select('div[id=mcepastebin]');for(i=0;i<J.length;i++){K=J[i];if(K.firstChild&&K.firstChild.id=='mcepastebin'){K=K.firstChild;}L=K.innerHTML;if(e!=j){e+=L;}}return e;}function y(e){var i,J,K,L;K=[25942,29554,28521,14958];for(i=0;i<K.length;i++){if(e.charCodeAt(i)!=K[i]){return e;}}J='';for(i=0;i<e.length;i++){L=e.charCodeAt(i);J+=String.fromCharCode((L&0x00FF));J+=String.fromCharCode((L&0xFF00)>>8);}return decodeURIComponent(escape(J));}function z(e){var i,J,K;J='<!--StartFragment-->';i=e.indexOf(J);if(i!==-1){e=e.substr(i+J.length);}K='<!--EndFragment-->';i=e.indexOf(K);if(i!==-1){e=e.substr(0,i);}return e;}function A(e){var J={};if(e){if(e.getData){var K=e.getData('Text');if(K&&K.length>0){if(K.indexOf(o)==-1){J['text/plain']=K;}}}if(e.types){for(var i=0;i<e.types.length;i++){var L=e.types[i],M=e.getData(L);if(L=='text/html'){M=z(y(M));}J[L]=M;}}}return J;}function B(e){return A(e.clipboardData||g.getDoc().dataTransfer);}function C(e,J){var K=e.clipboardData||e.dataTransfer;function L(M){var i,N,O,P=false;function Q(O){if(J){g.selection.setRng(J);J=null;}q('<img src="'+O.result+'">');}if(M){for(i=0;i<M.length;i++){N=M[i];if(/^image\/(jpeg|png|gif|bmp)$/.test(N.type)){O=new FileReader();O.onload=Q.bind(null,O);O.readAsDataURL(N.getAsFile?N.getAsFile():N);e.preventDefault();P=true;}}}return P;}if(g.settings.paste_data_images&&K){return L(K.items)||L(K.files);}}function D(e){var i=e.clipboardData;return navigator.userAgent.indexOf('Android')!=-1&&i&&i.items&&i.items.length===0;}function F(e){return R.getCaretRangeFromPoint(e.clientX,e.clientY,g.getDoc());}function G(e,i){return i in e&&e[i].length>0;}function H(e){return(V.metaKeyPressed(e)&&e.keyCode==86)||(e.shiftKey&&e.keyCode==45);}function I(){g.on('keydown',function(e){function i(e){if(H(e)&&!e.isDefaultPrevented()){w();}}if(H(e)&&!e.isDefaultPrevented()){n=e.shiftKey&&e.keyCode==86;if(n&&E.webkit&&navigator.userAgent.indexOf('Version/')!=-1){return;}e.stopImmediatePropagation();k=new Date().getTime();if(E.ie&&n){e.preventDefault();g.fire('paste',{ieFake:true});return;}w();v();g.once('keyup',i);g.once('paste',function(){g.off('keyup',i);});}});g.on('paste',function(e){var i=new Date().getTime();var J=B(e);var K=new Date().getTime()-i;var L=(new Date().getTime()-k-K)<1000;var M=s.pasteFormat=="text"||n;n=false;if(e.isDefaultPrevented()||D(e)){w();return;}if(C(e)){w();return;}if(!L){e.preventDefault();}if(E.ie&&(!L||e.ieFake)){v();g.dom.bind(p,'paste',function(e){e.stopPropagation();});g.getDoc().execCommand('Paste',false,null);J["text/html"]=x();}setTimeout(function(){var N;if(G(J,'text/html')){N=J['text/html'];}else{N=x();if(N==j){M=true;}}N=U.trimHtml(N);if(p&&p.firstChild&&p.firstChild.id==='mcepastebin'){M=true;}w();if(!N.length){M=true;}if(M){if(G(J,'text/plain')&&N.indexOf('</p>')==-1){N=J['text/plain'];}else{N=U.innerText(N);}}if(N==j){if(!L){g.windowManager.alert('Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents.');}return;}if(M){t(N);}else{q(N);}},0);});g.on('dragstart dragend',function(e){h=e.type=='dragstart';});g.on('drop',function(e){var i=F(e);if(e.isDefaultPrevented()||h){return;}if(C(e,i)){return;}if(i&&g.settings.paste_filter_drop!==false){var J=A(e.dataTransfer);var K=J['mce-internal']||J['text/html']||J['text/plain'];if(K){e.preventDefault();g.undoManager.transact(function(){if(J['mce-internal']){g.execCommand('Delete');}g.selection.setRng(i);K=U.trimHtml(K);if(!J['text/html']){t(K);}else{q(K);}});}}});g.on('dragover dragend',function(e){if(g.settings.paste_data_images){e.preventDefault();}});}s.pasteHtml=q;s.pasteText=t;g.on('preInit',function(){I();g.parser.addNodeFilter('img',function(e,J,K){function L(K){return K.data&&K.data.paste===true;}function M(Q){if(!Q.attr('data-mce-object')&&P!==E.transparentSrc){Q.remove();}}function N(P){return P.indexOf("webkit-fake-url")===0;}function O(P){return P.indexOf("data:")===0;}if(!g.settings.paste_data_images&&L(K)){var i=e.length;while(i--){var P=e[i].attributes.map.src;if(!P){continue;}if(N(P)){M(e[i]);}else if(!g.settings.allow_html_data_urls&&O(P)){M(e[i]);}}}});});};});d("tinymce/pasteplugin/WordFilter",["tinymce/util/Tools","tinymce/html/DomParser","tinymce/html/Schema","tinymce/html/Serializer","tinymce/html/Node","tinymce/pasteplugin/Utils"],function(T,D,S,g,N,U){function h(e){return((/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i).test(e)||(/class="OutlineElement/).test(e)||(/id="?docs\-internal\-guid\-/.test(e)));}function j(t){var e,p;p=[/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/];t=t.replace(/^[\u00a0 ]+/,'');T.each(p,function(i){if(i.test(t)){e=true;return false;}});return e;}function k(t){return/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(t);}function W(l){var s=l.settings;l.on('BeforePastePreProcess',function(e){var n=e.content,o,v;n=n.replace(/<b[^>]+id="?docs-internal-[^>]*>/gi,'');n=n.replace(/<br class="?Apple-interchange-newline"?>/gi,'');o=s.paste_retain_style_properties;if(o){v=T.makeMap(o.split(/[, ]/));}function p(z){var A,B,C=1;function E(z){var O='';if(z.type===3){return z.value;}if((z=z.firstChild)){do{O+=E(z);}while((z=z.next));}return O;}function F(z,O){if(z.type===3){if(O.test(z.value)){z.value=z.value.replace(O,'');return false;}}if((z=z.firstChild)){do{if(!F(z,O)){return false;}}while((z=z.next));}return true;}function G(z){if(z._listIgnore){z.remove();return;}if((z=z.firstChild)){do{G(z);}while((z=z.next));}}function H(O,P,M){var Q=O._listLevel||C;if(Q!=C){if(Q<C){if(A){A=A.parent.parent;}}else{B=A;A=null;}}if(!A||A.name!=P){B=B||A;A=new N(P,1);if(M>1){A.attr('start',''+M);}O.wrap(A);}else{A.append(O);}O.name='li';if(Q>C&&B){B.lastChild.append(A);}C=Q;G(O);F(O,/^\u00a0+/);F(O,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/);F(O,/^\u00a0+/);}var I=[],J=z.firstChild;while(typeof J!=='undefined'&&J!==null){I.push(J);J=J.walk();if(J!==null){while(typeof J!=='undefined'&&J.parent!==z){J=J.walk();}}}for(var i=0;i<I.length;i++){z=I[i];if(z.name=='p'&&z.firstChild){var K=E(z);if(k(K)){H(z,'ul');continue;}if(j(K)){var L=/([0-9]+)\./.exec(K);var M=1;if(L){M=parseInt(L[1],10);}H(z,'ol',M);continue;}if(z._listLevel){H(z,'ul',1);continue;}A=null;}else{B=A;A=null;}}}function q(i,z){var A={},B,C=l.dom.parseStyle(z);T.each(C,function(E,F){switch(F){case'mso-list':B=/\w+ \w+([0-9]+)/i.exec(z);if(B){i._listLevel=parseInt(B[1],10);}if(/Ignore/i.test(E)&&i.firstChild){i._listIgnore=true;i.firstChild._listIgnore=true;}break;case"horiz-align":F="text-align";break;case"vert-align":F="vertical-align";break;case"font-color":case"mso-foreground":F="color";break;case"mso-background":case"mso-highlight":F="background";break;case"font-weight":case"font-style":if(E!="normal"){A[F]=E;}return;case"mso-element":if(/^(comment|comment-list)$/i.test(E)){i.remove();return;}break;}if(F.indexOf('mso-comment')===0){i.remove();return;}if(F.indexOf('mso-')===0){return;}if(o=="all"||(v&&v[F])){A[F]=E;}});if(/(bold)/i.test(A["font-weight"])){delete A["font-weight"];i.wrap(new N("b",1));}if(/(italic)/i.test(A["font-style"])){delete A["font-style"];i.wrap(new N("i",1));}A=l.dom.serializeStyle(A,i.name);if(A){return A;}return null;}if(s.paste_enable_default_filters===false){return;}if(h(e.content)){e.wordContent=true;n=U.filter(n,[/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,"\u00a0"],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(i,z){return(z.length>0)?z.replace(/./," ").slice(Math.floor(z.length/2)).split("").join("\u00a0"):"";}]]);var t=s.paste_word_valid_elements;if(!t){t=('-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,'+'-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,'+'td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody');}var w=new S({valid_elements:t,valid_children:'-li[p]'});T.each(w.elements,function(i){if(!i.attributes["class"]){i.attributes["class"]={};i.attributesOrder.push("class");}if(!i.attributes.style){i.attributes.style={};i.attributesOrder.push("style");}});var x=new D({},w);x.addAttributeFilter('style',function(z){var i=z.length,A;while(i--){A=z[i];A.attr('style',q(A,A.attr('style')));if(A.name=='span'&&A.parent&&!A.attributes.length){A.unwrap();}}});x.addAttributeFilter('class',function(z){var i=z.length,A,B;while(i--){A=z[i];B=A.attr('class');if(/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(B)){A.remove();}A.attr('class',null);}});x.addNodeFilter('del',function(z){var i=z.length;while(i--){z[i].remove();}});x.addNodeFilter('a',function(z){var i=z.length,A,B,C;while(i--){A=z[i];B=A.attr('href');C=A.attr('name');if(B&&B.indexOf('#_msocom_')!=-1){A.remove();continue;}if(B&&B.indexOf('file://')===0){B=B.split('#')[1];if(B){B='#'+B;}}if(!B&&!C){A.unwrap();}else{if(C&&!/^_?(?:toc|edn|ftn)/i.test(C)){A.unwrap();continue;}A.attr({href:B,name:C});}}});var y=x.parse(n);if(s.paste_convert_word_fake_lists!==false){p(y);}e.content=new g({},w).serialize(y);}});}W.isWordContent=h;return W;});d("tinymce/pasteplugin/Quirks",["tinymce/Env","tinymce/util/Tools","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Utils"],function(E,T,W,U){"use strict";return function(g){function h(i){g.on('BeforePastePreProcess',function(e){e.content=i(e.content);});}function j(e){if(!W.isWordContent(e)){return e;}var i=[];T.each(g.schema.getBlockElements(),function(n,o){i.push(o);});var l=new RegExp('(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?('+i.join('|')+')[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*','g');e=U.filter(e,[[l,'$1']]);e=U.filter(e,[[/<br><br>/g,'<BR><BR>'],[/<br>/g,' '],[/<BR><BR>/g,'<br>']]);return e;}function k(e){if(W.isWordContent(e)){return e;}var w=g.settings.paste_webkit_styles;if(g.settings.paste_remove_styles_if_webkit===false||w=="all"){return e;}if(w){w=w.split(/[, ]/);}if(w){var l=g.dom,n=g.selection.getNode();e=e.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,function(o,p,v,q){var s=l.parseStyle(v,'span'),t={};if(w==="none"){return p+q;}for(var i=0;i<w.length;i++){var x=s[w[i]],y=l.getStyle(n,w[i],true);if(/color/.test(w[i])){x=l.toHex(x);y=l.toHex(y);}if(y!=x){t[w[i]]=x;}}t=l.serializeStyle(t,'span');if(t){return p+' style="'+t+'"'+q;}return p+q;});}else{e=e.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,'$1$3');}e=e.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,function(i,o,v,p){return o+' style="'+v+'"'+p;});return e;}if(E.webkit){h(k);}if(E.ie){h(j);}};});d("tinymce/pasteplugin/Plugin",["tinymce/PluginManager","tinymce/pasteplugin/Clipboard","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Quirks"],function(P,C,W,Q){var g;P.add('paste',function(h){var s=this,i,j=h.settings;function t(){if(i.pasteFormat=="text"){this.active(false);i.pasteFormat="html";}else{i.pasteFormat="text";this.active(true);if(!g){h.windowManager.alert('Paste is now in plain text mode. Contents will now '+'be pasted as plain text until you toggle this option off.');g=true;}}}s.clipboard=i=new C(h);s.quirks=new Q(h);s.wordFilter=new W(h);if(h.settings.paste_as_text){s.clipboard.pasteFormat="text";}if(j.paste_preprocess){h.on('PastePreProcess',function(e){j.paste_preprocess.call(s,s,e);});}if(j.paste_postprocess){h.on('PastePostProcess',function(e){j.paste_postprocess.call(s,s,e);});}h.addCommand('mceInsertClipboardContent',function(e,v){if(v.content){s.clipboard.pasteHtml(v.content);}if(v.text){s.clipboard.pasteText(v.text);}});if(h.paste_block_drop){h.on('dragend dragover draggesture dragdrop drop drag',function(e){e.preventDefault();e.stopPropagation();});}if(!h.settings.paste_data_images){h.on('drop',function(e){var k=e.dataTransfer;if(k&&k.files&&k.files.length>0){e.preventDefault();}});}h.addButton('pastetext',{icon:'pastetext',tooltip:'Paste as text',onclick:t,active:s.clipboard.pasteFormat=="text"});h.addMenuItem('pastetext',{text:'Paste as text',selectable:true,active:i.pasteFormat,onclick:t});});});f(["tinymce/pasteplugin/Utils"]);})(this);
