/*
 * SInA - SAP HANA Simple Info Access API
 * version 2.0.8 - 2015-08-26 

 * Copyright (c) 2015 SAP SE; All rights reserved
 */
/*
 * @file Simple info access (SINA) API: datasource Interface
 * @namespace sap.bc.ina.api.sina.base.datasource
 * @copyright 2014 SAP SE. All rights reserved.
 */
(function(g){"use strict";if(g!==null){g.sap=g.sap||{};g.sap.bc=g.sap.bc||{};g.sap.bc.ina=g.sap.bc.ina||{};g.sap.bc.ina.api=g.sap.bc.ina.api||{};g.sap.bc.ina.api.sina=g.sap.bc.ina.api.sina||{};g.sap.bc.ina.api.sina.expandPackage=function(g,p){var s=p.split('.');var w=g;for(var i=0;i<s.length;i++){if(typeof w[s[i]]==='undefined'){w[s[i]]={};}w=w[s[i]];}};}}(window));(function(g){"use strict";g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.base.datasource');var m=g.sap.bc.ina.api.sina.base.datasource;m.getRootDataSource=function(){};m.DataSource=function(){this.init.apply(this,arguments);};m.DataSourceMetaData=function(){this.init.apply(this,arguments);};m.DataSourceMetaData.prototype={init:function(){}};m.DataSource.prototype={init:function(p){this.type=p.type||'Category';this.name=p.name||'dummy';this.label=p.label||p.name;this.labelPlural=p.labelPlural||p.label;this.key=this.type+'/'+this.name;},equals:function(o){if(this.key!==o.key){return false;}return true;},getMetaData:function(c){},getMetaDataSync:function(){},getType:function(){return this.type;},getLabel:function(){return this.label;},getLabelPlural:function(){return this.labelPlural;},toURL:function(){return{'type':this.type,'name':this.name,'label':this.label,'labelPlural':this.labelPlural};}};}(window));
/*
 * @file Simple info access (SINA) API: Filter Interface
 * @namespace sap.bc.ina.api.sina.base.filter
 * @copyright 2014 SAP SE. All rights reserved.
 */
(function(g){"use strict";g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.base.filter');var m=g.sap.bc.ina.api.sina.base.filter;m.Filter=function(){this.init.apply(this,arguments);};m.Condition=function(){this.init.apply(this,arguments);};m.ConditionGroup=function(){this.init.apply(this,arguments);};m.Filter.prototype={init:function(p){p=p||{};this.sina=p.sina;this.setDataSource(p.dataSource,false);this.root=null;this.conditionGroupsByAttribute={};this.defaultConditionGroup=this.sina.createFilterConditionGroup({operator:'And'});this.searchTerms="";},addFilterCondition:function(a,o,v){var l=a;var b=o;var c=v;var p=a;if(a instanceof m.ConditionGroup){p=a.conditions[0];}if(jQuery.type(a)==='object'){l=p.attribute;b=p.operator;c=p.value;}if(l===undefined||b===undefined||c===undefined){return this;}if(this.conditionGroupsByAttribute[l]===undefined){this.conditionGroupsByAttribute[l]=this.sina.createFilterConditionGroup({operator:'OR'});this.defaultConditionGroup.addCondition(this.conditionGroupsByAttribute[l]);}if(a instanceof m.ConditionGroup){this.conditionGroupsByAttribute[l].addCondition(a);}else{this.conditionGroupsByAttribute[l].addCondition(this.sina.createFilterCondition(l,b,c));}return this;},empty:function(){this.root=null;this.conditionGroupsByAttribute={};this.defaultConditionGroup=this.sina.createFilterConditionGroup({operator:'And'});this.searchTerms='';return this;},hasFilterCondition:function(a,o,v){if(typeof a==="string"){a=this.sina.createFilterCondition(a,o,v);}return this.defaultConditionGroup.hasCondition(a);},resetFilterConditions:function(){this.root=null;this.conditionGroupsByAttribute={};this.defaultConditionGroup=this.sina.createFilterConditionGroup({operator:'And'});return this;},removeFilterCondition:function(a,o,v){var c=this.sina.createFilterCondition(a,o,v);this.defaultConditionGroup.removeCondition(c);if(this.conditionGroupsByAttribute[a]){this.conditionGroupsByAttribute[a].removeCondition(c);if(this.conditionGroupsByAttribute[a].conditions.length===0){delete this.conditionGroupsByAttribute[a];}}return this;},addFilterConditionGroup:function(c){this.defaultConditionGroup.addCondition(c);},getFilterConditions:function(){return this.defaultConditionGroup;},getSearchTerms:function(){return this.searchTerms;},getDataSource:function(){return this.dataSource;},removeFilterConditionGroup:function(c){this.defaultConditionGroup.removeCondition(c);var a=c.conditions[0].attribute;if(this.conditionGroupsByAttribute[a]){this.conditionGroupsByAttribute[a].removeCondition(c);if(this.conditionGroupsByAttribute[a].conditions.length===0){delete this.conditionGroupsByAttribute[a];}}},setSearchTerms:function(s){this.searchTerms=s;},setDataSource:function(d){this.dataSource=d;},getJson:function(){},setJson:function(j){}};m.Condition.prototype={init:function(a,o,v){if(jQuery.type(a)==='object'){var p=a;a=p.attribute;o=p.operator;v=p.value;}this.attribute=a||"";this.operator=o||"=";this.value=v;},equals:function(o){if(!(o instanceof m.Condition)){return false;}return this.attribute.toLowerCase()===o.attribute.toLowerCase()&&this.operator===o.operator&&this.value.toLowerCase()===o.value.toLowerCase();},getJson:function(){},setJson:function(j){},toString:function(){return this.attribute+this.operator+this.value+'';}};m.ConditionGroup.prototype={init:function(p){p=p||{};this.label=p.label||'';this.conditions=p.conditions||[];this.setOperator(p.operator||'And');},addCondition:function(c){this.conditions.push(c);return this;},equals:function(o){if(!(o instanceof m.ConditionGroup)){return false;}if(this.conditions.length!==o.conditions.length){return false;}for(var i=0,l=this.conditions.length;i<l;i++){var c=this.conditions[i];var a=false;for(var j=0,b=o.conditions.length;j<b;j++){var d=o.conditions[j];if(c.equals(d)){a=true;break;}}if(a){continue;}else{return false;}}return true;},getConditions:function(){return this.conditions;},getConditionsAsArray:function(a,c){c=c||[];a=a||this;for(var i=0;i<a.conditions.length;i++){if(a.conditions[i]instanceof m.ConditionGroup){this.getConditionsAsArray(a.conditions[i],c);}else{c.push(a.conditions[i]);}}return c;},hasCondition:function(c){for(var i=0,l=this.conditions.length;i<l;i++){var a=this.conditions[i];if(a instanceof m.ConditionGroup){if(c instanceof m.ConditionGroup){if(a.equals(c)){return true;}}else if(c instanceof m.Condition){if(a.hasCondition(c)){return true;}}}else if(a instanceof m.Condition){if(c instanceof m.ConditionGroup){if(c.hasCondition(a)){return true;}}else if(c instanceof m.Condition){if(a.equals(c)){return true;}}}}return false;},removeCondition:function(c){var a;for(var i=0,l=this.conditions.length;i<l;i++){a=this.conditions[i];if(a instanceof m.ConditionGroup){if(c instanceof m.ConditionGroup){if(a.equals(c)){this.conditions.splice(i,1);}}else if(c instanceof m.Condition){a.removeCondition(c);}}else if(a instanceof m.Condition){if(c instanceof m.ConditionGroup){c.removeCondition(a);}else if(c instanceof m.Condition){if(a.equals(c)){this.conditions.splice(i,1);}}}}for(var j=0,b=this.conditions.length;j<b;j++){a=this.conditions[j];if(a instanceof m.ConditionGroup&&a.conditions.length===0){this.conditions.splice(j,1);}}return this;},setLabel:function(l){this.label=l;return this;},setOperator:function(o){switch(o.toLowerCase()){case'or':o='Or';break;case'and':o='And';break;default:throw{message:'unknown operator for condition group: '+o};}this.operator=o;return this;},toString:function(){return this.label;},getJson:function(){},setJson:function(j){}};}(window));
/*
 * @file The Simple Information Access (SINA) Interface
 * @namespace sap.bc.ina.api.sina.base
 * @requires jQuery
 * @copyright 2014 SAP SE. All rights reserved.
 */
(function(g){"use strict";g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.base');var m=g.sap.bc.ina.api.sina.base;var e=function(){};jQuery.extend(m,{provider:{},registerProvider:function(p){this.provider[p.impl_type]=p;}});m.Sina=function(){this.init.apply(this,arguments);};m.Sina.prototype={init:function(){},_initQueryProperties:function(p){p=p||{};p.zina=this;p.sina=this;p.system=p.system||this.getSystem();if(p.dataSource){p.dataSource=new this._provider.DataSource(p.dataSource);}return p;},createChartQuery:function(p){p=this._initQueryProperties(p);return new this._provider.chartQuery(p);},createSearchQuery:function(p){p=this._initQueryProperties(p);return new this._provider.searchQuery(p);},createGroupBarChartQuery:function(p){p=this._initQueryProperties(p);return new this._provider.groupBarChartQuery(p);},createLineChartQuery:function(p){p=this._initQueryProperties(p);p.dimensions=[p.dimensionLine,p.dimensionX];p.measures=[{name:p.measureY.name,aggregationFunction:p.measureY.aggregationFunction}];return new this._provider.lineChartQuery(p);},createSuggestionQuery:function(p){p=this._initQueryProperties(p);return new this._provider.suggestionQuery(p);},createPerspectiveQuery:function(p){p=this._initQueryProperties(p);return new this._provider.perspectiveQuery(p);},createPerspectiveSearchQuery:function(p){p=this._initQueryProperties(p);return new this._provider.perspectiveSearchQuery(p);},createPerspectiveGetQuery:function(p){p=this._initQueryProperties(p);return new this._provider.perspectiveGetQuery(p);},sinaSystem:function(s){if(s){this.sys=s;}else{return this.sys;}return{};},getSystem:function(){if(this.sys){return this.sys;}return{};},setSystem:function(s){this.sys=s;},createFacet:function(p){p.sina=this;return new this._provider.Facet(p);},FacetType:{ATTRIBUTE:'attribute',DATASOURCE:'datasource',SEARCH:'searchresult'},createFilter:function(p){p.sina=this;return new this._provider.Filter(p);},createFilterCondition:function(a,o,v){return new this._provider.FilterCondition(a,o,v);},createFilterConditionGroup:function(p){return new this._provider.FilterConditionGroup(p);},createDataSource:function(p){return new this._provider.DataSource(p);},createDataSourceQuery:function(p){p=this._initQueryProperties(p);return new this._provider.DataSourceQuery(p);},getRootDataSource:function(){return this._provider.getRootDataSource();},getAllDataSources:function(p){p=this._initQueryProperties(p);return this._provider.getAllDataSources(p);},getAllDataSourcesSync:function(p){p=this._initQueryProperties(p);return this._provider.getAllDataSourcesSync(p);},getSearchConfiguration:function(p){p=this._initQueryProperties(p);return new this._provider.searchConfiguration(p);},addUserHistoryEntry:function(E){var p=this._initQueryProperties(p);p.oEntry=E;return this._provider.addUserHistoryEntry(p);},emptyUserHistory:function(){var p=this._initQueryProperties(p);return this._provider.emptyUserHistory(p);}};m.Query=function(){this.init.apply(this,arguments);};m.Query.prototype={init:function(p){p=p||{};this.sina=p.sina;this.system=p.system;this.onSuccess=p.onSuccess;this.onError=p.onError;this._responseJson=null;this.setTop(p.top||10);this.setSkip(p.skip||0);this.resultSetProperties=p;this.filter=this.filter||p.filter||this.sina.createFilter({dataSource:p.dataSource});this.datasource=this.datasource||p.dataSource;if(p.filterConditions&&p.filterConditions.length>0){for(var i=0,l=p.filterConditions.length;i<l;i++){var a=p.filterConditions[i];if(a&&a instanceof Array&&a.length>0){this.addFilterCondition(a[0],a[1],a[2]);}else if(a&&typeof a==='string'){this.addFilterCondition(p.filterConditions[0],p.filterConditions[1],p.filterConditions[2]);break;}}}this.setSearchTerms(p.searchTerms||'');},dataSource:function(n){if(n){this.setDataSource(n);return this;}else{return this.getDataSource();}},getDataSource:function(){return this.filter.getDataSource();},setDataSource:function(d){if(d===undefined){return this;}if(this.filter.getDataSource()===undefined){this.filter.setDataSource(d);this._resetResultSet();return this;}if(!this.filter.getDataSource().equals(d)){this.filter.setDataSource(d);this._resetResultSet();}return this;},setFacetOptions:function(o){this.facetOptions=o;},getFacetOptions:function(){return this.facetOptions;},getFilter:function(){return this.filter;},setFilter:function(f){this.filter=f;this._resetResultSet();return this;},setSearchTerms:function(t){if(this.filter.getSearchTerms()!==t){this.filter.setSearchTerms(t);this._resetResultSet();}return this;},getSearchTerms:function(){return this.filter.getSearchTerms();},skip:function(n){if(n!==undefined){this.setSkip(n);}else{return this._skip;}return this;},getSkip:function(){return this._skip;},setSkip:function(s){if(typeof s!=='number'){return false;}this._skip=this._skip||undefined;if(this._skip!==s){this._skip=s;this._resetResultSet();}return this;},top:function(n){if(n!==undefined){this.setTop(n);}else{return this._top;}return this;},getTop:function(){return this._top;},setTop:function(t){if(isNaN(t)){return false;}this._top=parseInt(this._top,10);if(this._top!==t){this._top=t;this._resetResultSet();}return this;},addFilterCondition:function(a,o,v){if(typeof a==="string"){a=this.sina.createFilterCondition(a,o,v);}if(this.filter.hasFilterCondition(a,o,v)===false){this.filter.addFilterCondition(a,o,v);this._resetResultSet();}return this;},removeFilterCondition:function(a,o,v){this.filter.removeFilterCondition(a,o,v);this._resetResultSet();return this;},resetFilterConditions:function(){this.filter.resetFilterConditions();this._resetResultSet();return this;},getResultSetSync:function(){this.resultSet=this.executeSync();return this.resultSet;},getResultSet:function(o,a){var t=this;o=o||this.onSuccess||e;a=a||this.onError||e;var r=this.execute();r.done(function(b){t.resultSet=b;o(b);});r.fail(function(b){a(b);});return r.promise();},_resetResultSet:function(){},execute:function(){},executeSync:function(){}};m.ChartQuery=function(){this.init.apply(this,arguments);};m.ChartQuery.prototype=jQuery.extend({},m.Query.prototype,{init:function(){m.Query.prototype.init.apply(this,arguments);}});m.FacetType=m.Sina.prototype.FacetType;m.Facet=function(){this.init.apply(this,arguments);};m.Facet.prototype={init:function(p){p=p||{};this.sina=p.sina;this.title=p.title||'';this.query=p.query||null;p.facetType=p.facetType||'';this.facetType=p.facetType.toLowerCase();if(p.query){this.setQuery(p.query);}},getChartType:function(){},getTitle:function(){return this.title;},getDimension:function(){return this.dimension;},getQuery:function(){return this.query;},getLayout:function(){},getLayoutBinding:function(){},getColorPalette:function(){},setQuery:function(q){this.query=q;}};m.PerspectiveQuery=function(){this.init.apply(this,arguments);};m.PerspectiveQuery.prototype=jQuery.extend({},m.Query.prototype,{init:function(){m.Query.prototype.init.apply(this,arguments);this.facets=[];},addFacet:function(f){this.facets.push(f);return this;},getFacets:function(){return this.facets;},setOrderBy:function(o){this._resetResultSet();this.orderBy=o||{orderBy:'$$score$$',sortOrder:'DESC'};return this;}});m.SearchQuery=function(){this.init.apply(this,arguments);};m.SearchQuery.prototype=jQuery.extend({},m.Query.prototype,{init:function(){m.Query.prototype.init.apply(this,arguments);}});m.SuggestionQuery=function(){this.init.apply(this,arguments);};m.SuggestionQuery.prototype=jQuery.extend({},m.Query.prototype,{init:function(){m.Query.prototype.init.apply(this,arguments);}});m.SinaError=function(){this.init.apply(this,arguments);};m.SinaError.SEVERITY_ERROR=3;m.SinaError.SEVERITY_WARNING=2;m.SinaError.SEVERITY_INFO=1;m.SinaError.prototype={init:function(p){this.message=p.message||'';this.errorCode=p.errorCode||null;this.severity=p.severity||m.SinaError.SEVERITY_ERROR;},getErrorCode:function(){return this.errorCode;},getMessage:function(){return this.message;},getSeverity:function(){return this.severity;},setSeverity:function(s){this.severity=s;},toString:function(){var a="";switch(this.severity){case m.SinaError.SEVERITY_ERROR:a+="SINA ERROR: ";break;case m.SinaError.SEVERITY_WARNING:a+="SINA WARNING: ";break;case m.SinaError.SEVERITY_INFO:a+="SINA INFO: ";break;}a+=this.message;return a;}};}(window));
/*
 * @file Simple info access (SINA) API: System representation
 * @namespace sap.bc.ina.api.sina.base.system
 * @copyright 2014 SAP SE. All rights reserved.
 */
(function(g){"use strict";var p=g.sap.bc.ina.api.sina.proxy;g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.base.system');var m=g.sap.bc.ina.api.sina.base.system;m.System=function(){this.init.apply(this,arguments);};m.Service=function(){this.init.apply(this,arguments);};m.Capability=function(){this.init.apply(this,arguments);};m.Capability.prototype={init:function(a){this.properties=a||{};this.name=this.properties.Capability||'';this.minVersion=this.properties.MinVersion||0;this.maxVersion=this.properties.MaxVersion||0;}};m.Service.prototype={init:function(a){this.properties=a||{};this.name=this.properties.Service;this.minVersion=this.properties.MinVersion||0;this.maxVersion=this.properties.MaxVersion||0;this.capabilities={};for(var i=0;i<this.properties.Capabilities.length;i++){this.capabilities[this.properties.Capabilities[i].Capability]=new m.Capability(this.properties.Capabilities[i]);}},getCapability:function(n){return this.capabilities[n];},getCapabilities:function(){return this.capabilities;}};m.System.prototype={init:function(a){this.properties=a||{};this.services={};this.proxy=a.proxy||new p.Proxy();},getService:function(n){return this.services[n];},getServices:function(){return this.services;},getSystemType:function(){return this.systemType;},_deleteServerInfo:function(){this.jqXHR=jQuery.Deferred();},_getServerInfo:function(i){var t=this;if(this.jqXHR&&i){return this.jqXHR.promise();}if(this.jqXHR&&i===false){if(this.jqXHR.state()==="resolved"){return this.properties;}if(this.jqXHR.state()==="pending"){this.deprecatedJqXHR=this.jqXHR;}}this.jqXHR=jQuery.Deferred();var r={async:i,type:'GET',url:this.infoUrl,getServerInfo:true,processData:false,contentType:'application/json',dataType:'json'};this.proxy.ajax(r).done(function(d){t.setServerInfo(d);t.jqXHR.resolve(t.properties);if(t.deprecatedJqXHR){t.deprecatedJqXHR.resolve(t.properties);}}).fail(function(e){t.jqXHR.reject(e);if(t.deprecatedJqXHR){t.deprecatedJqXHR.reject(e);}});if(i===true){return this.jqXHR.promise();}return this.properties;},getServerInfo:function(){return this._getServerInfo(true);},getServerInfoSync:function(){return this._getServerInfo(false);},setServerInfo:function(j){this.properties.rawServerInfo=j;}};}(window));
/*
 * @file Proxy which offers some extras for ajax calls.
 * @namespace sap.bc.ina.api.sina.proxy
 * @copyright Copyright (c) 2014 SAP SE. All rights reserved.
 * @ignore
 */
(function(g){"use strict";g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.proxy');var m=g.sap.bc.ina.api.sina.proxy;m.Proxy=function(){this.init.apply(this,arguments);};m.inaReqResBuffer={};m.Proxy.prototype={init:function(p){this.properties=p||{};this.xsrfToken='';this.xsrfService=this.properties.xsrfService;this.xsrfRetries=0;this.xsrfRequest={'headers':{'X-CSRF-Token':'Fetch'},'cache':false,'url':this.xsrfService};this.properties.cachelifetime=this.properties.cachelifetime||0;this.properties.httpMethod=this.properties.httpMethod||'post';if(this.properties.cachelifetime>0){g.window.setInterval(function(){m.inaReqResBuffer={};},this.properties.cachelifetime);}this.properties.recordFile=this.properties.recordFile;this.properties.demoMode=this.properties.demoMode||"";this._checkRecordingURLValues();},_checkRecordingURLValues:function(){function a(n){return decodeURI((new RegExp(n+'='+'(.+?)(&|$)').exec(g.window.location.search)||[null])[1]);}function h(n){if(g.window.location.search.toLowerCase().indexOf('&'+n.toLowerCase())!==-1){return true;}if(g.window.location.search.toLowerCase().indexOf('?'+n.toLowerCase())!==-1){return true;}return false;}if(h('record')){this.properties.recordFile=a('record');}if(h('demoMode')){this.properties.demoMode=a('demoMode');}},_requestHashValue:function(u,d){if(d){var p=u.indexOf("?")===-1?"?":"&";u=u+p+'Request=';if(typeof d==="string"){u+=d;}else{u+=JSON.stringify(d);}}return u;},_handleRequestFromCache:function(r){var i=JSON.stringify(r.data);var a=m.inaReqResBuffer[i];if(a){var j=jQuery.Deferred();j.resolve(a);return j.promise();}return{};},_handleRequestFromRecords:function(r,a){var t=this;function _(c,d,e){var f=c[t._requestHashValue(d,e)];if(f){return f;}else{return jQuery.Deferred().reject("Could not find request hash "+t._requestHashValue(d,e)+" in record file "+a);}}if(r.async===false){if(!this.recordings){this.recordings=this._loadRecordings(a).responseText;this.recordings=JSON.parse(this.recordings);}var b={};if(jQuery.isArray(this.recordings)){for(var i=0;i<this.recordings.length;i++){b[t._requestHashValue(this.recordings[i].requestUrl,this.recordings[i].requestData)]=this.recordings[i].responseData;}this.recordings=b;}return{responseText:JSON.stringify(_(this.recordings,r.url,r.data))};}return this._loadRecordingsAsync(r.async,a).then(function(c){return _(c,r.url,r.data);});},_loadRecordings:function(r){return jQuery.ajax({async:false,dataType:'json',url:r});},_loadRecordingsAsync:function(a,r){var t=this;if(this.recordingsDefer){return this.recordingsDefer;}this.recordingsDefer=jQuery.Deferred();var j=jQuery.ajax({dataType:'json',url:r});j.done(function(b){var c={};if(jQuery.isArray(b)){for(var i=0;i<b.length;i++){c[t._requestHashValue(b[i].requestUrl,b[i].requestData)]=b[i].responseData;}b=c;}t.recordingsDefer.resolve(b);});j.fail(function(e){t.recordingsDefer.resolve({});});return this.recordingsDefer;},_saveRecordingsAsync:function(r){var t=this;return jQuery.ajax({type:'PUT',url:t.properties.recordFile,data:JSON.stringify(r)});},setXSRFService:function(u){this.xsrfService=u;this.xsrfRequest.url=u;},_getXSRFToken:function(){var t=this;if(!this.xsrfDeferred){this.xsrfRetries++;this.xsrfDeferred=jQuery.ajax(this.xsrfRequest);this.xsrfDeferred.done(function(d){t.xsrfToken=t.xsrfDeferred.getResponseHeader('X-CSRF-Token')||t.xsrfToken||'';if(t.xsrfToken){t.xsrfRetries=0;}});}return this.xsrfDeferred.promise();},_requestWithXSRFToken:function(r){var t=this;if(r.async===false){if(this.xsrfDeferred&&this.xsrfDeferred.state()==='pending'){this.xsrfDeferred.abort();}this.xsrfRequest.async=false;this.xsrfDeferred=jQuery.ajax(this.xsrfRequest);if(r.url===this.xsrfService){return this.xsrfDeferred();}this.xsrfToken=this.xsrfDeferred.getResponseHeader('X-CSRF-Token')||this.xsrfToken||'';r.headers={'X-CSRF-Token':this.xsrfToken};return jQuery.ajax(r);}else{if(r.url===this.xsrfService){return this._getXSRFToken();}var d=jQuery.Deferred();this._getXSRFToken().done(function(a){r.headers={'X-CSRF-Token':t.xsrfToken};jQuery.ajax(r).done(function(a){d.resolve(a);}).fail(function(e,b,c){if(e.status===400){if(e.responseJSON&&e.responseJSON.Error&&e.responseJSON.Error.Code&&e.responseJSON.Error.Code===403){if(t.xsrfRetries<5){t.xsrfDeferred=null;return t._requestWithXSRFToken(r);}}}if((e.status>=200&&e.status<=299)&&(b||c)){e.status=500;e.statusText=b;var E=b+': ';if(c&&c.stack){E=E+c.stack;}e.responseText=E;}d.reject(e);});}).fail(function(e){d.reject(e);});return d.promise();}},ajax:function(r){var t=this;var j;var i=r.data===undefined?undefined:JSON.stringify(r.data);if(this.properties.cachelifetime>0){return this._handleRequestFromCache(r);}if(this.properties.demoMode){j=this._handleRequestFromRecords(r,this.properties.demoMode);}else{r.processData=r.processData||false;r.type=r.type||this.properties.httpMethod||'POST';if(i){if(r.type.toLowerCase()==='get'){r.data='Request='+i;}else{r.data=i;}}j=this._requestWithXSRFToken(r);}if(j&&j.done){j.done(function(a){if(t.properties.cachelifetime>0){t._cacheResponse(r,a);}if(t.properties.recordFile){t._recordResponseAsync(r,a,t.properties.recordFile);}});}return j;},_cacheResponse:function(r,d){var i=JSON.stringify(r.data);m.inaReqResBuffer[i]=d;},_recordResponseAsync:function(r,a,b){var t=this;this._loadRecordingsAsync(false,b).then(function(c){c[t._requestHashValue(r.url,r.data)]=a;return c;}).then(function(c){if(b===t.properties.demoMode){throw"Recording: source file must not be the same as target file";}t._saveRecordingsAsync(c);});}};}(window));
/*
 * Simple info access (SINA) API: JSON Templates
 * Package: sap.bc.ina.api.sina.impl.inav2.jsontemplates
 * Copyright (c) 2014 SAP SE. All rights reserved.
 */
(function(g){"use strict";g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.impl.inav2.jsontemplates');var m=g.sap.bc.ina.api.sina.impl.inav2.jsontemplates;m.getDataSourceMetaDataRequest=function(){return jQuery.extend({},{"DataSource":{},"Options":["SynchronousRun"],"Metadata":{"Context":"Search","Expand":["Cube"]},"ServiceVersion":204});};m.getCatalogRequest=function(){return jQuery.extend({},{"DataSource":{"ObjectName":"$$DataSources$$","PackageName":"ABAP"},"Options":["SynchronousRun"],"Search":{"Top":1000,"Skip":0,"OrderBy":[{"AttributeName":"Description","SortOrder":"ASC"},{"AttributeName":"ObjectName","SortOrder":"ASC"}],"Expand":["Grid","Items"],"Filter":{"Selection":{"Operator":{"Code":"And","SubSelections":[{"MemberOperand":{"AttributeName":"SupportedService","Comparison":"=","Value":"Search"}}]}}},"NamedValues":[{"AttributeName":"ObjectName","Name":"ObjectName"},{"AttributeName":"Description","Name":"Description"},{"AttributeName":"DescriptionPlural","Name":"DescriptionPlural"},{"AttributeName":"Type","Name":"Type"}]},"SearchTerms":"*","ServiceVersion":204});};m.getESHConnectorRequest=function(){return jQuery.extend({},{"DataSource":{"SchemaName":"","PackageName":"ABAP","ObjectName":"~ESH_CONNECTOR~","Type":"Connector"},"Search":{"Top":1000,"Skip":0,"OrderBy":[{"AttributeName":"DESCRIPTION","SortOrder":"ASC"}],"Expand":["Grid","Items","TotalCount"],"Filter":{},"NamedValues":[{"AttributeName":"$$ResultItemAttributes$$","Name":"$$ResultItemAttributes$$"},{"AttributeName":"$$RelatedActions$$","Name":"$$RelatedActions$$"}],"SearchTerms":"*","SelectedValues":[]}});};m.getSuggestionRequest=function(){return jQuery.extend({},{"DataSource":{},"Options":["SynchronousRun"],"Suggestions":{"Expand":["Grid","Items"],"Precalculated":false,"SearchTerms":"","AttributeNames":[]},"ServiceVersion":204});};m.getSuggestion2Request=function(){return jQuery.extend({},{"DataSource":{},"Options":["SynchronousRun"],"Suggestions2":{"Expand":["Grid","Items"],"Precalculated":false,"AttributeNames":[]},"ServiceVersion":204});};m.getPerspectiveRequest=function(){return jQuery.extend({},{"DataSource":{},"Options":["SynchronousRun"],"Search":{"Expand":["Grid","Items","ResultsetFacets","TotalCount"],"Filter":{"Selection":{"Operator":{"Code":"And","SubSelections":[{"MemberOperand":{"AttributeName":"$$RenderingTemplatePlatform$$","Comparison":"=","Value":"html"}},{"MemberOperand":{"AttributeName":"$$RenderingTemplateTechnology$$","Comparison":"=","Value":"Tempo"}},{"MemberOperand":{"AttributeName":"$$RenderingTemplateType$$","Comparison":"=","Value":"ResultItem"}}]}}},"Top":10,"Skip":0,"SearchTerms":"S*","NamedValues":[{"Function":"WhyFound","Name":"$$WhyFound$$"},{"Function":"RelatedActions","Name":"$$RelatedActions$$"}]},"ServiceVersion":204});};m.getPerspectiveSearchRequest=function(){return jQuery.extend({},{"DataSource":{"ObjectName":"$$Perspectives$$","Type":"View"},"Options":["SynchronousRun"],"Search":{"Expand":["Grid","Items"],"Filter":{"Selection":{"Operator":{"Code":"Or","SubSelections":[{"MemberOperand":{"AttributeName":"SCHEMA_VERSION_NUMBER","Comparison":"=","Value":"3"}},{"MemberOperand":{"AttributeName":"SCHEMA_VERSION_NUMBER","Comparison":"=","Value":"4"}},{"MemberOperand":{"AttributeName":"SCHEMA_VERSION_NUMBER","Comparison":"=","Value":"5"}}]}}},"SearchTerms":"*","SelectedValues":[{"AttributeName":"PACKAGE_ID","Name":"PACKAGE_ID"},{"AttributeName":"PERSPECTIVE_ID","Name":"PERSPECTIVE_ID"},{"AttributeName":"TITLE_TEXT","Name":"TITLE_TEXT"},{"AttributeName":"SUMMARY_TEXT","Name":"SUMMARY_TEXT"}],"Skip":0,"Top":30}});};m.getPerspectiveRequestFactsheet=function(){return jQuery.extend({},{"DataSource":{},"Options":["SynchronousRun"],"Search":{"Expand":["Grid","Items","ResultsetFacets","TotalCount"],"Filter":{"Selection":{"Operator":{"Code":"And","SubSelections":[{"MemberOperand":{"AttributeName":"$$RenderingTemplatePlatform$$","Comparison":"=","Value":"html"}},{"MemberOperand":{"AttributeName":"$$RenderingTemplateTechnology$$","Comparison":"=","Value":"Tempo"}},{"MemberOperand":{"AttributeName":"$$RenderingTemplateType$$","Comparison":"=","Value":"ResultItem"}}]}}},"Top":10,"Skip":0,"SearchTerms":"S*","NamedValues":[{"Function":"WhyFound","Name":"$$WhyFound$$"},{"AttributeName":"$$RelatedActions$$"},{"AttributeName":"$$RelatedActions.Proxy$$"}]},"ServiceVersion":204});};m.getSearchRequest=function(){return jQuery.extend({},{"DataSource":{},"SearchTerms":"DUMMY","Search":{"Expand":["Grid","Items","TotalCount"],"Top":"DUMMY","Skip":"DUMMY","SelectedValues":"DUMMY","NamedValues":[{"AttributeName":"$$ResultItemAttributes$$","Name":"$$ResultItemAttributes$$"},{"AttributeName":"$$RelatedActions$$","Name":"$$RelatedActions$$"}]}});};m.getChartRequest=function(){return jQuery.extend({},{"DataSource":{},"Options":["SynchronousRun"],"SearchTerms":"","Analytics":{"Definition":{"Dimensions":[{"Axis":"Rows","Name":"CATEGORY","SortOrder":1,"Top":5},{"Axis":"Columns","Name":"CustomDimension1","Members":[{"Aggregation":"COUNT","AggregationDimension":"CATEGORY","MemberOperand":{"AttributeName":"Measures","Comparison":"=","Value":"COUNT"},"Name":"COUNT","SortOrder":2}]}],"Filter":{}}}});};m.getSearchConfigurationRequest=function(){return jQuery.extend({},{"SearchConfiguration":{"Action":"Update","Data":{"PersonalizedSearch":{"PersonalizationPolicy":"","SessionUserActive":true,"ResetUserData":true},"NavigationEvent":{"SourceApplication":"","TargetApplication":"","Parameter":[]}}}});};}(window));
/*
 * @file Implementation of the datasource interface
 * @namespace sap.bc.ina.api.sina.impl.inav2.datasource
 * @copyright 2014 SAP SE. All rights reserved.
 */
(function(g){"use strict";var d=g.sap.bc.ina.api.sina.base.datasource;var t=g.sap.bc.ina.api.sina.impl.inav2.jsontemplates;g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.impl.inav2.datasource');var m=g.sap.bc.ina.api.sina.impl.inav2.datasource;m.getRootDataSource=function(){if(!m.rootDataSource){m.rootDataSource=new m.DataSource({objectName:"$$ALL$$",packageName:"ABAP",schemaName:"",type:"Category"});}return m.rootDataSource;};m.DataSource=function(){this.init.apply(this,arguments);};m.DataSourceMetaData=function(){this.init.apply(this,arguments);};m.DataSourceMetaData.prototype=jQuery.extend({},d.DataSourceMetaData.prototype,{init:function(p){p=p||{};this.datasource=p.datasource||{};this.description=p.description||'';this.dimensions={};},_getMetaDataRequest:function(){var r=t.getDataSourceMetaDataRequest();r.DataSource=this.datasource.toInAJson();return r;},_getMetaData:function(i,c){var a=this;var r={async:i,url:g.sap.bc.ina.api.sina.getSystem().inaUrl,processData:false,contentType:'application/json',dataType:'json',data:this._getMetaDataRequest()};var j=g.sap.bc.ina.api.sina.getSystem().proxy.ajax(r);j.done(function(b){if(!a.rawMetadata){a._parseServerMetaData(b);}if(c){c(a);}});return this;},_parseServerMetaData:function(a){this.rawMetadata=a;this.description=this.rawMetadata.Cube.Description;this.datasource.setLabel(this.description);for(var i=0;i<this.rawMetadata.Cube.Dimensions.length;i++){var b={};b.name=this.rawMetadata.Cube.Dimensions[i].Name;b.description=this.rawMetadata.Cube.Dimensions[i].Description;b.attributes={};for(var j=0;j<this.rawMetadata.Cube.Dimensions[i].Attributes.length;j++){b.attributes[this.rawMetadata.Cube.Dimensions[i].Attributes[j].Name]={name:this.rawMetadata.Cube.Dimensions[i].Attributes[j].Name,description:this.rawMetadata.Cube.Dimensions[i].Attributes[j].Description};}this.dimensions[b.name]=b;}}});m.DataSource.prototype=jQuery.extend({},d.DataSource.prototype,{init:function(p){p=p||{};var D;if(p.key){this.key=p.key;D=true;}p.schemaName=p.schemaName||p.SchemaName||{label:'',value:''};this.setSchemaName(p.schemaName,D);p.packageName=p.packageName||p.PackageName||"ABAP";this.setPackageName(p.packageName,D);p.objectName=p.objectName||p.ObjectName||{label:'',value:''};this.setObjectName(p.objectName,D);p.type=p.type||p.Type||"View";this.setType(p.type,D);this.label=p.label||p.Label||p.Description||'';this.labelPlural=p.labelPlural||p.LabelPlural||p.DescriptionPlural||this.label||'';this.semanticObjectType=p.SemanticObjectType||'';if(p.metaData){this.setMetaData(p.metaData);}if(!this.key){throw'Datasource has no key'+JSON.stringify(p);}},getMetaData:function(c){var a=this;if(!a.metaData){a.metaData=new m.DataSourceMetaData({datasource:this});}a.metaData._getMetaData(true,c);},getMetaDataSync:function(){var a=this;if(!a.metaData){a.metaData=new m.DataSourceMetaData({datasource:this});a.metaData._getMetaData(false);}return a.metaData;},setMetaData:function(a){this.metaData=a;},getSchemaName:function(){return this.schemaName;},_getSchemaNameAsString:function(){if(jQuery.type(this.schemaName)==='object'){return this.schemaName.value;}if(jQuery.type(this.schemaName)==='string'){return this.schemaName;}return'';},setSchemaName:function(s,a){if(!this.schemaName){this.schemaName={};}if(jQuery.type(s)==='object'){this.schemaName.label=s.label||s.value||'';this.schemaName.value=s.value||'';}if(jQuery.type(s)==='string'){this.schemaName.label=s;this.schemaName.value=s;}if(a!==true){this._constructKey();}},getPackageName:function(){return this.packageName;},_getPackageNameAsString:function(){if(jQuery.type(this.packageName)==='object'){return this.packageName.value;}if(jQuery.type(this.packageName)==='string'){return this.packageName;}return'';},setPackageName:function(p,a){if(!this.packageName){this.packageName={};}if(jQuery.type(p)==='object'){this.packageName.label=p.label||p.value||'';this.packageName.value=p.value||'';}if(jQuery.type(p)==='string'){this.packageName.label=p;this.packageName.value=p;}if(a!==true){this._constructKey();}},getObjectName:function(){return this.objectName;},setObjectName:function(o,a){if(!this.objectName){this.objectName={};}if(jQuery.type(o)==='object'){this.objectName.label=o.label||o.value||'';this.objectName.value=o.value||'';}if(jQuery.type(o)==='string'){this.objectName.label=o;this.objectName.value=o;}if(a!==true){this._constructKey();}},_constructKey:function(){this.key=this._getTypeAsString()+'/'+this._getPackageNameAsString()+'/'+this._getSchemaNameAsString()+'/'+this._getObjectNameAsString();},setObjectNameValue:function(v,a){if(!this.objectName){this.objectName={};}this.objectName.value=v||'';if(a!==true){this._constructKey();}},setObjectNameLabel:function(l){if(!this.objectName){this.objectName={};}this.objectName.label=l||'';if(!this.label){this.setLabel(l);}if(!this.labelPlural){this.setLabelPlural(l);}},_getObjectNameAsString:function(){if(jQuery.type(this.objectName)==='object'){return this.objectName.value;}if(jQuery.type(this.objectName)==='string'){return this.objectName;}return'';},getType:function(){return this.type;},_getTypeAsString:function(){if(jQuery.type(this.type)==='object'){return this.type.value;}if(jQuery.type(this.type)==='string'){return this.type;}return'';},setType:function(a,b){if(!this.type){this.type={};}if(jQuery.type(a)==='object'){this.type.label=a.label||a.value||'';this.type.value=a.value||'';}if(jQuery.type(a)==='string'){this.type.label=a;this.type.value=a;}if(b!==true){this._constructKey();}},getLabel:function(){if(typeof this.label!=='undefined'&&this.label!==''){return this.label;}if(typeof this.getObjectName().label!=='undefined'&&this.getObjectName().label!==''){return this.getObjectName().label;}if(typeof this.getObjectName().value!=='undefined'&&this.getObjectName().value!==''){return this.getObjectName().value;}return'';},setLabel:function(l){this.label=l||'';this.labelPlural=this.labelPlural||this.label;},getLabelPlural:function(){if(typeof this.labelPlural!=='undefined'&&this.labelPlural!==''){return this.labelPlural;}return this.getLabel();},setLabelPlural:function(l){this.labelPlural=l||'';},fromInAJson:function(i){this.setSchemaName({value:i.SchemaName,label:i.SchemaLabel});this.setPackageName({value:i.PackageName,label:i.PackageLabel});this.setObjectName({value:i.ObjectName,label:i.ObjectLabel});this.setType({value:i.Type,label:''});},toInAJson:function(){var j={'SchemaName':this.getSchemaName().value,'PackageName':this.getPackageName().value,'ObjectName':this.getObjectName().value};if(this.getType().value){j.Type=this.getType().value;}return j;},toURL:function(){var j={"label":this.label,"labelPlural":this.labelPlural,"SchemaName":{"label":this.getSchemaName().label,"value":this.getSchemaName().value},"PackageName":{"label":this.getPackageName().label,"value":this.getPackageName().value},"ObjectName":{"label":this.getObjectName().label,"value":this.getObjectName().value}};if(this.getType().value){j.Type=this.getType().value;}return j;}});}(window));
/*
 * @file Implementation of the filter interface
 * @namespace sap.bc.ina.api.sina.impl.inav2.filter
 * @copyright 2014 SAP SE. All rights reserved.
 */
(function(g){"use strict";var f=g.sap.bc.ina.api.sina.base.filter;g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.impl.inav2.filter');var m=g.sap.bc.ina.api.sina.impl.inav2.filter;m.Filter=function(){this.init.apply(this,arguments);};m.Condition=function(){this.init.apply(this,arguments);};m.ConditionGroup=function(){this.init.apply(this,arguments);};m.Filter.prototype=jQuery.extend({},f.Filter.prototype,{init:function(p){g.sap.bc.ina.api.sina.base.filter.Filter.prototype.init.apply(this,[p]);this.defaultConditionGroup=new m.ConditionGroup({operator:'And'});},getJson:function(){var r=[];this.defaultConditionGroup.getJson(r);var a={Selection:r[0]};return a;},setJson:function(j){if(j.Selection===undefined){return;}var a=new m.ConditionGroup();a.setJson(j);this.defaultConditionGroup.addCondition(a);}});m.Condition.prototype=jQuery.extend(Object.create(f.Condition.prototype),{init:function(a,o,v){g.sap.bc.ina.api.sina.base.filter.Condition.prototype.init.apply(this,[a,o,v]);if(jQuery.type(a)==='object'){this.inaV2_extended_properties=a;delete this.inaV2_extended_properties.attribute;delete this.inaV2_extended_properties.operator;delete this.inaV2_extended_properties.value;}},getJson:function(p){var o;var j={};if(this.operator.toLowerCase()==='contains'){o='SearchOperand';}else{o='MemberOperand';}j[o]={'AttributeName':this.attribute,'Comparison':this.operator,'Value':this.value};if(o==='SearchOperand'){delete j[o].Comparison;}j[o]=jQuery.extend({},j[o],this.inaV2_extended_properties);if(this.operator==='='&&this.value===null){j.MemberOperand.Comparison='IS NULL';j.MemberOperand.Value='';}p.push(j);},setJson:function(j){this.attribute=j.MemberOperand.AttributeName;this.operator=j.MemberOperand.Comparison;this.value=j.MemberOperand.Value;if(j.MemberOperand.Comparison==='IS NULL'&&j.MemberOperand.Value===''){this.operator='=';this.value=null;}}});m.ConditionGroup.prototype=jQuery.extend(Object.create(f.ConditionGroup.prototype),{init:function(p){f.ConditionGroup.prototype.init.apply(this,[p]);},getJson:function(p){if(this.conditions.length===0){return{};}var c=[];for(var i=0;i<this.conditions.length;++i){this.conditions[i].getJson(c);}var j={'Operator':{'Code':this.operator,'SubSelections':c}};if(p){p.push(j);}else{var r={Selection:j};return r;}return{};},setJson:function(j){if(j.Selection===undefined&&j.Operator){j.Selection={};j.Selection.Operator=j.Operator;}this.setOperator(j.Selection.Operator.Code);var c=j.Selection.Operator.SubSelections;for(var i=0;i<c.length;i++){var a;if(c[i].Operator){a=new m.ConditionGroup();}else{a=new m.Condition();}a.setJson(c[i]);this.addCondition(a);}}});}(window));
/*
 * @file Proxy class to buffer InA JSON requests/responses.
 * @namespace sap.bc.ina.api.sina.impl.inav2.proxy
 * @copyright Copyright (c) 2014 SAP SE. All rights reserved.
 * @ignore
 */
(function(g){"use strict";var p=g.sap.bc.ina.api.sina.proxy;g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.impl.inav2.proxy');var m=g.sap.bc.ina.api.sina.impl.inav2.proxy;m.inaReqResBuffer={};m.Proxy=function(){this.init.apply(this,arguments);};m.Proxy.prototype=jQuery.extend({},p.Proxy.prototype,{init:function(a){var t=this;t.properties=a||{};p.Proxy.prototype.init.apply(this,[a]);}});}(window));
/*
 * @file Simple info access (SINA) API: Implementation of the SINA interface
 * for the INA V2 service.
 * @namespace sap.bc.ina.api.sina.impl.inav2
 * @requires sap.bc.ina.api.sina
 * @requires sap.bc.ina.api.sina.impl.inav2.filter
 * @requires sap.bc.ina.api.sina.impl.inav2.system
 * @requires sap.bc.ina.api.sina.impl.inav2.proxy
 * @requires jQuery
 * @copyright 2014 SAP SE. All rights reserved.
 */
(function(g){"use strict";var f=g.sap.bc.ina.api.sina.base;var p=g.sap.bc.ina.api.sina.impl.inav2.jsontemplates;var q=g.sap.bc.ina.api.sina.impl.inav2.filter;var r=g.sap.bc.ina.api.sina.impl.inav2.datasource;g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.impl.inav2');var s=g.sap.bc.ina.api.sina.impl.inav2;s.Condition=q.Condition;s.Sina=function(){this.init.apply(this,arguments);};s.Facet=function(){this.init.apply(this,arguments);};s.Perspective=function(){this.init.apply(this,arguments);};s.Perspective2=function(){this.init.apply(this,arguments);};s.Query=function(){this.init.apply(this,arguments);};s.CatalogQuery=function(){this.init.apply(this,arguments);};s.CatalogResultSet=function(){this.init.apply(this,arguments);};s.PerspectiveQuery=function(){this.init.apply(this,arguments);};s.PerspectiveGetQuery=function(){this.init.apply(this,arguments);};s.PerspectiveSearchQuery=function(){this.init.apply(this,arguments);};s.PerspectiveSearchResultSet=function(){this.init.apply(this,arguments);};s.Suggestion=function(){this.init.apply(this,arguments);};s.SuggestionQuery=function(){this.init.apply(this,arguments);};s.SuggestionResultSet=function(){this.init.apply(this,arguments);};s.Suggestion2Query=function(){this.init.apply(this,arguments);};s.Suggestion2ResultSet=function(){this.init.apply(this,arguments);};s.ChartQuery=function(){this.init.apply(this,arguments);};s.ChartResultSet=function(){this.init.apply(this,arguments);};s.GroupBarChartQuery=function(){this.init.apply(this,arguments);};s.GroupBarChartResultSet=function(){this.init.apply(this,arguments);};s.LineChartQuery=function(){this.init.apply(this,arguments);};s.LineChartResultSet=function(){this.init.apply(this,arguments);};s.SearchQuery=function(){this.init.apply(this,arguments);};s.SearchResultSet=function(){this.init.apply(this,arguments);};s.SuggestionAutoQuery=function(a){if(a.system instanceof g.sap.bc.ina.api.sina.impl.inav2.system.ABAPSystem){jQuery.extend(this,s.Suggestion2Query.prototype);}if(a.system instanceof g.sap.bc.ina.api.sina.impl.inav2.system.HANASystem){jQuery.extend(this,s.SuggestionQuery.prototype);}this.init.apply(this,arguments);};s.DataSourceQuery=function(){this.init.apply(this,arguments);};s.ESHConnectorDataSourceQuery=function(){this.init.apply(this,arguments);};s.SearchConfiguration=function(){this.init.apply(this,arguments);};s.UserHistory=function(){this.init.apply(this,arguments);};s.IMPL_TYPE="inav2";f.registerProvider({impl_type:s.IMPL_TYPE,sina:s.Sina,chartQuery:s.ChartQuery,searchQuery:s.SearchQuery,groupBarChartQuery:s.GroupBarChartQuery,lineChartQuery:s.LineChartQuery,suggestionQuery:s.SuggestionAutoQuery,perspectiveQuery:s.PerspectiveQuery,perspectiveSearchQuery:s.PerspectiveSearchQuery,perspectiveGetQuery:s.PerspectiveGetQuery,Facet:s.Facet,DataSource:r.DataSource,Filter:q.Filter,FilterCondition:q.Condition,FilterConditionGroup:q.ConditionGroup,getRootDataSource:r.getRootDataSource,DataSourceQuery:s.DataSourceQuery,getAllDataSources:function(a){return a.zina._getAllDataSources(a);},getAllDataSourcesSync:function(a){return a.zina._getAllDataSourcesSync(a);},searchConfiguration:s.SearchConfiguration,addUserHistoryEntry:function(a){var u=new s.UserHistory(a);return u.addUserHistoryEntry(a.oEntry);},emptyUserHistory:function(a){var u=new s.UserHistory(a);return u.emptyUserHistory();}});s.Sina.prototype=jQuery.extend({},f.Sina.prototype,{init:function(a){a=a||{};this.setSystem(a.system||new s.system.HANASystem());f.Sina.prototype.init.apply(this,arguments);},sapclient:function(a){var b;if(a){if(a<0){b=new s.system.HANASystem();}else{b=new s.system.ABAPSystem({'sapclient':a});}this.setSystem(b);}else{return this.getSystem().properties.sapclient();}return{};},_registerPostProcessor:function(a){if(!this.postProcessor){this.postProcessor=[];}this.postProcessor.push(a);},_postprocess:function(a,b){if(this.postProcessor){for(var i=0;i<this.postProcessor.length;i++){this.postProcessor[i](a,b);}}},_extractDataSources:function(a){var e=a.getElements();var d=[];for(var i=0;i<e.length;++i){var b=e[i];var l=b.Description.value===null?b.ObjectName.value:b.Description.value;var c=b.DescriptionPlural===undefined||b.DescriptionPlural.value===null?l:b.DescriptionPlural.value;var h=this.createDataSource({objectName:{label:b.ObjectName.value,value:b.ObjectName.value},packageName:{label:"ABAP",value:"ABAP"},schemaName:"",type:{label:'View',value:'View'},label:l,labelPlural:c});d.push(h);}return this._removeDuplicateDataSources(d);},_extractESHConnectorDataSources:function(a){var e=a.getElements();var d=[];for(var i=0;i<e.length;++i){var b=e[i];var l=b.DESCRIPTION.value===null?b.OBJECT_NAME.value:b.DESCRIPTION.value;var c=b.DESCRIPTIONPLURAL===undefined||b.DESCRIPTIONPLURAL.value===null?l:b.DESCRIPTIONPLURAL.value;var h=this.createDataSource({objectName:{label:b.OBJECT_NAME.value,value:b.OBJECT_NAME.value},packageName:{label:"ABAP",value:"ABAP"},schemaName:"",type:{label:'View',value:'View'},label:l,labelPlural:c});d.push(h);}return this._removeDuplicateDataSources(d);},_removeDuplicateDataSources:function(d){var a=[];var m={};for(var i=0;i<d.length;++i){var b=d[i];if(m[b.key]){continue;}m[b.key]=true;a.push(b);}return a;},_getAllDataSources:function(a){if(this._dataSourcesDeferred){return this._dataSourcesDeferred;}var t=this;var d=t._dataSourcesDeferred=new jQuery.Deferred();var b=this.createDataSourceQuery(a);b.getResultSet().then(function(c){t._dataSources=t._extractDataSources(c);d.resolve(t._dataSources);},function(e){a.sina=t;b=new s.ESHConnectorDataSourceQuery(a);b.getResultSet().then(function(c){t._dataSources=t._extractESHConnectorDataSources(c);d.resolve(t._dataSources);},function(e){if(t._dataSourcesDeferred===d){t._dataSourcesDeferred=null;}d.reject(e);});});return this._dataSourcesDeferred;},_getAllDataSourcesSync:function(a){if(this._dataSources){return this._dataSources;}var d=this.createDataSourceQuery(a);var b=d.getResultSetSync();if(b.elements.length!==0){this._dataSources=this._extractDataSources(b);this._dataSourcesDeferred=jQuery.when(this._dataSources);}else{a.sina=this;d=new s.ESHConnectorDataSourceQuery(a);b=d.getResultSetSync();this._dataSources=this._extractESHConnectorDataSources(b);this._dataSourcesDeferred=jQuery.when(this._dataSources);}return this._dataSources;}});s.Query.prototype=jQuery.extend({},{init:function(a){this.filter=a.filter||a.sina.createFilter({dataSource:a.dataSource});},_resetResultSet:function(){this.deferredResultSet=null;this.resultSet=null;this.jqXHR=null;},_getInAV2Error:function(d){var e=[];if(d&&d.error){e.push(new f.SinaError({message:"INA V2 Service Error "+d.error.code+": "+d.error.message,errorCode:d.error.code}));}if(d&&d.Messages){for(var i=0;i<d.Messages.length;i++){if(d.Messages[i].Type>=2){e.push(new f.SinaError({message:"INA V2 Service Error "+d.Messages[i].Number+": "+d.Messages[i].Text,errorCode:d.Messages[i].Number}));}}}return e;},setDataSource:function(d){if(d===undefined){return this;}d=new r.DataSource(d);if(this.filter.getDataSource()===undefined){this.filter.setDataSource(d);this._resetResultSet();return this;}if(!this.filter.getDataSource().equals(d)){this.filter.setDataSource(d);this._resetResultSet();}return this;},execute:function(){var t=this;var j=t.createJsonRequest();t.system.getServerInfo();if(!t.jqXHR){t.jqXHR=t._fireRequest(j,true);}var d=jQuery.Deferred();t.jqXHR.done(function(a){var e=t._getInAV2Error(a);if(a&&e&&e.length>0){if(a.error){d.reject(e[0]);return;}else if(a.Messages){if(e.length>=a.Messages.length){d.reject(e);return;}}}var b=new t.resultSetClass(t.resultSetProperties);b.setJsonData(a);d.resolve(b);}).fail(function(e){d.reject(e);}).always(function(a){t._responseJson=a;});return d.promise();},executeSync:function(){var t=this;if(t.resultSet!==null){return t.resultSet;}var j=t.createJsonRequest();t.system.getServerInfo();var d=JSON.parse(t._fireRequest(j,false).responseText);t._responseJson=d;t.resultSet=new t.resultSetClass(t.resultSetProperties);if(d){var e=t._getInAV2Error(d);if(e&&e.length>0){throw e[0];}t.resultSet.setJsonData(d);}return t.resultSet;},_fireRequest:function(d,a,b){a=a===undefined?true:a;var c={async:a,url:this.system.inaUrl,contentType:'application/json',dataType:b||'json',data:d};var j=this.system.proxy.ajax(c);return j;},_assembleOrderBy:function(){var o=[];function a(c,d){var i={};if(c.toLowerCase()==='$$score$$'){i.Function='Score';}else{i.AttributeName=c;}i.SortOrder=d.toUpperCase();return i;}var b;if(jQuery.type(this.orderBy)==='array'){for(var j=0;j<this.orderBy.length;j++){b=a(this.orderBy[j].orderBy,this.orderBy[j].sortOrder);o.push(b);}}else if(jQuery.type(this.orderBy)==='object'&&this.orderBy.orderBy){b=a(this.orderBy.orderBy,this.orderBy.sortOrder);o.push(b);}return o;}});s.CatalogQuery.prototype=jQuery.extend({},s.Query.prototype,{init:function(a){a=a||{};this.resultSetClass=s.SearchResultSet;},createJsonRequest:function(){return p.getCatalogRequest();}});s.Facet.prototype=jQuery.extend({},f.Facet.prototype,{init:function(a){a=a||{};f.Facet.prototype.init.apply(this,arguments);if(this.facetType==='$$datasources$$'){this.facetType=f.FacetType.DATASOURCE;this.query=this.sina.createChartQuery();this.query.resultSet=new s.ChartResultSet({"type":"datasource"});}else if(this.facetType===f.FacetType.ATTRIBUTE){this.query=this.sina.createChartQuery();this.query.resultSet=new s.ChartResultSet();}else if(this.facetType===f.FacetType.SEARCH){this.query=this.sina.createSearchQuery();this.query.resultSet=new s.SearchResultSet({sina:this.sina});}},setJsonData:function(d){this.query.resultSet.setJsonData(d);this._parseServerSideFacetMetaData(d.Metadata);},_parseServerSideFacetMetaData:function(d){if(d&&d.Cube){this.title=d.Cube.Description;this.dimension=d.Cube.ObjectName;}}});s.PerspectiveQuery.prototype=jQuery.extend({},f.PerspectiveQuery.prototype,s.Query.prototype,{init:function(a){var t=this;t.chartFacets=[];t.searchFacet=null;t.searchresultset=null;t.layout=null;t.templateFactsheet=a.templateFactsheet||false;a=a||{};s.Query.prototype.init.apply(this,arguments);f.PerspectiveQuery.prototype.init.apply(this,arguments);a.orderBy=a.orderBy||{};this.setOrderBy(a.orderBy);a.expand=a.expand||["Grid","Items","ResultsetFacets","TotalCount"];this.setExpand(a.expand);this.resultSetClass=s.Perspective;},setExpand:function(e){if(this._expand===e){return;}this._resetResultSet();this._expand=e;},createJsonRequest:function(){var t=p.getPerspectiveRequest();if(this.templateFactsheet){t=p.getPerspectiveRequestFactsheet();}t.DataSource=this.filter.dataSource.toInAJson();var a=this.filter.getSearchTerms();t.Search.SearchTerms=a;t.Search.Top=this._top;t.Search.Skip=this._skip;t.Search.Filter=this.filter.getJson();t.Search.OrderBy=this._assembleOrderBy();t.Search.Expand=this._expand;if(this.facetOptions){t.Facets=this.facetOptions;}return t;},getPerspective:function(o,a){this.getResultSet(o,a);},generatePerspectiveSync:function(){return this.getResultSetSync();}});s.Perspective.prototype={init:function(a){var t=this;t.sina=a.sina;t.chartFacets=[];t.searchFacet=null;t.searchresultset=null;t.layout=null;a=a||{};},getSearchResultSet:function(){return this.searchresultset;},getChartFacets:function(){return this.chartFacets;},getSearchFacet:function(){return this.searchFacet;},getLayout:function(){return this.layout;},determineFacetType:function(a){try{if(a.ResultSet.ItemLists[0].Items[0].NamedValues[0].Name==='$$DataSource$$'){return'$$datasources$$';}else{return f.FacetType.ATTRIBUTE;}}catch(e){return f.FacetType.ATTRIBUTE;}},setJsonData:function(d){var t=this;t.searchFacet=this.sina.createFacet({"facetType":"searchresult"});t.searchFacet.setJsonData(d);t.searchresultset=t.searchFacet.getQuery().getResultSetSync();if(d.ResultsetFacets&&d.ResultsetFacets.Elements){for(var j=0;j<d.ResultsetFacets.Elements.length;j++){var a=t.determineFacetType(d.ResultsetFacets.Elements[j]);var b=this.sina.createFacet({"facetType":a});b.setJsonData(d.ResultsetFacets.Elements[j]);t.chartFacets.push(b);}}}};s.PerspectiveGetQuery.prototype=jQuery.extend({},s.Query.prototype,{init:function(a){a=a||{};this.perspectiveId=a.perspectiveId;s.Query.prototype.init.apply(this,[a]);this.resultSetClass=s.Perspective2;},setPerspectiveId:function(a){this.perspectiveId=a;},getPerspective:function(o,a){var t=this;var b={async:true,url:"/sap/bc/ina/service/v2/Perspectives('"+this.perspectiveId+"')",type:"GET"};var j=this.system.proxy.ajax(b);j.done(function(d){if(d&&d.error){a(d.error);}t.resultSet=new t.resultSetClass(t.resultSetProperties);t.resultSet.setJsonData(d);if(o){o(t.resultSet);}}).fail(function(e){if(a){a(e);}});}});s.Perspective2.prototype={init:function(a){a=a||{};},getFacetForID:function(a){var t=this;for(var j=0;j<t.facets.length;j++){if(t.facets[j].facetId===a){return t.facets[j];}}return undefined;},getDimensionForID:function(d){var t=this;for(var j=0;j<t.dimensions.length;j++){if(t.dimensions[j].Name===d){return t.dimensions[j];}}return undefined;},getPreviewDimension:function(){if(this.bindings["WIDGET-4"]&&this.bindings["WIDGET-4"].dimension){return this.bindings["WIDGET-4"].dimension;}if(this.bindings["WIDGET-1"]&&this.bindings["WIDGET-1"].dimension){return this.bindings["WIDGET-1"].dimension;}if(this.bindings["WIDGET-2"]&&this.bindings["WIDGET-2"].dimension){return this.bindings["WIDGET-2"].dimension;}if(this.bindings["WIDGET-3"]&&this.bindings["WIDGET-3"].dimension){return this.bindings["WIDGET-3"].dimension;}return undefined;},setJsonData:function(d){var t=this;t.rawdata=d;t.ChangedAt=d.ChangedAt;t.ChangedBy=d.ChangedBy;t.content=JSON.parse(d.Content);t.perspectiveId=d.Id;t.name=d.Name;t.packageName=d.Package;t.isActive=d.isActive;t.isGenerated=d.isGenerated;t.datasource=t.content.Model.Queries[0].Datasource;t.measures=[];var m=t.content.Model.Queries[0].CustomDimension1.Members;for(var k=0;k<m.length;k++){t.measures.push(m[k]);}t.dimensions=[];var a=t.content.Model.Queries[0].Dimensions;for(var j=0;j<a.length;j++){t.dimensions.push(a[j]);}t.facets=[];var b=t.content.Model.Facets;for(var i=0;i<b.length;i++){t.facets.push({isActive:b[i].Active,facetId:b[i].FacetId,dimension:t.getDimensionForID(b[i].SeriesChart.ScaleDimensions[0].DimensionName)});}t.bindings={};var c=t.content.Bindings;for(var l=0;l<c.length;l++){var e=c[l];t.bindings[e.WidgetId]=t.getFacetForID(e.FacetId);}}};s.PerspectiveSearchQuery.prototype=jQuery.extend({},s.Query.prototype,{init:function(a){a=a||{};s.Query.prototype.init.apply(this,[a]);this.filter.searchTerms=a.searchTerms||"*";this.resultSetClass=s.PerspectiveSearchResultSet;},createJsonRequest:function(){var t=p.getPerspectiveSearchRequest();t.Search.SearchTerms=this.filter.searchTerms;t.Search.Top=this._top;t.Search.Skip=this._skip;return t;},getPerspectiveResults:function(o,a){this.getResultSet(o,a);}});s.PerspectiveSearchResultSet.prototype={init:function(a){var t=this;t.perspectives=[];a=a||{};},getPerspectiveSearchResultSet:function(){return this.perspectives;},setJsonData:function(d){var t=this;var a=d["ItemLists"][0]["Items"];for(var i=0;i<a.length;i++){var n=a[i]["NamedValues"];var b={packageId:n[0].Value,perspectiveId:n[0].Value+"/"+n[1].Value,perspectiveDescription:n[3].Value,title:n[2].Value};t.perspectives.push(b);}}};s.SuggestionQuery.prototype=jQuery.extend({},f.SuggestionQuery.prototype,s.Query.prototype,{init:function(a){a=a||{};this.attributes=a.attributes||[];s.Query.prototype.init.apply(this,arguments);f.SuggestionQuery.prototype.init.apply(this,arguments);this.resultSetClass=s.SuggestionResultSet;},addResponseAttribute:function(a){this.attributes.push(a);this._resetResultSet();return this;},setResponseAttributes:function(a){this.attributes=a;this._resetResultSet();return this;},createJsonRequest:function(){var t=p.getSuggestionRequest();t.Suggestions.Precalculated=false;var a=this.filter.getSearchTerms();if(this.attributes.length===0){throw"add at least one response attribute to your query";}t.Suggestions.SearchTerms=a;t.Suggestions.AttributeNames=this.attributes;t.DataSource=this.filter.dataSource.toInAJson();t.Suggestions.Top=this._top;var q=this.filter.getJson();if(q&&q.Selection){t.Suggestions.Filter=this.filter.getJson();}return t;}});s.SuggestionResultSet.prototype={init:function(){this.suggestions=[];},setJsonData:function(c){this.suggestions=[];var e={};for(var i=0;i<c.ItemLists.length;i++){e[c.ItemLists[i].Name]=c.ItemLists[i];}for(var a=0;a<e.Suggestions.Items.length;a++){var h=e.Suggestions.Items[a],t="",j="",k="";var l={};for(var d=0;d<h.NamedValues.length;++d){var n=h.NamedValues[d];switch(n.Name){case"Term":t=n.Value;l.label=t;break;case"AttributeName":j=n.Value;l.attribute=j;break;case"$$AttributeDescription$$":k=n.Value;l.attributeDescription=k;break;case"Score":var m=n.Value;l.score=parseInt(m,10);break;}}this.suggestions.push(l);}this.suggestions.sort(function(a,b){return b.score-a.score;});for(var o=this.suggestions.length-1;o>=0;o--){delete this.suggestions[o].score;}},getElements:function(){return this.suggestions;}};s.Suggestion2Query.prototype=jQuery.extend({},f.SuggestionQuery.prototype,s.Query.prototype,{init:function(a){a=a||{};this.attributes=a.attributes||[];s.Query.prototype.init.apply(this,[a]);f.SuggestionQuery.prototype.init.apply(this,[a]);this.resultSetClass=s.Suggestion2ResultSet;this.searchTerms=a.searchTerms||{};this.suggestionTerm=a.suggestionTerm||'';this.options=['SynchronousRun'];},addResponseAttribute:function(a){this.attributes.push(a);this._resetResultSet();return this;},setOptions:function(o){this.options=o;this._resetResultSet();return this;},addSearchTerm:function(t){if(t){this.searchTerms[t]=t;}this._resetResultSet();return this;},clearSearchTerms:function(){this.searchTerms={};this._resetResultSet();return this;},setSuggestionTerm:function(t){if(this.suggestionTerm!==t){this.suggestionTerm=t;this._resetResultSet();}return this;},setResponseAttributes:function(a){this.attributes=a;this._resetResultSet();return this;},createJsonRequest:function(){var t=p.getSuggestion2Request();t.Suggestions2.Precalculated=false;t.Suggestions2.NamedValues=[];for(var i=0;i<this.attributes.length;i++){t.Suggestions2.NamedValues.push({AttributeName:this.attributes[i],Name:this.attributes[i]});}t.DataSource=this.filter.dataSource.toInAJson();t.Suggestions2.Top=this.getTop();t.Suggestions2.Skip=this.getSkip();var a=new q.ConditionGroup();for(var b in this.searchTerms){var c=new q.Condition('$$SearchTerms$$','contains',b);a.addCondition(c);}var d=new q.Condition('$$SuggestionTerms$$','contains',this.suggestionTerm);a.addCondition(d);a.addCondition(this.getFilter().getFilterConditions());t.Suggestions2.Filter=a.getJson();t.Options=this.options;return t;}});s.Suggestion2ResultSet.prototype={init:function(){this.datasources={};this.suggestions=[];},setJsonData:function(b){this.datasources={};this.suggestions=[];var e={};if(!b.ItemLists){return;}for(var i=0;i<b.ItemLists.length;i++){e[b.ItemLists[i].Name]=b.ItemLists[i];}for(var a=0;a<b.Grids.length;a++){var h=b.Grids[a].Axes;var k=b.Grids[a].Cells;if(h===undefined||k===undefined){return;}for(var l=0;l<k.length;++l){var m=k[l],n="",o={};o.dataSource=new r.DataSource();o.attribute={};for(var j=0;j<m.Index.length;j++){var t=m.Index[j];var u=h[j].Tuples[t];if(u===undefined){continue;}for(var c=0;c<u.length;c++){var v=h[j].Dimensions[c];var w=u[c];var x=e[v.ItemListName];var y=x.Items[w].NamedValues;for(var d=0;d<y.length;++d){var z=y[d];switch(z.Name){case"$$Term$$":o.scope=z.Scope;o.label=z.ValueFormatted;o.valueRaw=m.Value||m.ValueFormatted||null;o.value=m.ValueFormatted||m.Value||null;var A=z.Value;if(o.scope==='DataSources'){o.labelRaw=new r.DataSource({objectName:A,label:o.label.replace(/<b>|<\/b>/ig,"")});}else{o.labelRaw=A;}if(!o.filter){o.filter={};}o.filter.value=A;o.filter.valueLabel=A;break;case"$$DataSource$$":var B=z.Value;if(B==='$$AllDataSources$$'){o.dataSource=r.getRootDataSource();}else{o.dataSource.setObjectNameValue(B);}break;case"$$DataSourceDescription$$":var C=z.Value;o.dataSource.setObjectNameLabel(C);break;case"$$Attribute$$":var D=z.Value;if(!o.filter){o.filter={};}o.filter.attribute=D;o.attribute.value=D;break;case"$$AttributeDescription$$":n=z.Value;if(!o.filter){o.filter={};}o.filter.attributeLabel=n;o.attribute.label=n;break;}}}}this.suggestions.push(o);}}},getElements:function(){return this.suggestions;}};s.ChartQuery.prototype=jQuery.extend({},f.ChartQuery.prototype,s.Query.prototype,{init:function(a){a=a||{};s.Query.prototype.init.apply(this,[a]);f.ChartQuery.prototype.init.apply(this,[a]);this.dimensions={};this.dimensions.CustomDimension1={Axis:"Columns",Name:"CustomDimension1",Members:[]};a.dimensions=a.dimensions||{};if(jQuery.type(a.dimensions)==='array'){for(var i=0;i<a.dimensions.length;i++){this.addDimension(a.dimensions[i]);}}else if(jQuery.type(a.dimensions)==='string'||jQuery.type(a.dimensions)==='object'){this.addDimension(a.dimensions);}a.measures=a.measures||{};if(jQuery.type(a.measures)==='array'){for(var j=0;j<a.measures.length;j++){this.addMeasure(a.measures[j]);}}else if(jQuery.type(a.measures)==='object'){this.addMeasure(a.measures);}this.resultSetClass=s.ChartResultSet;},createJsonRequest:function(){var t=p.getChartRequest();t.DataSource=this.filter.dataSource.toInAJson();t.SearchTerms=this.filter.getSearchTerms();t.Analytics.Definition.Filter=this.filter.getJson();t.Analytics.Definition.Dimensions=[];for(var d in this.dimensions){t.Analytics.Definition.Dimensions.push(this.dimensions[d]);}return t;},count:function(d){this.addMeasure({name:d,aggregationFunction:'COUNT'});return this;},addMeasure:function(a){if(jQuery.isEmptyObject(a)){return{};}var m;if(a.aggregationFunction.toUpperCase()==='COUNT'||a.aggregationFunction.toUpperCase()==='AVG'){m=this._createAggregationDimension(a.aggregationFunction,a.name,a.aggregationFunction,a.sortOrder||undefined,a.top||undefined);}else{m=this._createAggregationDimension(a.aggregationFunction,'',a.name,a.sortOrder,a.top);delete m.AggregationDimension;delete m.Name;delete m.SortOrder;}this.dimensions.CustomDimension1.Members.push(m);return this;},addDimension:function(d,a,t){if(jQuery.type(d)==='object'){if(jQuery.isEmptyObject(d)){return{};}this.dimensions[d.name]=this._createDimension(d.name,null,d.sortOrder,d.top);}else if(jQuery.type(d)==='string'){if(!d){return{};}this.dimensions[d]=this._createDimension(d,null,a,t);}return this;},_createDimension:function(d,a,b,t){return{"Axis":a||"Rows","Name":d,"SortOrder":b||1,"Top":t||5};},_createAggregationDimension:function(a,b,n,c){return{"Aggregation":a,"AggregationDimension":b,"MemberOperand":{"AttributeName":"Measures","Comparison":"=","Value":n},"Name":n,"SortOrder":c||2};}});s.ChartResultSet.prototype={init:function(a){a=a||{};this.type=a.type;this.elements=[];},_parseNamedValues:function(e,n,m){var t=this;for(var i=0;i<n.length;i++){var a=n[i].Name;var v=n[i].Value;e.label=n[i].ValueFormatted;e.labelRaw=n[i].Value;switch(a){case'$$DataSource$$':t._parseNamedValuesForDataSource(e,v);break;case'$$AttributeValue$$':t._parseNamedValuesForRange(e,v,m);break;}}},_parseNamedValuesForRange:function(e,v,m){var a,b,c;for(var d=0;d<v.length;++d){var n=v[d];switch(n.Name){case"ValueID":e.label=n.ValueFormatted;a=n.Value;break;case"Value1":if(m.Cube.ObjectName&&(n.Value!==undefined)){b=new q.Condition(m.Cube.ObjectName,">=",n.Value);}break;case"Value2":if(m.Cube.ObjectName&&(n.Value!==undefined)){c=new q.Condition(m.Cube.ObjectName,"<=",n.Value);}break;case"Order":break;}}if(a){if(b&&c){var h=new q.ConditionGroup();h.setOperator("AND");h.setLabel(e.label);if(b.value){h.addCondition(b);}if(c.value){h.addCondition(c);}e.labelRaw=h;}else if(b&&b.value&&(!c)){b.operator='=';e.labelRaw=b;}else if(c&&c.value&&(!b)){c.operator='=';e.labelRaw=c;}}},_parseNamedValuesForDataSource:function(e,v){e.dataSource=new r.DataSource();for(var d=0;d<v.length;++d){var n=v[d];switch(n.Name){case"ObjectName":var l=n.ValueFormatted;e.dataSource.setLabel(l);e.dataSource.setObjectName(n.Value,n.ValueFormatted);break;case"PackageName":e.dataSource.setPackageName(n.Value,n.ValueFormatted);break;case"SchemaName":e.dataSource.setSchemaName(n.Value,n.ValueFormatted);break;case"Type":e.dataSource.setType(n.Value,n.ValueFormatted);break;default:e[n.Name]=n.Value;break;}}},setJsonData:function(d){this.elements=[];var m;if(d.Metadata){m=d.Metadata;}if(d.ResultSet){d=d.ResultSet;}var b={};for(var i=0;i<d.ItemLists.length;i++){b[d.ItemLists[i].Name]=d.ItemLists[i];}for(var a=0;a<d.Grids.length;a++){var e=d.Grids[a].Axes;var h=d.Grids[a].Cells;for(var k=0;k<h.length;++k){if(e[0].Dimensions.length===1){var l=h[k];var n={valueRaw:l.Value||l.ValueFormatted||null,value:l.ValueFormatted||l.Value||null};for(var j=0;j<1;j++){var o=l.Index[j];var t=e[j].Tuples[o];if(t===undefined){continue;}for(var c=0;c<t.length;c++){var u=e[j].Dimensions[c];var v=t[c];var w=b[u.ItemListName];var x=w.Items[v].NamedValues;this._parseNamedValues(n,x,m);}}this.elements.push(n);}}}},getElements:function(){return this.elements;}};var R=function(){this.init.apply(this,arguments);};R.prototype={init:function(o){this.resultSet=o.resultSet;this.parse();},parse:function(){this.enhance(this.resultSet);var a=this.resultSet.Grids[0];var b=a.Axes[0];var c=a.Axes[1];var k=function(n){return n.NamedValues[0].Value;};var t=new T({keyFunction:k});for(var i=0;i<a.Cells.length;++i){var d=a.Cells[i];var e=d.Index[0];var h=this.resolve(b,e);var j=d.Index[1];var l=this.resolve(c,j);l=[jQuery.extend({},l[0])];l[0].cell=d;var m=h;m.push.apply(m,l);t.insert(m);}return t;},resolve:function(a,b){var c=[];var t=a.Tuples[b];for(var i=0;i<t.length;++i){var d=t[i];var e=a.Dimensions[i].ItemList.Items[d];c.push(e);}return c;},enhance:function(a){var b={};for(var i=0;i<a.ItemLists.length;++i){var c=a.ItemLists[i];b[c.Name]=c;}for(var h=0;h<a.Grids.length;++h){var d=a.Grids[h];for(var j=0;j<d.Axes.length;++j){var e=d.Axes[j];for(var k=0;k<e.Dimensions.length;++k){var l=e.Dimensions[k];l.ItemList=b[l.ItemListName];}}}}};var T=function(){this.init.apply(this,arguments);};T.prototype={init:function(o){this.root={data:"root",subTree:{}};if(o&&o.keyFunction){this.keyFunction=o.keyFunction;}else{this.keyFunction=function(a){return a;};}},insert:function(a){var b=this.root;for(var i=0;i<a.length;++i){var c=a[i];var k=this.keyFunction(c);if(!b.subTree.hasOwnProperty(k)){b.subTree[k]={subTree:{},data:c};}b=b.subTree[k];}},toString:function(){var a=[];this.toStringHelper(this.root,[],a);return a.join("");},toStringHelper:function(t,a,b){var c=null;if(t===this.root){c=t.data;}else{c=this.keyFunction(t.data);}a.push(c);var h=false;for(var d in t.subTree){if(t.subTree.hasOwnProperty(d)){h=true;var e=t.subTree[d];var i=a.slice(0);this.toStringHelper(e,i,b);}}if(!h){b.push(a.toString()+"\n");}}};s.GroupBarChartQuery.prototype=jQuery.extend({},s.ChartQuery.prototype,{init:function(a){a=a||{};s.ChartQuery.prototype.init.apply(this,[a]);this.resultSetClass=s.GroupBarChartResultSet;}});s.GroupBarChartResultSet.prototype={init:function(a){a=a||{};this.elements=[];},setJsonData:function(d){var t=this;this.elements=[];var a=new R({resultSet:d});var b=a.parse();function c(e,h){for(var i in e){var j=e[i];var k={label:j.data.NamedValues[0].ValueFormatted,value:[]};if(j.data.cell){k.value={value:j.data.cell.ValueFormatted,valueRaw:j.data.cell.Value};}if(h){h.value.push(k);}else{t.elements.push(k);}if(j.subTree){c(j.subTree,k);}}}c(b.root.subTree);},getElements:function(){return this.elements;}};s.LineChartQuery.prototype=jQuery.extend({},s.ChartQuery.prototype,{init:function(a){a=a||{};s.ChartQuery.prototype.init.apply(this,[a]);this.resultSetClass=s.LineChartResultSet;}});s.LineChartResultSet.prototype=jQuery.extend({},s.GroupBarChartResultSet.prototype,{init:function(a){a=a||{};this.elements=[];},setJsonData:function(d){var t=this;this.elements=[];var a=new R({resultSet:d});var b=a.parse();function c(e,h){for(var i in e){var j=e[i];var k={label:j.data.NamedValues[0].ValueFormatted,value:[]};for(var l in j.subTree){var m=j.subTree[l];var n={x:m.data.NamedValues[0].ValueFormatted};for(var o in m.subTree){var u=m.subTree[o];n.y=u.data.cell.Value;}k.value.push(n);}t.elements.push(k);}}c(b.root.subTree);},getElements:function(){return this.elements;}});s.SearchQuery.prototype=jQuery.extend({},f.SearchQuery.prototype,s.Query.prototype,{init:function(a){a=a||{};s.Query.prototype.init.apply(this,[a]);f.SearchQuery.prototype.init.apply(this,[a]);this.sqlSearch=(a.sqlSearch===undefined||a.sqlSearch===true)?true:false;this.attributes=a.attributes||[];a.orderBy=a.orderBy||{};this.setOrderBy(a.orderBy);this.resultSetClass=s.SearchResultSet;},addResponseAttribute:function(a){this.attributes.push(a);this._resetResultSet();return this;},createJsonRequest:function(){var t=p.getSearchRequest();t.DataSource=this.filter.dataSource.toInAJson();if(this.system instanceof g.sap.bc.ina.api.sina.impl.inav2.system.HANASystem){if(this.attributes.length===0){throw{message:"Add at least one response attribute to your query"};}if(this.sqlSearch===true){t.Options=["SqlSearch"];}}var a=[];for(var i=0;i<this.attributes.length;++i){var b=this.attributes[i];if(jQuery.type(b)==='string'){a.push({Name:b,AttributeName:b});}else if(jQuery.type(b)==='object'){var c={Name:b.name||b.attributeName,AttributeName:b.attributeName||b.name};if(b.highlighted===true){c.Function='Highlighted';}if(b.snippet===true){c.Function='Snippet';}if(b.startPosition!==undefined){c.StartPosition=b.startPosition;}if(b.maxLength!==undefined){c.MaxLength=b.maxLength;}a.push(c);}}t.Search.SelectedValues=a;var d=this.filter.getSearchTerms();if(!d){d='*';}t.SearchTerms=d;t.Search.Top=this._top;t.Search.Skip=this._skip;t.Search.Filter=this.filter.getJson();t.Search.OrderBy=this._assembleOrderBy();return t;},setOrderBy:function(o){this._resetResultSet();this.orderBy=o||{orderBy:'$$score$$',sortOrder:'DESC'};}});s.SearchResultSet.prototype={init:function(a){a=a||{};this.sina=a.sina;this.elements=[];this.totalcount=0;},toString:function(a){var e=this.elements;var b=[];var i;for(i=0;i<e.length;++i){var c=e[i];var d={};for(var h in c){if(h.slice(0,2)==='$$'||h.slice(0,1)==='_'){continue;}var j=c[h];if(!j.label||!j.value){continue;}var k={label:j.label,value:j.value};d[h]=k;}b.push(d);}return JSON.stringify(b);},setJsonData:function(d){var a=this;this.elements=[];function b(){this.type="";this.platform="";this.technology="";this.width="";this.height="";this.variant="";this.uri="";}b.prototype={_fromInaJson:function(k){this.type=k.Type||"";this.platform=k.Platform||"";this.technology=k.Technology||"";this.width=k.Width||"";this.height=k.Height||"";this.variant=k.Variant||"";this.uri=k.Uri||"";}};function e(){this.type="";this.description="";this.uri="";this.request=null;this.encodedJSON="";}e.prototype={_fromInaJson:function(k){var l=this;l.description=k.Description;l.uri=k.Uri;switch(k.Type){case"RelatedRequest":l.type='Search';var m={};m.dataSource=new r.DataSource();m.dataSource.fromInAJson(k.Request.DataSource);m.system=g.sap.bc.ina.api.sina.getSystem();m.top=1;l.request=a.sina.createSearchQuery(m);l.request.filter.setJson(k.Request.Filter);if(k.Request.Filter.Selection===undefined){l.request.invalid=true;l.request.invalidMessage="Related request '"+l.description+"' is invalid because of missing filter conditions.";}break;case"GeneralUri":l.type='Link';l.url=l.uri;break;case"SAPNavigation":l.type='Navigation';l.url=l.uri;break;}l.encodedJSON=encodeURIComponent(l);}};function h(k){this.resultElementAttribute=k;this.correspondingSearchAttributeName="";this.description="";this.isTitle=false;this.presentationUsage=[];this.displayOrder=null;this.semanticObjectType="";}h.prototype={_fromInaJson:function(k){var l=this;l.correspondingSearchAttributeName=k.correspondingSearchAttributeName||"";l.dataType=k.DataType||"";l.description=k.Description||"";l.presentationUsage=k.presentationUsage||[];l.semanticObjectType=k.SemanticObjectType||"";if(k.IsTitle!==undefined){l.isTitle=k.IsTitle;}if(l.isTitle){if(!l.resultElementAttribute.resultElement.title){l.resultElementAttribute.resultElement.title=l.resultElementAttribute.resultElement.$$DataSourceMetaData$$.getLabel()+":";}l.resultElementAttribute.resultElement._registerPostProcessor(function(){l.resultElementAttribute.resultElement.title=l.resultElementAttribute.resultElement.title+" "+l.resultElementAttribute.value;});}}};function t(k){this.resultElement=k;this.$$MetaData$$=new h(this);this.label="";this.labelRaw="";this.value="";this.valueRaw="";}t.prototype={_fromInaJson:function(k){var l=this;l.labelRaw=this.$$MetaData$$.correspondingSearchAttributeName||k.Name||"";l.label=this.$$MetaData$$.description||k.Name||"";l.valueRaw=k.Value||null;l.value=k.ValueFormatted||null;},toString:function(){return this.value;}};function u(){this.title="";this.$$DataSourceMetaData$$={};this.$$RelatedActions$$={};this.$$RenderingTemplateSpecification$$={};this.$$WhyFound$$=[];this.$$PostProcessors$$=[];}u.prototype={_fromInaJson:function(D){var J=this;for(var k=0;k<D.length;++k){var K=D[k];switch(K.Name){case"$$DataSourceMetaData$$":var L=K.Value[0];var M=new r.DataSource(L);J.$$DataSourceMetaData$$=M;break;case"$$AttributeMetadata$$":for(var m=0;m<K.Value.length;++m){var N=K.Value[m];if(!J[N.Name]){J[N.Name]=new t(J);}J[N.Name].$$MetaData$$._fromInaJson(N);J[N.Name].$$MetaData$$.displayOrder=m;}break;case"$$ResultItemAttributes$$":for(var l=0;l<K.Value.length;++l){var O=K.Value[l];if(!J[O.Name]){J[O.Name]=new t(J);}J[O.Name]._fromInaJson(O);}break;case"$$RelatedActions$$":var P={};for(var n=0;n<K.Value.length;++n){var Q=K.Value[n];var S=new e();S._fromInaJson(Q);P[Q.ID]=S;}J.$$RelatedActions$$=P;break;case"$$RenderingTemplateSpecification$$":for(var o=0;o<K.Value.length;++o){var U=new b();U._fromInaJson(K.Value[o]);if(U.type==="ItemDetails"){J._detailTemplate=U;}else{J.$$RenderingTemplateSpecification$$=U;}}break;case"$$WhyFound$$":for(var z=0;z<K.Value.length;++z){var V={};V.label=K.Value[z].Description;V.labelRaw=K.Value[z].Name;V.value=K.Value[z].Value;V.valueHighlighted=V.value;V.valueRaw=K.Value[z].Value;J.$$WhyFound$$.push(V);}break;default:J[K.Name]=new t();J[K.Name].label=K.Name||"";J[K.Name].valueRaw=K.Value||K.ValueFormatted||null;J[K.Name].value=K.ValueFormatted||K.Value||null;}}for(var i=0;i<this.$$PostProcessors$$.length;i++){this.$$PostProcessors$$[i]();}},_registerPostProcessor:function(k){this.$$PostProcessors$$.push(k);}};function _(y){if(y._detailTemplate&&!y.$$RelatedActions$$.$$DETAILS$$){y.$$RelatedActions$$.$$DETAILS$$={request:a.sina.createSearchQuery(),description:'',encodedJSON:'',type:'Search',uri:''};}if(y._detailTemplate&&y.$$RelatedActions$$.$$DETAILS$$){var k=new s.SearchResultSet({sina:a.sina});k.elements[0]=jQuery.extend(true,{},y);k.elements[0].$$RenderingTemplateSpecification$$=y._detailTemplate;k.totalcount=1;delete k.elements[0].$$RelatedActions$$.$$DETAILS$$;y.$$RelatedActions$$.$$DETAILS$$.request.resultSet=k;return k.elements[0];}return{};}var v={};if(!d.ItemLists){return{};}for(var i=0;i<d.ItemLists.length;i++){v[d.ItemLists[i].Name]=d.ItemLists[i];if(d.ItemLists[i].Name.toLowerCase()==="searchresult"){this.totalcount=d.ItemLists[i].TotalCount.Value;}}var w;if(d&&d.Grids&&d.Grids[0]&&d.Grids[0].Axes&&d.Grids[0].Axes[0]){w=d.Grids[0].Axes[0];}else{return{};}for(var j=0;j<w.Tuples.length;j++){var x=w.Tuples[j];if(x===undefined){continue;}var y=new u();for(var c=x.length-1;c>=0;c--){var A=w.Dimensions[c];var B=x[c];var C=v[A.ItemListName];var D=C.Items[B].NamedValues;y._fromInaJson(D);}if(w&&w.Dimensions[1]){var E=w.Dimensions[1];var F=v[E.ItemListName];var G=x[1];if(F&&F.Items&&F.Items[G]){var H=F.Items[G].NamedValues[2];if(H){y=this._postProcess4WhyFound(y,H.Value);}}}var I=_(y);this._postProcessRelatedAction(y);if(I){this._postProcessRelatedAction(I);}this.elements.push(y);}return{};},getElements:function(){return this.elements;},_postProcessRelatedAction:function(e){if(!e.$$RelatedActions$$){return;}for(var a in e.$$RelatedActions$$){var b=e.$$RelatedActions$$[a];if(b.type==="Search"){g.sap.bc.ina.api.sina._postprocess(b,e.title);}}},_postProcess4WhyFound:function(e,m){if(e.$$WhyFound$$&&e.$$WhyFound$$.length>0){var i=e.$$WhyFound$$.length;while(i--){if(e[e.$$WhyFound$$[i].labelRaw]!==undefined&&m!==undefined){var j=m.length;while(j--){if(m[j].Name===e.$$WhyFound$$[i].labelRaw&&m[j].correspondingSearchAttributeName){e.$$WhyFound$$[i].labelRaw=m[j].correspondingSearchAttributeName;}}}}}return e;}};s.DataSourceQuery.prototype=jQuery.extend({},f.SearchQuery.prototype,s.SearchQuery.prototype,{init:function(a){f.SearchQuery.prototype.init.apply(this,[a]);s.SearchQuery.prototype.init.apply(this,[a]);this.template=p.getCatalogRequest();this.template.SearchTerms=this.getSearchTerms()||'*';if(this._top===undefined){this.setTop(1000);}this.template.Search.Top=this.getTop();if(this._skip===undefined){this.setSkip(0);}this.template.Search.Skip=this.getSkip();},createJsonRequest:function(){return this.template;}});s.ESHConnectorDataSourceQuery.prototype=jQuery.extend({},f.SearchQuery.prototype,s.SearchQuery.prototype,{init:function(a){f.SearchQuery.prototype.init.apply(this,[a]);s.SearchQuery.prototype.init.apply(this,[a]);this.template=p.getESHConnectorRequest();var b=this.system.getServerInfoSync();var c=b.rawServerInfo.ServerInfo.SystemId;var d=c+this.system.sapclient()+"~ESH_CONNECTOR~";var e=a.dataSource||{SchemaName:"",PackageName:"ABAP",ObjectName:d,type:"Connector"};this.template.DataSource=e;this.template.SearchTerms=this.getSearchTerms()||'*';if(this._top===undefined){this.setTop(1000);}this.template.Search.Top=this.getTop();if(this._skip===undefined){this.setSkip(0);}this.template.Search.Skip=this.getSkip();},createJsonRequest:function(){return this.template;}});s.UserHistory.prototype=jQuery.extend({},f.Query.prototype,s.Query.prototype,{init:function(a){a=a||{};f.Query.prototype.init.apply(this,[a]);s.Query.prototype.init.apply(this,[a]);},addUserHistoryEntry:function(n,a){var d={"SearchConfiguration":{"Action":"Update","ClientEvent":n}};return this._fireRequest(d,a,'text');},emptyUserHistory:function(a){var d={"SearchConfiguration":{"Action":"Update","Data":{"PersonalizedSearch":{"ResetUserData":true}}}};return this._fireRequest(d,a,'text');}});s.SearchConfiguration.prototype=jQuery.extend({},f.Query.prototype,s.Query.prototype,{init:function(a){a=a||{};f.Query.prototype.init.apply(this,[a]);s.Query.prototype.init.apply(this,[a]);},load:function(a){var d={"SearchConfiguration":{"Action":"Get","Data":{"PersonalizedSearch":{}}}};return this._fireRequest(d,a);},save:function(S,a){return this._fireRequest(S,a,'text');}});}(window));
/*
 * @file Simple info access (SINA) API: System representation
 * @namespace sap.bc.ina.api.sina.impl.inav2.system
 * @copyright 2014 SAP SE. All rights reserved.
 */
(function(g){"use strict";var b=g.sap.bc.ina.api.sina.base;var s=b.system;var p=g.sap.bc.ina.api.sina.impl.inav2.proxy;g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.impl.inav2.system');var m=g.sap.bc.ina.api.sina.impl.inav2.system;m.ABAPSystem=function(){this.init.apply(this,arguments);};m.HANASystem=function(){this.init.apply(this,arguments);};m.ABAPSystem.prototype=jQuery.extend({},s.System.prototype,{init:function(a){a=a||{};this.systemType='ABAP';this.inaUrl=a.inaUrl||'/sap/es/ina/GetResponse';this.infoUrl=a.infoUrl||'/sap/es/ina/GetServerInfo';a.proxy=a.proxy||new p.Proxy({'xsrfService':this.infoUrl});s.System.prototype.init.apply(this,[a]);this.properties={};if(a.sapclient){this.sapclient(a.sapclient);}else{var c=this._readSapClientFromUrl();this.sapclient(c);}if(a.saplanguage){this.saplanguage(a.saplanguage);}else{var d=this._getUrlParameter("sap-language");this.saplanguage(d);}},setSinaUrlParameter:function(n,v){v=''+v;if(n.toUpperCase()==='SAP-CLIENT'&&v.length<3){for(var i=0;i<2;i++){v='0'+v;}}var a=function(u){var c=(new RegExp(n+'='+'(.+?)(&|$)','i').exec(u)||[null])[1];if(!c){if(u.indexOf('?')===-1){u+='?'+encodeURIComponent(n)+'='+encodeURIComponent(v);}else{u+='&'+encodeURIComponent(n)+'='+encodeURIComponent(v);}}else{u=u.replace(n+'='+c,encodeURIComponent(n)+'='+encodeURIComponent(v));}return u;};this.infoUrl=a(this.infoUrl);this.inaUrl=a(this.inaUrl);},_getUrlParameter:function(n){var a=g.location.href;var v=(new RegExp(n+'='+'(.+?)(&|$)','i').exec(a)||[null])[1];if(!v){return v;}v=decodeURIComponent(v.replace(/\+/g,' '));return v;},_readSapClientFromUrl:function(){if(g.sap.bc.ina.api.sina.properties&&g.sap.bc.ina.api.sina.properties.noSapClientFromUrl&&g.sap.bc.ina.api.sina.properties.noSapClientFromUrl===true){return'';}return this._getUrlParameter('sap-client');},sapclient:function(a){if(a){this.properties.sapclient=a;this.setSinaUrlParameter('sap-client',this.properties.sapclient);this._deleteServerInfo();this.getServerInfo();}else{return this.properties.sapclient;}},saplanguage:function(l){if(l){this.properties.saplanguage=l;this.setSinaUrlParameter('sap-language',this.properties.saplanguage);}else{return this.properties.saplanguage;}},setServerInfo:function(j){this.properties.rawServerInfo=j;if(this instanceof m.ABAPSystem){this.properties.dbms=j.ServerInfo.DataBaseManagementSystem;this.properties.sapclient=j.ServerInfo.Client;this.properties.saplanguage=j.ServerInfo.UserLanguageCode;this.properties.systemid=j.ServerInfo.SystemId;}for(var i=0;i<j.Services.length;i++){this.services[j.Services[i].Service]=new s.Service(j.Services[i]);}}});m.HANASystem.prototype=jQuery.extend({},s.System.prototype,{init:function(a){a=a||{};this.systemType='HANA';this.infoUrl=a.infoUrl||'/sap/bc/ina/service/v2/GetServerInfo';this.inaUrl=a.inaUrl||'/sap/bc/ina/service/v2/GetResponse';a.proxy=a.proxy||new p.Proxy({'xsrfService':this.infoUrl});s.System.prototype.init.apply(this,[a]);this._setUpAjaxErrorHandler();},_setUpAjaxErrorHandler:function(){jQuery(g.document).ajaxError(function(e,j,a,t){switch(j.status){case 401:g.window.location='/sap/hana/xs/formLogin/login.html?x-sap-origin-location='+encodeURIComponent(g.window.location.pathname)+encodeURIComponent(g.window.location.search);break;case 404:return;}});}});}(window));(function(g){"use strict";g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.impl.odata2.datasource');var m=g.sap.bc.ina.api.sina.impl.odata2.datasource;var d=g.sap.bc.ina.api.sina.base.datasource;m.DataSource=function(){this.init.apply(this,arguments);};m.DataSource.prototype=jQuery.extend({},d.DataSource.prototype,{init:function(p){p=p||{};d.DataSource.prototype.init.apply(this,arguments);this.type=p.type||'EntitySet';this.entityType=p.entityType||p.name;this.label=p.label||'icognito datasource';this.labelPlural=p.labelPlural||'icognito datasource plural';this.serviceUrl=p.serviceUrl||'no go';this.metaUrl=p.metaUrl||'no go meta';this.key=this.type+'§§§'+this.entityType;if(!this.key){throw'Datasource has no key!! '+JSON.stringify(p);}},getType:function(){return this.type;},getLabel:function(){return this.label;},getLabelPlural:function(){return this.labelPlural;},toURL:function(){return{type:this.type,entityType:this.entityType,label:this.label,labelPlural:this.labelPlural,serviceUrl:this.serviceUrl,metaUrl:this.metaUrl};}});}(window));(function(g){"use strict";g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.impl.odata2.filter');var m=g.sap.bc.ina.api.sina.impl.odata2.filter;var f=g.sap.bc.ina.api.sina.base.filter;m.Filter=function(){this.init.apply(this,arguments);};m.Filter.prototype=jQuery.extend({},f.Filter.prototype,{init:function(p){f.Filter.prototype.init.apply(this,[p]);},hasFilterCondition:function(){return false;},addFilterCondition:function(){},resetFilterConditions:function(){}});}(window));(function(g){"use strict";g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.impl.odata2.system');var m=g.sap.bc.ina.api.sina.impl.odata2.system;var b=g.sap.bc.ina.api.sina.base;var s=b.system;m.System=function(){this.init.apply(this,arguments);};m.System.prototype=jQuery.extend({},s.System.prototype,{init:function(p){p=p||{};s.System.prototype.init.apply(this,[p]);},getServerInfo:function(){return jQuery.when(true);}});}(window));(function(g){"use strict";g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.impl.odata2');var m=g.sap.bc.ina.api.sina.impl.odata2;m.MetaDataService={metaDataMap:{},getMetaData:function(d){var t=this;if(!d||!d.key){throw'Datasource missing';}var a=t.metaDataMap[d.key];if(a){return jQuery.when(a);}return t._fireMetaRequest(d).then(function(b){var a=t._parseResponse(b);t.metaDataMap[d.key]=a;return a;});},_parseResponse:function(a){var b;$(a).find('EntityType').each(function(){var k=[];b={};$(this).find('Key>PropertyRef').each(function(){k.push($(this).attr('Name'));});$(this).find('Property').each(function(i){var c=$(this).attr('Name');b[c]={label:$(this).find('Annotation').attr('String')||c,labelRaw:c,type:$(this).attr('Type'),isTitle:$.inArray(c,k)===-1?false:true,presentationUsage:$.inArray(c,k)===-1?['Summary']:['Title'],displayOrder:i};});});return b;},_fireMetaRequest:function(d){var u='/christianhana'+d.metaUrl;var r={async:true,method:'GET',url:u,processData:false,dataType:'xml'};return $.ajax(r);}};}(window));(function(g){"use strict";g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.impl.odata2');var m=g.sap.bc.ina.api.sina.impl.odata2;var b=g.sap.bc.ina.api.sina.base;m.PerspectiveQuery=function(){this.init.apply(this,arguments);};m.PerspectiveQuery.prototype=jQuery.extend({},b.PerspectiveQuery.prototype,{init:function(){b.PerspectiveQuery.prototype.init.apply(this,arguments);},execute:function(){var t=this;var s=t.filter.searchTerms;var p;var u=t.filter.dataSource.serviceUrl;return $.ajax({method:'GET',data:{$inlinecount:'allpages',estimate:true,$top:10,$skip:0,search:s,$format:'json'},url:u}).then(function(d){p=new m.Perspective({sina:this.sina});return p.fromJson(d);});}});m.Perspective=function(){this.init.apply(this,arguments);};m.Perspective.prototype={init:function(p){var t=this;t.chartFacets=[];t.searchFacet=null;t.searchResultSet=null;},getSearchResultSet:function(){return this.searchResultSet;},getChartFacets:function(){return this.chartFacets;},getSearchFacet:function(){return this.searchFacet;},fromJson:function(d){var t=this;this.searchResultSet=new m.SearchResultSet({sina:this.sina});return this.searchResultSet.fromJson(d).then(function(){return t;});}};}(window));(function(g){"use strict";g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.impl.odata2');var m=g.sap.bc.ina.api.sina.impl.odata2;var b=g.sap.bc.ina.api.sina.base;m.SearchQuery=function(){this.init.apply(this,arguments);};m.SearchQuery.prototype=jQuery.extend({},b.SearchQuery.prototype,{init:function(){b.SearchQuery.prototype.init.apply(this,arguments);},execute:function(){var u=this.filter.dataSource.serviceUrl;return $.ajax({method:'GET',data:{$count:true,estimate:true,$top:500,$skip:0,$filter:'Search.search(term=%274500000001%27)'},url:u}).then(function(){return{};});}});m.SearchResultSet=function(){this.init.apply(this,arguments);};m.SearchResultSet.prototype={init:function(p){p=p||{};this.elements=[];this.elements.push({$$RelatedActions$$:[],$$WhyFound$$:[],$$DataSourceMetaData$$:this.dataSource,FIRST_NAME:{$$MetaData$$:{presentationUsage:['Title'],displayOrder:1},label:'First Name',labelRaw:'First Name',value:'Sally',valueRaw:'Sally'},LAST_NAME:{$$MetaData$$:{presentationUsage:['Summary'],displayOrder:2},label:'Last Name',labelRaw:'Last Name',value:'Spring',valueRaw:'Spring'}});this.totalcount=1;},getElements:function(){return this.elements;},createEmptyElement:function(d){return{$$RelatedActions$$:[],$$WhyFound$$:[],$$DataSourceMetaData$$:d};},createAttribute:function(a,c,d,e){var f;if(e){switch(e.type){case"Edm.DateTime":var r=/[-]?\d+/;var D=new Date(parseInt(r.exec(c)[0],10));var o=sap.ui.core.format.DateFormat.getDateInstance({style:"medium"});c=o.format(D);break;}f={$$MetaData$$:{presentationUsage:e.presentationUsage,displayOrder:d},label:e.label,labelRaw:e.labelRaw,value:c,valueRaw:c};}else{f={$$MetaData$$:{presentationUsage:[],displayOrder:d},label:a,labelRaw:a,value:c,valueRaw:c};}return f;},getDataSourcesByMetaInfo:function(e){var s=e.split('.');var a=s[s.length-1];for(var i=0;i<m.dataSources.length;i++){if(a===m.dataSources[i].entityType){return m.dataSources[i];}}return null;},parseRecord:function(r){var t=this;var d=t.getDataSourcesByMetaInfo(r.__metadata.type);return m.MetaDataService.getMetaData(d).then(function(a){var e=t.createEmptyElement(d);var c=0;for(var f in r){if(f[0]==='@'||f[0]==='_'){continue;}var h=r[f];e[f]=t.createAttribute(f,h,++c,a[f]);}return e;});},fromJson:function(d){var t=this;t.totalcount=d['@odata.count']||d.d['__count']||1;t.totalcount=parseInt(t.totalcount,10);var r=d.value||d.d.results;var e=[];t.elements=[];for(var i=0;i<r.length;++i){var a=r[i];e.push(this.parseRecord(a).done(function(c){t.elements.push(c);}));}return jQuery.when.apply(null,e).then(function(){return arguments;});}};}(window));(function(g){"use strict";g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.impl.odata2');var m=g.sap.bc.ina.api.sina.impl.odata2;var b=g.sap.bc.ina.api.sina.base;m.SuggestionQuery=function(){this.init.apply(this,arguments);};m.SuggestionQuery.prototype=jQuery.extend({},b.SuggestionQuery.prototype,{init:function(){b.SuggestionQuery.prototype.init.apply(this,arguments);}});}(window));(function(g){"use strict";g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina.impl.odata2');var m=g.sap.bc.ina.api.sina.impl.odata2;var b=g.sap.bc.ina.api.sina.base;var s=g.sap.bc.ina.api.sina.impl.odata2.system;var f=g.sap.bc.ina.api.sina.impl.odata2.filter;var d=g.sap.bc.ina.api.sina.impl.odata2.datasource;var p=g.sap.bc.ina.api.sina.proxy;m.dataSources=[new d.DataSource({label:'Patients Type',labelPlural:'Patients Types',entityType:'PatientsType',entitySetName:'Patients',serviceUrl:'/sap/hc/mri/search/services/SearchPatient.xsodata/Patients',metaUrl:'/sap/hc/mri/search/services/SearchPatient.xsodata/$metadata'}),new d.DataSource({label:'Documents Type',labelPlural:'Documents Types',entityType:'DocumentsType',entitySetName:'Documents',serviceUrl:'/sap/hc/mri/search/services/SearchDocument.xsodata/Documents',metaUrl:'/sap/hc/mri/search/services/SearchDocument.xsodata/$metadata'})];m.Sina=function(){this.init.apply(this,arguments);};m.Sina.prototype=jQuery.extend({},b.Sina.prototype,{init:function(){this.setSystem(new s.System({proxy:new p.Proxy({})}));b.Sina.prototype.init.apply(this,arguments);this.rootDataSource=new d.DataSource({label:'All',labelPlural:'All',name:'$$ALL$$'});},getRootDataSource:function(){return this.rootDataSource;},getAllDataSources:function(){return jQuery.when(m.dataSources);}});m.IMPL_TYPE='odata2';b.registerProvider({impl_type:m.IMPL_TYPE,sina:m.Sina,searchQuery:m.SearchQuery,suggestionQuery:m.SuggestionQuery,perspectiveQuery:m.PerspectiveQuery,Filter:f.Filter,DataSource:d.DataSource,getAllDataSources:m.getAllDataSources});}(window));
/*
 * @file Simple info access (SINA) API: Factory
 * @namespace sap.bc.ina.api.sina
 * @requires jQuery
 * @copyright 2014 SAP SE. All rights reserved.
 */
(function(g){"use strict";var b=g.sap.bc.ina.api.sina.base;g.sap.bc.ina.api.sina.expandPackage(g,'sap.bc.ina.api.sina');var m=g.sap.bc.ina.api.sina;m.properties=m.properties||{};if(m.impl&&m.impl.inav2&&m.impl.inav2.IMPL_TYPE){m.SINA_TYPE_INAV2=m.impl.inav2.IMPL_TYPE;}m.getSina=function(p){p=p||{};p.impl_type=p.impl_type||m.SINA_TYPE_INAV2;if(p.impl_type===m.SINA_TYPE_INAV2){if(!p.system){var i=m.impl.inav2.proxy;var a=m.impl.inav2.system;var n=new i.Proxy(p);var s;if(p.systemType&&p.systemType.toUpperCase()==='ABAP'){s=new a.ABAPSystem({'proxy':n});}else{s=new a.HANASystem({'proxy':n});}n.setXSRFService(s.infoUrl);p.system=s;}}if(b.provider[p.impl_type]&&b.provider[p.impl_type].sina){var c=new b.provider[p.impl_type].sina(p);c._provider=b.provider[p.impl_type];return c;}return{};};m.properties.impl_type=m.properties.impl_type||'inav2';g.sap.bc.ina.api.sina=jQuery.extend({},m,m.getSina(m.properties));return g.sap.bc.ina.api.sina;}(window));
